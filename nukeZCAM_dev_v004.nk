#! /Applications/Nuke13.0v3/Nuke13.0v3.app/Contents/MacOS/libnuke-13.0.3.dylib -nx
version 13.0 v3
define_window_layout_xml {<?xml version="1.0" encoding="UTF-8"?>
<layout version="1.0">
    <window x="0" y="25" w="2560" h="1470" maximized="1" screen="0">
        <splitter orientation="1">
            <split size="40"/>
            <dock id="" hideTitles="1" activePageId="Toolbar.1">
                <page id="Toolbar.1"/>
            </dock>
            <split size="1897" stretch="1"/>
            <splitter orientation="2">
                <split size="851"/>
                <dock id="" activePageId="Viewer.1">
                    <page id="Viewer.1"/>
                </dock>
                <split size="599"/>
                <dock id="" activePageId="DAG.1" focus="true">
                    <page id="DAG.1"/>
                    <page id="Curve Editor.1"/>
                    <page id="DopeSheet.1"/>
                </dock>
            </splitter>
            <split size="615"/>
            <dock id="" activePageId="Properties.1">
                <page id="Properties.1"/>
                <page id="uk.co.thefoundry.backgroundrenderview.1"/>
            </dock>
        </splitter>
    </window>
</layout>
}
Root {
 inputs 0
 name /Users/afry/GitHub/nukeZCAM/nukeZCAM_dev_v004.nk
 mapsize {0.1093260188 0.09103641457}
 frame 82
 last_frame 480
 lock_range true
 format "2048 1556 0 0 2048 1556 1 2K_Super_35(full-ap)"
 proxy_type scale
 proxy_format "1024 778 0 0 1024 778 1 1K_Super_35(full-ap)"
 colorManagement Nuke
 OCIO_config custom
 customOCIOConfigPath /Users/afry/Documents/GitHub/OpenColorIO-Configs/aces_1.2/config.ocio
 workingSpaceLUT linear
 monitorLut sRGB
 monitorOutLUT rec709
 int8Lut sRGB
 int16Lut sRGB
 logLut Cineon
 floatLut linear
}
BackdropNode {
 inputs 0
 name BackdropNode1
 label "writeNode = nuke.toNode('Write4')\nreadNode = nuke.toNode('Read68')\n\n\nfor i in range(0,1024):\n    nuke.execute(writeNode, i, i)\n    readNode.knob('reload').execute()"
 xpos 663
 ypos 1681
 bdwidth 196
 bdheight 107
}
BackdropNode {
 inputs 0
 name BackdropNode2
 label "writeNode = nuke.toNode('Write4')\nreadNode = nuke.toNode('Read68')\n\n\nfor i in range(0,1024):\n    nuke.execute(writeNode, i, i)\n    readNode.knob('reload').execute()"
 xpos 108
 ypos 1690
 bdwidth 196
 bdheight 107
}
Shuffle2 {
 inputs 0
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 name Shuffle1
 xpos 1207
 ypos 189
}
Reformat {
 inputs 0
 type "to box"
 format "256 256 0 0 256 256 1 square_256"
 box_width 256
 box_height 256
 box_fixed true
 name Reformat1
 xpos -1424
 ypos 314
}
Ramp {
 p0 {0 0}
 p1 {{width i} 0}
 name Ramp2
 xpos -1424
 ypos 338
}
Grade {
 white {1.399999976 0.5600000024 1 1}
 gamma {0.6100000143 1.320000052 0.6499999762 1}
 name Grade2
 xpos -1424
 ypos 362
}
Expression {
 expr0 "y==floor(r(x, pos.y)*height*mult)?1:0"
 expr1 "y==floor(g(x, pos.y)*height*mult)?1:0"
 expr2 "y==floor(b(x, pos.y)*height*mult)?1:0"
 channel3 alpha
 name PlotScanline
 xpos -1424
 ypos 423
 addUserKnob {20 User}
 addUserKnob {12 pos}
 addUserKnob {7 mult R 0 5}
 mult 1
}
Constant {
 inputs 0
 channels rgb
 color 0.18
 name Constant2
 xpos 62
 ypos -684
}
set N204f8c00 [stack 0]
EXPTool {
 mode Stops
 red 1
 green 1
 blue 1
 name Exposure1
 xpos -46
 ypos -611
}
push $N204f8c00
Expression {
 temp_name0 stop
 temp_expr0 1
 channel0 rgba
 expr0 r*pow(2,1)
 name Expression2
 xpos 62
 ypos -612
}
Reformat {
 inputs 0
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Reformat2
 xpos 156
 ypos -685
}
Expression {
 channel0 rgba
 expr0 .18*pow(2,(cx*7))
 name Expression1
 xpos 156
 ypos -653
}
Ramp {
 p0 {0 0}
 p1 {{width} 0}
 color 20
 name Ramp1
 xpos 156
 ypos -612
 disable true
}
Read {
 inputs 0
 file_type exr
 file "/Users/afry/Downloads/thomas-mansencal 2/images/Cornell_Box_Rigid_Spheres_190_Patch_Roughplastic_CIE_1931_2_Degree_Standard_Observer_XYZ.exr"
 format "1024 1024 0 0 1024 1024 1 square_1K"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read94
 xpos 14257
 ypos -487
}
Colorspace {
 colorspace_in CIE-XYZ
 primary_out ACES
 name Colorspace44
 xpos 14257
 ypos -407
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_04_reconstruction_update_2015/beerfest_lightshow_04_003485.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read90
 xpos 13910
 ypos -486
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace26
 xpos 13910
 ypos -406
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_04/beerfest_lightshow_04_004121.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read89
 xpos 13763
 ypos -482
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace25
 xpos 13763
 ypos -402
}
Reformat {
 inputs 0
 type "to box"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 box_width 274
 box_height 1080
 box_fixed true
 name Reformat14
 xpos 13521
 ypos -1067
}
Radial {
 area {72.1875 902 203.8125 1034}
 softness 0
 name Radial2
 xpos 13521
 ypos -1035
}
EXPTool {
 mode Stops
 red {{(frame-3)*2}}
 green {{red}}
 blue {{red}}
 name Exposure7
 xpos 13521
 ypos -1011
}
Transform {
 translate {0 {(-frame+1)*(height/5) -0.1}}
 center {960 540}
 name Transform1
 xpos 13521
 ypos -987
}
TimeEcho {
 framesbehind 6
 name TimeEcho2
 xpos 13521
 ypos -963
}
set N20423c00 [stack 0]
Dot {
 name Dot21
 xpos 13599
 ypos -755
}
set N20423800 [stack 0]
push $N20423c00
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 white -1 -1 rgba.red 0 0 white -1 -1 rgba.green 0 1 white -1 -1 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle38
 xpos 13673
 ypos -946
}
set N20423400 [stack 0]
Multiply {
 value {1 0.1384 0.0662 1}
 name Multiply27
 xpos 14097
 ypos -773
}
Colorspace {
 colorspace_in CIE-Yxy
 primary_out ACES
 name Colorspace41
 xpos 14097
 ypos -741
}
Expression {
 expr0 r/max(r,g,b)
 expr1 g/max(r,g,b)
 expr2 b/max(r,g,b)
 name Expression24
 xpos 14097
 ypos -717
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply28
 xpos 14095
 ypos -677
}
Text {
 message "BP28\n0:0:1"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text19
 xpos 14095
 ypos -646
}
push $N20423c00
Grade {
 multiply {0 0 1 1}
 multiply_panelDropped true
 name Grade11
 xpos 13992
 ypos -707
}
Colorspace {
 primary_out ACES
 name Colorspace36
 xpos 13992
 ypos -683
}
Text {
 message "709\n0:0:1"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text20
 xpos 13985
 ypos -647
}
push $N20423800
push $N20423400
Multiply {
 value {1 0.1889 0.7129 1}
 name Multiply25
 xpos 13888
 ypos -779
}
Colorspace {
 colorspace_in CIE-Yxy
 primary_out ACES
 name Colorspace40
 xpos 13888
 ypos -747
}
Expression {
 expr0 r/max(r,g,b)
 expr1 g/max(r,g,b)
 expr2 b/max(r,g,b)
 name Expression23
 xpos 13888
 ypos -723
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply26
 xpos 13888
 ypos -685
}
Text {
 message "BP28\n0:1:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text21
 xpos 13883
 ypos -660
}
push $N20423c00
Grade {
 multiply {0 1 0 1}
 multiply_panelDropped true
 name Grade12
 xpos 13782
 ypos -703
}
Colorspace {
 primary_out ACES
 name Colorspace37
 xpos 13782
 ypos -679
}
Text {
 message "709\n0:1:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text22
 xpos 13782
 ypos -655
}
push $N20423800
push $N20423400
Multiply {
 value {1 0.6885 0.3078 1}
 name Multiply21
 xpos 13673
 ypos -776
}
Colorspace {
 colorspace_in CIE-Yxy
 primary_out ACES
 name Colorspace39
 xpos 13673
 ypos -744
}
Expression {
 expr0 r/max(r,g,b)
 expr1 g/max(r,g,b)
 expr2 b/max(r,g,b)
 name Expression22
 xpos 13673
 ypos -720
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply22
 xpos 13673
 ypos -682
}
Text {
 message "BP28\n1:0:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text23
 xpos 13673
 ypos -650
}
push $N20423800
Grade {
 multiply {1 0 0 1}
 multiply_panelDropped true
 name Grade13
 xpos 13565
 ypos -701
}
Colorspace {
 primary_out ACES
 name Colorspace38
 xpos 13565
 ypos -677
}
Text {
 message "709\n1:0:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text24
 xpos 13565
 ypos -653
}
push $N20423c00
Text {
 message 1:1:1
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text25
 xpos 13432
 ypos -649
}
ContactSheet {
 inputs 7
 width {{input.width*columns}}
 height {{input.height}}
 rows 1
 columns 7
 name ContactSheet8
 xpos 13488
 ypos -476
}
FrameHold {
 firstFrame 5
 name FrameHold3
 xpos 13488
 ypos -438
}
Group {
 name AF_WindsorExpBlur3
 tile_color 0x10e9efff
 xpos 13488
 ypos -406
 addUserKnob {20 User}
 addUserKnob {41 channels T Dissolve2.channels}
 addUserKnob {4 iterations M {1 2 3 4 5 6 7 8 9 10}}
 iterations 10
 addUserKnob {7 size l Size R 0 5}
 size 1.82
 addUserKnob {41 which T Dissolve2.which}
 addUserKnob {26 version l "" +STARTLINE T v001}
}
 Input {
  inputs 0
  name Input1
  xpos 784
  ypos 334
 }
 NoOp {
  name NoOp2
  xpos 784
  ypos 374
  addUserKnob {20 User}
  addUserKnob {7 size R 0 10}
  size {{parent.size}}
 }
set N20746000 [stack 0]
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur22
  xpos 1843
  ypos 480
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 10
 }
 Multiply {
  value 0
  name Multiply9
  xpos 1843
  ypos 518
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur21
  xpos 1708
  ypos 483
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 9
 }
 Multiply {
  value 0
  name Multiply8
  xpos 1708
  ypos 521
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur20
  xpos 1593
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 8
 }
 Multiply {
  value 0
  name Multiply7
  xpos 1593
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur19
  xpos 1491
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 7
 }
 Multiply {
  value 0
  name Multiply6
  xpos 1491
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur4
  xpos 1378
  ypos 483
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 6
 }
 Multiply {
  value 0
  name Multiply5
  xpos 1378
  ypos 521
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur5
  xpos 1268
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 5
 }
 Multiply {
  value 0
  name Multiply4
  xpos 1268
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur15
  xpos 1161
  ypos 487
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 4
 }
 Multiply {
  value 0
  name Multiply3
  xpos 1161
  ypos 525
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur16
  xpos 1062
  ypos 485
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 3
 }
 Multiply {
  value 0
  name Multiply2
  xpos 1062
  ypos 523
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push 0
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur17
  xpos 877
  ypos 487
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 1
 }
push $N20746000
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur18
  xpos 970
  ypos 488
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 2
 }
 Multiply {
  value 0
  name Multiply1
  xpos 970
  ypos 526
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
 Merge2 {
  inputs 10+1
  operation plus
  name Plus10
  xpos 877
  ypos 608
 }
 Multiply {
  value {{1/(parent.iterations+1)}}
  name Multiply14
  xpos 877
  ypos 634
 }
 Crop {
  box {0 0 {input.width} {input.height}}
  name Crop1
  xpos 877
  ypos 672
 }
push $N20746000
 Dissolve {
  inputs 2
  channels rgb
  which 0.16
  name Dissolve2
  xpos 792
  ypos 775
 }
 Output {
  name Output1
  xpos 792
  ypos 875
 }
end_group
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_04/beerfest_lightshow_04_003636.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read88
 xpos 13249
 ypos -489
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace22
 xpos 13249
 ypos -409
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_04/beerfest_lightshow_04_003505.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read87
 xpos 13111
 ypos -491
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace21
 xpos 13111
 ypos -411
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_04/beerfest_lightshow_04_003498.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read86
 xpos 12971
 ypos -491
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace20
 xpos 12971
 ypos -411
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_03/beerfest_lightshow_03_001712.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read85
 xpos 12789
 ypos -489
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace19
 xpos 12789
 ypos -409
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_02/beerfest_lightshow_02_001382.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read84
 xpos 12647
 ypos -484
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace18
 xpos 12647
 ypos -404
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_02/beerfest_lightshow_02_001357.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read83
 xpos 12516
 ypos -487
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace17
 xpos 12516
 ypos -407
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_02/beerfest_lightshow_02_001306.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read82
 xpos 12355
 ypos -489
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace16
 xpos 12355
 ypos -409
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_01/beerfest_lightshow_01_001615.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read81
 xpos 12198
 ypos -493
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace15
 xpos 12198
 ypos -413
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/2018-acesreferenceimages-data/ACES_ref_Isabella.0.exr
 format "2880 1620 0 0 2880 1620 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read80
 xpos 12044
 ypos -495
}
Read {
 inputs 0
 file_type exr
 file "/Users/afry/Downloads/Thomas Mansencal - EdisonBulb_ACES2065-1.exr"
 format "5634 3753 0 0 5634 3753 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read79
 xpos 11933
 ypos -496
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/FS7_fire_lin_ap0.exr
 format "4096 2160 0 0 4096 2160 1 4K_DCP"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read78
 xpos 11772
 ypos -496
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/arri_ludwigstraÃŸe_take0000_lens_wide_open.exr
 format "2880 1620 0 0 2880 1620 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read77
 xpos 11624
 ypos -497
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/B091C011_161004_R2XF.346.exr
 format "2048 1152 0 0 2048 1152 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read76
 xpos 11514
 ypos -497
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/B091C011_161004_R2XF.532.exr
 format "2048 1152 0 0 2048 1152 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read75
 xpos 11404
 ypos -497
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/B091C011_161004_R2XF.660.exr
 format "2048 1152 0 0 2048 1152 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read74
 xpos 11294
 ypos -497
}
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A004C007_190809_R39K_LogC_AlexaWideGamut.tif
 format "3414 2198 0 0 3414 2198 1 "
 origset true
 raw true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read73
 xpos 11149
 ypos -530
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace14
 xpos 11149
 ypos -440
}
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A016C009_191220_R19I_LogC_AlexaWideGamut.tif
 format "2880 1080 0 0 2880 1080 1 "
 origset true
 raw true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read72
 xpos 11039
 ypos -530
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace13
 xpos 11039
 ypos -440
}
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A009C002_190210_R0EI_LogC_AlexaWideGamut.tif
 format "3414 2198 0 0 3414 2198 1 "
 origset true
 raw true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read71
 xpos 10929
 ypos -530
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace12
 xpos 10929
 ypos -440
}
OCIOColorSpace {
 in_colorspace "ACES - ACES2065-1"
 out_colorspace scene_linear
 name OCIOColorSpace23
 xpos 10929
 ypos -416
}
Group {
 name GamutCompress1
 label "\[value direction]"
 xpos 10929
 ypos -392
 addUserKnob {20 GamutCompress}
 addUserKnob {41 threshold t "Percentage of the gamut to protect. A value of 0.8 means 20% of the outer gamut will be utilized for gamut compression." T compress.threshold}
 addUserKnob {41 power T compress.power}
 addUserKnob {26 distance_limit_label l " " t "Specifies the distance beyond the gamut boundary to map to the gamut boundary for each color component." T "<b>distance limit"}
 addUserKnob {41 cyan t "Maximum distance beyond the green-blue gamut boundary to compress to the gamut boundary." T compress.cyan}
 addUserKnob {41 magenta t "Maximum distance beyond the blue-red gamut boundary to compress to the gamut boundary." T compress.magenta}
 addUserKnob {41 yellow t "Maximum distance beyond the red-green gamut boundary to compress to the gamut boundary." T compress.yellow}
 addUserKnob {6 overlay l "graph overlay" +STARTLINE}
 addUserKnob {22 reset t "Reset knobs to default values. Distance limits are calculated based on an the average of a selection of digital cinema cameras." T "n = nuke.thisNode()\nnuke.root().begin()\ndefaults = \{\n    'threshold': (0.815, 0.803, 0.88),\n    'power': 1.2,\n    'cyan': 0.147,\n    'magenta':0.264,\n    'yellow': 0.312,\n\}\nfor k, v in defaults.items():\n    n\[k].setValue(v)" +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {20 info_tab l Info}
 addUserKnob {26 info_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc>\n<b>GamutCompress</b><br>\nmaps out of gamut colors back into gamut.\n<br><br><a href=https://github.com/colour-science/aces-vwg-gamut-mapping-2020/tree/master/model>Documentation</a>"}
 addUserKnob {26 about_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc><br>\n<b>About</b><br>\nWritten by <a href=https://github.com/jedypod color=red>Jed Smith</a> <br> with <a href=https://community.acescentral.com/t/rgb-saturation-gamut-mapping-approach-and-a-comp-vfx-perspective>help</a> from the <a href=https://community.acescentral.com/c/aces-development-acesnext/vwg-aces-gamut-mapping-working-group>ACES Gamut Mapping VWG</a>"}
}
 Input {
  inputs 0
  name Input
  xpos -40
  ypos -274
 }
 Dot {
  name Dot4
  xpos -6
  ypos -174
 }
set N4ddd3000 [stack 0]
 Dot {
  name Dot2
  xpos -226
  ypos -174
 }
 Expression {
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 max(r,g,b)
  name achromatic
  xpos -260
  ypos -130
 }
set N4ddd2800 [stack 0]
push $N4ddd3000
 Merge2 {
  inputs 2
  operation minus
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge1
  xpos -40
  ypos -130
 }
push $N4ddd2800
 Dot {
  name Dot1
  xpos -226
  ypos -78
 }
set N4ddd2000 [stack 0]
 Expression {
  expr0 abs(r)
  expr1 abs(g)
  expr2 abs(b)
  name abs
  xpos -167
  ypos -81
 }
set N4ddd1c00 [stack 0]
 Merge2 {
  inputs 2
  operation divide
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge2
  xpos -40
  ypos -82
 }
set N4ddd1800 [stack 0]
 Expression {
  expr0 "2 * x / (width - 1)"
  expr1 "2 * x / (width - 1)"
  expr2 "2 * x / (width - 1)"
  name Grad
  xpos 180
  ypos -82
 }
 Group {
  name compress1
  xpos 180
  ypos 63
  addUserKnob {20 compress}
  addUserKnob {18 threshold R 0.4 1}
  threshold {{parent.compress.threshold}}
  addUserKnob {6 threshold_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 power R 1 3}
  power {{parent.compress.power}}
  addUserKnob {7 cyan}
  cyan {{parent.compress.cyan}}
  addUserKnob {7 magenta}
  magenta {{parent.compress.magenta}}
  addUserKnob {7 yellow}
  yellow {{parent.compress.yellow}}
  addUserKnob {26 ""}
  addUserKnob {26 ""}
  addUserKnob {6 invert +STARTLINE}
  invert {{parent.direction}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -130
  }
  Dot {
   name Dot2
   xpos -6
   ypos -30
  }
set N4ddd0c00 [stack 0]
  Dot {
   name Dot1
   xpos 434
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001||r>thr.r+s.r)?r:thr.r+s.r*pow(-(pow((r-thr.r)/s.r,p)/(pow((r-thr.r)/s.r,p)-1)),1/p)
   expr1 (g<thr.g||lim.g<1.0001||g>thr.g+s.g)?g:thr.g+s.g*pow(-(pow((g-thr.g)/s.g,p)/(pow((g-thr.g)/s.g,p)-1)),1/p)
   expr2 (b<thr.b||lim.b<1.0001||b>thr.b+s.b)?b:thr.b+s.b*pow(-(pow((b-thr.b)/s.b,p)/(pow((b-thr.b)/s.b,p)-1)),1/p)
   name uncompress_power
   xpos 400
   ypos 50
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
push $N4ddd0c00
  Dot {
   name Dot6
   xpos -446
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001)?r:thr.r+s.r*((r-thr.r)/s.r)/(pow(1+pow((r-thr.r)/s.r,p),1/p))
   expr1 (g<thr.g||lim.g<1.0001)?g:thr.g+s.g*((g-thr.g)/s.g)/(pow(1+pow((g-thr.g)/s.g,p),1/p))
   expr2 (b<thr.b||lim.b<1.0001)?b:thr.b+s.b*((b-thr.b)/s.b)/(pow(1+pow((b-thr.b)/s.b,p),1/p))
   name compress_power1
   xpos -480
   ypos 38
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name switch_reverse
   xpos -40
   ypos 230
  }
  Output {
   name Output
   xpos -40
   ypos 326
  }
 end_group
 Expression {
  expr0 "abs(g - 2 * y / height) < 0.004 || abs(b - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  expr1 "abs(b - 2 * y / height) < 0.004 || abs(r - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  expr2 "abs(r - 2 * y / height) < 0.004 || abs(g - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  expr3 "abs(r - 2 * y / height) < 0.004 || abs(g - 2 * y / height) < 0.004 || abs(b - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  name Plot
  xpos 180
  ypos 185
 }
push $N4ddd2000
 Dot {
  name Dot3
  xpos -226
  ypos 234
 }
push $N4ddd1c00
 Dot {
  name Dot7
  xpos -133
  ypos 185
 }
push $N4ddd1800
 Group {
  name compress
  xpos -40
  ypos 62
  addUserKnob {20 compress}
  addUserKnob {18 threshold R 0.4 1}
  threshold {0.815 0.803 0.88}
  addUserKnob {6 threshold_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 power R 1 3}
  power 1.2
  addUserKnob {7 cyan}
  cyan 0.147
  addUserKnob {7 magenta}
  magenta 0.264
  addUserKnob {7 yellow}
  yellow 0.312
  addUserKnob {26 ""}
  addUserKnob {26 ""}
  addUserKnob {6 invert +STARTLINE}
  invert {{parent.direction}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -130
  }
  Dot {
   name Dot2
   xpos -6
   ypos -30
  }
set N4dd62000 [stack 0]
  Dot {
   name Dot1
   xpos 434
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001||r>thr.r+s.r)?r:thr.r+s.r*pow(-(pow((r-thr.r)/s.r,p)/(pow((r-thr.r)/s.r,p)-1)),1/p)
   expr1 (g<thr.g||lim.g<1.0001||g>thr.g+s.g)?g:thr.g+s.g*pow(-(pow((g-thr.g)/s.g,p)/(pow((g-thr.g)/s.g,p)-1)),1/p)
   expr2 (b<thr.b||lim.b<1.0001||b>thr.b+s.b)?b:thr.b+s.b*pow(-(pow((b-thr.b)/s.b,p)/(pow((b-thr.b)/s.b,p)-1)),1/p)
   name uncompress_power
   xpos 400
   ypos 50
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
push $N4dd62000
  Dot {
   name Dot6
   xpos -446
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001)?r:thr.r+s.r*((r-thr.r)/s.r)/(pow(1+pow((r-thr.r)/s.r,p),1/p))
   expr1 (g<thr.g||lim.g<1.0001)?g:thr.g+s.g*((g-thr.g)/s.g)/(pow(1+pow((g-thr.g)/s.g,p),1/p))
   expr2 (b<thr.b||lim.b<1.0001)?b:thr.b+s.b*((b-thr.b)/s.b)/(pow(1+pow((b-thr.b)/s.b,p),1/p))
   name compress_power1
   xpos -480
   ypos 38
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name switch_reverse
   xpos -40
   ypos 230
  }
  Output {
   name Output
   xpos -40
   ypos 326
  }
 end_group
 Merge2 {
  inputs 2
  operation multiply
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge3
  xpos -40
  ypos 182
 }
 Merge2 {
  inputs 2
  operation minus
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge5
  xpos -40
  ypos 230
 }
set N4dd60400 [stack 0]
 Merge2 {
  inputs 2
  name Merge7
  xpos 180
  ypos 231
 }
 Dot {
  name Dot9
  xpos 214
  ypos 268
 }
push $N4dd60400
 Switch {
  inputs 2
  which {{parent.overlay}}
  name Switch1
  selected true
  xpos -40
  ypos 265
 }
 Output {
  name Output
  xpos -40
  ypos 302
 }
end_group
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace24
 xpos 10929
 ypos -360
}
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A006C004_190809_R39K_LogC_AlexaWideGamut.tif
 format "3414 2198 0 0 3414 2198 1 "
 origset true
 raw true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read70
 xpos 10819
 ypos -530
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace11
 xpos 10819
 ypos -440
}
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A018C013_191220_R19I_02_LogC_AlexaWideGamut.tif
 format "2880 1080 0 0 2880 1080 1 "
 origset true
 raw true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read69
 xpos 10709
 ypos -530
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace10
 xpos 10709
 ypos -440
}
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A018C013_191220_R19I_03_LogC_AlexaWideGamut.tif
 format "2880 1080 0 0 2880 1080 1 "
 origset true
 raw true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read67
 xpos 10599
 ypos -530
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace9
 xpos 10599
 ypos -440
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/thomas-mansencal/IMG_9957_3_MRF_AP0.exr
 format "5634 3753 0 0 5634 3753 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read66
 xpos 10363
 ypos -529
}
Read {
 inputs 0
 file_type exr
 file "/Users/afry/Downloads/thomas-mansencal/5D Mark II - Spac-o-ween - 001.exr"
 format "5634 3753 0 0 5634 3753 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read65
 xpos 10201
 ypos -527
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/biped_jelly_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read63
 xpos 9678
 ypos -542
}
Text {
 message "Rec709\n////////////"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 60
 yjustify center
 box {1438 -176 2398 364}
 center {960 540}
 name Text18
 xpos 9678
 ypos -462
}
OCIOColorSpace {
 in_colorspace "ACES - ACES2065-1"
 out_colorspace scene_linear
 name OCIOColorSpace7
 xpos 9680
 ypos -403
}
OCIOColorSpace {
 in_colorspace "Utility - Linear - sRGB"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace8
 xpos 9680
 ypos -379
}
Dot {
 name Dot13
 xpos 9720
 ypos -343
}
Reformat {
 inputs 0
 type "to box"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 box_width 274
 box_height 1080
 box_fixed true
 name Reformat12
 xpos 8675
 ypos -588
}
Radial {
 area {72.1875 902 203.8125 1034}
 softness 0
 name Radial1
 xpos 8675
 ypos -556
}
EXPTool {
 mode Stops
 red {{(frame-3)*2}}
 green {{red}}
 blue {{red}}
 name Exposure6
 xpos 8675
 ypos -532
}
Transform {
 translate {0 {(-frame+1)*(height/5) -0.1}}
 center {960 540}
 name Transform2
 xpos 8675
 ypos -508
}
TimeEcho {
 framesbehind 6
 name TimeEcho1
 xpos 8675
 ypos -484
}
set N4dc75c00 [stack 0]
Grade {
 multiply {0 0 1 1}
 multiply_panelDropped true
 name Grade9
 xpos 9191
 ypos -456
}
set N4dc75800 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace2
 xpos 9298
 ypos -434
}
Text {
 message "AP1\n0:0:1"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text9
 xpos 9294
 ypos -386
}
push $N4dc75800
Colorspace {
 primary_out ACES
 name Colorspace23
 xpos 9191
 ypos -432
}
Text {
 message "709\n0:0:1"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text10
 xpos 9185
 ypos -384
}
push $N4dc75c00
Grade {
 multiply {0 1 0 1}
 multiply_panelDropped true
 name Grade6
 xpos 8981
 ypos -452
}
set N4dff7800 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace4
 xpos 9085
 ypos -436
}
Text {
 message "AP1\n0:1:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text7
 xpos 9090
 ypos -390
}
push $N4dff7800
Colorspace {
 primary_out ACES
 name Colorspace22
 xpos 8981
 ypos -428
}
Text {
 message "709\n0:1:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text8
 xpos 8981
 ypos -404
}
push $N4dc75c00
Grade {
 multiply {1 0 0 1}
 multiply_panelDropped true
 name Grade1
 xpos 8764
 ypos -450
}
set N4dff5c00 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace1
 xpos 8872
 ypos -428
}
Text {
 message "AP1\n1:0:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text6
 xpos 8872
 ypos -404
}
push $N4dff5c00
Colorspace {
 primary_out ACES
 name Colorspace20
 xpos 8764
 ypos -426
}
Text {
 message "709\n1:0:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text5
 xpos 8764
 ypos -402
}
push $N4dc75c00
Text {
 message 1:1:1
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text4
 xpos 8631
 ypos -398
}
ContactSheet {
 inputs 7
 width {{input.width*columns}}
 height {{input.height}}
 rows 1
 columns 7
 name ContactSheet6
 xpos 8687
 ypos -225
}
FrameHold {
 firstFrame 5
 name FrameHold1
 xpos 8687
 ypos -201
}
Group {
 name AF_WindsorExpBlur1
 tile_color 0x10e9efff
 xpos 8687
 ypos -169
 addUserKnob {20 User}
 addUserKnob {41 channels T Dissolve2.channels}
 addUserKnob {4 iterations M {1 2 3 4 5 6 7 8 9 10}}
 iterations 10
 addUserKnob {7 size l Size R 0 5}
 size 1.82
 addUserKnob {41 which T Dissolve2.which}
 addUserKnob {26 version l "" +STARTLINE T v001}
}
 Input {
  inputs 0
  name Input1
  xpos 784
  ypos 334
 }
 NoOp {
  name NoOp2
  xpos 784
  ypos 374
  addUserKnob {20 User}
  addUserKnob {7 size R 0 10}
  size {{parent.size}}
 }
set N4df86c00 [stack 0]
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur22
  xpos 1843
  ypos 480
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 10
 }
 Multiply {
  value 0
  name Multiply9
  xpos 1843
  ypos 518
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur21
  xpos 1708
  ypos 483
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 9
 }
 Multiply {
  value 0
  name Multiply8
  xpos 1708
  ypos 521
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur20
  xpos 1593
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 8
 }
 Multiply {
  value 0
  name Multiply7
  xpos 1593
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur19
  xpos 1491
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 7
 }
 Multiply {
  value 0
  name Multiply6
  xpos 1491
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur4
  xpos 1378
  ypos 483
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 6
 }
 Multiply {
  value 0
  name Multiply5
  xpos 1378
  ypos 521
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur5
  xpos 1268
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 5
 }
 Multiply {
  value 0
  name Multiply4
  xpos 1268
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur15
  xpos 1161
  ypos 487
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 4
 }
 Multiply {
  value 0
  name Multiply3
  xpos 1161
  ypos 525
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur16
  xpos 1062
  ypos 485
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 3
 }
 Multiply {
  value 0
  name Multiply2
  xpos 1062
  ypos 523
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push 0
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur17
  xpos 877
  ypos 487
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 1
 }
push $N4df86c00
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur18
  xpos 970
  ypos 488
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 2
 }
 Multiply {
  value 0
  name Multiply1
  xpos 970
  ypos 526
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
 Merge2 {
  inputs 10+1
  operation plus
  name Plus10
  xpos 877
  ypos 608
 }
 Multiply {
  value {{1/(parent.iterations+1)}}
  name Multiply14
  xpos 877
  ypos 634
 }
 Crop {
  box {0 0 {input.width} {input.height}}
  name Crop1
  xpos 877
  ypos 672
 }
push $N4df86c00
 Dissolve {
  inputs 2
  channels rgb
  which 0.16
  name Dissolve2
  xpos 792
  ypos 775
 }
 Output {
  name Output1
  xpos 792
  ypos 875
 }
end_group
Reformat {
 inputs 0
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Reformat6
 xpos 7539
 ypos -514
}
set N4e310400 [stack 0]
Crop {
 box {0 0 1024 {height/7}}
 reformat true
 crop false
 name Crop1
 xpos 7703
 ypos -494
}
set N4e2a7800 [stack 0]
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 white -1 -1 rgba.red 0 0 white -1 -1 rgba.green 0 1 black -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle23
 xpos 8336
 ypos -449
}
push $N4e2a7800
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 white -1 -1 rgba.red 0 0 black -1 -1 rgba.green 0 1 white -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle22
 xpos 8230
 ypos -444
}
push $N4e2a7800
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 black -1 -1 rgba.red 0 0 white -1 -1 rgba.green 0 1 white -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle24
 xpos 8108
 ypos -438
}
push $N4e2a7800
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 black -1 -1 rgba.red 0 0 black -1 -1 rgba.green 0 1 white -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle21
 xpos 7989
 ypos -440
}
push $N4e2a7800
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 black -1 -1 rgba.red 0 0 white -1 -1 rgba.green 0 1 black -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle20
 xpos 7888
 ypos -442
}
push $N4e2a7800
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 white -1 -1 rgba.red 0 0 black -1 -1 rgba.green 0 1 black -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle19
 xpos 7796
 ypos -440
}
push $N4e2a7800
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 white -1 -1 rgba.red 0 0 white -1 -1 rgba.green 0 1 white -1 -1 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3"
 name Shuffle18
 xpos 7703
 ypos -440
}
ContactSheet {
 inputs 7
 width 1024
 height 1024
 rows 7
 columns 1
 name ContactSheet2
 xpos 7709
 ypos -367
}
push $N4e310400
Expression {
 channel0 rgba
 expr0 .18*pow(2,(cx*7))
 name Expression7
 xpos 7539
 ypos -482
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply
 xpos 7539
 ypos -362
}
Colorspace {
 primary_out ACES
 name Colorspace10
 xpos 7539
 ypos -338
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-r-b.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read28
 xpos 7196
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-g.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read27
 xpos 7086
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-g-r.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read26
 xpos 6976
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-g-b.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read25
 xpos 6866
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-b.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read24
 xpos 6756
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-b-r.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read23
 xpos 6646
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-b-g.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read22
 xpos 6536
 ypos -520
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-r.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read32
 xpos 6416
 ypos -517
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/troy-sobotka/ACEScg-notorious-primary-r-g.exr"
 format "960 540 0 0 960 540 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read29
 xpos 6306
 ypos -517
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0022.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read59
 xpos 6131
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0021.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Read58
 xpos 6021
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0020.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read57
 xpos 5911
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0019.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read56
 xpos 5801
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0018.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read55
 xpos 5691
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0017.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read54
 xpos 5581
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0016.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read53
 xpos 5471
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0015.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read52
 xpos 5361
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0014.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read51
 xpos 5251
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0013.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read50
 xpos 5141
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0012.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read49
 xpos 5031
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0011.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read48
 xpos 4921
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0010.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read47
 xpos 4811
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0009.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read46
 xpos 4701
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0008.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read45
 xpos 4591
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0007.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read44
 xpos 4481
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0006.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read43
 xpos 4371
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0005.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read42
 xpos 4261
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0004.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read41
 xpos 4151
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0003.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read40
 xpos 4041
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0002.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read38
 xpos 3931
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/daniel-brylka/210203_Prius_EXR_balance_ACESCentral_aces.0001.exr"
 format "5496 3670 0 0 5496 3670 1 "
 origset true
 name Read34
 xpos 3821
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/jedsmith_colorchecker24_streaks_flat.aces.exr"
 format "1152 576 0 0 1152 576 1 "
 origset true
 name Read39
 xpos 3642
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/acescg_hueswatches_24.aces.exr"
 format "2048 768 0 0 2048 768 1 "
 origset true
 name Read33
 xpos 3497
 ypos -519
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/jedsmith_colorchecker24_streaks_6ev.aces.exr"
 format "1152 576 0 0 1152 576 1 "
 origset true
 name Read37
 xpos 3339
 ypos -516
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/jedsmith_2020-08-20-06h43m50_riviere-au-tonnerre_sunrise.2048x1024.aces.exr"
 format "2048 1024 0 0 2048 1024 1 2K_LatLong"
 origset true
 name Read36
 xpos 3232
 ypos -515
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/jedsmith_2020-01-07-09h24_snowy_sunrise.2048x1024.aces.exr"
 format "2048 1024 0 0 2048 1024 1 2K_LatLong"
 origset true
 name Read35
 xpos 3122
 ypos -515
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/christophe-brejon/louise_sun_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read31
 xpos 2989
 ypos -528
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/christophe-brejon/louise_concert_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read30
 xpos 2856
 ypos -529
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/monsieur-lixm/fx_explosion_lookdev_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read21
 xpos 2715
 ypos -528
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/monsieur-lixm/dragonscene_ap0_v01_1003.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read20
 xpos 2605
 ypos -528
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/monsieur-lixm/dragonscene_ap0_v01_1002.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read19
 xpos 2495
 ypos -528
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/monsieur-lixm/dragonscene_ap0_v01_1001.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read18
 xpos 2385
 ypos -528
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/sunny_spheres_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read17
 xpos 2238
 ypos -530
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/red_volumetric_002_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read16
 xpos 2129
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/red_volumetric_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read15
 xpos 2019
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/macbeth_spheres_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read14
 xpos 1909
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/light_sabers_003_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read13
 xpos 1799
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/light_sabers_002_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read12
 xpos 1689
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/light_sabers_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read11
 xpos 1579
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/glowing_spheres_002_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read10
 xpos 1469
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/glowing_spheres_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read9
 xpos 1359
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/cornell_box_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read8
 xpos 1249
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/blue_volumetric_002_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read7
 xpos 1139
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/blue_volumetric_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read6
 xpos 1029
 ypos -531
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/biped_jelly_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read5
 xpos 915
 ypos -536
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/aces_2048x1080_graded.00304.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read4
 xpos 806
 ypos -532
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/RED_Christmas_ACES_via_RWG.exr"
 format "4096 2160 0 0 4096 2160 1 4K_DCP"
 origset true
 name Read3
 xpos 709
 ypos -528
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/images/TheLegoMovie_OT_VWG_zmk17_020_aces.0287.exr"
 format "2000 824 0 0 2000 824 1 kragle(Overscan)"
 origset true
 raw true
 name Read1
 xpos 613
 ypos -528
}
Switch {
 inputs 88
 which {{frame-1}}
 name Switch1
 label "\[value inputs]"
 xpos 710
 ypos -377
}
Reformat {
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 resize fit
 black_outside true
 name Reformat3
 xpos 710
 ypos -345
}
Saturation {
 saturation 4
 name Saturation3
 xpos 616
 ypos -303
 disable true
}
set N4e068800 [stack 0]
EXPTool {
 mode Stops
 red 5
 green 5
 blue 5
 name Exposure4
 xpos 677
 ypos -246
}
push $N4e068800
Dot {
 name Dot14
 xpos 648
 ypos -241
}
push $N4e068800
EXPTool {
 mode Stops
 red -3
 green -3
 blue -3
 name Exposure3
 xpos 549
 ypos -246
}
ContactSheet {
 inputs 3
 width {{input.width*columns}}
 height {{input.height*rows}}
 columns 1
 roworder TopBottom
 name ContactSheet5
 xpos 614
 ypos -216
}
Dot {
 name Dot2
 xpos 739
 ypos -208
}
set N4e3d3000 [stack 0]
Colorspace {
 primary_in ACES
 colorspace_out CIE-XYZ
 name Colorspace3
 label "ACES to XYZ"
 xpos 705
 ypos -120
}
Dot {
 name Dot4
 xpos 739
 ypos -88
}
set N4e3d2800 [stack 0]
Multiply {
 value 100
 name Multiply3
 label "Mult by 100 to put in absolute nits"
 xpos 705
 ypos -70
}
Dot {
 name Dot1
 xpos 739
 ypos -28
}
Group {
 name ZCAM
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 705
 ypos -1
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N4e3d1400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N4e363c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N4e363c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N4e386400 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N4e386400
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N4e362000 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N4e361c00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N4e362000
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N4e361000 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N4e360c00 [stack 0]
push $N4e362000
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N4e360800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N4e360400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N4e6ebc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N4e6eb800 [stack 0]
add_layer {zcam zcam.J zcam.Q zcam.M zcam.C}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N4e361c00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N4e362000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N4e362000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N4e362000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N4e3d1400
push $N4e361c00
push $N4e361000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N4e6e9c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
add_layer {zcam_bM zcam_bM.red zcam_bM.green zcam_bM.blue zcam_bM.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N4e6e9c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
add_layer {zcam_aM zcam_aM.red zcam_aM.green zcam_aM.blue zcam_aM.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N4e361c00
push $N4e360c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N4e6e8800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
add_layer {zcam_bC zcam_bC.red zcam_bC.green zcam_bC.blue zcam_bC.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N4e6e8800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
add_layer {zcam_aC zcam_aC.red zcam_aC.green zcam_aC.blue zcam_aC.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N4e361c00
push $N4e360800
push $N4e361000
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N4e682c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N4e682800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
add_layer {zcam_bS zcam_bS.red zcam_bS.green zcam_bS.blue zcam_bS.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N4e682800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
add_layer {zcam_aS zcam_aS.red zcam_aS.green zcam_aS.blue zcam_aS.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N4e6ebc00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
add_layer {zcam_Vz zcam_Vz.red zcam_Vz.green zcam_Vz.blue zcam_Vz.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N4e682c00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
add_layer {zcam_Sz zcam_Sz.red zcam_Sz.green zcam_Sz.blue zcam_Sz.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N4e6ebc00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
add_layer {zcam_Kz zcam_Kz.red zcam_Kz.green zcam_Kz.blue zcam_Kz.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N4e6eb800
add_layer {zcam_Wz zcam_Wz.red zcam_Wz.green zcam_Wz.blue zcam_Wz.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N4e682c00
add_layer {zcam_s zcam_s.red zcam_s.green zcam_s.blue zcam_s.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N4e360c00
add_layer {zcam_C zcam_C.red zcam_C.green zcam_C.blue zcam_C.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N4e360400
add_layer {zcam_J zcam_J.red zcam_J.green zcam_J.blue zcam_J.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N4e361000
add_layer {zcam_M zcam_M.red zcam_M.green zcam_M.blue zcam_M.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N4e360800
add_layer {zcam_Q zcam_Q.red zcam_Q.green zcam_Q.blue zcam_Q.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N4e361c00
add_layer {zcam_h zcam_h.red zcam_h.green zcam_h.blue zcam_h.alpha}
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N4e3d1400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N4e5a5400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N4e5a4800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N4e5a4800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N4e53ac00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N4e53a000 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N4e53a000
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N4e53a000
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N4e539000 [stack 0]
push $N4e539000
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N4e53ac00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N4e4e6000 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N4e4e6000
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N4e4e6000
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N4e54a400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N4e4e5000 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N4e54a400
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N4e4e4800 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N4e54a400
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N4e497800 [stack 0]
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N4e496c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N4e549d00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N4e4e5000
push $N4e4e4800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N4e495000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N4e495000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N4e549d00
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N4fb9ac00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N4fb9ac00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N4e548f00 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N4e548f00
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N4e5a5400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N4e5a5400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N4e5a5400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N4e549d00
push $N4e5a5400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N4e53ac00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N4e497800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N4e496c00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N4e54a400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
set N4e3f9600 [stack 0]
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_J
 fromInput2 {{0} B}
 mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
 name Shuffle2
 xpos 493
 ypos 50
}
Multiply {
 value {{1/parent.Multiply3.value}}
 name Multiply1
 label "Div by 100 to go from nits"
 xpos 493
 ypos 74
}
set N4fb3c800 [stack 0]
ColorLookup {
 channels all
 lut {master {curve 0 x0.1089436561 0.0001599900424 x0.1538826674 0.0009879767895 x0.1697753966 0.001544326544 x0.1965807676 0.003412183374 x0.2212548852 0.005426112562 x0.2435974032 0.008081480861 x0.2744711637 0.01256972551 x0.335355252 0.02871714532 x0.3656598926 0.03916549683 x0.4067366123 0.05721262097 x0.451582104 0.08475825191 x0.5436673164 0.1626603603 x0.6915633678 0.3178277612 x0.7352961302 0.373636854 x0.8164004087 0.4692798555 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
   red {}
   green {}
   blue {}
   alpha {}}
 name ColorLookup4
 xpos 493
 ypos 116
}
Gamma {
 value 2.2
 name Gamma1
 xpos 493
 ypos 148
}
Multiply {
 value {{parent.Multiply3.value}}
 name Multiply4
 label "Mult by 100 to put in absolute nits"
 xpos 493
 ypos 180
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
 name Shuffle3
 xpos 493
 ypos 222
}
push $N4e3f9600
Copy {
 inputs 2
 from0 -rgba.alpha
 to0 -rgba.alpha
 channels zcam_J
 name Copy1
 xpos 706
 ypos 213
}
set N4fadf000 [stack 0]
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_J
 fromInput2 {{0} B}
 in2 zcam_M
 mappings "4 black -1 -1 rgba.red 0 0 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
 name Shuffle5
 xpos 1002
 ypos 243
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 in2 zcam_h
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
 name Shuffle6
 xpos 1002
 ypos 267
}
push $N4e3d3000
PositionToPoints2 {
 inputs 2
 display textured
 render_mode textured
 detail 1
 pointSize 1
 name PositionToPoints1
 xpos 1002
 ypos 326
}
Reformat {
 inputs 0
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Reformat4
 xpos -200
 ypos 89
}
Expression {
 channel0 zcam_J
 expr0 100
 channel1 zcam_M
 expr1 y/height*100
 channel2 zcam_h
 expr2 cx*180
 name Expression3
 xpos -200
 ypos 121
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle9
 xpos -200
 ypos 145
}
Group {
 name ZCAM2
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -200
 ypos 169
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N4fadc800 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N4fe67000 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N4fe67000
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N4fe80f00 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N4fe80f00
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N4fe65400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N4fe65000 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N4fe65400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N4fe64400 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N4fdebc00 [stack 0]
push $N4fe65400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N4fdeb800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N4fdeb400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N4fdeb000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N4fdeac00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N4fe65000
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N4fe65400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N4fe65400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N4fe65400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N4fadc800
push $N4fe65000
push $N4fe64400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N4fde9000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N4fde9000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N4fe65000
push $N4fdebc00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N4fd7b800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N4fd7b800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N4fe65000
push $N4fdeb800
push $N4fe64400
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N4fd7a000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N4fd79c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N4fd79c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N4fdeb000
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N4fd7a000
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N4fdeb000
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N4fdeac00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N4fd7a000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N4fdebc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N4fdeb400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N4fe64400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N4fdeb800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N4fe65000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N4fadc800
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N4fcac800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N4fc2b800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N4fc2b800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N4fc2a000 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N4fc29400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N4fc29400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N4fc29400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N4fc28400 [stack 0]
push $N4fc28400
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N4fc2a000
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N4fbed400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N4fbed400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N4fbed400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N4fda4f00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N4fbec400 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N4fda4f00
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5009b800 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N4fda4f00
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5009ac00 [stack 0]
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5009a000 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N4fda4800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N4fbec400
push $N5009b800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N50098400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N50098400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N4fda4800
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5002e000 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5002e000
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N4fffb900 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N4fffb900
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N4fcac800
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N4fcac800
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N4fcac800
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N4fda4800
push $N4fcac800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N4fc2a000
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5009ac00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5009a000
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N4fda4f00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace2
 xpos -200
 ypos 221
}
set N5014fc00 [stack 0]
Expression {
 temp_name0 minChan
 temp_expr0 min(r,min(g,b)
 temp_name1 maxChan
 temp_expr1 max(r,max(g,b)
 expr0 max(r<0,g<0,b<0)?0:r
 expr1 max(r<0,g<0,b<0)?0:g
 expr2 max(r<0,g<0,b<0)?0:b
 name Expression4
 xpos -336
 ypos 261
}
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace8
 xpos -200
 ypos 296
}
set N5014f400 [stack 0]
Group {
 name ZCAM3
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -200
 ypos 333
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5014e800 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5014d400 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5014d400
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N50129d00 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N50129d00
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N500e3400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N500e3000 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N500e3400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N500e2400 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N500e2000 [stack 0]
push $N500e3400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N500e1c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N500e1800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N500e1400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N500e1000 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N500e3000
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N500e3400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N500e3400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N500e3400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5014e800
push $N500e3000
push $N500e2400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5c9bf000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5c9bf000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N500e3000
push $N500e2000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5c9bdc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5c9bdc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N500e3000
push $N500e1c00
push $N500e2400
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5c9bc400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5c95bc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5c95bc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N500e1400
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5c9bc400
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N500e1400
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N500e1000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5c9bc400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N500e2000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N500e1800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N500e2400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N500e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N500e3000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5014e800
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5c876800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5c875c00 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5c875c00
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5c874400 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5cb17400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5cb17400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5cb17400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5cb16400 [stack 0]
push $N5cb16400
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5c874400
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5cacb400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5cacb400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5cacb400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5c9b9d00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5caca400 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N5c9b9d00
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5cac9c00 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N5c9b9d00
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5cac9000 [stack 0]
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5cac8400 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5c9b9600 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5caca400
push $N5cac9c00
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5ca82400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5ca82400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5c9b9600
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5ca80400 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5ca80400
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5c9b8800 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5c9b8800
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5c876800
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5c876800
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5c876800
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5c9b9600
push $N5c876800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5c874400
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5cac9000
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5cac8400
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5c9b9d00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
set N4fff8f00 [stack 0]
Dot {
 name Dot3
 xpos -10
 ypos 327
}
set N5cd8e000 [stack 0]
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_J
 fromInput2 {{0} B}
 in2 zcam_M
 mappings "4 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1 zcam_J.red 0 0 rgba.red 0 0"
 name Shuffle11
 xpos -44
 ypos 345
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 in2 zcam_h
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
 name Shuffle12
 xpos -44
 ypos 369
}
set N5cd8d800 [stack 0]
push $N4fff8f00
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle10
 xpos -200
 ypos 385
}
PositionToPoints2 {
 inputs 2
 display textured
 render_mode textured
 detail 1
 pointSize 1
 name PositionToPoints2
 xpos -44
 ypos 507
}
push $N4fadf000
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_M
 fromInput2 {{0} B}
 mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3 zcam_M.green 0 1 rgba.green 0 1"
 name Shuffle13
 xpos 858
 ypos 293
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 in2 zcam_h
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.green 1 1 rgba.green 0 1"
 name Shuffle16
 xpos 858
 ypos 317
}
set N5cd8c800 [stack 0]
Expression {
 channel0 rgba
 expr0 (g/360)+.5
 name Expression6
 xpos 959
 ypos 366
}
push $N5014fc00
Clamp {
 name Clamp1
 xpos -200
 ypos 252
 disable true
}
ColorWheel {
 inputs 0
 format "1024 1024 0 0 1024 1024 1 square_1K"
 gamma 0.45
 name ColorWheel1
 xpos 412
 ypos -674
}
set N5cd33800 [stack 0]
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace5
 xpos 276
 ypos -665
}
Multiply {
 value 0.3
 name Multiply6
 xpos 276
 ypos -611
 disable true
}
Constant {
 inputs 0
 channels rgb
 color {1 0.4 0.4 1}
 color_panelDropped true
 name Constant1
 xpos -156
 ypos -680
}
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace1
 xpos -156
 ypos -608
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/GitHub/nukeFnCoder24/fnCoder_samples_out.exr
 format "209 1 0 0 209 1 1 "
 origset true
 name Read60
 xpos -1270
 ypos 280
}
set N5cd32400 [stack 0]
LayerContactSheet {
 showLayerNames true
 name LayerContactSheet2
 xpos -1270
 ypos 398
}
push $N5cd32400
Dot {
 name Dot6
 xpos -1210
 ypos 454
}
Multiply {
 value {0.001 1 1 1}
 name Multiply7
 xpos -1203
 ypos 466
}
push $N5cd32400
Dot {
 name Dot5
 xpos -1089
 ypos 354
}
Colorspace {
 colorspace_in CIE-Yxy
 name Colorspace11
 xpos -1123
 ypos 406
}
Grade {
 multiply 0.095
 name Grade7
 xpos -1123
 ypos 430
}
PositionToPoints2 {
 inputs 2
 display textured
 render_mode textured
 detail 1
 name PositionToPoints3
 xpos -1123
 ypos 519
}
push $N4fb3c800
Colorspace {
 colorspace_in st2084
 name Colorspace4
 xpos 231
 ypos 83
}
Group {
 name ssts
 xpos 231
 ypos 129
 addUserKnob {20 ssts_tab l ssts}
 addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
 addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
 lum {0.0001 4.8 10000}
 addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
 addUserKnob {7 exposure R -5 5}
 addUserKnob {7 knee}
 knee 0.35
 addUserKnob {7 shoulder}
 shoulder 0.89
 addUserKnob {78 slope n 3}
 slope {0.38 1.501 0.01}
 addUserKnob {20 TsParams_tab l TsParams}
 addUserKnob {7 mid_lum l "mid lum" R 0 20}
 mid_lum 4.8
 addUserKnob {7 expShift R -4 4}
 addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
 minPoint {5.493164063e-06 0.0001 0}
 addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
 midPoint {0.18 4.8 1.55}
 addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
 maxPoint {47185.92 10000 0}
 addUserKnob {7 knotIncLow}
 knotIncLow 1.505149978
 addUserKnob {7 knotIncHigh}
 knotIncHigh 1.806179974
 addUserKnob {7 pctLow}
 pctLow 0.18
 addUserKnob {7 pctHigh}
 pctHigh 0.8920050508
 addUserKnob {78 coefsLow n 5}
 coefsLow {-4 -4 -3.157376577 -0.4852499958 1.847732471}
 addUserKnob {78 coefsHigh n 5}
 coefsHigh {-0.7185482425 2.081030717 3.641590816 4 4}
 addUserKnob {20 Constants_tab l const}
 addUserKnob {3 N_KNOTS_LOW}
 N_KNOTS_LOW 4
 addUserKnob {3 N_KNOTS_HIGH}
 N_KNOTS_HIGH 4
 addUserKnob {7 MIN_STOP_SDR R -20 20}
 MIN_STOP_SDR -6.5
 addUserKnob {7 MAX_STOP_SDR R -20 20}
 MAX_STOP_SDR 6.5
 addUserKnob {7 MIN_STOP_RRT R -20 20}
 MIN_STOP_RRT -15
 addUserKnob {7 MAX_STOP_RRT R -20 20}
 MAX_STOP_RRT 18
 addUserKnob {7 MIN_LUM_SDR R 0 0.1}
 MIN_LUM_SDR 0.02
 addUserKnob {7 MAX_LUM_SDR R 0 100}
 MAX_LUM_SDR 48
 addUserKnob {7 MIN_LUM_RRT R 0 0.1}
 MIN_LUM_RRT 0.0001
 addUserKnob {7 MAX_LUM_RRT R 0 10000}
 MAX_LUM_RRT 10000
}
 Input {
  inputs 0
  name Input
  xpos -1030
  ypos -634
 }
 Dot {
  name Dot25
  label " "
  xpos -996
  ypos -318
 }
set N5ccaf800 [stack 0]
 Dot {
  name Dot26
  label " "
  xpos -996
  ypos 1506
 }
push $N5ccaf800
 Dot {
  name Dot4
  label " "
  xpos -886
  ypos -318
 }
set N5ccaf000 [stack 0]
 Dot {
  name Dot5
  label " "
  xpos -776
  ypos -318
 }
set N5ccaec00 [stack 0]
 Dot {
  name Dot2
  label " "
  xpos -666
  ypos -318
 }
set N5ccae800 [stack 0]
 Dot {
  name Dot3
  label " "
  xpos -556
  ypos -318
 }
set N5ccae400 [stack 0]
 Expression {
  temp_name0 logr
  temp_expr0 "log10( max(r, 5.96046448e-08 ))"
  temp_name1 logg
  temp_expr1 "log10( max(g, 5.96046448e-08 ))"
  temp_name2 logb
  temp_expr2 "log10( max(b, 5.96046448e-08 ))"
  expr0 "logr <= log10(minPoint.x)"
  expr1 "logg <= log10(minPoint.x)"
  expr2 "logb <= log10(minPoint.x)"
  name segment_bottom
  xpos -590
  ypos -178
 }
 Dot {
  name Dot1
  label " "
  xpos -556
  ypos 162
 }
push $N5ccae400
 Dot {
  name Dot7
  label " "
  xpos -336
  ypos -318
 }
set N5ccad800 [stack 0]
 Expression {
  temp_name0 logr
  temp_expr0 "log10( max(r, 5.96046448e-08 ))"
  temp_name1 logg
  temp_expr1 "log10( max(g, 5.96046448e-08 ))"
  temp_name2 logb
  temp_expr2 "log10( max(b, 5.96046448e-08 ))"
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "logr * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
  expr1 "logg * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
  expr2 "logb* minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
  expr3 1
  name Expression
  xpos -370
  ypos -178
 }
 Merge2 {
  inputs 2
  operation multiply
  also_merge all
  name Multiply3
  xpos -370
  ypos 158
 }
 Dot {
  name Dot27
  label " "
  xpos -336
  ypos 786
 }
push $N5ccae800
 Expression {
  temp_name0 logr
  temp_expr0 "log10( max(r, 5.96046448e-08 ))"
  temp_name1 logg
  temp_expr1 "log10( max(g, 5.96046448e-08 ))"
  temp_name2 logb
  temp_expr2 "log10( max(b, 5.96046448e-08 ))"
  expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
  expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
  expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
  name segment_low
  xpos -700
  ypos -178
 }
 Dot {
  name Dot22
  label " "
  xpos -666
  ypos 354
 }
push $N5ccad800
 Dot {
  name Dot9
  label " "
  xpos -6
  ypos -318
 }
set N5cc6fc00 [stack 0]
 Dot {
  name Dot6
  label " "
  xpos -6
  ypos -198
 }
set N5cc6f800 [stack 0]
 Dot {
  name Dot8
  label " "
  xpos 214
  ypos -198
 }
set N5cc6f400 [stack 0]
 Dot {
  name Dot13
  label " "
  xpos 434
  ypos -198
 }
 Dot {
  name Dot12
  label " "
  xpos 434
  ypos -78
 }
set N5cc6ec00 [stack 0]
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
  expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
  expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
  name Expression5
  xpos 290
  ypos -34
 }
 ColorMatrix {
  matrix {
      {0.5 -1 0.5}
      {-1 1 0}
      {0.5 0.5 0}
    }
  name ColorMatrix3
  label "mult_f3_f33( cf, M)"
  xpos 290
  ypos 8
 }
push $N5cc6ec00
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 t*t
  expr1 t
  expr2 1
  expr3 1
  name Expression6
  xpos 400
  ypos -34
 }
 MergeExpression {
  inputs 2
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 0
  expr1 0
  expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
  name dot_f3_f2
  label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
  xpos 400
  ypos 8
 }
push 0
push $N5cc6f400
 Dot {
  name Dot11
  label " "
  xpos 214
  ypos -78
 }
set N5cc6d800 [stack 0]
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
  expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
  expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
  name Expression3
  xpos 70
  ypos -34
 }
 ColorMatrix {
  matrix {
      {0.5 -1 0.5}
      {-1 1 0}
      {0.5 0.5 0}
    }
  name ColorMatrix1
  label "mult_f3_f33( cf, M)"
  xpos 70
  ypos 8
 }
push $N5cc6d800
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 t*t
  expr1 t
  expr2 1
  expr3 1
  name Expression4
  xpos 180
  ypos -34
 }
 MergeExpression {
  inputs 2
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 0
  expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
  expr2 0
  name dot_f3_f7
  label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
  xpos 180
  ypos 8
 }
push $N5cc6f800
 Dot {
  name Dot10
  label " "
  xpos -6
  ypos -78
 }
set N5cc6c400 [stack 0]
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
  expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
  expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
  name Expression1
  xpos -150
  ypos -34
 }
 ColorMatrix {
  matrix {
      {0.5 -1 0.5}
      {-1 1 0}
      {0.5 0.5 0}
    }
  name ColorMatrix2
  label "mult_f3_f33( cf, M)"
  xpos -150
  ypos 8
 }
push $N5cc6c400
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 t*t
  expr1 t
  expr2 1
  expr3 1
  name Expression2
  xpos -40
  ypos -34
 }
 MergeExpression {
  inputs 2
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
  expr1 0
  expr2 0
  name dot_f3_f1
  label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
  xpos -40
  ypos 8
 }
 Merge2 {
  inputs 3+1
  operation plus
  bbox B
  output rgb
  name Merge1
  xpos 180
  ypos 158
 }
 Merge2 {
  inputs 2
  operation multiply
  also_merge all
  name Multiply1
  xpos 180
  ypos 350
 }
 Dot {
  name Dot28
  label " "
  xpos 214
  ypos 786
 }
push 0
push $N5ccaec00
 Expression {
  temp_name0 logr
  temp_expr0 "log10( max(r, 5.96046448e-08 ))"
  temp_name1 logg
  temp_expr1 "log10( max(g, 5.96046448e-08 ))"
  temp_name2 logb
  temp_expr2 "log10( max(b, 5.96046448e-08 ))"
  expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
  expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
  expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
  name segment_high
  xpos -810
  ypos -178
 }
 Dot {
  name Dot23
  label " "
  xpos -776
  ypos 474
 }
push $N5cc6fc00
 Dot {
  name Dot14
  label " "
  xpos 764
  ypos -318
 }
set N5cc0d800 [stack 0]
 Dot {
  name Dot15
  label " "
  xpos 764
  ypos -198
 }
set N5cc0d400 [stack 0]
 Dot {
  name Dot17
  label " "
  xpos 984
  ypos -198
 }
set N5cc0d000 [stack 0]
 Dot {
  name Dot20
  label " "
  xpos 1204
  ypos -198
 }
 Dot {
  name Dot19
  label " "
  xpos 1204
  ypos -78
 }
set N5cc0c800 [stack 0]
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
  expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
  expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
  expr3 j
  name Expression11
  xpos 1060
  ypos -34
 }
 ColorMatrix {
  matrix {
      {0.5 -1 0.5}
      {-1 1 0}
      {0.5 0.5 0}
    }
  name ColorMatrix6
  label "mult_f3_f33( cf, M)"
  xpos 1060
  ypos 8
 }
push $N5cc0c800
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 t*t
  expr1 t
  expr2 1
  expr3 1
  name Expression12
  xpos 1170
  ypos -34
 }
 MergeExpression {
  inputs 2
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 0
  expr1 0
  expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
  name dot_f3_f6
  label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
  xpos 1170
  ypos 8
 }
push 0
push $N5cc0d000
 Dot {
  name Dot18
  label " "
  xpos 984
  ypos -78
 }
set N5cbb7000 [stack 0]
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
  expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
  expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
  expr3 j
  name Expression9
  xpos 840
  ypos -34
 }
 ColorMatrix {
  matrix {
      {0.5 -1 0.5}
      {-1 1 0}
      {0.5 0.5 0}
    }
  name ColorMatrix5
  label "mult_f3_f33( cf, M)"
  xpos 840
  ypos 8
 }
push $N5cbb7000
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 t*t
  expr1 t
  expr2 1
  expr3 1
  name Expression10
  xpos 950
  ypos -34
 }
 MergeExpression {
  inputs 2
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 0
  expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
  expr2 0
  name dot_f3_f5
  label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
  xpos 950
  ypos 8
 }
push $N5cc0d400
 Dot {
  name Dot16
  label " "
  xpos 764
  ypos -78
 }
set N5cbb5c00 [stack 0]
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
  expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
  expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
  expr3 j
  name Expression7
  xpos 620
  ypos -34
 }
 ColorMatrix {
  matrix {
      {0.5 -1 0.5}
      {-1 1 0}
      {0.5 0.5 0}
    }
  name ColorMatrix4
  label "mult_f3_f33( cf, M)"
  xpos 620
  ypos 8
 }
push $N5cbb5c00
 Expression {
  temp_name0 logx
  temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
  temp_name1 knot_coord
  temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
  temp_name2 j
  temp_expr2 int(knot_coord)
  temp_name3 t
  temp_expr3 "knot_coord - j"
  expr0 t*t
  expr1 t
  expr2 1
  expr3 1
  name Expression8
  xpos 730
  ypos -34
 }
 MergeExpression {
  inputs 2
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
  expr1 0
  expr2 0
  name dot_f3_f4
  label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
  xpos 730
  ypos 8
 }
 Merge2 {
  inputs 3+1
  operation plus
  bbox B
  output rgb
  name Merge2
  xpos 950
  ypos 158
 }
 Merge2 {
  inputs 2
  operation multiply
  also_merge all
  name Multiply2
  xpos 950
  ypos 470
 }
 Dot {
  name Dot29
  label " "
  xpos 984
  ypos 786
 }
push $N5ccaf000
 Expression {
  temp_name0 logr
  temp_expr0 "log10( max(r, 5.96046448e-08 ))"
  temp_name1 logg
  temp_expr1 "log10( max(g, 5.96046448e-08 ))"
  temp_name2 logb
  temp_expr2 "log10( max(b, 5.96046448e-08 ))"
  expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
  expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
  expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
  name segment_peak
  xpos -920
  ypos -178
 }
 Dot {
  name Dot24
  label " "
  xpos -886
  ypos 618
 }
push $N5cc0d800
 Dot {
  name Dot21
  label " "
  xpos 1534
  ypos -318
 }
 Expression {
  temp_name0 logr
  temp_expr0 "log10( max(r, 5.96046448e-08 ))"
  temp_name1 logg
  temp_expr1 "log10( max(g, 5.96046448e-08 ))"
  temp_name2 logb
  temp_expr2 "log10( max(b, 5.96046448e-08 ))"
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "logr * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
  expr1 "logg * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
  expr2 "logb* maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
  expr3 1
  name proc_low1
  label Expression
  xpos 1500
  ypos -160
 }
 Merge2 {
  inputs 2
  operation multiply
  also_merge all
  name Multiply4
  xpos 1500
  ypos 614
 }
 Dot {
  name Dot30
  xpos 1534
  ypos 810
 }
 Merge2 {
  inputs 4+1
  operation plus
  bbox B
  output rgb
  name Merge3
  xpos 510
  ypos 1118
 }
 Expression {
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 pow(10,r)
  expr1 pow(10,g)
  expr2 pow(10,b)
  name Expression13
  xpos 510
  ypos 1238
 }
 Copy {
  inputs 2
  from0 rgba.alpha
  to0 rgba.alpha
  name Copy1
  xpos 510
  ypos 1496
 }
 Output {
  name Output1
  xpos 510
  ypos 1814
 }
end_group
Multiply {
 value 0.01
 name Multiply5
 xpos 231
 ypos 180
}
Expression {
 expr0 "y==floor(r(x, pos.y)*height*mult)?1:0"
 expr1 "y==floor(g(x, pos.y)*height*mult)?1:0"
 expr2 "y==floor(b(x, pos.y)*height*mult)?1:0"
 channel3 alpha
 name PlotScanline1
 xpos 231
 ypos 224
 addUserKnob {20 User}
 addUserKnob {12 pos}
 addUserKnob {7 mult R 0 5}
 mult 1
}
push $N5014f400
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_J
 fromInput2 {{0} B}
 in2 zcam_M
 mappings "4 black -1 -1 rgba.red 0 0 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
 name Shuffle7
 xpos -30
 ypos 228
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 in2 zcam_h
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
 name Shuffle8
 xpos -30
 ypos 252
}
push $N4fff8f00
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_M
 fromInput2 {{0} B}
 in2 zcam_h
 mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3 zcam_M.green 0 1 rgba.green 0 1"
 name Shuffle14
 xpos -34
 ypos 285
}
StickyNote {
 inputs 0
 name StickyNote1
 label "node = nuke.selectedNode()\n\nnodeToSample = nuke.selectedNode()\n\nvrange = range(0,1023)\n\nlutKnob = node.knob('lut')\n\nfor xPos in range(0,1024):\n    for yPos in reversed(range(0,1023)):\n        sample = nodeToSample.sample('rgba.green',xPos,yPos)\n        if sample > 0.00001:\n            print(sample)\n            node.knob('lut').setValueAt(sample,xPos,2)\n            break\n\n    print(xPos)\n    node.knob('lut').setValueAt(.5,xPos,2)"
 xpos -602
 ypos 318
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/macbeth_spheres_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read2
 xpos 1359
 ypos -573
}
push $N4e3f9600
Dot {
 name Dot7
 xpos 398
 ypos 35
}
Saturation {
 saturation 0
 mode Average
 name Saturation1
 xpos 364
 ypos 146
}
Grade {
 channels rgba
 multiply 0.001
 name Grade5
 xpos 364
 ypos 175
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
 name Shuffle4
 xpos 364
 ypos 225
}
push $N5cd8c800
Expression {
 temp_name0 limit
 temp_expr0 clipped709_JMh.lut.green((g/360)+.5)*limitScale
 temp_name1 scaledVal
 temp_expr1 b/limit
 temp_name2 scale
 temp_expr2 1-thr
 expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
 channel3 alpha
 expr3 limit
 name clipToLimit
 xpos 858
 ypos 341
 addUserKnob {20 User}
 addUserKnob {7 limitScale R 0 100}
 limitScale 1.5
 addUserKnob {7 thr}
 thr 1
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_M
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_M.red 0 0 rgba.blue 0 2 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.alpha 0 3"
 name Shuffle15
 xpos 858
 ypos 365
}
push $N4fadf000
Copy {
 inputs 2
 from0 -rgba.alpha
 to0 -rgba.alpha
 channels zcam_M
 name Copy3
 xpos 706
 ypos 393
}
Grade {
 inputs 1+1
 channels zcam_M
 multiply 0
 name Grade4
 xpos 706
 ypos 451
}
Expression {
 temp_expr0 zcam_M.red
 temp_name1 max_at_h
 temp_expr1 Sampler1.lut.green(zcam_h.red)
 channel0 zcam_M
 expr0 Sampler1.lut.red(r)
 expr2 zcam_M.red>Sampler1.lut.green?r*1:zcam_M.red
 name Expression5
 xpos 706
 ypos 491
}
Group {
 name ZCAM1
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 706
 ypos 515
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5cee8400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5ce72c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5ce72c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5ce8c800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5ce8c800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5ce71000 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5ce70c00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5ce71000
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5d1f7c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5d1f7800 [stack 0]
push $N5ce71000
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5d1f7400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5d1f7000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5d1f6c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5d1f6800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5ce70c00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5ce71000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5ce71000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5ce71000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5cee8400
push $N5ce70c00
push $N5d1f7c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5d1f4c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5d1f4c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5ce70c00
push $N5d1f7800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5d187400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5d187400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5ce70c00
push $N5d1f7400
push $N5d1f7c00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5d185c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5d185800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5d185800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5d1f6c00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5d185c00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5d1f6c00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5d1f6800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5d185c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5d1f7800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5d1f7000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5d1f7c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5d1f7400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5ce70c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5cee8400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5d0b8400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5d02f400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5d02f400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5d02dc00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5d02d000 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5d02d000
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5d02d000
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5cfe7c00 [stack 0]
push $N5cfe7c00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5d02dc00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5cfe5000 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5cfe5000
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5cfe5000
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5d19c800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5cf97c00 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N5d19c800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5cf97400 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N5d19c800
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5cf96800 [stack 0]
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5cf95c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5d19c100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5cf97c00
push $N5cf97400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5d327c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5d327c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5d19c100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5d325c00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5d325c00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5cf5b200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5cf5b200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5d0b8400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5d0b8400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5d0b8400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5d19c100
push $N5d0b8400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5d02dc00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5cf96800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5cf95c00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5d19c800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Multiply {
 value {{1/parent.Multiply3.value}}
 name Multiply2
 label "Div by 100 to go from nits"
 xpos 706
 ypos 567
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace6
 label "XYZ to sRGB Prims"
 xpos 706
 ypos 637
}
set N5d257400 [stack 0]
Reformat {
 format "1024 1024 0 0 1024 1024 1 square_1K"
 resize height
 name Reformat7
 xpos 706
 ypos 769
}
set N5d257000 [stack 0]
push $N5d257000
Group {
 name PlotWaveform
 xpos 589
 ypos 825
 addUserKnob {20 Waveform_tab l Waveform}
 addUserKnob {41 useGPUIfAvailable l "Use GPU if available" T WaveForm.useGPUIfAvailable}
 addUserKnob {41 vectorize l "Vectorize on CPU" -STARTLINE T WaveForm.vectorize}
 addUserKnob {26 ""}
 addUserKnob {4 style M {fill add right bottom pip "" ""}}
 addUserKnob {6 guides t "draw guides at integer values (0, 1, 2 etc), and 0.18" -STARTLINE}
 guides true
 addUserKnob {6 split_rgb l "split rgb" t "separate rgb" -STARTLINE}
 addUserKnob {41 specifiedFormat l format t "specify the output format. Otherwise the input format will be used." -STARTLINE T WaveForm.specifiedFormat}
 addUserKnob {41 format l "" -STARTLINE T WaveForm.format}
 addUserKnob {6 log_transform l "log transform" t "display waveform in log (generic log2 shaper)" +STARTLINE}
 addUserKnob {6 antialias t "enable antialiasing" -STARTLINE}
 addUserKnob {7 max_value l "max value" t "The value to map to the top of frame. For example you may want to set this to the max pixel value in the image." R 1 25}
 max_value 1.5
 addUserKnob {7 min_value l "min value" R -1 0}
 addUserKnob {7 brightness t "multiply the brightness of the waveform"}
 brightness 0.2
 addUserKnob {22 set_max l "set max" t "Set's the max slider to the max pixel value on the current frame of the input image." T "n = nuke.thisNode()\nnuke.root().begin()\nn.begin()\nct = nuke.toNode('CT')\nnuke.execute(ct, nuke.frame(), nuke.frame())\nmaxpx = ct\['maxlumapixvalue'].getValue()\nave = (maxpx\[0] + maxpx\[1] + maxpx\[2])/3\nn\['max_value'].setValue(ave)" +STARTLINE}
 addUserKnob {41 box_size l pip_size t "set the picture in picture size" T Reformat3.box_size}
}
 Input {
  inputs 0
  name Input
  xpos 70
  ypos -226
 }
 AddChannels {
  name AddChannels1
  xpos 70
  ypos -184
 }
 Dot {
  name Dot1
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 104
  ypos -102
 }
set N5d256000 [stack 0]
 Reformat {
  format {{{parent.WaveForm.format}}}
  resize distort
  filter impulse
  name ReScale
  xpos 70
  ypos -58
  disable {{!parent.specifiedFormat}}
 }
set N5d255c00 [stack 0]
 CurveTool {
  operation "Max Luma Pixel"
  ROI {0 0 {input.width} {input.height}}
  autocropdata {0 0 {input.width} {input.height}}
  maxlumapixdata {{curve x1 1047 x14 1800} {curve x1 2212 x14 436}}
  maxlumapixvalue {{curve x1 5.210135937 x14 3.869687557} {curve x1 10.19536495 x14 4.130000114} {curve x1 9.513872147 x14 3.160937548}}
  minlumapixdata {{curve x1 0 x14 380} {curve x1 26 x14 0}}
  minlumapixvalue {{curve x1 0.01240783278 x14 0} {curve x1 0.00967685692 x14 0} {curve x1 0.02308944985 x14 0}}
  name CT
  xpos -40
  ypos -58
 }
push $N5d255c00
 BlinkScript {
  recompileCount 39
  KernelDescription "2 \"PlotWaveform\" iterate pixelWise 88b7f52352ee7ffcbd8d6465ec4ac2ee10c040557f69f3c5cce1cf1b8c43cde4 2 \"src\" Read Random \"dst\" Write Random 10 \"max_value\" Float 1 AAAAAA== \"min_value\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"mult\" Float 1 AAAAAA== \"log_min\" Float 1 AAAAAA== \"log_max\" Float 1 AAAAAA== \"enable_log_transform\" Bool 1 AA== \"antialias\" Bool 1 AA== \"draw_lines\" Bool 1 AA== \"lines_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 10 \"max_value\" 1 1 \"min_value\" 1 1 \"tolerance\" 1 1 \"mult\" 1 1 \"log_min\" 1 1 \"log_max\" 1 1 \"enable_log_transform\" 1 1 \"antialias\" 1 1 \"draw_lines\" 1 1 \"lines_color\" 4 1 1 \"yscale\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotWaveform : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> src;\n  Image<eWrite, eAccessRandom> dst;\n\n  param:\n    float max_value;\n    float min_value;\n    float tolerance;\n    float mult;\n    float log_min;\n    float log_max;\n    bool enable_log_transform;\n    bool antialias;\n    bool draw_lines;\n    float4 lines_color;\n\n  local:\n    float yscale;\n\n  void init() \{\n    yscale = dst.bounds.height() / max_value;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write(float x, float y, int k, float c) \{\n    // Write cubic antialiased pixel value c in channel k at continuous float position x, y\n    int n = 2;\n    int u0 = round(x);\n    int v0 = round(y);\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float c0 = dst(u, v, k); // existing color\n          // merge current color sample over existing color sample\n          dst(u, v, k) = c*w*mult+c0;\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  float log_transform(float x) \{\n    return x > 0.0f ? (log( x / 0.18f)/log(2.0f) - log_min) / (log_max - log_min) : x;\n  \}\n\n  void process(int2 pos) \{\n    float4 source = src(pos.x, pos.y);\n    if (enable_log_transform) \{\n      for (int k = 0; k < 3; k++)\{\n        source\[k] = log_transform(source\[k]);\n      \}\n    \}\n    float4 source_scaled = (source - min_value) * yscale;\n    if (antialias) \{\n      for (int k = 0; k < 3; k++)\{\n        write(pos.x, source_scaled\[k], k, source\[k]);\n      \}\n    \} else \{\n      for (int k = 0; k < 3; k++)\{\n        if ( dst.bounds.inside(pos.x, source_scaled\[k])) \{\n          dst(pos.x, source_scaled\[k], k) = source\[k]*mult + dst(pos.x, source_scaled\[k], k);\n          dst(pos.x, source_scaled\[k], 3) = 1.0f;\n        \}\n      \}\n    \}\n    if (draw_lines) \{\n      if (pos.x > 0 && pos.y > 0) return; // only draw the lines once\n      for (int i = 0; i < 50; i++) \{\n        float val = i;\n        if (enable_log_transform) val = log_transform(i);\n        for (int k = 0; k < 3; k++) \{\n          write(pos.x, (val - min_value)*yscale, k, lines_color\[k]);\n        \}\n      \}\n    \}\n  \}\n\};"
  rebuild ""
  PlotWaveform_max_value {{"parent.log_transform ? 1.01 : (parent.max_value+parent.min_value)"}}
  PlotWaveform_min_value {{parent.min_value}}
  PlotWaveform_tolerance 2
  PlotWaveform_mult {{parent.brightness}}
  PlotWaveform_log_min -6.5
  PlotWaveform_log_max 6.5
  PlotWaveform_enable_log_transform {{parent.log_transform}}
  PlotWaveform_antialias {{parent.antialias}}
  PlotWaveform_draw_lines {{parent.guides}}
  PlotWaveform_lines_color {0.6 0 0.02 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name WaveForm
  xpos 70
  ypos 32
 }
 Group {
  name RGB_Split
  selected true
  xpos 70
  ypos 110
  disable {{!parent.split_rgb}}
 }
  Input {
   inputs 0
   name Input
   xpos 45
   ypos -59
  }
  Reformat {
   type "to box"
   box_width {{rint(input.width/3)}}
   box_height {{input.height}}
   scale {1 1}
   resize none
   name Reformat4
   xpos 45
   ypos 1
  }
  Dot {
   name Dot18
   label " "
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos 79
   ypos 53
  }
set N5d5fbc00 [stack 0]
  Dot {
   name Dot19
   label " "
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos 189
   ypos 53
  }
  Expression {
   expr0 0
   expr1 0
   expr2 b
   expr3 a
   name Expression3
   xpos 155
   ypos 97
  }
push $N5d5fbc00
  Expression {
   expr0 0
   expr1 g
   expr2 0
   expr3 a
   name Expression2
   xpos 45
   ypos 97
  }
push $N5d5fbc00
  Dot {
   name Dot17
   label " "
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -31
   ypos 53
  }
  Expression {
   expr0 r
   expr1 0
   expr2 0
   expr3 a
   name Expression1
   xpos -65
   ypos 97
  }
  ContactSheet {
   inputs 3
   width {{parent.input.width}}
   height {{parent.input.height}}
   rows 1
   columns 3
   roworder TopBottom
   name ContactSheet1
   selected true
   xpos 45
   ypos 152
  }
  Output {
   name Output
   xpos 45
   ypos 241
  }
 end_group
 Keyer {
  operation "luminance key"
  name Keyer1
  xpos 70
  ypos 176
 }
 Dot {
  name Dot5
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 104
  ypos 234
 }
set N5d5f9800 [stack 0]
 Dot {
  name Dot3
  label " Fill"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 104
  ypos 378
 }
 Dot {
  name Dot13
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 104
  ypos 444
 }
set N5d5f9000 [stack 0]
 Shuffle {
  alpha white
  name Shuffle1
  label "\[value in] -> \[value out]"
  xpos 747
  ypos 420
 }
 Reformat {
  type "to box"
  box_width {{"min(input.width, parent.Input.width*box_size)"}}
  scale 0.5
  filter notch
  black_outside true
  pbb true
  name Reformat3
  xpos 747
  ypos 465
  addUserKnob {20 User}
  addUserKnob {7 box_size R 0.05 0.6}
  box_size 0.3
 }
push $N5d256000
 Dot {
  name Dot8
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos -102
 }
set N5d5afc00 [stack 0]
 Dot {
  name Dot2
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 544
  ypos -102
 }
 BlackOutside {
  name BlackOutside2
  xpos 510
  ypos 14
 }
set N5d5af400 [stack 0]
 Dot {
  name Dot7
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 18
 }
set N5d5af000 [stack 0]
 Dot {
  name Dot14
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 874
  ypos 18
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge4
  xpos 840
  ypos 518
 }
 Dot {
  name Dot11
  label PIP
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 874
  ypos 570
 }
push $N5d5f9800
 Dot {
  name Dot9
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 214
  ypos 234
 }
set N5d5ae000 [stack 0]
 Reformat {
  type "to box"
  box_width {{parent.Input.width}}
  box_height {{parent.Input.height}}
  box_fixed true
  resize none
  center false
  black_outside true
  name Reformat1
  xpos 400
  ypos 230
 }
 BlackOutside {
  name BlackOutside1
  xpos 400
  ypos 254
 }
set N5d5ad400 [stack 0]
 Position {
  translate {0 {-parent.input.height}}
  name MoveDown
  xpos 620
  ypos 254
  disable true
 }
push $N5d5af000
 Crop {
  box {0 {-parent.input.height} {input.width} {input.height}}
  reformat true
  crop false
  name Crop2
  xpos 730
  ypos 182
 }
 Merge2 {
  inputs 2
  name Merge2
  xpos 730
  ypos 326
 }
 Dot {
  name Dot6
  label " Bottom"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 378
 }
push $N5d5ad400
 Position {
  translate {{parent.input.width} 0}
  name MoveRight
  xpos 400
  ypos 278
 }
push $N5d5af400
 Crop {
  box {0 0 {parent.MoveRight.bbox.r} {input.height}}
  reformat true
  crop false
  name Crop1
  xpos 510
  ypos 278
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 510
  ypos 326
 }
 Dot {
  name Dot4
  label " Right"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 544
  ypos 378
 }
push $N5d5ae000
 Reformat {
  type "to box"
  box_width {{parent.input.width}}
  box_height {{parent.input.height}}
  box_fixed true
  resize distort
  center false
  black_outside true
  name Reformat2
  xpos 180
  ypos 279
 }
push $N5d5afc00
 Dot {
  name Dot12
  label " "
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 190
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge3
  xpos 290
  ypos 279
 }
 Dot {
  name Dot10
  label " Add"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 378
 }
push $N5d5f9000
 Switch {
  inputs 5
  which {{parent.style}}
  name SwitchStyle
  xpos 70
  ypos 566
 }
 Output {
  name Output
  xpos 70
  ypos 710
 }
end_group
ContactSheet {
 inputs 2
 width 2048
 height 1024
 rows 1
 columns 2
 name ContactSheet3
 xpos 706
 ypos 892
}
Colorspace {
 colorspace_out sRGB
 name Colorspace12
 xpos 706
 ypos 916
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/examples/ramp_Colour_histo_v001.png
 raw true
 file_type png
 checkHashOnRead false
 version 4
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write3
 xpos 706
 ypos 960
}
push $N4e3d2800
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace7
 label "XYZ to sRGB Prims"
 xpos 880
 ypos -95
}
push $N4e3f9600
LayerContactSheet {
 width {{input.width*columns}}
 height {{input.height*rows}}
 rows 5
 autodims false
 showLayerNames true
 name LayerContactSheet1
 xpos 881
 ypos 13
}
Group {
 inputs 0
 name ZCAM4
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 2872
 ypos 438
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5d4f3400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5d4f2000 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5d4f2000
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5d504800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5d504800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5d4f0400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5d48fc00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5d4f0400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5d48f000 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5d48ec00 [stack 0]
push $N5d4f0400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5d48e800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5d48e400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5d48e000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5d48dc00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5d48fc00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5d4f0400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5d4f0400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5d4f0400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5d4f3400
push $N5d48fc00
push $N5d48f000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5d417c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5d417c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5d48fc00
push $N5d48ec00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5d416800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5d416800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5d48fc00
push $N5d48e800
push $N5d48f000
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5d415000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5d414c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5d414c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5d48e000
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5d415000
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5d48e000
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5d48dc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5d415000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5d48ec00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5d48e400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5d48f000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5d48e800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5d48fc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5d4f3400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5d9af400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5d9ae800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5d9ae800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5d9ad000 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5d9ac400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5d9ac400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5d9ac400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5d95b000 [stack 0]
push $N5d95b000
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5d9ad000
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5d958400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5d958400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5d958400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5d420800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5dd07000 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N5d420800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5dd06800 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N5d420800
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5dd05c00 [stack 0]
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5dd05000 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5d420100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5dd07000
push $N5dd06800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5dca3000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5dca3000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5d420100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5dca1000 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5dca1000
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5dcab200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5dcab200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5d9af400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5d9af400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5d9af400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5d420100
push $N5d9af400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5d9ad000
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5dd05c00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5dd05000
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5d420800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Group {
 inputs 0
 name ZCAM5
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 2871
 ypos 543
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5dbd6400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5dbd5000 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5dbd5000
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5db99600 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5db99600
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5db53000 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5db52c00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5db53000
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5db52000 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5db51c00 [stack 0]
push $N5db53000
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5db51800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5db51400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5db51000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5db50c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5db52c00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5db53000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5db53000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5db53000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5dbd6400
push $N5db52c00
push $N5db52000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5dadac00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5dadac00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5db52c00
push $N5db51c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5dad9800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5dad9800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5db52c00
push $N5db51800
push $N5db52000
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5da6fc00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5da6f800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5da6f800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5db51000
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5da6fc00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5db51000
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5db50c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5da6fc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5db51c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5db51400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5db52000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5db51800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5db52c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5dbd6400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5dd96400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5dd95800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5dd95800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5dd3fc00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5dd3f000 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5dd3f000
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5dd3f000
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5dd3e000 [stack 0]
push $N5dd3e000
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5dd3fc00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5e0e7000 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5e0e7000
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5e0e7000
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5dac5600 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5e0e6000 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N5dac5600
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5e0e5800 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N5dac5600
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5e0e4c00 [stack 0]
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5e093c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5dac4f00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5e0e6000
push $N5e0e5800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5e092000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5e092000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5dac4f00
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5e01fc00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5e01fc00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5dac4100 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5dac4100
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5dd96400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5dd96400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5dd96400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5dac4f00
push $N5dd96400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5dd3fc00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5e0e4c00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5e093c00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5dac5600
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Constant {
 inputs 0
 channels rgb
 color {1 1 1 0}
 name Constant4
 xpos 1407
 ypos 1021
}
Group {
 name ZCAM7
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 1413
 ypos 1122
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5dfb5000 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5df33800 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5df33800
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5df65d00 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5df65d00
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5df31c00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5df31800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5df31c00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5df30c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5df30800 [stack 0]
push $N5df31c00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5df30400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5debbc00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5debb800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5debb400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5df31800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5df31c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5df31c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5df31c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5dfb5000
push $N5df31800
push $N5df30c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5deb9800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5deb9800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5df31800
push $N5df30800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5deb8400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5deb8400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5df31800
push $N5df30400
push $N5df30c00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5de52800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5de52400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5de52400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5debb800
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5de52800
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5debb800
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5debb400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5de52800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5df30800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5debbc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5df30c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5df30400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5df31800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5dfb5000
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5e179000 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5e178400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5e178400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5e50e800 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5e50dc00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5e50dc00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5e50dc00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5e50cc00 [stack 0]
push $N5e50cc00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5e50e800
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5e4bdc00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5e4bdc00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5e4bdc00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5de81d00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5e4bcc00 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N5de81d00
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5e4bc400 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N5de81d00
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5e46f400 [stack 0]
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5e46e800 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5de81600 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5e4bcc00
push $N5e4bc400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5e46cc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5e46cc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5de81600
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5e3f2800 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5e3f2800
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5de80800 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5de80800
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5e179000
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5e179000
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5e179000
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5de81600
push $N5e179000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5e50e800
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5e46f400
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5e46e800
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5de81d00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_M
 fromInput2 {{0} B}
 mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
 name Shuffle27
 xpos 1413
 ypos 1204
}
push $N5cd8d800
ColorLookup {
 lut {master {}
   red {}
   green {curve 35.93902588 35.93735504 35.93753433 35.83887863 35.84093094 35.83343124 35.83169174 35.8393631 35.74020004 35.74031067 35.74192429 35.73725891 35.74119949 35.73592377 35.74422836 35.64019394 35.64123917 35.64620209 35.63986588 35.64028549 35.64251328 35.64444351 35.64264679 35.64365768 35.64627838 35.6400528 35.64422607 35.6402359 35.64598846 35.64023209 35.64229584 35.64193344 35.64261246 35.64746094 35.63682556 35.64370728 35.74347687 35.74534988 35.74236679 35.73675537 35.73838425 35.74174118 35.73894882 35.83584213 35.8412323 35.84160233 35.83996201 35.93353271 35.93379593 35.9345932 35.93690109 35.9334259 36.02864838 36.02735901 36.03026199 36.13125229 36.12955475 36.1228981 36.22369385 36.23100662 36.23028183 36.32764435 36.32866287 36.32495499 36.42479706 36.43197632 36.51892853 36.52161789 36.62269974 36.62142944 36.72122574 36.71898651 36.81211853 36.81745148 36.91525269 36.91080475 37.00736618 37.01118469 37.11250305 37.10976791 37.20728302 37.302845 37.30813217 37.40581512 37.49928665 37.49621201 37.59971619 37.69556808 37.69856644 37.7942009 37.89320374 37.8953743 37.9887886 38.0848999 38.18097687 38.28239059 38.27840424 38.37966919 38.47603607 38.57341003 38.67168808 38.76914978 38.86764526 38.96129608 39.06372833 39.0587883 39.16090012 39.25426865 39.35076523 39.54669952 39.65062332 39.74605942 39.84653854 39.94113922 40.04415131 40.13307953 40.23431778 40.33208847 40.53032684 40.62407303 40.72422791 40.81940079 41.0147171 41.11276627 41.205616 41.40884781 41.50452805 41.59882736 41.79209137 41.89821625 42.08958435 42.18856049 42.38302612 42.47993469 42.67907715 42.87290573 42.97105789 43.16693115 43.35734177 43.45572662 43.65342712 43.84939194 44.04508972 44.23981476 44.33708954 44.52936935 44.72503662 44.91989517 45.11779785 45.31217575 45.50875854 45.802948 45.9931488 46.19252777 46.38772964 46.6788559 46.87607193 47.06939697 47.36288071 47.56106949 47.85041046 48.04606628 48.33797073 48.63450241 48.8302803 49.12152863 49.41314697 49.70755768 50.00176239 50.29244232 50.58903885 50.88072586 51.26889801 51.55887222 51.85607529 52.24630737 52.53870773 52.92798233 53.32294083 53.70902634 54.10313034 54.4930191 54.8834877 55.27364731 55.76058578 56.14982986 56.63882065 57.02841568 57.52117157 58.00784683 58.59671783 59.08158493 59.66658783 60.15639496 60.74389267 61.42667007 62.0124588 62.69457626 63.37681198 64.06443024 64.74681854 65.52774048 66.31021881 67.18876648 68.06681061 69.04246521 70.01992035 71.0954361 72.26702881 73.5359726 75.00061798 76.46730042 78.22219849 80.27219391 82.81466675 86.32720947 92.77294159 92.47978973 92.18859863 91.79653168 91.50267029 91.20867157 90.91717529 90.62378693 90.33008575 90.03785706 89.74498749 89.45091248 89.16085052 88.86864471 88.67375946 88.37815094 88.085495 87.79483795 87.59604645 87.30580902 87.0121994 86.81477356 86.52365112 86.23173523 86.03422546 85.74343109 85.54766846 85.25550842 85.06121063 84.76651764 84.57078552 84.2778244 84.08197021 83.88652039 83.59406281 83.39922333 83.20137787 82.91230011 82.71536255 82.5194397 82.32489014 82.12976074 81.83760071 81.63871002 81.44684601 81.25106812 81.05558777 80.85884857 80.66533661 80.46903229 80.27294922 80.07853699 79.88320923 79.68422699 79.49024963 79.29807281 79.09967804 78.90900421 78.71144867 78.5160141 78.41762543 78.22486877 78.02793121 77.8327713 77.63743591 77.538414 77.34404755 77.14785004 76.95386505 76.85432434 76.66082001 76.46557617 76.36669922 76.17180634 75.97953033 75.87796783 75.68638611 75.58480835 75.39293671 75.19451904 75.09546661 74.90167236 74.80386353 74.60942078 74.51292419 74.31633759 74.22088623 74.02400208 73.9262619 73.82820129 73.63532257 73.5329361 73.34237671 73.24393463 73.14796448 72.94664001 72.85445404 72.75701141 72.55846405 72.46213531 72.36598969 72.16790009 72.06879425 71.97034454 71.87717438 71.68063354 71.58218384 71.48220062 71.38748932 71.18919373 71.09493256 70.99671173 70.89975739 70.80356598 70.70063019 70.50937653 70.41379547 70.31585693 70.21424103 70.11564636 70.02377319 69.92427826 69.82659912 69.72718811 69.52993011 69.43439484 69.33586884 69.23802185 69.14391327 69.04188538 68.94511414 68.85124969 68.75066376 68.65606689 68.55521393 68.45934296 68.36096954 68.25971222 68.16757965 68.16598511 68.0719986 67.96924591 67.87125397 67.77245331 67.67298126 67.58018494 67.48213196 67.38024139 67.28182983 67.28593445 67.18592072 67.08972931 66.98931122 66.89664459 66.79805756 66.79642487 66.70214081 66.59933472 66.50008392 66.41074371 66.40585327 66.3109436 66.20988464 66.1124649 66.11530304 66.0152359 65.91700745 65.8237381 65.81882477 65.72261047 65.63230896 65.52981567 65.52659607 65.43000031 65.33524323 65.33707428 65.23472595 65.13607788 65.1364212 65.04023743 64.94284821 64.9420929 64.84729767 64.7466507 64.74583435 64.65124512 64.64472961 64.55191803 64.45690918 64.45206451 64.35195923 64.35571289 64.25643158 64.16059113 64.16474915 64.06148529 64.06513977 63.97050858 63.9621048 63.86985397 63.8689003 63.77021408 63.77110672 63.67314148 63.67557907 63.57141876 63.57269287 63.47716904 63.47528076 63.37807083 63.38178635 63.28870773 63.28250885 63.18983078 63.17935944 63.08506393 63.08610153 63.08560181 62.98813629 62.98815918 62.89539337 62.89074326 62.89227676 62.79391861 62.80060577 62.69675446 62.69349289 62.6987114 62.59804153 62.60001373 62.59631348 62.50022888 62.49723434 62.50081253 62.40248871 62.40455627 62.40127182 62.30357361 62.30435562 62.30903625 62.20350266 62.20768356 62.20788956 62.21188354 62.11141586 62.10919189 62.10776138 62.10743332 62.01356506 62.01385498 62.01596069 62.00792313 62.00862503 61.91064835 61.9157753 61.91419601 61.91669464 61.91671753 61.82128525 61.82202148 61.8179512 61.81774902 61.82175064 61.81283188 61.8212204 61.72205734 61.71910858 61.71814346 61.71916962 61.71774292 61.7182312 61.71863937 61.72136688 61.71554947 61.71817398 61.62194443 61.62340546 61.62140274 61.62311172 61.62061691 61.61877823 61.62100601 61.62590027 61.623703 61.6206665 61.6184845 61.6190834 61.62500381 61.61876297 61.62221146 61.62573624 61.6214447 61.72372818 61.71715546 61.71935272 61.72673798 61.71169281 61.72066116 61.72264099 61.71887207 61.72253418 61.72341156 61.81517792 61.81740189 61.81483459 61.81319809 61.8238678 61.82185364 61.81326675 61.91387558 61.91043091 61.91744995 61.91103363 61.91780472 62.01591873 62.01387787 62.01602554 62.01297379 62.11548996 62.1067276 62.11439133 62.11171722 62.20619965 62.20685196 62.20759964 62.30322266 62.31111908 62.30070496 62.40403748 62.40358353 62.4039917 62.50132751 62.49913025 62.60264587 62.59640503 62.59876633 62.69623947 62.69539261 62.79282761 62.79143906 62.79136276 62.8872757 62.89276123 62.98524094 62.98807907 63.09153748 63.08860397 63.18286896 63.18919754 63.28068161 63.38180542 63.38282013 63.47850037 63.47373581 63.5747261 63.57614136 63.66799927 63.76377106 63.76695633 63.86920547 63.8690834 63.96191788 64.0622406 64.06108093 64.16133118 64.2569809 64.3600769 64.3585434 64.45617676 64.55487823 64.55782318 64.64794922 64.74227905 64.84680939 64.94369507 64.94055939 65.04627228 65.13388062 65.23962402 65.33287811 65.4275589 65.52989197 65.53150177 65.62509918 65.7230835 65.81693268 65.91795349 66.01490021 66.11055756 66.21057129 66.30930328 66.40958405 66.50550079 66.59815979 66.70316315 66.79588318 66.89571381 66.99430847 67.08624268 67.19080353 67.38208771 67.4837265 67.58010864 67.68003082 67.77623749 67.87133026 67.96807098 68.16547394 68.26278687 68.36183167 68.45191193 68.65579987 68.75180817 68.84950256 69.0428009 69.14099884 69.23834229 69.43442535 69.53222656 69.632164 69.82555389 69.92132568 70.11766052 70.11710358 69.63220978 69.24219513 68.75249481 68.36241913 67.87065887 67.47970581 67.09386444 66.60186768 66.20877838 65.81997681 65.42755127 65.03684998 64.65388489 64.35582733 63.96272278 63.57807922 63.18227768 62.88772202 62.50184631 62.20812607 61.81761932 61.52979279 61.13270569 60.8433075 60.54949188 60.24839401 59.86664963 59.57280731 59.27680588 58.98794174 58.69143295 58.395401 58.10408783 57.81227493 57.52017593 57.22842026 56.93185806 56.73752975 56.44951248 56.15695953 55.8586235 55.66687393 55.37416458 55.17963409 54.88437271 54.5905571 54.39528656 54.09878922 53.90460968 53.6129303 53.41859436 53.22289658 52.93015289 52.73370361 52.5394783 52.24549103 52.04938126 51.85460281 51.66251755 51.36879349 51.17526627 50.97798538 50.78419113 50.59011459 50.29180908 50.09874725 49.9030304 49.70691299 49.51330948 49.31416321 49.12406921 48.93008041 48.73166275 48.5334053 48.34260941 48.1462822 47.9478035 47.75603104 47.56013489 47.36261749 47.26512909 47.07024765 46.8780098 46.67582703 46.48662567 46.28880692 46.18995285 45.99759293 45.79856491 45.60540009 45.40980911 45.31474304 45.11869049 44.92122269 44.82301712 44.62847519 44.43479538 44.23583221 44.14387131 43.94570923 43.75009537 43.6511879 43.45724106 43.3602829 43.16654968 43.06821442 42.87141037 42.77432632 42.57572937 42.48049927 42.28443146 42.18509674 42.09146881 41.89381027 41.79674149 41.70076752 41.60007095 41.4064827 41.30747986 41.21148682 41.11444473 41.01685715 41.01596832 40.91708374 40.8192215 40.72195816 40.72220612 40.62486267 40.62443542 40.62629318 40.52801132 40.52706528 40.52642441 40.52826309 40.52755737 40.52542496 40.62447739 40.62583542 40.62650299 40.72006607 40.722332 40.82121658 40.91996765 40.9183197 41.01393509 41.11212921 41.20765305 41.30715561 41.40750504 41.50414658 41.60311508 41.69623566 41.79405594 41.89445114 41.99298477 42.08938599 42.28832626 42.38425064 42.48408127 42.57555771 42.67367172 42.87223816 42.96618271 43.06409073 43.25631714 43.35832977 43.45511246 43.65016556 43.75005341 43.85033035 44.04236984 44.14174652 44.23405457 44.43339539 44.53247452 44.72551727 44.82435226 45.01816177 45.1144371 45.21289062 45.40856552 45.5055809 45.70195007 45.79958725 45.99597549 46.09237671 46.28448486 46.3854866 46.58003998 46.68035126 46.87126541 46.97217941 47.16590118 47.36387634 47.45806503 47.65653992 47.75207901 47.9508667 48.14645004 48.23873138 48.43315125 48.63419724 48.7325592 48.92672729 49.12291336 49.21957779 49.41174698 49.60598373 49.80088806 49.90135193 50.09980774 50.29282761 50.49066162 50.68149948 50.88059235 50.97676849 51.16749191 51.3680687 51.56032944 51.75828552 51.95176697 52.14532471 52.34380341 52.54034042 52.73302078 52.9310379 53.12508392 53.32193756 53.51812363 53.80844879 54.00219727 54.19412994 54.39422607 54.68812943 54.8812294 55.07985687 55.27775192 55.56428146 55.75908279 56.05290985 56.2503891 56.44662857 56.74081802 56.93344116 57.22630692 57.51855469 57.71522141 58.00474548 58.29778671 58.4928894 58.10174942 57.51724243 57.02995682 56.54502487 56.05408478 55.66115189 55.17497635 54.78374481 54.29734039 53.89680481 53.51512146 53.12183762 52.73596191 52.34302139 51.95048523 51.6583519 51.26992416 50.97431564 50.58506012 50.29478836 50.00054169 49.70521164 49.41481781 49.12256622 48.82258987 48.528759 48.23807907 47.94736099 47.65626907 47.45898438 47.16497421 46.96705246 46.67845535 46.48375702 46.19107056 45.99602509 45.80202484 45.51155853 45.31067276 45.11905289 44.92168808 44.72563934 44.53132248 44.33517075 44.13421631 43.941185 43.75241852 43.55344391 43.35908508 43.15803528 43.06006241 42.87314987 42.67250443 42.57690048 42.37783051 42.18070602 42.09049988 41.89379883 41.79845428 41.60339737 41.50534439 41.31389618 41.20898438 41.11144638 40.91736603 40.82047653 40.72212219 40.52598953 40.42882156 40.33652496 40.23299789 40.03804779 39.9419899 39.84508514 39.74180603 39.64971542 39.5467186 39.44969177 39.35247803 39.25508881 39.0634079 38.96280289 38.86997223 38.8663559 38.77120209 38.67147827 38.56869125 38.48201752 38.37813187 38.28376007 38.18398285 38.07896805 38.08473587 37.98754883 37.89468384 37.79115295 37.79249573 37.692276 37.59499741 37.49941254 37.50154114 37.40305328 37.30319977 37.29952621 37.20677948 37.10554123 37.11078262 37.009758 37.01052094 36.90775299 36.91514587 36.81627274 36.80949402 36.71221542 36.71870422 36.62062454 36.6251297 36.5263443 36.52375793 36.42905426 36.42491913 36.32607269 36.32991409 36.32505417 36.22491074 36.2259407 36.22787094 36.13265228 36.13449478 36.1322937 36.03222275 36.02610779 36.03511047 35.93461227 x1125.702881 0}
   blue {}
   alpha {}}
 name clipped709_JMh
 xpos 160
 ypos 442
}
push $N5cd8e000
Multiply {
 value 0.01
 name Multiply8
 xpos 171
 ypos 320
}
push $N5cd8d800
Sampler {
 sampler {0 1024}
 lut {red {curve 0.4999994338 x0.0009775171056 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.0175953079 0.4999994338 0.4999994338 x0.01955034211 0.4999994338 0.4999994338 x0.02150537632 0.4999994338 0.4999994338 x0.02346041054 0.4999994338 0.4999994338 x0.02541544475 0.4999994338 0.4999994338 x0.02737047896 0.4999994338 0.4999994338 x0.02932551317 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.03421309963 0.4999994338 x0.0351906158 0.4999994338 0.4999994338 x0.03714565188 0.4999994338 x0.03812316805 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.04203323647 0.4999994338 x0.04301075265 0.4999994338 0.4999994338 x0.04496578872 0.4999994338 x0.0459433049 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.04985337332 0.4999994338 x0.05083088949 0.4999994338 0.4999994338 x0.05278592557 0.4999994338 x0.05376344174 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.05767351016 0.4999994338 x0.05865102634 0.4999994338 0.4999994338 x0.06060606241 0.4999994338 x0.06158357859 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.06744868308 0.4999994338 x0.06842619926 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.07429130375 0.4999994338 x0.07526881993 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.08308895677 0.4999994338 x0.08406647295 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.08993157744 0.4999994338 x0.09090909362 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.09872923046 0.4999994338 x0.09970674664 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1055718511 0.4999994338 x0.1065493673 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1143695042 0.4999994338 x0.1153470203 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1212121248 0.4999994338 x0.122189641 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.13391985 0.4999994338 x0.1348973662 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1485826075 0.4999994338 x0.1495601237 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1652003974 0.4999994338 x0.1661779135 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1798631549 0.4999994338 x0.1808406711 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.1964809448 0.4999994338 x0.1974584609 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.2111437023 0.4999994338 x0.2121212184 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.2277614921 0.4999994338 x0.2287390083 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.2424242496 0.4999994338 x0.2434017658 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.2668621838 0.50000453 x0.2678397 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.297165215 0.4999994338 x0.2981427312 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.3294232786 0.4999994338 x0.3304007947 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.3597263098 0.4999994338 x0.360703826 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.3919843733 0.4999994338 x0.3929618895 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999943078 0.4999994338 0.4999994338 0.4999994338 x0.4222874045 0.50000453 x0.4232649207 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999943078 0.50000453 0.4999994338 x0.4545454681 0.4999994338 x0.4555229843 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 x0.4848484993 0.4999994338 x0.4858260155 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 x0.5327468514 0.4999994338 x0.5337243676 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999943078 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.50000453 0.50000453 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.59433043 0.50000453 x0.5953079462 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999943078 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 x0.657869041 0.50000453 x0.6588465571 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 x0.7194526196 0.4999994338 x0.7204301357 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.50000453 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.7829912305 0.4999994338 x0.7839687467 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.8445748091 0.4999994338 x0.8455523252 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.90811342 0.4999994338 x0.9090909362 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 x0.9696969986 0.4999994338 x0.9706745148 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338 0.4999994338}
   green {curve L 31.83551025 x0.2008529007 67.20974731 x0.4523992836 48.30766296 x0.7116855383 55.49045563 x1 32.42992401}
   blue {curve 176.3074646 x0.0009775171056 177.0280914 177.7571869 178.4942322 179.2392273 179.9922638 -179.2472992 -178.479187 -177.7039795 -176.9217072 -176.1325684 -175.3365326 -174.5341339 -173.7257385 -172.9119873 -172.0919952 -171.266983 -170.4371643 x0.0175953079 -169.602829 -168.7641754 x0.01955034211 -167.9215698 -167.0754852 x0.02150537632 -166.2264252 -165.3747406 x0.02346041054 -164.5200958 -163.6639252 x0.02541544475 -162.8060608 -161.9472046 x0.02737047896 -161.0873566 -160.2277985 x0.02932551317 -159.3677216 -158.5079498 -157.6496429 -156.7921448 -155.9369202 x0.03421309963 -155.0839233 x0.0351906158 -154.2322235 -153.3852234 x0.03714565188 -152.5402985 x0.03812316805 -151.6991882 -150.8624268 -150.0299683 -149.2024078 x0.04203323647 -148.3795776 x0.04301075265 -147.5618591 -146.750412 x0.04496578872 -145.9447327 x0.0459433049 -145.1459045 -144.3528137 -143.5679016 -142.7877045 x0.04985337332 -142.0164185 x0.05083088949 -141.2518311 -140.4963074 x0.05278592557 -139.7462158 x0.05376344174 -139.005249 -138.2719269 -137.548172 -136.8309937 x0.05767351016 -136.1222534 x0.05865102634 -135.4241028 -134.7341309 x0.06060606241 -134.05159 x0.06158357859 -133.3782196 -132.7133179 -132.0571442 -131.4104004 -130.7727966 -130.1426239 x0.06744868308 -129.522522 x0.06842619926 -128.9105835 -128.3085022 -127.7154312 -127.1300583 -126.5534363 -125.9847031 x0.07429130375 -125.425354 x0.07526881993 -124.8750687 -124.3319931 -123.7979813 -123.2726822 -122.7547607 -122.2436981 -121.7437973 -121.2499313 x0.08308895677 -120.7644043 x0.08406647295 -120.2854309 -119.8148041 -119.3534775 -118.8982086 -118.448616 -118.008667 x0.08993157744 -117.5756378 x0.09090909362 -117.1491013 -116.729454 -116.3167343 -115.9108429 -115.51091 -115.119072 -114.7330475 -114.3529434 x0.09872923046 -113.9781723 x0.09970674664 -113.6104889 -113.249382 -112.8935471 -112.5442276 -112.2000732 -111.8623428 x0.1055718511 -111.52845 x0.1065493673 -111.2017288 -110.8795624 -110.5628052 -110.2510147 -109.9444885 -109.6428528 -109.3468246 -109.055542 x0.1143695042 -108.7678223 x0.1153470203 -108.4855499 -108.2086868 -107.9344864 -107.6659698 -107.4015884 -107.1413269 x0.1212121248 -106.8857956 x0.122189641 -106.6342621 -106.3863449 -106.1434937 -105.9036942 -105.6673813 -105.4352646 -105.2072678 -104.981575 -104.7609863 -104.543251 -104.3295898 -104.1191254 x0.13391985 -103.9121552 x0.1348973662 -103.7073288 -103.5073776 -103.3097305 -103.1152573 -102.9236908 -102.7361832 -102.5513687 -102.3686981 -102.1893463 -102.0124664 -101.8391266 -101.6685944 -101.500885 -101.3352051 x0.1485826075 -101.1719742 x0.1495601237 -101.0114288 -100.8541794 -100.698967 -100.5457458 -100.3954391 -100.2480164 -100.1019135 -99.9582901 -99.81784821 -99.67919922 -99.54303741 -99.40869141 -99.27676392 -99.14633179 -99.0191803 -98.89281464 x0.1652003974 -98.76908875 x0.1661779135 -98.64769745 -98.52738953 -98.409935 -98.29354858 -98.17910767 -98.06780243 -97.95747375 -97.84875488 -97.74217224 -97.63750458 -97.53403473 -97.43332672 -97.3335495 -97.23551941 x0.1798631549 -97.13896942 x0.1808406711 -97.04425049 -96.95212555 -96.85972595 -96.77013397 -96.68202972 -96.59484863 -96.50952148 -96.42649841 -96.3445816 -96.26344299 -96.18431091 -96.10641479 -96.02996063 -95.95507812 -95.88117981 -95.80950928 x0.1964809448 -95.73854828 x0.1974584609 -95.66920471 -95.60133362 -95.53430176 -95.46897888 -95.40502167 -95.34222412 -95.28018951 -95.22046661 -95.16082001 -95.1035614 -95.04668427 -94.99155426 -94.93701935 -94.88400269 x0.2111437023 -94.83301544 x0.2121212184 -94.78235626 -94.73234558 -94.684021 -94.63742828 -94.59171295 -94.54663849 -94.503479 -94.46068573 -94.41899109 -94.37902069 -94.33952332 -94.3017807 -94.26459503 -94.22827148 -94.19332123 -94.15947723 x0.2277614921 -94.1269455 x0.2287390083 -94.09528351 -94.06499481 -94.03471375 -94.00635529 -93.97930908 -93.95225525 -93.92682648 -93.90250397 -93.87891388 -93.85614777 -93.83475494 -93.81443787 -93.51556396 -93.16397858 x0.2424242496 -92.81221008 x0.2434017658 -92.46097565 -92.10933685 -91.75797272 -91.40596771 -91.05480957 -90.703125 -90.35197449 -90.00005341 -89.64833069 -89.29642487 -88.94536591 -88.59345245 -88.24186707 -87.89083862 -87.53879547 -87.18766022 -86.83607483 -86.48445892 -86.13298798 -85.78100586 -85.42920685 -85.0778656 -84.72644806 -84.37506104 x0.2668621838 -84.02339172 x0.2678397 -83.67183685 -83.32027435 -82.96880341 -82.61690521 -82.26573944 -81.91412354 -81.56270599 -81.21089172 -80.85932922 -80.50782013 -80.15628815 -79.80454254 -79.45318604 -79.10142517 -78.74991608 -78.39840698 -78.04681396 -77.69528198 -77.34365082 -76.99221802 -76.64073944 -76.28916168 -75.93722534 -75.5863266 -75.23439026 -74.88256073 -74.53091431 -74.17945099 -73.82816315 -73.4765625 x0.297165215 -73.12471771 x0.2981427312 -72.77326965 -72.42196655 -72.07049561 -71.71871185 -71.36724091 -71.01579285 -70.66396332 -70.31231689 -69.96099091 -69.60956573 -69.2578125 -68.90632629 -68.55438995 -68.2033844 -67.85182953 -67.49979401 -67.14846039 -66.79668427 -66.44523621 -66.09378815 -65.74243164 -65.39041138 -65.03909302 -64.68755341 -64.33565521 -63.98432159 -63.63277817 -63.28139877 -62.92975235 -62.57808685 -62.22626495 -61.87521362 x0.3294232786 -61.52323914 x0.3304007947 -61.17179871 -60.8200798 -60.46903992 -60.11749649 -59.76571655 -59.41381073 -59.06235504 -58.71113586 -58.35943985 -58.00794601 -57.65601349 -57.30449677 -56.95283508 -56.60138321 -56.24978256 -55.89867401 -55.54664612 -55.19552231 -54.8441124 -54.49192429 -54.14077377 -53.78865814 -53.43777084 -53.08612442 -52.73423004 -52.38290405 -52.03130341 -51.67964554 -51.32822418 -50.97655487 x0.3597263098 -50.62523651 x0.360703826 -50.27373886 -49.92136383 -49.57020569 -49.21824646 -48.86746979 -48.51581192 -48.16392136 -47.81227493 -47.46107483 -47.10931015 -46.75773239 -46.40627289 -46.05514526 -45.70356369 -45.35123062 -45.00028229 -44.64833832 -44.29677582 -43.94533157 -43.59440231 -43.24197006 -42.89065933 -42.53913116 -42.18762589 -41.83597183 -41.4846077 -41.13315964 -40.78186035 -40.4301796 -40.07788467 -39.72669983 -39.37467957 x0.3919843733 -39.02323532 x0.3929618895 -38.67201614 -38.32023621 -37.96833801 -37.61686707 -37.26586151 -36.91412354 -36.56280899 -36.2108345 -35.85923767 -35.50828552 -35.15553665 -34.80471802 -34.45311737 -34.1014595 -33.74998856 -33.39873886 -33.0466423 -32.69543839 -32.34375381 -31.99185944 -31.64094925 -31.28888321 -30.93751526 -30.58550644 -30.23398399 -29.88276291 -29.53146172 -29.17924309 -28.82774162 -28.47654533 x0.4222874045 -28.12514305 x0.4232649207 -27.7735157 -27.42168236 -27.07026482 -26.7183342 -26.36751366 -26.01599503 -25.66420746 -25.31237411 -24.96137238 -24.60906029 -24.25840759 -23.90583611 -23.55424309 -23.20311356 -22.85111237 -22.50030518 -22.14834595 -21.79711342 -21.44508553 -21.09440613 -20.74219131 -20.39069748 -20.03963661 -19.68751907 -19.33540535 -18.98475838 -18.63292122 -18.28107452 -17.92967224 -17.57847595 -17.22660446 -16.87447739 x0.4545454681 -16.52266884 x0.4555229843 -16.17162704 -15.81982899 -15.46895218 -15.11732864 -14.76584053 -14.41400719 -14.06231976 -13.71068954 -13.35957909 -13.0074749 -12.65591812 -12.30516243 -11.95309639 -11.60125065 -11.25000668 -10.89822578 -10.54682636 -10.19559765 -9.843922615 -9.492348671 -9.140686989 -8.789406776 -8.437381744 -8.085835457 -7.734455585 -7.382839203 -7.031270504 -6.679451466 -6.32804966 -5.976819038 x0.4848484993 -5.625026703 x0.4858260155 -5.273333073 -4.921647549 -4.57044363 -4.218632698 -3.867095709 -3.515827417 -3.164312601 -2.812455177 -2.460875273 -2.109203339 -1.757820725 -1.406288385 -1.054721594 -0.703020215 -0.351698637 2.427518484e-05 0.351539582 0.7031132579 1.054671168 1.406401992 1.757814407 2.109508276 2.460862875 2.812501192 3.1641469 3.515648365 3.86716795 4.218748093 4.570329666 4.921858311 5.273546219 5.62499094 5.976554871 6.328083038 6.67969799 7.031258106 7.382876396 7.734297276 8.086149216 8.43764019 8.788971901 9.140665054 9.492019653 9.843785286 10.19538403 10.54692459 10.89831448 11.25000858 x0.5327468514 11.60141277 x0.5337243676 11.95334053 12.30476189 12.64957047 12.63229656 12.61542606 12.5992651 12.58302784 12.56738091 12.55178356 12.53700256 12.52237129 12.50777245 12.4943037 12.48087788 12.46780968 12.45454407 12.44208622 12.42996883 12.41788578 12.40637112 12.39531708 12.38438988 12.37391949 12.36345577 12.35368633 12.34412766 12.33449745 12.32584286 12.31720734 12.30891991 12.3007412 12.29322052 12.28550148 12.2786541 12.27191925 12.26561928 12.25934505 12.25370121 12.24818611 12.24267864 12.23802185 12.23327923 12.22885895 12.22486591 12.22131062 12.2177639 12.21453381 12.21204472 12.2092495 12.20731449 12.2048502 12.20345211 12.20226097 12.20119762 12.20044899 12.20011425 12.19968891 12.20000744 12.20022106 12.20108509 12.20226765 12.20367146 x0.59433043 12.20527172 x0.5953079462 12.20732117 12.20968151 12.2119503 12.21496582 12.21839619 12.22162724 12.22562885 12.2296114 12.2337122 12.23867226 12.24354076 12.2488451 12.25424194 12.2605257 12.26670361 12.27299595 12.27985001 12.28734684 12.29462528 12.30215836 12.31044292 12.31896591 12.32770443 12.33679199 12.34632301 12.35598278 12.36599064 12.37634373 12.38736057 12.39807892 12.4094696 12.42130947 12.43330669 12.44586086 12.45855331 12.47171211 12.48513126 12.49901295 12.51314831 12.52766514 12.54265022 12.55799675 12.57305431 12.58925819 12.60562992 12.62225533 12.63950729 12.65712166 12.67502117 12.69342995 12.71166039 12.73073769 12.75033092 12.77009106 12.79049015 12.81129742 12.83240032 12.85391617 12.87572002 12.89819336 12.92097759 12.94406319 12.96782017 12.99224949 x0.657869041 13.01676655 x0.6588465571 13.04185009 13.06726551 13.09335136 13.11979771 13.14682388 13.17429352 13.2022562 13.23055935 13.25972748 13.28924465 13.31914234 13.34964085 13.38064766 13.41217518 13.44444561 13.47763252 13.51070118 13.54442024 13.57921028 13.61415291 13.64988518 13.68620396 13.72333622 13.76036453 13.79904366 13.83752918 13.87725925 13.91745949 13.95826149 14.00037861 14.04242897 14.08552933 14.12913609 14.17437649 14.21944904 14.26519203 14.31247044 14.35972881 14.40854263 14.45823383 14.50835228 14.55995464 14.61200714 14.6652813 14.71902275 14.77446651 14.83057499 14.88763809 14.94602394 15.00507927 15.06549263 15.12709713 15.18992138 15.25429916 15.31963158 15.38607979 15.45447731 15.52437019 15.59562969 15.66778755 15.74201965 15.81735134 x0.7194526196 15.89535332 x0.7204301357 15.97485924 16.05641365 16.13975143 16.22486496 16.31268501 16.40259171 16.49495697 16.59004211 16.68808365 16.78915405 16.89317894 16.99999237 17.1102581 17.22484207 17.34291458 17.46552467 17.59222794 17.72416687 17.86110497 18.00336456 18.1518116 18.30620575 18.46718216 18.63565063 18.81143188 18.99529648 19.18823051 19.38946342 19.60097122 19.82253265 20.05530548 20.29905128 20.55480576 20.8236618 21.10634041 21.40266037 21.71334457 22.03974342 22.38178062 22.74096107 23.11727333 23.51199913 23.92589378 24.3593483 24.81386948 25.28886604 25.78739548 26.30896759 26.85493469 27.42675018 28.02640915 28.65293503 29.3106823 29.99875641 30.7193985 31.47564125 32.26753616 33.09830475 33.97034836 34.88492584 35.8452301 36.85400391 37.9134407 39.02717209 x0.7829912305 40.19839478 x0.7839687467 41.43107986 42.72550201 44.08901978 45.52266693 47.03256607 48.6194191 50.28736877 52.04463959 53.88686371 55.82282257 57.84971237 59.97327805 62.19246674 64.50495911 66.91353607 69.41324615 71.9929657 74.65518951 77.38815308 80.17959595 83.02291107 85.90283203 88.80589294 91.71356964 94.6157608 97.49390411 100.3399277 103.1342468 105.8708191 108.5346069 111.1200333 113.6238785 116.0333939 118.3508987 120.5743179 122.7002029 124.7342758 126.67099 128.5195923 130.2785187 131.9514618 133.5428467 135.0563812 136.495285 137.862381 139.1619568 140.3997955 141.5757141 142.6951904 143.7622528 144.7778625 145.746048 146.6695557 147.5508423 148.3922272 149.1962738 149.9644318 150.6999817 151.4039001 152.0779877 152.724472 153.3438416 x0.8445748091 153.9387512 x0.8455523252 154.5097961 155.05867 155.5861359 156.0935974 156.5820312 157.052475 157.5056305 157.9426727 158.3641357 158.7709961 159.1637573 159.5432434 159.9098511 160.2645111 160.6075745 160.9397125 161.2611542 161.572525 161.8743286 162.1669159 162.4507141 162.7260284 162.9932404 163.2527161 163.5046997 163.7496033 163.9876099 164.2190094 164.4440918 164.6630707 164.8761749 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 x0.90811342 164.9063263 x0.9090909362 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 x0.9696969986 164.9063263 x0.9706745148 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 164.9063263 165.3670959 165.9415283 166.5244751 167.1159363 167.716095 168.3247681 168.9422455 169.5683289 170.2032623 170.8468018 171.499115 172.1601105 172.8298187 173.5082855 174.195343 174.8907471 175.5949707}}
 name clipped709_JMh_01
 xpos 164
 ypos 382
}
Constant {
 inputs 0
 channels rgb
 color 0.05
 name Constant5
 xpos 2210
 ypos 1516
}
CMSTestPattern {
 inputs 0
 cube_size 16
 name CMSTestPattern1
 xpos 1789
 ypos 1020
}
Reformat {
 type scale
 scale 0.1428571429
 filter impulse
 name Reformat10
 xpos 1789
 ypos 1092
}
set N5e32ac00 [stack 0]
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace26
 xpos 1789
 ypos 1116
}
Multiply {
 value 100
 name Multiply14
 label "Mult by 100 to put in absolute nits"
 xpos 1789
 ypos 1140
}
Group {
 name ZCAM12
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 1789
 ypos 1182
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5e329400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5e2b7c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5e2b7c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5e2f0800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5e2f0800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5e2b6000 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5e2b5c00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5e2b6000
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5e2b5000 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5e2b4c00 [stack 0]
push $N5e2b6000
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5e2b4800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5e2b4400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5e247c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5e247800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5e2b5c00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5e2b6000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5e2b6000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5e2b6000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  surrounds dark
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5e329400
push $N5e2b5c00
push $N5e2b5000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5e245c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5e245c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5e2b5c00
push $N5e2b4c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5e244800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5e244800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5e2b5c00
push $N5e2b4800
push $N5e2b5000
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5e5cac00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5e5ca800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5e5ca800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5e247c00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5e5cac00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5e247c00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5e247800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5e5cac00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5e2b4c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5e2b4400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5e2b5000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5e2b4800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5e2b5c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5e329400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5e8fd400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5e8fc800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5e8fc800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5e896c00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5e896000 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5e896000
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5e896000
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5e895000 [stack 0]
push $N5e895000
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5e896c00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5e842000 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5e842000
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5e842000
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5e604800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5e841000 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N5e604800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5e840800 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N5e604800
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5e7ef800 [stack 0]
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5e7eec00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5e604100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5e841000
push $N5e840800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5e7ed000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5e7ed000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5e604100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5e76ac00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5e76ac00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5e7b3200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5e7b3200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5e8fd400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5e8fd400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5e8fd400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5e604100
push $N5e8fd400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5e896c00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5e7ef800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5e7eec00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5e604800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Group {
 name ZCAM13
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 1789
 ypos 1319
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5e70c400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5e692c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5e692c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5e6b5600 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5e6b5600
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5e691000 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5e690c00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5e691000
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5e62fc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5e62f800 [stack 0]
push $N5e691000
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5e62f400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5e62f000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5e62ec00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5e62e800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5e690c00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5e691000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5e691000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5e691000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  surrounds dark
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5e70c400
push $N5e690c00
push $N5e62fc00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5e62cc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5e62cc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5e690c00
push $N5e62f800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5e9b3400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5e9b3400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5e690c00
push $N5e62f400
push $N5e62fc00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5e9b1c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5e9b1800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5e9b1800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5e62ec00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5e9b1c00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5e62ec00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5e62e800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5e9b1c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5e62f800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5e62f000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5e62fc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5e62f400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5e690c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5e70c400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5ecec400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5ec63400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5ec63400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5ec61c00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5ec61000 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5ec61000
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5ec61000
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5ec27c00 [stack 0]
push $N5ec27c00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5ec61c00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5ec25000 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5ec25000
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5ec25000
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5e9d5600 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5ebcfc00 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N5e9d5600
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5ebcf400 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N5e9d5600
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5ebce800 [stack 0]
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5ebcdc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5e9d4f00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5ebcfc00
push $N5ebcf400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5eb63c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5eb63c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5e9d4f00
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5eb61c00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5eb61c00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5e9d4100 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5e9d4100
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5ecec400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5ecec400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5ecec400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5e9d4f00
push $N5ecec400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5ec61c00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5ebce800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5ebcdc00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5e9d5600
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Multiply {
 value 0.01
 name Multiply15
 label "Div by 100 to go from nits"
 xpos 1789
 ypos 1371
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace27
 xpos 1789
 ypos 1413
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle40
 xpos 1789
 ypos 1546
}
set N5ea83000 [stack 0]
push $N5e32ac00
Difference {
 inputs 2
 name Difference2
 xpos 2074
 ypos 1326
}
push $N4e3d3000
Group {
 name ACES_OutputTransform_v1_2_1
 tile_color 0xa57aaaff
 xpos 1352
 ypos 10
 addUserKnob {20 ACES_OutputTransform_tab l "ACES OutputTransform"}
 addUserKnob {41 gamut l "input gamut" T GamutToXYZ_lite.gamut}
 addUserKnob {26 ""}
 addUserKnob {35 presets t "display output presets." M {display/sRGB "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB\"\}" "display/sRGB D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB D60 sim.\"\}" display/Rec.709 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709\"\}" "display/Rec.709 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709 D60 sim.\"\}" display/Rec.2020 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 1 limiting_pri 1 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.2020\"\}" display/P3D60 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 4 limiting_pri 4 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D60\"\}" display/P3D65 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65\"\}" "display/P3D65 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 D60 sim.\"\}" display/P3DCI "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI\"\}" "display/P3DCI D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI D60 sim.\"\}" "display/P3DCI D65 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 1 dark_to_dim 0 legal_range 0 label \"P3DCI D65 sim.\"\}" display/DCDM "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 7 limiting_pri 7 eotf 5 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"DCDM\"\}" "display/P3D65 ST2084 108nits 7.2nits" "knobs this \{lum \{0.0001 7.2 108\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 108nits 7.2nits\"\}" "display/P3D65 ST2084 1000nits 15nits" "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 1000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 4000nits 15nits" "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 4000nits 15nits\"\}" display/Rec2020_HLG_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 7 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_HLG_1000nits_15nits\"\}" display/Rec2020_ST2084_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_1000nits_15nits\"\}" display/Rec2020_ST2084_2000nits_15nits "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_2000nits_15nits\"\}" display/Rec2020_ST2084_4000nits_15nits "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_4000nits_15nits\"\}" display/OCES "knobs this \{lum \{0.0001 4.8 10000\} override_ssts_params 0 use_c9 0 display_pri 6 limiting_pri 6 eotf 9 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"OCES\"\}" "" ""}}
 addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
 addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
 lum {0.02 4.8 48}
 addUserKnob {20 ssts_params_grp l "SSTS Parameters" n 1}
 ssts_params_grp 0
 addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
 addUserKnob {35 presets_ssts_param l presets t "If you want to override the default SSTS parameters and play around, here are some useful starting points." M {contrast/default "knobs this \{override_ssts_params 0 pctLow 0.35 pctHigh 0.89 slope \{0 1.5 0.\} exposure 0.0 use_c9 0\}" contrast/sdr "knobs this \{override_ssts_params 1 pctLow 0.35 pctHigh 0.89 slope \{0.1 1.6 0.01\} exposure 0.0 use_c9 0\}" contrast/high "knobs this \{override_ssts_params 1 pctLow 0.2 pctHigh 0.89 slope \{0.28 1.75 0.01\} exposure 0.0 use_c9 0\}" contrast/med "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.89 slope \{0.38 1.3 0.01\} exposure 0.0 use_c9 0\}" contrast/med-low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.42 0.01\} exposure 0.0 use_c9 0\}" contrast/low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.2 0.01\} exposure 0.0 use_c9 0\}" ""}}
 addUserKnob {7 exposure R -5 5}
 addUserKnob {7 pctLow l knee}
 pctLow 0.35
 addUserKnob {7 pctHigh l shoulder}
 pctHigh 0.89
 addUserKnob {78 slope n 3}
 slope {0.38 1.501 0.01}
 addUserKnob {20 endGroup n -1}
 addUserKnob {6 use_c9 l "use SegmentedSpline_c9" t "In ACES 1.1 the Output Transform was re-written for HDR tonescales. \n\nIn ACES 1.1, HDR transforms use the new SSTS (Single Stage Tone Scale), while SDR transforms continue to use the old SegmentedSpline_c5 -> OCES -> SegmentedSpline_c9 -> ODT transform.\n\nIf this is enabled, the SegmentedSpline_c9 transform is used to maintain compatibility with the ACES SDR output transforms and enable a 1:1 match with the AMPAS CTL.\n\nIf you are curious, turn use_c9 off and play around with the SSTS Parameters." +STARTLINE}
 use_c9 true
 addUserKnob {26 ""}
 addUserKnob {4 display_pri l "display pri" t "Display encoding primaries." M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 addUserKnob {4 limiting_pri l "limiting pri" t "Limiting primaries for the output transform." -STARTLINE M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 addUserKnob {4 eotf l EOTF t "Electrical to Optical Transfer Function of the monitor." M {sRGB BT.1886 "Gamma 2.2" "Gamma 2.4" "Gamma 2.6" DCDM "ST-2084 (PQ)" HLG Linear OCES ""}}
 eotf Linear
 addUserKnob {6 stretch_black l "stretch black" t "For hdr outputs: stretch black luminance to a PQ code value of 0" +STARTLINE}
 addUserKnob {6 d60_sim l "d60 sim" t "d60 whitepoint simulation." +STARTLINE}
 addUserKnob {6 force_d65_cat l "force d60 to d65 cat" -STARTLINE}
 addUserKnob {6 dark_to_dim l "dark to dim surround" t "Apply gamma adjustment to compensate for \"Dark to Dim\" surround. For SDR outputs only." +STARTLINE}
 addUserKnob {6 legal_range l "legal range" t "Output legal range." +STARTLINE}
}
 BackdropNode {
  inputs 0
  name Electrical_Optical_Transfer_Function
  tile_color 0x151515ff
  label "ACESlib.OutputTransforms.ctl : 185\n// EOTF"
  note_font_size 12
  xpos -2025
  ypos 2294
  bdwidth 3391
  bdheight 740
  z_order -10
 }
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x272727ff
  label "HDR EOTFs"
  note_font_size 42
  xpos 425
  ypos 2379
  bdwidth 910
  bdheight 617
  z_order -5
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x272727ff
  label "SDR EOTFs"
  note_font_size 42
  xpos -1158
  ypos 2384
  bdwidth 1436
  bdheight 608
  z_order -5
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ
  tile_color 0x555b5cff
  label "ACESlib.OutputTransforms.ctl : 90\n// Rendering primaries to XYZ\n"
  note_font_size 12
  xpos -1400
  ypos 906
  bdwidth 380
  bdheight 156
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ1
  tile_color 0x555a5cff
  label "// Apply desaturation to compensate for luminance difference\nlinearCV = mult_f3_f33( linearCV, ODT_SAT_MAT);\n( SDR only)"
  note_font_size 12
  xpos -1412
  ypos 669
  bdwidth 439
  bdheight 186
 }
 BackdropNode {
  inputs 0
  name D60_whitepoint_simulation
  tile_color 0x232323ff
  label "ACESlib.OutputTransforms.ctl : 150\n// Scale to avoid clipping when device calibration is different from D60. \n// To simulate D60, unequal code values are sent to the display.\n"
  note_font_size 12
  xpos -1399
  ypos 176
  bdwidth 818
  bdheight 463
 }
 BackdropNode {
  inputs 0
  name Luminance_to_Linear_Code_Values
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 87\n/*  Scale absolute luminance to linear code value  */\n"
  note_font_size 12
  xpos -1367
  ypos -50
  bdwidth 315
  bdheight 148
 }
 BackdropNode {
  inputs 0
  name Output_Color_Encoding_Specification
  tile_color 0x1d1d1dff
  label "<font size=12>OCES\n<font size=0.1>\n- ACES Output Output Color Encoding Specification \n- An idealized reference display with 0.0001 / 4.8 / 10000 luma\n w/ ACES AP0 Primaries."
  note_font_size 27.4
  xpos -1833
  ypos 2379
  bdwidth 367
  bdheight 377
 }
 BackdropNode {
  inputs 0
  name Output_Legal_Range
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 216\n"
  note_font_size 12
  xpos -1369
  ypos 3128
  bdwidth 318
  bdheight 176
 }
 BackdropNode {
  inputs 0
  name Single_Stage_Tone_Scale
  tile_color 0x272727ff
  label "<b>Single Stage Tone Scale : ACESlib.OutputTransforms.ctl : 82</b><pre>// Apply the tonescale independently in rendering-space RGB\nfloat rgbPost\[3] = ssts_f3( rgbPre, PARAMS);\n\nIf output is SDR, output OCES from SSTS and use SegmentedSpline_c9."
  note_font_size 12
  xpos -1502
  ypos -653
  bdwidth 609
  bdheight 533
 }
 BackdropNode {
  inputs 0
  name clamp_negatives
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 174\n// Clip values < 0 (i.e. projecting outside the display primaries)\nNote: Also clamping values > 1 here."
  note_font_size 12
  xpos -1393
  ypos 2087
  bdwidth 386
  bdheight 120
 }
 BackdropNode {
  inputs 0
  name dim_surround_gamma_adjustment
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 92\n// Apply gamma adjustment to compensate for dim surround\n"
  note_font_size 12
  xpos -1407
  ypos 1063
  bdwidth 395
  bdheight 258
 }
 BackdropNode {
  inputs 0
  name limit_primaries
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n// Gamut limit to limiting primaries\n"
  note_font_size 12
  xpos -1408
  ypos 1655
  bdwidth 396
  bdheight 194
 }
 BackdropNode {
  inputs 0
  name limit_primaries1
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 144\n// CIE XYZ to display encoding primaries\n"
  note_font_size 12
  xpos -1402
  ypos 1892
  bdwidth 384
  bdheight 151
 }
 BackdropNode {
  inputs 0
  name limit_primaries2
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n    // Apply CAT from ACES white point to assumed observer adapted white point\n    // TODO: Needs to expand from just supporting D60 sim to allow for any\n    // observer adapted white point.\n"
  note_font_size 12
  xpos -1407
  ypos 1337
  bdwidth 467
  bdheight 301
 }
 BackdropNode {
  inputs 0
  name rrt_sweeteners_
  tile_color 0x555a5cff
  label "<b>RRT Sweeteners : ACESlib.OutputTransforms.ctl : 79</b><pre>// RRT sweeteners\nfloat rgbPre\[3] = rrt_sweeteners( in);\n"
  note_font_size 18
  xpos -1469
  ypos -1234
  bdwidth 519
  bdheight 548
 }
 Input {
  inputs 0
  name Input
  xpos -1250
  ypos -1450
 }
 AddChannels {
  channels rgba
  name AddChannels
  xpos -1250
  ypos -1415
 }
 Group {
  name GamutToXYZ_lite
  xpos -1250
  ypos -1373
  addUserKnob {20 GamutToXYZ_lite_tab l GamutToXYZ_lite}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACES
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {20 chromaticities_grp l "" +STARTLINE n 1}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {20 endGroup n -1}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorMatrix {
  matrix {
      {1.049811006 0 -9.748453158e-05}
      {-0.4959030151 1.373313069 0.09824004024}
      {4.020908051e-08 0 0.9912520051}
    }
  name ColorMatrix4
  label "XYZ to ACES"
  note_font Helvetica
  xpos -1250
  ypos -1338
 }
 Dot {
  name Dot7
  label " ACES 2065-1 IN"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -1268
 }
 Group {
  name glow_module1
  note_font Helvetica
  xpos -1250
  ypos -1089
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_GLOW_GAIN}
  RRT_GLOW_GAIN 0.05
  addUserKnob {7 RRT_GLOW_MID}
  RRT_GLOW_MID 0.08
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -562
  }
  Dot {
   name Dot2
   xpos -6
   ypos -510
  }
set N5ea80800 [stack 0]
  Dot {
   name Dot4
   xpos -116
   ypos -510
  }
set N5ea80400 [stack 0]
  Expression {
   temp_name0 chroma
   temp_expr0 sqrt(b*(b-g)+g*(g-r)+r*(r-b))
   temp_name1 ycRadiusWeight
   temp_expr1 1.75
   channel0 {-rgba.red rgba.green -rgba.blue none}
   expr0 "( b + g + r + ycRadiusWeight * chroma) / 3.0"
   channel1 {rgba.red -rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_yc1
   xpos -150
   ypos -466
  }
push 0
push $N5ea80400
  Dot {
   name Dot3
   xpos -226
   ypos -510
  }
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   expr1 0
   expr2 0
   name rgb_2_saturation1
   xpos -260
   ypos -466
  }
set N5edef400 [stack 0]
  Expression {
   channel0 {rgba.red rgba.green rgba.blue none}
   expr0 "(r - 0.4) / 0.2"
   name Expression1
   xpos -370
   ypos -466
  }
  Expression {
   temp_name0 t
   temp_expr0 "max( 1.0 - fabs( r / 2.0), 0.0)"
   temp_name1 sign
   temp_expr1 r>0?1:r<0?-1:0
   temp_name2 valy
   temp_expr2 "1.0 + sign * (1.0 - t * t)"
   channel0 {-rgba.red -rgba.green rgba.blue none}
   expr0 "valy / 2"
   channel1 {rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red rgba.green rgba.blue none}
   expr2 0
   name sigmoid_shaper1
   xpos -370
   ypos -442
  }
push $N5edef400
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   note_font Helvetica
   xpos -260
   ypos -393
  }
set N5edee800 [stack 0]
  Expression {
   temp_name0 ycOut
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ((ycOut <= ((1 + glowGainIn) * 2./3. * glowMid)) ? -glowGainIn / (1 + glowGainIn) : ( ycOut >= (2. * glowMid)) ? 0 : glowGainIn * (glowMid / ycOut - 1./2.) / (glowGainIn / 2. - 1.))"
   channel1 none
   channel2 none
   name glow_inv
   xpos -150
   ypos -346
  }
push $N5edee800
  Expression {
   temp_name0 ycIn
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ( ycIn <= 2./3. * glowMid ? glowGainIn : ycIn >= 2. * glowMid ? 0 : glowGainIn * (glowMid / ycIn - 1./2.) )"
   channel1 none
   channel2 none
   name glow_fwd
   xpos -370
   ypos -346
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -260
   ypos -297
  }
  Dot {
   name Dot5
   xpos -226
   ypos -246
  }
push $N5ea80800
  Merge2 {
   inputs 2
   operation multiply
   bbox B
   output rgb
   name Merge3
   note_font Helvetica
   xpos -40
   ypos -249
  }
  Output {
   name Output
   xpos -40
   ypos -178
  }
 end_group
 Group {
  name red_modifier1
  note_font Helvetica
  xpos -1250
  ypos -1041
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_RED_SCALE}
  RRT_RED_SCALE 0.82
  addUserKnob {7 RRT_RED_PIVOT}
  RRT_RED_PIVOT 0.03
  addUserKnob {7 RRT_RED_HUE}
  addUserKnob {7 RRT_RED_WIDTH R 0 360}
  RRT_RED_WIDTH 135
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  Dot {
   name Dot1
   xpos -6
   ypos 42
  }
set N5edecc00 [stack 0]
  Dot {
   name Dot2
   xpos -226
   ypos 42
  }
set N5edec800 [stack 0]
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   channel0 rgb
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   channel1 none
   expr1 0
   channel2 none
   expr2 0
   name rgb_2_saturation
   xpos -260
   ypos 86
  }
push $N5edec800
  Dot {
   name Dot3
   xpos -336
   ypos 42
  }
  Expression {
   temp_name0 hue
   temp_expr0 "(r==g&&g==b)?0:(180/pi) * atan2( sqrt(3)*(g-b), 2*r-g-b)"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "hue < 0 ? hue + 360 : hue"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_hue
   xpos -370
   ypos 86
  }
  Expression {
   temp_name0 hue
   temp_expr0 r
   temp_name1 centerH
   temp_expr1 RRT_RED_HUE
   temp_name2 hueCentered
   temp_expr2 hue-centerH
   channel0 {-rgba.red rgba.green -rgba.blue -rgba.alpha}
   expr0 "hueCentered < -180.0 ? hueCentered + 360.0 : (hueCentered > 180.0) ? hueCentered - 360.0 : hueCentered"
   name center_hue
   xpos -370
   ypos 134
  }
  Expression {
   temp_name0 centeredHue
   temp_expr0 g
   temp_name1 knot_coord
   temp_expr1 "(centeredHue - knots.0) * 4.0/w"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "(min((centeredHue > knots.0?1:0) , (centeredHue < knots.4?1:0)) ? j == 3 ? t*t*t * -1./6 + t*t * 3./6 +  t * -3./6 + 1 * 1./6 : j == 2 ? t*t*t * 3./6 + t*t * -6./6 + t * 0./6 + 1. *4./6 : j == 1 ? t*t*t * -3./6 + t*t * 3./6 + t * 3./6 + 1. * 1./6 : j == 0 ? t*t*t * 1./6 + t*t * 0./6 + t * 0./6 + 1. * 0./6 : 0 : 0) * 3/2"
   channel1 none
   channel2 none
   name cubic_basis_shaper
   xpos -370
   ypos 182
   addUserKnob {20 param}
   addUserKnob {7 w R 0 360}
   w {{parent.RRT_RED_WIDTH}}
   addUserKnob {78 knots n 5}
   knots {{-w/2} {-w/4} 0 {w/4} {w/2}}
  }
  Dot {
   name Dot4
   xpos -336
   ypos 234
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy4
   note_font Helvetica
   xpos -260
   ypos 226
  }
  Dot {
   name Dot6
   label " r : hueWeight\n g : centeredHue\n b : saturation"
   note_font "Helvetica \[pyrs]"
   note_font_size 12
   note_font_color 0xff
   xpos -226
   ypos 282
  }
  Dot {
   name Dot7
   xpos -226
   ypos 330
  }
set N5ed72000 [stack 0]
push $N5edecc00
  Dot {
   name Dot8
   xpos -6
   ypos 258
  }
set N5ed71c00 [stack 0]
  MergeExpression {
   inputs 2
   temp_name0 minChan
   temp_expr0 "Ag < 0 ? Bg : Bb"
   temp_name1 a_
   temp_expr1 "Ar * (1. - RRT_RED_SCALE) - 1."
   temp_name2 b
   temp_expr2 "Br - Ar* (RRT_RED_PIVOT + minChan) * (1. - RRT_RED_SCALE)"
   temp_name3 c
   temp_expr3 "Ar * RRT_RED_PIVOT * minChan * (1. - RRT_RED_SCALE)"
   expr0 "( -b - sqrt( b * b - 4. * a_ * c)) / ( 2. * a_)"
   name red_modifier_rev
   note_font Helvetica
   xpos -150
   ypos 351
  }
push $N5ed72000
push $N5ed71c00
  MergeExpression {
   inputs 2
   expr0 "r + Ar * Ab * (RRT_RED_PIVOT - r) * (1. - RRT_RED_SCALE)"
   name red_modifier_fwd
   note_font Helvetica
   xpos -40
   ypos 327
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -40
   ypos 423
  }
  Output {
   name Output
   xpos -40
   ypos 494
  }
 end_group
 Clamp {
  channels rgb
  maximum_enable false
  name clamp_f3_min
  label "Clamp Negative Values"
  xpos -1250
  ypos -976
 }
 ColorMatrix {
  matrix {
      {1.451439381 -0.2365107685 -0.2149285674}
      {-0.07655383646 1.176229835 -0.09967593104}
      {0.008316127583 -0.0060324613 0.997716248}
    }
  name ColorMatrix15
  label "ACES to ACEScg"
  xpos -1250
  ypos -928
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3_
  label "clamp to HALF_MAX"
  xpos -1250
  ypos -880
 }
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix
  label "// --- Global desaturation --- //\nrgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);"
  xpos -1250
  ypos -790
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.96
 }
 Dot {
  name Dot29
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xff
  xpos -1216
  ypos -558
 }
set N5f10f800 [stack 0]
 Group {
  name ssts
  xpos -1250
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} {parent.lum} {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.override_ssts_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 mid_lum l "mid lum" R 0 20}
  mid_lum {{parent.lum.1}}
  addUserKnob {7 expShift R -4 4}
  expShift {{"(parent.override_ssts_params ? exposure : 0) + (mid_lum<= 4.8 ? 0 : \[sample parent.expShift r 0 0] )"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} 4.8 {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR + (MAX_STOP_RRT-MAX_STOP_SDR) / (log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR)) * (log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N5f10f000 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N5f10f000
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N5f10e800 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N5f10e400 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N5f10e000 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N5f10dc00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N5f10dc00
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N5f10d000 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr1 "logg * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr2 "logb* minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N5f10e000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N5f10d000
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N5f0c7400 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N5f0c7000 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N5f0c6c00 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N5f0c6400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression5
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N5f0c6400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N5f0c6c00
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N5f0c5000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression3
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N5f0c5000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N5f0c7000
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N5f06f800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N5f06f800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N5f10e400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N5f0c7400
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N5f06d000 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N5f06cc00 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N5f06c800 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N5f00fc00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression11
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N5f00fc00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N5f06c800
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N5f00e800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression9
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N5f00e800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N5f06cc00
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N5f00d400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression7
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N5f00d400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N5f10e800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N5f06d000
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr1 "logg * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr2 "logb* maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -160
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Dot {
   name Dot30
   xpos 1534
   ypos 810
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Dot {
  name Dot23
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -462
 }
set N5efa4800 [stack 0]
 Dot {
  name Dot22
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos -462
 }
 ColorMatrix {
  matrix {
      {0.6954522133 0.1406786889 0.163869068}
      {0.04479461163 0.8596711159 0.09553432465}
      {-0.005525866989 0.004025223665 1.001500726}
    }
  name ColorMatrix7
  label "ACEScg to ACES"
  note_font Helvetica
  xpos -1690
  ypos -398
 }
 Dot {
  name Dot21
  label " OCES"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos 2658
 }
push $N5efa4800
 Dot {
  name Dot28
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -342
 }
set N5ef47400 [stack 0]
 Group {
  name segmented_spline_c9_fwd
  xpos -1140
  ypos -346
  addUserKnob {20 SegmentedSplineParams_c9_tab l SegmentedSplineParams_c9}
  addUserKnob {78 coefsLow n 10}
  coefsLow {-1.698970004 -1.698970004 -1.4779 -1.2291 -0.8648 -0.448 0.00518 0.4511080334 0.9113744414 0.9113744414}
  addUserKnob {78 coefsHigh n 10}
  coefsHigh {0.5154386965 0.8470437783 1.1358 1.3802 1.5197 1.5985 1.6467 1.674609136 1.687873339 1.687873339}
  addUserKnob {12 minPoint}
  minPoint {0.0028799 0.02}
  addUserKnob {12 midPoint}
  midPoint {4.79999924 4.8}
  addUserKnob {12 maxPoint}
  maxPoint {1005.719116 48}
  addUserKnob {7 slopeLow}
  addUserKnob {7 slopeHigh}
  slopeHigh 0.04
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 8
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 8
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N5ef46c00 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N5ef46c00
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N5ef46400 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N5ef46000 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N5ef45c00 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N5ef45800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N5ef45800
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N5ef44c00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr1 "logg * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr2 "logb* slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N5ef45c00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N5ef44c00
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N5eef7000 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N5eef6c00 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N5eef6800 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N5eef6000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression15
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N5eef6000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N5eef6800
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N5eef4c00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression14
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N5eef4c00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N5eef6c00
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N5ee9f400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N5ee9f400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N5ef46000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N5eef7000
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N5ee9cc00 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N5ee9c800 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N5ee9c400 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N5ee47800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression3
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N5ee47800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N5ee9c400
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N5ee46400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression5
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N5ee46400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N5ee9c800
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N5ee45000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression16
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N5ee45000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N5ef46400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N5ee9cc00
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr1 "logg * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr2 "logb* slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
push $N5ef47400
 Switch {
  inputs 2
  which {{parent.use_c9}}
  name Switch_c9
  xpos -1250
  ypos -298
 }
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_
  xpos -1250
  ypos 38
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Dot {
  name Dot12
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 282
 }
set N5f1d4400 [stack 0]
 Dot {
  name Dot15
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 282
 }
set N5f16bc00 [stack 0]
 Dot {
  name Dot13
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 282
 }
 Dot {
  name Dot16
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 354
 }
set N5f16b400 [stack 0]
 Expression {
  temp_name0 tr
  temp_expr0 "(-r - c_x_0) / (c_x_1 - c_x_0)"
  temp_name1 tg
  temp_expr1 "(-g - c_x_0) / (c_x_1 - c_x_0)"
  temp_name2 tb
  temp_expr2 "(-b - c_x_0) / (c_x_1 - c_x_0)"
  expr0 "tr < 0.0 ? -(tr * c_b + c_c) : tr > 1.0 ? r : -(( tr * c_a + c_b) * tr + c_c)"
  expr1 "tg < 0.0 ? -(tg * c_b + c_c) : tg > 1.0 ? g : -(( tg * c_a + c_b) * tg + c_c)"
  expr2 "tb < 0.0 ? -(tb * c_b + c_c) : tb > 1.0 ? b : -(( tb * c_a + c_b) * tb + c_c)"
  name roll_white_fwd_1
  xpos -920
  ypos 398
  addUserKnob {20 Params}
  addUserKnob {7 new_wht}
  new_wht 0.918
  addUserKnob {7 c_width}
  c_width 0.5
  addUserKnob {7 c_x_0 +DISABLED}
  c_x_0 -1
  addUserKnob {7 c_x_1 +DISABLED}
  c_x_1 {{"c_x_0 + c_width"}}
  addUserKnob {7 c_y0 +DISABLED}
  c_y0 {{-new_wht}}
  addUserKnob {7 c_y1 +DISABLED}
  c_y1 {{c_x_1}}
  addUserKnob {7 c_m1 +DISABLED}
  c_m1 {{"(c_x_1 - c_x_0)"}}
  addUserKnob {7 c_a +DISABLED}
  c_a {{"c_y0 - c_y1 + c_m1"}}
  addUserKnob {7 c_b +DISABLED}
  c_b {{"2 * (c_y1 - c_y0) - c_m1"}}
  addUserKnob {7 c_c +DISABLED}
  c_c {{c_y0}}
 }
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96
  temp_name1 NEW_WHT
  temp_expr1 0.918
  expr0 "min( r, NEW_WHT) * SCALE"
  expr1 "min( g, NEW_WHT) * SCALE"
  expr2 "min( b, NEW_WHT) * SCALE"
  name Expression2
  label "// Scale and clamp white to avoid casted highlights due to D60 simulation"
  xpos -920
  ypos 440
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 498
 }
push $N5f16b400
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96362
  expr0 "r * SCALE"
  expr1 "g * SCALE"
  expr2 "b * SCALE"
  name mult_f_f3_
  label D65
  xpos -1030
  ypos 344
 }
push $N5f16bc00
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_
  xpos -1140
  ypos 350
 }
 Dot {
  name Dot14
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 426
 }
push $N5f1d4400
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch1
  xpos -1250
  ypos 422
 }
 Switch {
  inputs 2
  which {{"parent.display_pri == 3"}}
  name switch_wp_is_dci_
  xpos -1250
  ypos 494
 }
 Dot {
  name Dot26
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 762
 }
set N5f169c00 [stack 0]
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix3
  label "// Apply desaturation to compensate \nfor luminance difference"
  xpos -1140
  ypos 746
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.93
 }
push $N5f169c00
 Switch {
  inputs 2
  which {{"parent.eotf < 5 && display_pri < 2"}}
  name Switch_eotf
  label "Use if output is SDR"
  xpos -1250
  ypos 800
 }
 ColorMatrix {
  matrix {
      {0.6624541879 0.1340042055 0.1561876982}
      {0.2722287476 0.6740817428 0.05368951708}
      {-0.005574660841 0.004060741514 1.010339141}
    }
  name ColorMatrix1
  label "ACES AP1 to XYZ"
  xpos -1250
  ypos 968
 }
 Dot {
  name Dot8
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1146
 }
set N5f169000 [stack 0]
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1136
 }
 Clamp {
  channels {rgba.red -rgba.green -rgba.blue none}
  maximum_enable false
  name ClampMin4
  xpos -1140
  ypos 1190
 }
 Expression {
  expr0 "pow(r, DIM_SURROUND_GAMMA)"
  expr1 g
  expr2 b
  channel3 none
  name dark_to_dim3
  xpos -1140
  ypos 1214
  addUserKnob {20 Params}
  addUserKnob {7 DIM_SURROUND_GAMMA}
  DIM_SURROUND_GAMMA 0.9811
 }
 Colorspace {
  colorspace_in CIE-Yxy
  colorspace_out CIE-XYZ
  name Colorspace4
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1256
 }
push $N5f169000
 Switch {
  inputs 2
  which {{"(parent.eotf <= 4) ? parent.dark_to_dim : 0"}}
  name DarkToDim_Switch
  label "enable if sdr\nand dark_to_dim enabled"
  xpos -1250
  ypos 1250
 }
 Dot {
  name Dot19
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1434
 }
set N5f4f3800 [stack 0]
 Dot {
  name Dot9
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 1434
 }
set N5f4f3400 [stack 0]
 ColorMatrix {
  matrix {
      {0.9872254133 -0.006114810705 0.01592640579}
      {-0.007603884675 1.001874804 0.005322027951}
      {0.003066040576 -0.005084238946 1.081519246}
    }
  name ColorMatrix2
  label "CAT: Bradford\n D60 to D65"
  xpos -1140
  ypos 1466
 }
set N5f4f3000 [stack 0]
push $N5f4f3400
 Dot {
  name Dot10
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -996
  ypos 1434
 }
push $N5f4f3000
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch
  xpos -1140
  ypos 1550
 }
push $N5f4f3800
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_1
  xpos -1250
  ypos 1550
 }
 Switch {
  inputs 2
  which {{parent.force_d65_cat}}
  name switch_force_d65_cat
  xpos -1250
  ypos 1598
 }
 Group {
  name limit_to_primaries
  label "Only enabled when display_pri != limiting_pri"
  xpos -1250
  ypos 1760
  disable {{"!(parent.display_pri != parent.limiting_pri)"}}
  addUserKnob {20 limit_to_primaries}
  addUserKnob {4 limiting_pri l "limiting pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  limiting_pri {{parent.limiting_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to limiting primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N5f4f2400 [stack 0]
push $N5f4f2400
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix5
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N5f4f2400
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N5f4f2400
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N5f4f2400
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N5f4f2400
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N5f4f2400
  ColorMatrix {
   matrix {
       {0.6954522133 0.1406786889 0.163869068}
       {0.04479461163 0.8596711159 0.09553432465}
       {-0.005525866989 0.004025223665 1.001500726}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N5f4f2400
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Clamp {
   channels rgb
   name clamp_f3
   label "Clip any values outside the limiting primaries"
   xpos -40
   ypos 56
  }
  Dot {
   name Dot2
   label " Convert limited RGB to XYZ"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 162
  }
set N5f47bc00 [stack 0]
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.9525524378 0 9.367863095e-05}
       {0.3439664543 0.7281661034 -0.07213255018}
       {-3.863927134e-08 0 1.008825183}
     }
   name ColorMatrix4
   label "ACES to XYZ"
   xpos 730
   ypos 224
  }
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.6624541879 0.1340042055 0.1561876982}
       {0.2722287476 0.6740817428 0.05368951708}
       {-0.005574660841 0.004060741514 1.010339141}
     }
   name ColorMatrix20
   label "ACEScg to XYZ"
   xpos 620
   ypos 224
  }
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.5049495697 0.2646814585 0.1830150485}
       {0.237623319 0.6891706586 0.07320601493}
       {0 0.0449459292 0.9638792276}
     }
   name ColorMatrix13
   label "P3D60 to XYZ"
   xpos 510
   ypos 224
  }
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.4451698363 0.2771343887 0.1722826511}
       {0.209491685 0.7215952873 0.06891305745}
       {0 0.04706057906 0.9073553085}
     }
   name ColorMatrix18
   label "P3DCI to XYZ"
   xpos 400
   ypos 224
  }
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.4865709841 0.2656676769 0.1982172877}
       {0.2289745659 0.6917385459 0.07928691059}
       {0 0.04511339962 1.043944359}
     }
   name ColorMatrix16
   label "P3D65 to XYZ"
   xpos 290
   ypos 224
  }
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.6369580626 0.1446169019 0.1688809693}
       {0.2627002299 0.6779980659 0.05930171534}
       {0 0.0280726999 1.060985088}
     }
   name ColorMatrix3
   label "Rec2020 to XYZ"
   xpos 180
   ypos 224
  }
push $N5f47bc00
  ColorMatrix {
   matrix {
       {0.4123907983 0.3575843275 0.180480808}
       {0.2126390189 0.7151686549 0.07219231874}
       {0.01933082007 0.1191947311 0.950532198}
     }
   name ColorMatrix1
   label "Rec709 to XYZ"
   xpos 70
   ypos 224
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch1
   xpos -40
   ypos 326
  }
  Output {
   name Output
   xpos -40
   ypos 446
  }
 end_group
 Group {
  name XYZ_2_DISPLAY_PRI
  label "CIE XYZ to display encoding primaries"
  xpos -1250
  ypos 1976
  addUserKnob {20 XYZ_2_DISPLAY_PRI_tab l XYZ_2_DISPLAY_PRI}
  addUserKnob {4 display_pri l "display pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  display_pri {{parent.display_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to display primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N5f479400 [stack 0]
push $N5f479400
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix3
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N5f479400
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N5f479400
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N5f479400
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N5f479400
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N5f479400
  ColorMatrix {
   matrix {
       {1.71665132 -0.3556708097 -0.2533662617}
       {-0.6666844487 1.616481304 0.01576855592}
       {0.01763986237 -0.04277062416 0.9421030879}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N5f479400
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.display_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Clamp {
  channels rgb
  name clamp_f3_all
  xpos -1250
  ypos 2164
 }
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 2514
 }
set N5f40a800 [stack 0]
push $N5f40a800
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 2514
 }
set N5f40a400 [stack 0]
 Dot {
  name Dot4
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 2514
 }
set N5f40a000 [stack 0]
 Dot {
  name Dot6
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -446
  ypos 2514
 }
set N5f409c00 [stack 0]
 Dot {
  name Dot18
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -226
  ypos 2514
 }
set N5f409800 [stack 0]
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -6
  ypos 2514
 }
set N5f409400 [stack 0]
 Dot {
  name Dot25
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 214
  ypos 2514
 }
set N5f409000 [stack 0]
 Dot {
  name Dot24
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2514
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2610
 }
set N5f408800 [stack 0]
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr
  label "stretch_black = True"
  xpos 510
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
push $N5f408800
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr2
  label "stretch_black = False"
  xpos 620
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Switch {
  inputs 2
  which {{parent.stretch_black}}
  name StretchBlacks_Switch
  xpos 620
  ypos 2750
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3__
  xpos 620
  ypos 2822
 }
 Expression {
  temp_name0 Lm_r
  temp_expr0 "pow((r / pq_C), pq_m1)"
  temp_name1 Lm_g
  temp_expr1 "pow((g / pq_C), pq_m1)"
  temp_name2 Lm_b
  temp_expr2 "pow((b / pq_C), pq_m1)"
  expr0 "pow(( pq_c1 + pq_c2 * Lm_r ) / ( 1.0 + pq_c3 * Lm_r ), pq_m2)"
  expr1 "pow(( pq_c1 + pq_c2 * Lm_g ) / ( 1.0 + pq_c3 * Lm_g ), pq_m2)"
  expr2 "pow(( pq_c1 + pq_c2 * Lm_b ) / ( 1.0 + pq_c3 * Lm_b ), pq_m2)"
  name Y_2_ST2084_
  label "ACESlib.OutputTransforms.ctl : 243 \nACESlib.Utilities_Color.ctl : 425"
  xpos 620
  ypos 2882
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
set N5f3c7400 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2514
 }
 Expression {
  temp_name0 Np_r
  temp_expr0 "pow( r, 1.0 / pq_m2 )"
  temp_name1 Np_g
  temp_expr1 "pow( g, 1.0 / pq_m2 )"
  temp_name2 Np_b
  temp_expr2 "pow( b, 1.0 / pq_m2 )"
  expr0 "r < 0 ? 0 : pow((Np_r - pq_c1) / ( pq_c2 - pq_c3 * Np_r ), 1.0/pq_m1) * pq_C"
  expr1 "g < 0 ? 0 : pow((Np_g - pq_c1) / ( pq_c2 - pq_c3 * Np_g ), 1.0/pq_m1) * pq_C"
  expr2 "b < 0 ? 0 : pow((Np_b - pq_c1) / ( pq_c2 - pq_c3 * Np_b ), 1.0/pq_m1) * pq_C"
  name ST2084_2_Y_f3_
  label "ACESlib.Utilities_Color.ctl : 408\n// Converts from the non-linear perceptually quantized space to linear cd/m^2"
  xpos 950
  ypos 2618
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Expression {
  temp_name0 Y_d
  temp_expr0 "0.2627*r + 0.6780*g + 0.0593*b"
  expr0 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((r-c_beta)/c_alpha)"
  expr1 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((g-c_beta)/c_alpha)"
  expr2 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((b-c_beta)/c_alpha)"
  name ST2084_2_HLG_1000nits_f3_3
  label "ACESlib.Utilities_Color.ctl : 469\n// HLG Inverse EOTF (i.e. HLG inverse OOTF followed by the HLG OETF)\n// HLG Inverse OOTF (display linear to scene linear)"
  xpos 950
  ypos 2732
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 L_w +DISABLED}
  L_w 1000
  addUserKnob {7 L_b +DISABLED}
  addUserKnob {7 c_alpha +DISABLED}
  c_alpha {{L_w-L_b}}
  addUserKnob {7 c_beta +DISABLED}
  c_beta {{L_b}}
  addUserKnob {7 c_gamma +DISABLED}
  c_gamma 1.2
 }
 Expression {
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "r <= 1.0/12 ? sqrt(3.0*r) : c_a * log(12.0 * r - c_b) + c_c"
  expr1 "g <= 1.0/12 ? sqrt(3.0*g) : c_a * log(12.0 * g- c_b) + c_c"
  expr2 "b <= 1.0/12 ? sqrt(3.0*b) : c_a * log(12.0 * b - c_b) + c_c"
  name ST2084_2_HLG_1000nits_f3_
  label "ACESlib.Utilities_Color.ctl : 493\n// HLG OETF (scene linear to non-linear signal value)"
  xpos 950
  ypos 2834
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 c_a +DISABLED}
  c_a 0.17883277
  addUserKnob {7 c_b t 1.-4.*a +DISABLED}
  c_b 0.28466892
  addUserKnob {7 c_c t 0.5-a*log(4.*a) +DISABLED}
  c_c 0.55991073
 }
 Dot {
  name Dot17
  label " HLG"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2970
 }
push $N5f3c7400
 Dot {
  name Dot27
  label " PQ"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2970
 }
push $N5f409000
 Expression {
  expr0 "pow( (48./52.37) * r, 1./2.6)"
  expr1 "pow( (48./52.37) * g, 1./2.6)"
  expr2 "pow( (48./52.37) * b, 1./2.6)"
  expr3 1
  name dcdm_encode
  xpos 180
  ypos 2702
 }
push $N5f409400
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_26_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.6"
  xpos -40
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.6
 }
push $N5f409800
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_24_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.4"
  xpos -260
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
 }
push $N5f409c00
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_22_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.2"
  xpos -480
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.2
 }
push $N5f40a000
 Expression {
  temp_name0 c_a
  temp_expr0 "pow( pow( Lw, 1./gamma) - pow( Lb, 1./gamma), gamma)"
  temp_name1 c_b
  temp_expr1 "pow( Lb, 1./gamma) / ( pow( Lw, 1./gamma) - pow( Lb, 1./gamma))"
  expr0 "pow( max( r / c_a, 0.), 1.0/gamma) - c_b"
  expr1 "pow( max( g / c_a, 0.), 1.0/gamma) - c_b"
  expr2 "pow( max( b / c_a, 0.), 1.0/gamma) - c_b"
  name bt1886_r_f3
  label "ACESlib.Utilities_Color.ctl : 301\n// The reference EOTF specified in Rec. ITU-R BT.1886\n// L = a(max\[(V+b),0])^g"
  xpos -700
  ypos 2684
  addUserKnob {20 Luminance}
  addUserKnob {7 Lw R 48 10000}
  Lw 1
  addUserKnob {7 Lb R 0.0001 0.02}
  addUserKnob {7 gamma R 1 4}
  gamma 2.4
 }
push $N5f40a400
 Expression {
  temp_name0 yb
  temp_expr0 "pow( offs * gamma / ( ( gamma - 1.0) * ( 1.0 + offs)), gamma)"
  temp_name1 rs
  temp_expr1 "pow( ( gamma - 1.0) / offs, gamma - 1.0) * pow( ( 1.0 + offs) / gamma, gamma)"
  expr0 "r >= yb ? ( 1.0 + offs) * pow( r, 1.0 / gamma) - offs : r * rs"
  expr1 "g >= yb ? ( 1.0 + offs) * pow( g, 1.0 / gamma) - offs : g * rs"
  expr2 "b >= yb ? ( 1.0 + offs) * pow( b, 1.0 / gamma) - offs : b * rs"
  name moncurve_r_f3_
  label "ACESlib.Utilities_Color.ctl : 260\nmoncurve_r with gamma of 2.4 and offset of 0.055 matches the EOTF found in IEC 61966-2-1:1999 (sRGB)"
  xpos -920
  ypos 2690
  addUserKnob {20 Luminance}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
  addUserKnob {7 offs}
  offs 0.055
 }
 Switch {
  inputs 10
  which {{parent.eotf}}
  name EOTF_Switch
  xpos -1250
  ypos 2966
 }
 Expression {
  temp_name0 REFBLACK
  temp_expr0 "64 / 1023"
  temp_name1 REFWHITE
  temp_expr1 "940 / 1023"
  expr0 "r * ( REFWHITE - REFBLACK) + REFBLACK"
  expr1 "g * ( REFWHITE - REFBLACK) + REFBLACK"
  expr2 "b * ( REFWHITE - REFBLACK) + REFBLACK"
  name fullRange_to_smpteRange_f3_
  label "ACESlib.OutputTransforms.ctl : 216"
  xpos -1250
  ypos 3224
  disable {{!parent.legal_range}}
 }
 Output {
  name Output
  xpos -1250
  ypos 3446
 }
 StickyNote {
  inputs 0
  name StickyNote1
  tile_color 0x535a61ff
  label "\n<b>ACESlib.RRT_Common.ctl : 135</b>\n<pre>\nfloat\[3] rrt_sweeteners( float in\[3])\n\{\n    float aces\[3] = in;\n    \n    // --- Glow module --- //\n    float saturation = rgb_2_saturation( aces);\n    float ycIn = rgb_2_yc( aces);\n    float s = sigmoid_shaper( (saturation - 0.4) / 0.2);\n    float addedGlow = 1. + glow_fwd( ycIn, RRT_GLOW_GAIN * s, RRT_GLOW_MID);\n\n    aces = mult_f_f3( addedGlow, aces);\n\n    // --- Red modifier --- //\n    float hue = rgb_2_hue( aces);\n    float centeredHue = center_hue( hue, RRT_RED_HUE);\n    float hueWeight = cubic_basis_shaper( centeredHue, RRT_RED_WIDTH);\n\n    aces\[0] = aces\[0] + hueWeight * saturation * (RRT_RED_PIVOT - aces\[0]) * (1. - RRT_RED_SCALE);\n\n    // --- ACES to RGB rendering space --- //\n    aces = clamp_f3( aces, 0., HALF_POS_INF);\n    float rgbPre\[3] = mult_f3_f44( aces, AP0_2_AP1_MAT);\n    rgbPre = clamp_f3( rgbPre, 0., HALF_MAX);\n    \n    // --- Global desaturation --- //\n    rgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);\n    return rgbPre;\n\}\n\n\n\n"
  note_font_size 10
  xpos -825
  ypos -1204
 }
 StickyNote {
  inputs 0
  name StickyNote2
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.SSTS.ctl : 163</b><pre>float ssts\n( \n    varying float x,\n    varying TsParams C\n)\n\{\n    const int N_KNOTS_LOW = 4;\n    const int N_KNOTS_HIGH = 4;\n\n    // Check for negatives or zero before taking the log. If negative or zero,\n    // set to HALF_MIN.\n    float logx = log10( max(x, HALF_MIN )); \n\n    float logy;\n\n    if ( logx <= log10(C.Min.x) ) \{ \n\n        logy = logx * C.Min.slope + ( log10(C.Min.y) - C.Min.slope * log10(C.Min.x) );\n\n    \} else if (( logx > log10(C.Min.x) ) && ( logx < log10(C.Mid.x) )) \{\n\n        float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.Min.x))/(log10(C.Mid.x)-log10(C.Min.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else if (( logx >= log10(C.Mid.x) ) && ( logx < log10(C.Max.x) )) \{\n\n        float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.Mid.x))/(log10(C.Max.x)-log10(C.Mid.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else \{ //if ( logIn >= log10(C.Max.x) ) \{ \n\n        logy = logx * C.Max.slope + ( log10(C.Max.y) - C.Max.slope * log10(C.Max.x) );\n\n    \}\n\n    return pow10(logy);\n\n\}"
  note_font_size 10
  xpos -830
  ypos -664
 }
 StickyNote {
  inputs 0
  name StickyNote3
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.Tonescales.ctl : 271</b><pre>float segmented_spline_c9_fwd\n  ( \n    varying float x,\n    varying SegmentedSplineParams_c9 C = ODT_48nits\n  )\n\{    \n  const int N_KNOTS_LOW = 8;\n  const int N_KNOTS_HIGH = 8;\n\n  // Check for negatives or zero before taking the log. If negative or zero,\n  // set to HALF_MIN.\n  float logx = log10( max(x, HALF_MIN )); \n\n  float logy;\n\n  if ( logx <= log10(C.minPoint.x) ) \{ \n\n    logy = logx * C.slopeLow + ( log10(C.minPoint.y) - C.slopeLow * log10(C.minPoint.x) );\n\n  \} else if (( logx > log10(C.minPoint.x) ) && ( logx < log10(C.midPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.minPoint.x))/(log10(C.midPoint.x)-log10(C.minPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n    \n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else if (( logx >= log10(C.midPoint.x) ) && ( logx < log10(C.maxPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.midPoint.x))/(log10(C.maxPoint.x)-log10(C.midPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else \{ //if ( logIn >= log10(C.maxPoint.x) ) \{ \n\n    logy = logx * C.slopeHigh + ( log10(C.maxPoint.y) - C.slopeHigh * log10(C.maxPoint.x) );\n\n  \}\n\n  return pow10(logy);\n  \n\}"
  note_font_size 10
  xpos -200
  ypos -660
 }
push $N5f10f800
 Reformat {
  type "to box"
  box_width 4
  box_height 4
  box_fixed true
  name Reformat1
  note_font Helvetica
  xpos -1140
  ypos -561
 }
 Fill {
  output rgb
  color {{parent.ssts.mid_lum}}
  name Fill1
  note_font Helvetica
  xpos -1140
  ypos -537
 }
 Group {
  name inv_ssts
  xpos -1140
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} 4.8 {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.ACES_SSTS.AcesSSTSKernel_override_curve_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 expShift R -4 4}
  expShift {{"override_ssts_params ? exposure : 0"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} {lum.1} {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR+(MAX_STOP_RRT-MAX_STOP_SDR)/(log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR))*(log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 4}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2) / 2"} {"(coefsLow.2 + coefsLow.3) / 2"} {"(coefsLow.3 + coefsLow.4) / 2"}}
  addUserKnob {78 KNOT_Y_HIGH n 4}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1) / 2"} {"(coefsHigh.1 + coefsHigh.2) / 2"} {"(coefsHigh.2 + coefsHigh.3) / 2"} {"(coefsHigh.3 + coefsHigh.4) / 2"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N5f331800 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N5f331800
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N5f331000 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N5f330c00 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N5f330800 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N5f330400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -202
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N5f330400
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N5f2ef400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N5f330800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr <= log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg <= log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb <= log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -202
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N5f2ef400
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N5f2edc00 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -174
  }
set N5f2ed800 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -174
  }
set N5f2ed400 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -174
  }
  Dot {
   name Dot19
   xpos 434
   ypos -78
  }
set N5f2ecc00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow5
   xpos 290
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low5
   xpos 290
   ypos -34
  }
push $N5f2ecc00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy5
   xpos 400
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals4
   xpos 400
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push 0
push $N5f2ed800
  Dot {
   name Dot10
   xpos -6
   ypos -78
  }
set N5f2a7400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow
   xpos -150
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low
   xpos -150
   ypos -34
  }
push $N5f2a7400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy
   xpos -40
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals
   xpos -40
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push $N5f2ed400
  Dot {
   name Dot18
   xpos 214
   ypos -78
  }
set N5f2a6000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow4
   xpos 70
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low4
   xpos 70
   ypos -34
  }
push $N5f2a6000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy4
   xpos 180
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals5
   xpos 180
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   name Merge2
   xpos 180
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N5f330c00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -202
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N5f2edc00
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N5f237400 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -174
  }
set N5f237000 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -174
  }
set N5f236c00 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -174
  }
  Dot {
   name Dot16
   xpos 1204
   ypos -78
  }
set N5f236400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow3
   xpos 1060
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low3
   xpos 1060
   ypos -34
  }
push $N5f236400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy3
   xpos 1170
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals3
   xpos 1170
   ypos 14
  }
push 0
push $N5f237000
  Dot {
   name Dot11
   xpos 764
   ypos -78
  }
set N5f235000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow1
   xpos 620
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low1
   xpos 620
   ypos -34
  }
push $N5f235000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy1
   xpos 730
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals1
   xpos 730
   ypos 14
  }
push $N5f236c00
  Dot {
   name Dot12
   xpos 984
   ypos -78
  }
set N5f5d7800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow2
   xpos 840
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low2
   xpos 840
   ypos -34
  }
push $N5f5d7800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy2
   xpos 950
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals2
   xpos 950
   ypos 14
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 950
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N5f331000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -202
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N5f237400
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -208
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Expression {
  channel0 rgb
  expr0 log(r)/log(2)-log(0.18)/log(2)
  name expShift
  note_font Helvetica
  xpos -1140
  ypos -489
 }
end_group
set N5eb08f00 [stack 0]
Dot {
 name Dot8
 xpos 1719
 ypos 51
}
set N5f56ec00 [stack 0]
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace16
 label "sRGb Lin to XYZ"
 xpos 1791
 ypos 57
}
Multiply {
 value 100
 name Multiply10
 label "Mult by 100 to put in absolute nits"
 xpos 1791
 ypos 89
}
Group {
 name ZCAM8
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 1791
 ypos 146
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5f56d800 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5f56c400 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5f56c400
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5f8df900 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5f8df900
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5f8f6400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5f8f6000 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5f8f6400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5f8f5400 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5f8f5000 [stack 0]
push $N5f8f6400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5f8f4c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5f8f4800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5f8f4400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5f87fc00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5f8f6000
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5f8f6400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5f8f6400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5f8f6400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  surrounds dark
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5f56d800
push $N5f8f6000
push $N5f8f5400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5f87e000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5f87e000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5f8f6000
push $N5f8f5000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5f87cc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5f87cc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5f8f6000
push $N5f8f4c00
push $N5f8f5400
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5f80b000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5f80ac00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5f80ac00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5f8f4400
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5f80b000
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5f8f4400
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5f87fc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5f80b000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5f8f5000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5f8f4800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5f8f5400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5f8f4c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5f8f6000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5f56d800
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5f745800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5f744c00 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5f744c00
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5f6d7000 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5f6d6400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5f6d6400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5f6d6400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5f6d5400 [stack 0]
push $N5f6d5400
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5f6d7000
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5f67a400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5f67a400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5f67a400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5f657900 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5f679400 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N5f657900
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5f678c00 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N5f657900
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5f62fc00 [stack 0]
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5f62f000 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5f657200 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5f679400
push $N5f678c00
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5f62d400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5f62d400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5f657200
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5f9b7000 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5f9b7000
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5f656400 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5f656400
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5f745800
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5f745800
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5f745800
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5f657200
push $N5f745800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5f6d7000
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5f62fc00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5f62f000
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5f657900
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Group {
 name ZCAM9
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 1791
 ypos 198
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N5f954800 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N5fcd3000 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N5fcd3000
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N5fd00800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N5fd00800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5fcd1400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5fcd1000 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5fcd1400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5fcd0400 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5fc63c00 [stack 0]
push $N5fcd1400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5fc63800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5fc63400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5fc63000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5fc62c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5fcd1000
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5fcd1400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5fcd1400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5fcd1400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  surrounds dim
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N5f954800
push $N5fcd1000
push $N5fcd0400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5fc61000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5fc61000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5fcd1000
push $N5fc63c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5fbf3800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5fbf3800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5fcd1000
push $N5fc63800
push $N5fcd0400
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5fbf2000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5fbf1c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5fbf1c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5fc63000
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5fbf2000
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5fc63000
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5fc62c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5fbf2000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5fc63c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5fc63400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5fcd0400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5fc63800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5fcd1000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N5f954800
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5fb20800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5faa3800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5faa3800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N5faa2000 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N5faa1400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N5faa1400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N5faa1400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N5faa0400 [stack 0]
push $N5faa0400
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N5faa2000
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N5fa65400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N5fa65400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N5fa65400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5fc1c800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N5fa64400 [stack 0]
 Dot {
  name Dot44
  label C,h
  selected true
  xpos -1673
  ypos 2768
 }
push $N5fc1c800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N5fe03800 [stack 0]
 Dot {
  name Dot20
  label M,h
  selected true
  xpos -1737
  ypos 2767
 }
push $N5fc1c800
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N5fe02c00 [stack 0]
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N5fe02000 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5fc1c100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N5fa64400
push $N5fe03800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N5fe00400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N5fe00400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5fc1c100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N5fd9a000 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N5fd9a000
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N5fdcf200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N5fdcf200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5fb20800
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5fb20800
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5fb20800
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5fc1c100
push $N5fb20800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N5faa2000
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N5fe02c00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N5fe02000
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5fc1c800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Multiply {
 value 0.01
 name Multiply11
 label "Mult by 100 to put in absolute nits"
 xpos 1791
 ypos 250
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace17
 label "XYZ to sRGB lin"
 xpos 1791
 ypos 301
}
Colorspace {
 colorspace_out sRGB
 name Colorspace15
 xpos 1791
 ypos 375
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle30
 xpos 1791
 ypos 399
}
Reformat {
 type scale
 scale 1.5
 resize none
 black_outside true
 name Reformat8
 xpos 1791
 ypos 420
}
set N600c6c00 [stack 0]
push $N600c6c00
Expression {
 channel0 rgba
 expr0 .1
 name Expression9
 xpos 1928
 ypos 420
}
Colorspace {
 colorspace_out sRGB
 name Colorspace19
 xpos 1928
 ypos 444
}
Merge2 {
 inputs 2
 name Merge1
 xpos 1825
 ypos 503
}
Crop {
 box {0 0 {width} {height}}
 name Crop2
 xpos 1825
 ypos 527
}
push $N5f56ec00
Colorspace {
 colorspace_out sRGB
 name Colorspace18
 xpos 1692
 ypos 380
}
Reformat {
 type scale
 scale 1.5
 resize none
 black_outside true
 name Reformat9
 xpos 1692
 ypos 506
}
ContactSheet {
 inputs 2
 width {{input.width*columns}}
 height {{input.height*rows}}
 rows 2
 columns 1
 name ContactSheet4
 xpos 1819
 ypos 586
}
Constant {
 inputs 0
 channels rgb
 color {100 33 0 0}
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Constant3
 xpos 1252
 ypos 920
}
Expression {
 expr0 (y/(height-1))*r
 expr2 cx*180
 name Expression8
 xpos 1252
 ypos 1031
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.red 0 0 zcam_J.blue 0 2 rgba.red 0 0 zcam_J.alpha 0 3"
 name Shuffle17
 xpos 1252
 ypos 1055
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_Q
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.red 0 0 zcam_Q.blue 0 2 rgba.red 0 0 zcam_Q.alpha 0 3"
 name Shuffle29
 xpos 1252
 ypos 1079
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_M
 fromInput2 {{0} B}
 mappings "4 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
 name Shuffle25
 xpos 1252
 ypos 1101
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_h
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.red 0 0 rgba.blue 0 2 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.alpha 0 3"
 name Shuffle26
 xpos 1252
 ypos 1125
}
Group {
 name ZCAM6
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 1252
 ypos 1154
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N6005a000 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N60058c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N60058c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N60044800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N60044800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N5ffeac00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N5ffea800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N5ffeac00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N5ffe9c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N5ffe9800 [stack 0]
push $N5ffeac00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N5ffe9400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N5ffe9000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N5ffe8c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N5ffe8800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N5ffea800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N5ffeac00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N5ffeac00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N5ffeac00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N6005a000
push $N5ffea800
push $N5ffe9c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N5ff76800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N5ff76800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N5ffea800
push $N5ffe9800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N5ff75400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N5ff75400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N5ffea800
push $N5ffe9400
push $N5ffe9c00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N5ff03800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N5ff03400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N5ff03400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N5ffe8c00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N5ff03800
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N5ffe8c00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N5ffe8800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N5ff03800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N5ffe9800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N5ffe9000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N5ffe9c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N5ffe9400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N5ffea800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N6005a000
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N5fe3e000 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N5fe3d400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N5fe3d400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N601d7800 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N601d6c00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N601d6c00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N601d6c00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N601d5c00 [stack 0]
push $N601d5c00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N601d7800
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N6017ac00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N6017ac00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N6017ac00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N5ff50800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N60179c00 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N5ff50800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N60179400 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N5ff50800
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N60178800 [stack 0]
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N60133800 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N5ff50100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N60179c00
push $N60179400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N60131c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N60131c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N5ff50100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N604b7800 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N604b7800
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N60503200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N60503200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N5fe3e000
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N5fe3e000
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N5fe3e000
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N5ff50100
push $N5fe3e000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N601d7800
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N60178800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N60133800
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N5ff50800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Multiply {
 value 0.01
 name Multiply9
 label "Div by 100 to go from nits"
 xpos 1252
 ypos 1213
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle28
 xpos 1252
 ypos 1255
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace13
 label "XYZ to sRGB Prims"
 xpos 1252
 ypos 1279
}
set N60455000 [stack 0]
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_M
 fromInput2 {{0} B}
 mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
 name Shuffle33
 xpos 1449
 ypos 1480
}
push $N5ea83000
PositionToPoints2 {
 display textured
 render_mode textured
 P_channel rgb
 detail 1
 name PositionToPoints5
 xpos 1789
 ypos 1570
}
Constant {
 inputs 0
 channels rgb
 color {100 {frame/1023*100} 0 0}
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Constant6
 xpos 344
 ypos 974
}
Expression {
 expr0 (y/(height-1))*r
 expr2 cx*180
 name Expression13
 xpos 344
 ypos 1096
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.red 0 0 zcam_J.blue 0 2 rgba.red 0 0 zcam_J.alpha 0 3"
 name Shuffle42
 xpos 344
 ypos 1120
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_Q
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.red 0 0 zcam_Q.blue 0 2 rgba.red 0 0 zcam_Q.alpha 0 3"
 name Shuffle43
 xpos 344
 ypos 1144
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_M
 fromInput2 {{0} B}
 mappings "4 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
 name Shuffle44
 xpos 344
 ypos 1166
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_h
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.red 0 0 rgba.blue 0 2 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.alpha 0 3"
 name Shuffle45
 xpos 344
 ypos 1190
}
Group {
 name ZCAM14
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 344
 ypos 1245
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N603da000 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N603d8c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N603d8c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N603b8800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N603b8800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N6036ac00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N6036a800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N6036ac00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N60369c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N60369800 [stack 0]
push $N6036ac00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N60369400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N60369000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N60368c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N60368800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N6036a800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N6036ac00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N6036ac00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N6036ac00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N603da000
push $N6036a800
push $N60369c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N602f6800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N602f6800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N6036a800
push $N60369800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N602f5400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N602f5400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N6036a800
push $N60369400
push $N60369c00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N6028f800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N6028f400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N6028f400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N60368c00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N6028f800
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N60368c00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N60368800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N6028f800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N60369800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N60369000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N60369c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N60369400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N6036a800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N603da000
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N605b6000 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N605b5400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N605b5400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N60553800 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N60552c00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N60552c00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N60552c00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N60551c00 [stack 0]
push $N60551c00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N60553800
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N608fac00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N608fac00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N608fac00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N602dc800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N608f9c00 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N602dc800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N608f9400 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N602dc800
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N608f8800 [stack 0]
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N608b7800 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N602dc100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N608f9c00
push $N608f9400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N608b5c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N608b5c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N602dc100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N6082f800 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N6082f800
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N60887200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N60887200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N605b6000
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N605b6000
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N605b6000
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N602dc100
push $N605b6000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N60553800
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N608f8800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N608b7800
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N602dc800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Multiply {
 value 0.01
 name Multiply17
 label "Div by 100 to go from nits"
 xpos 344
 ypos 1324
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle46
 xpos 344
 ypos 1366
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace28
 label "XYZ to sRGB Prims"
 xpos 344
 ypos 1390
}
Dot {
 name Dot9
 xpos 378
 ypos 1439
}
set N607ccc00 [stack 0]
Dot {
 name Dot11
 xpos 505
 ypos 1465
}
set N607cc800 [stack 0]
Expression {
 channel0 rgba
 expr0 min((r<0?0:1),(g<0?0:1),(b<0?0:1))
 name Expression10
 xpos 428
 ypos 1490
}
push $N607cc800
Expression {
 channel0 rgba
 expr0 min((r>1?0:1),(g>1?0:1),(b>1?0:1))
 name Expression12
 xpos 533
 ypos 1488
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply16
 xpos 471
 ypos 1521
}
push $N607ccc00
Copy {
 inputs 2
 from0 rgba.alpha
 to0 rgba.alpha
 name Copy8
 xpos 344
 ypos 1576
}
Premult {
 name Premult1
 xpos 344
 ypos 1608
}
Dot {
 name Dot10
 xpos 378
 ypos 1715
}
set N6076ec00 [stack 0]
Group {
 name FrameBlendMerge
 help http://richardfrazer.com/tools-tutorials/frameblendmerge/
 knobChanged "\nn = nuke.thisNode()\nk = nuke.thisKnob()\n#print n\['customframerange'].getValue()\nif k.name()==\"customframerange\":\n    n\['framerangestart'].setEnabled((n\['customframerange'].getValue())!=0)\n    n\['framerangeend'].setEnabled(n\['customframerange'].getValue()!=0)\n    n\['numberframes'].setEnabled((1-n\['customframerange'].getValue())!=0)\nif k.name()==\"invertalpha\":\n    n\['defaultinvert'].setValue((n\['invertalpha'].getValue())!=0)\nif k.name()==\"method\":\n    n\['vectordetail'].setVisible((n\['method'].getValue())!=0)\n    n\['smooth'].setVisible(n\['method'].getValue()!=0)\n    if n\['method'].getValue()==0:\n        n\['invertalpha'].setValue(n\['defaultinvert'].getValue())\n    if n\['method'].getValue()==1:\n        n\['invertalpha'].setValue(0)\n"
 xpos 344
 ypos 2007
 disable true
 addUserKnob {20 User}
 addUserKnob {4 operation M {atop average color-burn color-dodge conjoint-over copy difference disjoint-over divide exclusion from geometric hard-light hypot in mask matte max min minus multiply out over overlay plus screen soft-light stencil under xor}}
 operation over
 addUserKnob {26 ""}
 addUserKnob {26 text2 l "" +STARTLINE T "Frame blend\n"}
 addUserKnob {3 framerangestart l "Frame Range"}
 addUserKnob {3 framerangeend l "" -STARTLINE}
 framerangeend 750
 addUserKnob {22 InputRange l "Input Range" -STARTLINE T "n = nuke.thisNode()\nf = n.firstFrame()\nl = n.lastFrame() \n\nn\['framerangestart'].setValue(f)\nn\['framerangeend'].setValue(l)"}
 addUserKnob {26 ""}
 addUserKnob {22 update l Update T "t = nuke.thisNode()\n\n\ntname = t.name()\n\n\n#print ('tname: ' + tname)\n\n\n\nnuke.thisNode().begin()\n\n\nframestart = int(t\['framerangestart'].value())\nframeend = int(t\['framerangeend'].value())\n\n\np = -1000\n\n\nfor d in nuke.allNodes():\n    if (d.Class() == 'FrameHold') or (d.Class() == 'Merge2'):\n         nuke.delete(d) \n    #else:\n    #     print (\"Ignore this\" + d.Class() )\n\n\n\nfor x in range(framestart, frameend):\n    nname = 'FrameHoldMerge' +str(x)\n    if(nuke.exists( nname )):\n        #print (nname + \" exists\")\n        k = nuke.toNode ( nname ) \n        nuke.delete ( k )\n    n = nuke.createNode( 'FrameHold' )              \n    n\['name'].setValue( nname )\n    n\['first_frame'].setValue( x )\n    n.setXYpos( p, 600 )\n    n.setInput(0, nuke.toNode( 'inputDot' ))\n    p = p + 100\n\n\nnewMerge = nuke.createNode('Merge2')\nnewMerge\['name'].setValue( 'MergeFrames' )\nnewMerge.setXYpos( -900, 700 )  \n\n\ni = 0\n\n\nfor x in range(framestart, frameend):\n    nname = 'FrameHoldMerge' +str(x)\n    n = nuke.toNode( nname )\n    if(i==2):\n        i=i+1\n    #print(\"connecting input \" + str(i))\n    newMerge.setInput(i, nuke.toNode( nname ))\n    i=i+1\n\n\nnewMerge.setInput(2, nuke.toNode( \"mask_dot\" ))\n\n\ntoperation = t\['operation'].value()\nnewMerge\['operation'].setValue( toperation )\n\n\no = nuke.toNode( 'OutputBlend' )\no.setInput(0, newMerge)\n\n\nnewMerge.hideControlPanel()\n\n\nnuke.thisNode().end()\n\n\nt = nuke.toNode( tname )\n\n\n#print ('t: ' +  t.name() )\n\n\nnuke.show(t)\n\n" +STARTLINE}
 addUserKnob {20 About}
 addUserKnob {26 textabout l "" +STARTLINE T "FrameBlendMerge v1.4 by Richard Frazer\nwww.richardfrazer.com/tools-tutorials/frameblendmerge/\n"}
}
 Input {
  inputs 0
  name Input
  xpos -905
  ypos 395
 }
 Dot {
  name inputDot
  xpos -871
  ypos 495
 }
set N6076e400 [stack 0]
 FrameHold {
  firstFrame 99
  name FrameHoldMerge99
  xpos 8800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 98
  name FrameHoldMerge98
  xpos 8700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 97
  name FrameHoldMerge97
  xpos 8600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 96
  name FrameHoldMerge96
  xpos 8500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 95
  name FrameHoldMerge95
  xpos 8400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 94
  name FrameHoldMerge94
  xpos 8300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 93
  name FrameHoldMerge93
  xpos 8200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 92
  name FrameHoldMerge92
  xpos 8100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 91
  name FrameHoldMerge91
  xpos 8000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 90
  name FrameHoldMerge90
  xpos 7900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 89
  name FrameHoldMerge89
  xpos 7800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 88
  name FrameHoldMerge88
  xpos 7700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 87
  name FrameHoldMerge87
  xpos 7600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 86
  name FrameHoldMerge86
  xpos 7500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 85
  name FrameHoldMerge85
  xpos 7400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 84
  name FrameHoldMerge84
  xpos 7300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 83
  name FrameHoldMerge83
  xpos 7200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 82
  name FrameHoldMerge82
  xpos 7100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 81
  name FrameHoldMerge81
  xpos 7000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 80
  name FrameHoldMerge80
  xpos 6900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 79
  name FrameHoldMerge79
  xpos 6800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 78
  name FrameHoldMerge78
  xpos 6700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 77
  name FrameHoldMerge77
  xpos 6600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 76
  name FrameHoldMerge76
  xpos 6500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 75
  name FrameHoldMerge75
  xpos 6400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 74
  name FrameHoldMerge74
  xpos 6300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 73
  name FrameHoldMerge73
  xpos 6200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 72
  name FrameHoldMerge72
  xpos 6100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 71
  name FrameHoldMerge71
  xpos 6000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 70
  name FrameHoldMerge70
  xpos 5900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 69
  name FrameHoldMerge69
  xpos 5800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 68
  name FrameHoldMerge68
  xpos 5700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 67
  name FrameHoldMerge67
  xpos 5600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 66
  name FrameHoldMerge66
  xpos 5500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 65
  name FrameHoldMerge65
  xpos 5400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 64
  name FrameHoldMerge64
  xpos 5300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 63
  name FrameHoldMerge63
  xpos 5200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 62
  name FrameHoldMerge62
  xpos 5100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 61
  name FrameHoldMerge61
  xpos 5000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 60
  name FrameHoldMerge60
  xpos 4900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 59
  name FrameHoldMerge59
  xpos 4800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 58
  name FrameHoldMerge58
  xpos 4700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 57
  name FrameHoldMerge57
  xpos 4600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 56
  name FrameHoldMerge56
  xpos 4500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 55
  name FrameHoldMerge55
  xpos 4400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 54
  name FrameHoldMerge54
  xpos 4300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 53
  name FrameHoldMerge53
  xpos 4200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 52
  name FrameHoldMerge52
  xpos 4100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 51
  name FrameHoldMerge51
  xpos 4000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 50
  name FrameHoldMerge50
  xpos 3900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 49
  name FrameHoldMerge49
  xpos 3800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 48
  name FrameHoldMerge48
  xpos 3700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 47
  name FrameHoldMerge47
  xpos 3600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 46
  name FrameHoldMerge46
  xpos 3500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 45
  name FrameHoldMerge45
  xpos 3400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 44
  name FrameHoldMerge44
  xpos 3300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 43
  name FrameHoldMerge43
  xpos 3200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 42
  name FrameHoldMerge42
  xpos 3100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 41
  name FrameHoldMerge41
  xpos 3000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 40
  name FrameHoldMerge40
  xpos 2900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 39
  name FrameHoldMerge39
  xpos 2800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 38
  name FrameHoldMerge38
  xpos 2700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 37
  name FrameHoldMerge37
  xpos 2600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 36
  name FrameHoldMerge36
  xpos 2500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 35
  name FrameHoldMerge35
  xpos 2400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 34
  name FrameHoldMerge34
  xpos 2300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 33
  name FrameHoldMerge33
  xpos 2200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 32
  name FrameHoldMerge32
  xpos 2100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 31
  name FrameHoldMerge31
  xpos 2000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 30
  name FrameHoldMerge30
  xpos 1900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 29
  name FrameHoldMerge29
  xpos 1800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 28
  name FrameHoldMerge28
  xpos 1700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 27
  name FrameHoldMerge27
  xpos 1600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 26
  name FrameHoldMerge26
  xpos 1500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 25
  name FrameHoldMerge25
  xpos 1400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 24
  name FrameHoldMerge24
  xpos 1300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 23
  name FrameHoldMerge23
  xpos 1200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 22
  name FrameHoldMerge22
  xpos 1100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 21
  name FrameHoldMerge21
  xpos 1000
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 20
  name FrameHoldMerge20
  xpos 900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 19
  name FrameHoldMerge19
  xpos 800
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 18
  name FrameHoldMerge18
  xpos 700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 17
  name FrameHoldMerge17
  xpos 600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 16
  name FrameHoldMerge16
  xpos 500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 15
  name FrameHoldMerge15
  xpos 400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 14
  name FrameHoldMerge14
  xpos 300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 13
  name FrameHoldMerge13
  xpos 200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 12
  name FrameHoldMerge12
  xpos 100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 11
  name FrameHoldMerge11
  xpos 0
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 10
  name FrameHoldMerge10
  xpos -100
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 9
  name FrameHoldMerge9
  xpos -200
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 8
  name FrameHoldMerge8
  xpos -300
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 7
  name FrameHoldMerge7
  xpos -400
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 6
  name FrameHoldMerge6
  xpos -500
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 5
  name FrameHoldMerge5
  xpos -600
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 4
  name FrameHoldMerge4
  xpos -700
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 3
  name FrameHoldMerge3
  xpos -800
  ypos 600
 }
 Input {
  inputs 0
  name Mask
  xpos -1349
  ypos 579
  number 1
 }
push $N6076e400
 Dot {
  name Dot2
  xpos -1202
  ypos 572
 }
 Remove {
  name Remove1
  xpos -1236
  ypos 604
 }
 Shuffle {
  red black
  green black
  blue black
  alpha white
  name Shuffle1
  xpos -1236
  ypos 638
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input1]" i}}
  name Switch3
  xpos -1349
  ypos 647
 }
 Dot {
  name mask_dot
  xpos -1315
  ypos 703
 }
set N6076d000 [stack 0]
push $N6076e400
 FrameHold {
  firstFrame 2
  name FrameHoldMerge2
  xpos -900
  ypos 600
 }
push $N6076e400
 FrameHold {
  firstFrame 1
  name FrameHoldMerge1
  xpos -1000
  ypos 600
 }
 Merge2 {
  inputs 99+1
  name MergeFrames
  selected true
  xpos -900
  ypos 700
 }
 Output {
  name OutputBlend
  xpos -900
  ypos 817
 }
push $N6076d000
 Viewer {
  input_process false
  name Viewer1
  xpos -1341
  ypos 942
 }
end_group
push $N5eb08f00
Expression {
 expr0 "y==floor(r(x, pos.y)*height*mult)?1:0"
 expr1 "y==floor(g(x, pos.y)*height*mult)?1:0"
 expr2 "y==floor(b(x, pos.y)*height*mult)?1:0"
 channel3 alpha
 name PlotScanline2
 xpos 1274
 ypos 668
 addUserKnob {20 User}
 addUserKnob {12 pos}
 addUserKnob {7 mult R 0 5}
 mult 1
}
push $N5d257400
Expression {
 expr0 "y==floor(r(x, pos.y)*height*mult)?1:0"
 expr1 "y==floor(g(x, pos.y)*height*mult)?1:0"
 expr2 "y==floor(b(x, pos.y)*height*mult)?1:0"
 channel3 alpha
 name PlotScanline3
 xpos 1134
 ypos 671
 addUserKnob {20 User}
 addUserKnob {12 pos}
 addUserKnob {7 mult R 0 5}
 mult 1
}
Copy {
 inputs 2
 from0 rgba.red
 to0 rgba.red
 name Copy2
 xpos 1206
 ypos 710
}
Rectangle {
 area {{width/2-1} 0 {width/2+1} {height}}
 color 0.05
 name Rectangle1
 xpos 1206
 ypos 742
}
TimeOffset {
 inputs 0
 time ""
 name TimeOffset1
 xpos -1560
 ypos 1572
}
push $N60455000
Colorspace {
 colorspace_out sRGB
 name Colorspace14
 xpos 998
 ypos 1393
 disable true
}
Clamp {
 name Clamp2
 xpos 998
 ypos 1434
 disable true
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/examples/ramp_J100_M25_v001.png
 colorspace texture_paint
 raw true
 file_type png
 checkHashOnRead false
 version 2
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write2
 xpos 998
 ypos 1503
}
push $N60455000
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle35
 xpos 1525
 ypos 2004
}
Cube {
 inputs 0
 display wireframe
 rows 1
 columns 1
 cube {0 0 0 1 1 1}
 name Cube1
 xpos 1652
 ypos 1966
}
push $N4e3d3000
EXPTool {
 mode Stops
 name Exposure2
 xpos 1061
 ypos 942
 disable true
}
Reformat {
 format "1024 1024 0 0 1024 1024 1 square_1K"
 black_outside true
 name Reformat11
 xpos 1061
 ypos 981
 disable true
}
Dot {
 name Dot20
 xpos 1088
 ypos 1639
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle41
 xpos 1060
 ypos 1839
}
Group {
 name ZCAMishDRT
 tile_color 0x770567ff
 gl_color 0x6d055eff
 label "v0.4\nBounds: \[value gamutBounds]"
 note_font "Verdana Italic"
 xpos 1060
 ypos 2017
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 gamut l "in gamut" T InGamut_to_XYZ.gamut}
 addUserKnob {26 ""}
 addUserKnob {41 inverseData1 l "Inverse Data 1" +INVISIBLE T ZCAM11.inverseData1}
 addUserKnob {4 gamutBounds l "Gamut Bounds" M {"Rec709/sRGB - 100nits" "P3 D65 - 100nits" "P3 D65 - 1000nits"}}
 addUserKnob {41 thr l threshold T clipToLimit1.thr}
 addUserKnob {26 ""}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
 addUserKnob {26 ""}
 addUserKnob {26 version l "" +STARTLINE T "Alpha v0.4"}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label "HDR curve"
  note_font_size 20
  xpos 1677
  ypos -224
  bdheight 132
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x71c67100
  label "SDR curve"
  note_font_size 20
  xpos 1492
  ypos -225
  bdheight 132
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JCh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2070
  name Read64
  xpos 449
  ypos 135
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace1
  xpos 449
  ypos 314
 }
 Multiply {
  value 100
  name Multiply3
  label "Mult by 100 to put in absolute nits"
  xpos 449
  ypos 338
 }
 Group {
  name ZCAM1
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 449
  ypos 380
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N60c53000 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N60c51c00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N60c51c00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N60c35d00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N60c35d00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N60bd3c00 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N60bd3800 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N60bd3c00
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N60bd2c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N60bd2800 [stack 0]
push $N60bd3c00
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N60bd2400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N60bd2000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N60bd1c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N60bd1800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N60bd3800
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N60bd3c00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N60bd3c00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N60bd3c00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N60c53000
push $N60bd3800
push $N60bd2c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N60b5f800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N60b5f800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N60bd3800
push $N60bd2800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N60b5e400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N60b5e400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N60bd3800
push $N60bd2400
push $N60bd2c00
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N60b5cc00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N60b5c800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N60b5c800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N60bd1c00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N60b5cc00
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N60bd1c00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N60bd1800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N60b5cc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N60bd2800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N60bd2000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N60bd2c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N60bd2400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N60bd3800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N60c53000
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N60e33000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N60e32400 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N60e32400
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N60e30c00 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N60ddfc00 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N60ddfc00
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N60ddfc00
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N60ddec00 [stack 0]
push $N60ddec00
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N60e30c00
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N60d8bc00 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N60d8bc00
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N60d8bc00
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N60b55d00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N60d8ac00 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N60b55d00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N60d8a400 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N60b55d00
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N60d89800 [stack 0]
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N60d88c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N60b55600 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N60d8ac00
push $N60d8a400
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N61132c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N61132c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N60b55600
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N61130c00 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N61130c00
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N60b54800 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N60b54800
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N60e33000
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N60e33000
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N60e33000
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N60b55600
push $N60e33000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N60e30c00
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N60d89800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N60d88c00
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N60b55d00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode1
  xpos 449
  ypos 433
 }
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -535
 }
 Group {
  name InGamut_to_XYZ
  tile_color 0x429940ff
  xpos 1344
  ypos -481
  addUserKnob {20 InputGamut_to_XYZ_tab l InputGamut_to_XYZ}
  addUserKnob {4 gamut l "in gamut" M {ACES ACEScg P3D65 Rec.2020 Rec.709 "Alexa WideGamut" "Red WideGamutRGB" "Sony SGamut3" "Filmlight E-Gamut" "DaVinci Wide Gamut" "" "" ""}}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {41 invert -STARTLINE T ColorMatrix.invert}
 }
  Input {
   inputs 0
   name Input
   xpos 290
   ypos -610
  }
  Dot {
   name Dot1
   xpos 324
   ypos -546
  }
set N61059c00 [stack 0]
  ColorMatrix {
   matrix {
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
     }
   name ColorMatrix
   xpos 290
   ypos -370
  }
  Output {
   name Output
   xpos 290
   ypos -250
  }
push $N61059c00
  Dot {
   name Dot391
   label " *RGB to XYZ D65 CAT: XYZ Scaling"
   xpos 434
   ypos -546
  }
set N61059000 [stack 0]
  ColorMatrix {
   matrix {
       {0.7006223202 0.1487748027 0.101058729}
       {0.2741184831 0.8736317754 -0.1477504224}
       {-0.09896290302 -0.1378953159 1.325916052}
     }
   name ColorMatrix30
   label "DaVinci WG to XYZ D65"
   xpos 1390
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.705396831 0.1640413404 0.08101775497}
       {0.2801307142 0.8202067018 -0.1003373787}
       {-0.1037815139 -0.07290726155 1.265746593}
     }
   name ColorMatrix29
   label "Filmlight E-Gamut to XYZ D65"
   xpos 1280
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.5990839005 0.2489254922 0.1024464965}
       {0.2150758207 0.8850684166 -0.1001443192}
       {-0.03206584975 -0.02765838802 1.148782015}
     }
   name ColorMatrix31
   label "SonySGamut3 to XYZ D65"
   xpos 1170
   ypos -465
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.735275209 0.06860940903 0.1465712786}
       {0.2866940796 0.8429790735 -0.1296732426}
       {-0.07968084514 -0.3473432064 1.516081929}
     }
   name ColorMatrix22
   label "REDWideGamutRGB to XYZ D65"
   xpos 1060
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.6380076408 0.2147038132 0.09774445742}
       {0.2919537723 0.8238408566 -0.1157948226}
       {0.002798279049 -0.06703422219 1.153293848}
     }
   name ColorMatrix21
   label "Arri AlexaWideGamut to XYZ D65"
   xpos 950
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.4123909175 0.3575843573 0.1804807931}
       {0.2126390785 0.7151687145 0.07219231129}
       {0.01933082566 0.1191947833 0.9505321383}
     }
   name ColorMatrix18
   label "Rec709 to XYZ D65"
   xpos 840
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.6369581223 0.1446169168 0.1688809693}
       {0.2627002299 0.6779981256 0.05930171534}
       {4.99410725e-17 0.02807269618 1.060985088}
     }
   name ColorMatrix17
   label "Rec2020 to XYZ D65"
   xpos 730
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.4865711331 0.2656677067 0.1982173175}
       {0.2289746404 0.6917386055 0.07928691804}
       {-3.972076965e-17 0.04511338845 1.043944478}
     }
   name ColorMatrix16
   label "P3D65 to XYZ D65"
   xpos 620
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.6609312296 0.1336961389 0.1558285803}
       {0.2722287476 0.6740817428 0.05368950963}
       {-0.006018006243 0.004383686464 1.090692043}
     }
   name ColorMatrix1
   label "ACEScg to XYZ D65"
   xpos 510
   ypos -466
  }
push $N61059000
  ColorMatrix {
   matrix {
       {0.9503623843 0 9.346324805e-05}
       {0.3439664543 0.728166163 -0.07213254273}
       {0 0 1.089057803}
     }
   name ColorMatrix2
   label "ACES to XYZ D65"
   xpos 400
   ypos -466
  }
  Switch {
   inputs 10
   which {{gamut}}
   name SwitchGamut
   xpos 400
   ypos -370
  }
 end_group
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos -450
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos -386
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N60ff9400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N60f7fc00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N60f7fc00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N60fbd600 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N60fbd600
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N60f7e000 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N60f7dc00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N60f7e000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N60f7d000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N60f7cc00 [stack 0]
push $N60f7e000
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N60f7c800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N60f7c400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N60effc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N60eff800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N60f7dc00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N60f7e000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N60f7e000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N60f7e000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N60ff9400
push $N60f7dc00
push $N60f7d000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N60efdc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N60efdc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N60f7dc00
push $N60f7cc00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N60efc800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N60efc800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N60f7dc00
push $N60f7c800
push $N60f7d000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N60e9ec00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N60e9e800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N60e9e800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N60effc00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N60e9ec00
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N60effc00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N60eff800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N60e9ec00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N60f7cc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N60f7c400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N60f7d000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N60f7c800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N60f7dc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N60ff9400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N611cd400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N611cc800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N611cc800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6115ac00 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6115a000 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6115a000
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6115a000
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N61159000 [stack 0]
push $N61159000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6115ac00
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N61506000 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N61506000
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N61506000
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N60ec9600 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N61505000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N60ec9600
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N61504800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N60ec9600
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N614bf800 [stack 0]
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N614bec00 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N60ec8f00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N61505000
push $N61504800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N614bd000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N614bd000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N60ec8f00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6143ac00 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6143ac00
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N60ec8100 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N60ec8100
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N611cd400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N611cd400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N611cd400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N60ec8f00
push $N611cd400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6115ac00
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N614bf800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N614bec00
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N60ec9600
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N610a0800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle1
  xpos 1501
  ypos -347
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply1
  label "Div by 100 to go from nits"
  xpos 1501
  ypos -294
 }
set N613d4800 [stack 0]
 ColorLookup {
  lut {master {curve 0 x0.3155371845 0.0004885200178 x0.4557278752 0.0009770400357 x0.5572770834 0.001465560053 x0.6389417648 0.001954080071 x0.7080863714 0.002442600206 x0.7684537172 0.002931120107 x0.8222920299 0.003419640008 x0.8710434437 0.003908160143 x0.9156916738 0.004396679811 x0.9569416642 0.00488519948 x0.9953647256 0.00537372008 x1.031342387 0.005862240214 x1.065215945 0.006350760348 x1.097246885 0.006839280017 x1.127625942 0.007327800151 x1.1565516 0.007816320285 x1.18417263 0.008304839954 x1.210611701 0.008793359622 x1.235978842 0.009281879291 x1.260344386 0.00977039896 x1.283829927 0.0102589 x1.306484222 0.01074740011 x1.328353047 0.01123590022 x1.349516273 0.01172440033 x1.370035648 0.01221290044 x1.389927149 0.01270140056 x1.409237504 0.01318990067 x1.428004384 0.01367860008 x1.446283937 0.01416710019 x1.464051604 0.0146556003 x1.48137033 0.01514410041 x1.49829185 0.01563259959 x1.5147686 0.01612110063 x1.530887127 0.01660960168 x1.546601415 0.01709810272 x1.562017918 0.01758660376 x1.577063084 0.0180751048 x1.591817141 0.01856360584 x1.606268764 0.01905210689 x1.620422602 0.01954060793 x1.634301901 0.02002930082 x1.647912741 0.0205178 x1.661279559 0.02100629918 x1.674377203 0.02149479836 x1.687264919 0.02198329754 x1.699935555 0.02247179672 x1.712349534 0.0229602959 x1.724600911 0.02344879508 x1.736634016 0.02393729426 x1.748460293 0.02442579344 x1.760126472 0.02491429262 x1.771592498 0.0254027918 x1.782871962 0.02589129098 x1.793977737 0.02637979016 x1.804940343 0.02686828934 x1.815739393 0.02735709958 x1.826370597 0.02784560062 x1.836866736 0.02833410166 x1.847224355 0.0288226027 x1.857404113 0.02931110375 x1.867494464 0.02979960479 x1.877436757 0.03028810583 x1.887247682 0.03077660687 x1.896924973 0.03126510978 x1.906464934 0.03175361082 x1.915921926 0.03224211186 x1.925237656 0.0327306129 x1.934447169 0.03321911395 x1.943548679 0.03370761499 x1.95255959 0.03419611603 x1.961439729 0.03468461707 x1.970244527 0.03517311811 x1.978953481 0.03566161916 x1.987545848 0.0361501202 x1.996038675 0.03663862124 x2.004450083 0.03712712228 x2.012759447 0.03761562333 x2.020984411 0.03810412437 x2.029144049 0.03859262541 x2.03719759 0.03908112645 x2.045162678 0.03957010061 x2.053059101 0.04005860165 x2.060864925 0.04054710269 x2.068619251 0.04103560373 x2.076281548 0.04152410477 x2.083870173 0.04201260582 x2.091404915 0.04250110686 x2.098843336 0.0429896079 x2.106226444 0.04347810894 x2.113511562 0.04396660998 x2.12078023 0.04445511103 x2.127949238 0.04494361207 x2.135038137 0.04543211311 x2.14212966 0.04592061415 x2.149119139 0.0464091152 x2.156025887 0.04689761624 x2.162891388 0.04738611728 x2.169694424 0.04787461832 x2.176475286 0.04836311936 x2.183150291 0.04885162041 x2.189781189 0.04934012145 x2.19634676 0.04982862249 x2.202888489 0.05031712353 x2.209363461 0.05080562457 x2.215793133 0.05129412562 x2.222175837 0.05178262666 x2.22851181 0.0522711277 x2.234778881 0.05275962874 x2.241019249 0.05324812979 x2.247189522 0.05373663083 x2.25331068 0.05422513187 x2.259382725 0.05471419916 x2.265448332 0.0552027002 x2.271441936 0.05569120124 x2.277362108 0.05617970228 x2.283297777 0.05666820332 x2.289182186 0.05715670437 x2.295014143 0.05764520541 x2.300793648 0.05813370645 x2.306542873 0.05862220749 x2.312238693 0.05911070853 x2.317880869 0.05959920958 x2.323513746 0.06008771062 x2.329114676 0.06057621166 x2.334638357 0.0610647127 x2.340174913 0.06155321375 x2.345633268 0.06204171479 x2.351080894 0.06253021955 x2.356472492 0.06301872432 x2.361853361 0.06350722909 x2.367154121 0.06399573386 x2.372467041 0.06448423862 x2.377744913 0.06497274339 x2.382941723 0.06546124816 x2.388173342 0.06594975293 x2.393322468 0.06643825769 x2.398459673 0.06692676246 x2.40358448 0.06741526723 x2.40862608 0.067903772 x2.413655043 0.06839227676 x2.418670177 0.06888078153 x2.423672676 0.0693692863 x2.428614616 0.06985779107 x2.43354249 0.07034629583 x2.438432455 0.0708348006 x2.44328475 0.07132330537 x2.448122978 0.07181181014 x2.452923059 0.0723003149 x2.45770812 0.07278881967 x2.462454796 0.07327732444 x2.467186451 0.07376582921 x2.471879005 0.07425433397 x2.476556301 0.07474283874 x2.481193542 0.07523134351 x2.485815763 0.07571984828 x2.490422487 0.07620835304 x2.494988441 0.07669685781 x2.499538898 0.07718536258 x2.504073143 0.07767386734 x2.508566141 0.07816237211 x2.513042927 0.07865169644 x2.517478943 0.07914020121 x2.52192235 0.07962870598 x2.526324272 0.08011721075 x2.530684948 0.08060571551 x2.535052776 0.08109422028 x2.539403677 0.08158272505 x2.543687105 0.08207122982 x2.548002958 0.08255973458 x2.552276134 0.08304823935 x2.556531668 0.08353674412 x2.56071949 0.08402524889 x2.564938545 0.08451375365 x2.569140196 0.08500225842 x2.573298216 0.08549076319 x2.577437878 0.08597926795 x2.58155942 0.08646777272 x2.585661888 0.08695627749 x2.589745522 0.08744478226 x2.59381032 0.08793328702 x2.597856045 0.08842179179 x2.601883173 0.08891029656 x2.605916023 0.08939880133 x2.609879017 0.08988730609 x2.613848209 0.09037581086 x2.617797136 0.09086431563 x2.621752977 0.0913528204 x2.62563777 0.09184132516 x2.629528046 0.09232982993 x2.633424282 0.0928183347 x2.637274742 0.09330683947 x2.641130924 0.09379534423 x2.644966602 0.094283849 x2.648756266 0.09477235377 x2.6525774 0.09526085854 x2.656352282 0.0957493633 x2.660132408 0.09623786807 x2.663840055 0.09672637284 x2.667604685 0.09721487761 x2.671296597 0.09770338237 x2.674993753 0.09819188714 x2.678669691 0.09868039191 x2.682324409 0.09916889668 x2.68598485 0.09965740144 x2.689623117 0.1001459062 x2.693240643 0.100634411 x2.696862698 0.1011229157 x2.700411081 0.1016114205 x2.703990221 0.1020999253 x2.707547665 0.10258843 x2.711082935 0.1030769348 x2.714622974 0.1035654396 x2.718168259 0.1040539443 x2.721664429 0.1045424491 x2.725112438 0.1050309539 x2.728617907 0.1055194587 x2.732074499 0.1060079634 x2.73550868 0.1064964682 x2.738947153 0.106984973 x2.742363453 0.1074734777 x2.745757341 0.1079619825 x2.749154568 0.1084504873 x2.752530098 0.108938992 x2.755882502 0.1094280034 x2.759266376 0.1099169999 x2.762599945 0.1104059964 x2.765884399 0.1108949929 x2.769225597 0.1113839895 x2.772544146 0.111872986 x2.775812864 0.1123619825 x2.779085636 0.112850979 x2.782361746 0.1133399755 x2.785614491 0.113828972 x2.78884387 0.1143179685 x2.792077541 0.114806965 x2.795287371 0.1152959615 x2.798473835 0.115784958 x2.801690578 0.1162739545 x2.804884672 0.116762951 x2.808027029 0.1172519475 x2.811200142 0.117740944 x2.814322233 0.1182299405 x2.817447424 0.118718937 x2.820576668 0.1192079335 x2.823709011 0.1196969301 x2.826790094 0.1201859266 x2.8298738 0.1206749231 x2.832961321 0.1211639196 x2.836052895 0.1216529161 x2.839091778 0.1221419126 x2.842161894 0.1226309091 x2.845179319 0.1231199056 x2.84820056 0.1236089021 x2.851196766 0.1240978986 x2.854224205 0.1245868951 x2.857198954 0.1250758916 x2.860204458 0.1255648881 x2.863157511 0.1260538846 x2.866113901 0.1265428811 x2.869073391 0.1270318776 x2.872035503 0.1275208741 x2.87497282 0.1280098706 x2.877885103 0.1284988672 x2.880800486 0.1289878637 x2.883718491 0.1294768602 x2.886611462 0.1299658567 x2.889507771 0.1304548532 x2.892377853 0.1309438497 x2.895223618 0.1314328462 x2.898099184 0.1319218427 x2.90092206 0.1324108392 x2.903803587 0.1328998357 x2.906632423 0.1333888322 x2.909463167 0.1338778287 x2.912240028 0.1343668252 x2.915048122 0.1348558217 x2.917829752 0.1353448182 x2.92064333 0.1358338147 x2.92343092 0.1363228112 x2.926192522 0.1368118078 x2.928928137 0.1373008043 x2.931723833 0.1377898008 x2.934435606 0.1382787973 x2.937179804 0.1387677938 x2.939925194 0.1392567903 x2.942616463 0.1397457868 x2.945339203 0.1402347833 x2.948035479 0.1407237798 x2.9507339 0.1412127763 x2.953434706 0.1417017728 x2.956051826 0.1421907693 x2.958786964 0.1426797658 x2.961437225 0.1431687623 x2.964003801 0.1436577588 x2.966688395 0.1441467553 x2.969346285 0.1446357518 x2.971977234 0.1451247483 x2.974582195 0.1456137449 x2.977189064 0.1461027414 x2.97979784 0.1465917379 x2.982409239 0.1470807344 x2.985023022 0.1475697309 x2.987551451 0.1480587274 x2.990169525 0.1485477239 x2.992760897 0.1490367204 x2.99529624 0.1495257169 x2.997833729 0.1500147134 x3.000373125 0.1505037099 x3.002914906 0.1509927064 x3.005458832 0.1514817029 x3.00797534 0.1519706994 x3.010523558 0.1524596959 x3.012985468 0.1529486924 x3.015508413 0.1534376889 x3.017974854 0.1539266855 x3.020442724 0.154415682 x3.022972107 0.1549046785 x3.025503397 0.155393675 x3.027947903 0.1558826715 x3.030365467 0.156371668 x3.032814503 0.1568150073 x3.035265684 0.1573030055 x3.037747383 0.1577910036 x3.040143013 0.1582790017 x3.042599678 0.1587669998 x3.04496932 0.159254998 x3.0474298 0.1597429961 x3.049892426 0.1602309942 x3.0522089 0.1607189924 x3.054615498 0.1612069905 x3.057054043 0.1616949886 x3.059434652 0.1621829867 x3.06175828 0.1626709849 x3.064142942 0.163158983 x3.066529274 0.1636469811 x3.06885767 0.1641349792 x3.071247816 0.1646229774 x3.073609829 0.1651109755 x3.07594347 0.1655989736 x3.078249693 0.1660869718 x3.080557108 0.1665749699 x3.082895994 0.167062968 x3.085206509 0.1675509661 x3.087519407 0.1680389643 x3.089893818 0.1685269624 x3.092089415 0.1690149605 x3.094377041 0.1695029587 x3.096636295 0.1699909568 x3.098987579 0.1704789549 x3.101189852 0.170966953 x3.103544474 0.1714549512 x3.105749846 0.1719429493 x3.108107805 0.1724309474 x3.110346556 0.1729189456 x3.112527132 0.1734069437 x3.114768267 0.1738949418 x3.116951942 0.1743829399 x3.119227171 0.1748709381 x3.121413231 0.1753589362 x3.123661995 0.1758469343 x3.125880957 0.1763349324 x3.128072023 0.1768229306 x3.130294323 0.1773109287 x3.132518768 0.1777989268 x3.134683132 0.178286925 x3.136941195 0.1787749231 x3.139048338 0.1792629212 x3.14121747 0.1797509193 x3.143388271 0.1802389175 x3.145529985 0.1807269156 x3.147704363 0.1812149137 x3.149939775 0.1817029119 x3.152024984 0.18219091 x3.154203415 0.1826789081 x3.156290531 0.1831669062 x3.158410788 0.1836549044 x3.160562277 0.1841429025 x3.1626544 0.1846309006 x3.164870501 0.1851188987 x3.166903734 0.1856068969 x3.169060707 0.186094895 x3.17109704 0.1865828931 x3.173257351 0.1870708913 x3.175295353 0.1875588894 x3.177366018 0.1880468875 x3.17946887 0.1885348856 x3.181604147 0.1890228838 x3.183709621 0.1895108819 x3.185723782 0.18999888 x3.187770367 0.1904868782 x3.189848661 0.1909748763 x3.191928625 0.1914628744 x3.193947315 0.1919508725 x3.195999384 0.1924388707 x3.198083401 0.1929268688 x3.200137138 0.1934148669 x3.202099562 0.1939028651 x3.204124928 0.1943908632 x3.206152201 0.1948788613 x3.208180428 0.1953668594 x3.210178137 0.1958548576 x3.212208748 0.1963428557 x3.214209318 0.1968308538 x3.21624279 0.1973188519 x3.218245745 0.1978068501 x3.22021842 0.1982948482 x3.222224951 0.1987828463 x3.224168539 0.1992708445 x3.226176023 0.1997588426 x3.228123188 0.2002468407 x3.230102062 0.2007348388 x3.232051373 0.201222837 x3.234032631 0.2017108351 x3.235984087 0.2021988332 x3.237999439 0.2026868314 x3.23988986 0.2031748295 x3.241844416 0.2036628276 x3.243768454 0.2041508257 x3.245725393 0.2046388239 x3.247652769 0.205126822 x3.249612093 0.2056148201 x3.251477242 0.2061028183 x3.253470659 0.2065908164 x3.255370378 0.2070788145 x3.257238626 0.2075668126 x3.259172201 0.2080548108 x3.261107445 0.2085428089 x3.263011694 0.209030807 x3.264884949 0.2095188051 x3.26675868 0.2100068033 x3.268634319 0.2104948014 x3.27057457 0.2109827995 x3.272387981 0.2114707977 x3.274298906 0.2119587958 x3.276178837 0.2124467939 x3.278059244 0.212934792 x3.279909372 0.2134227902 x3.281728029 0.2139107883 x3.283612251 0.2143987864 x3.285465956 0.2148867846 0.2153747827 x3.289142609 0.2158627808 x3.290999174 0.2163507789 x3.292888403 0.2168387771 x3.294682503 0.2173267752 x3.296541929 0.2178147733 x3.298337698 0.2183027714 x3.300134897 0.2188570052 x3.301996946 0.2193450034 x3.303796291 0.2198330015 x3.30559659 0.2203209996 x3.307461739 0.2208089978 x3.309199333 0.2212969959 x3.311067104 0.221784994 x3.312871695 0.2222729921 x3.314676523 0.2227609903 x3.316450357 0.2232489884 x3.318257093 0.2237369865 x3.320065022 0.2242249846 x3.321776867 0.2247129828 x3.323585987 0.2252009809 x3.325365305 0.225688979 x3.327112913 0.2261769772 x3.328892708 0.2266649753 x3.330641508 0.2271529734 x3.332424164 0.2276409715 x3.334207058 0.2281289697 x3.335958719 0.2286169678 x3.337743998 0.2291049659 x3.339400053 0.2295929641 x3.341186762 0.2300809622 x3.342909575 0.2305689603 x3.344633102 0.2310569584 x3.346358061 0.2315449566 0.2320329547 x3.349809408 0.2325209528 x3.351602077 0.2330089509 x3.353330374 0.2334969491 x3.355059147 0.2339849472 x3.356724262 0.2344729453 x3.358454466 0.2349609435 x3.360153675 0.2354489416 x3.361886024 0.2359369397 x3.363586903 0.2364249378 x3.365255594 0.236912936 x3.36692524 0.2374009341 x3.368628502 0.2378889322 x3.370365143 0.2383769304 x3.372004986 0.2388649285 x3.373743296 0.2393529266 x3.375384092 0.2398409247 x3.377058744 0.2403289229 x3.378767252 0.240816921 x3.38041091 0.2413049191 x3.382120848 0.2417929173 x3.383766174 0.2422809154 x3.38544488 0.2427689135 x3.387091398 0.2432569116 x3.388738871 0.2437449098 x3.390387297 0.2442329079 x3.392036676 0.244720906 0.2452089041 x3.395336628 0.2456969023 x3.396988153 0.2461849004 x3.398640633 0.2466728985 x3.400293827 0.2471608967 x3.401881218 0.2476488948 x3.403535366 0.2481368929 x3.405091763 0.248624891 x3.40674758 0.2491128892 x3.408405066 0.2496008873 x3.409996033 0.2500888705 x3.411621332 0.2505768538 x3.413280964 0.251064837 x3.414808273 0.2515528202 x3.416435719 0.2520408034 x3.418030977 0.2525287867 x3.419593334 0.2530167699 x3.421257019 0.2535047531 x3.422821283 0.2539927363 0.2544807196 x3.42605114 0.2549687028 x3.427617788 0.255456686 0.2559446692 x3.430785656 0.2564326525 x3.43235445 0.2569206357 0.2574086189 x3.435493708 0.2578966022 x3.437096834 0.2583845854 x3.438668728 0.2588725686 x3.440173864 0.2593605518 x3.441813231 0.2598485351 x3.443320036 0.2603365183 x3.444893837 0.2608245015 x3.446401834 0.2613124847 x3.4480443 0.261800468 x3.449553251 0.2622884512 x3.451130629 0.2627764344 x3.45264101 0.2632644176 x3.45421958 0.2637524009 x3.455798626 0.2642403841 x3.457277775 0.2647283673 x3.458790779 0.2652163506 x3.460371733 0.2657043338 x3.461885929 0.266192317 x3.463435173 0.2666803002 x3.464951515 0.2671682835 x3.466468096 0.2676562667 x3.467951059 0.2681442499 x3.469536781 0.2686322331 x3.471055031 0.2691202164 x3.472540617 0.2696081996 x3.474060535 0.2700961828 x3.475547075 0.270584166 x3.477068186 0.2710721493 x3.478556156 0.2715601325 x3.480078697 0.2720481157 x3.481567621 0.272536099 x3.483057737 0.2730240822 x3.484514475 0.2735120654 x3.486005783 0.2740000486 x3.487497568 0.2744880319 x3.489023685 0.2749760151 x3.490448952 0.2754639983 x3.491942406 0.2759519815 x3.493436813 0.2764399648 x3.494898558 0.276927948 x3.496393442 0.2774159312 x3.497889996 0.2779039145 x3.499318123 0.2783918977 x3.500747919 0.2788798809 x3.502245665 0.2793678641 x3.503744841 0.2798558474 x3.505176067 0.2803438306 x3.506641388 0.2808318138 x3.508108139 0.281319797 x3.509541035 0.2818077803 x3.510974646 0.2822957635 x3.512476921 0.2827837467 x3.513843298 0.2832717299 x3.515347481 0.2837597132 x3.516782761 0.2842476964 x3.518219233 0.2847356796 x3.519656181 0.2852236629 x3.521060467 0.2857116461 x3.522498131 0.2861996293 x3.523936749 0.2866876125 x3.525375843 0.2871755958 x3.526781797 0.287663579 x3.528290987 0.2881515622 x3.529663563 0.2886395454 x3.531070709 0.2891275287 x3.532513142 0.2896155119 0.2901034951 x3.535296202 0.2905914783 x3.536740303 0.2910794616 x3.538150311 0.2915674448 x3.539595604 0.292055428 x3.540938377 0.2925434113 x3.542384148 0.2930313945 x3.543796301 0.2935193777 x3.545175076 0.2940073609 x3.546519756 0.2944953442 x3.547899485 0.2949833274 x3.549383163 0.2954713106 x3.550729275 0.2959592938 x3.552110195 0.2964472771 x3.55345726 0.2969352603 x3.554874897 0.2974232435 x3.556257248 0.2979112267 x3.557675362 0.29839921 x3.559023619 0.2988871932 x3.560408831 0.2993751764 x3.561758995 0.2998631597 x3.563109636 0.3003511429 x3.564530611 0.3008391261 x3.565882444 0.3013271093 x3.567234039 0.3018150926 x3.568622112 0.3023030758 x3.569974899 0.302791059 x3.571329355 0.3032790422 x3.572683573 0.3037670255 x3.574038267 0.3042550087 x3.575393915 0.3047429919 x3.57675004 0.3052309752 x3.578036785 0.3057189584 x3.579463005 0.3062069416 x3.580821037 0.3066949248 x3.582178593 0.3071829081 x3.583537102 0.3076708913 x3.584826946 0.3081588745 x3.586186171 0.3086468577 x3.58754611 0.309134841 x3.588836908 0.3096228242 x3.590162992 0.3101108074 x3.591454506 0.3105987906 x3.592816353 0.3110867739 x3.594178677 0.3115747571 x3.595472336 0.3120627403 x3.596801043 0.3125507236 x3.598094702 0.3131409883 x3.59945941 0.3136300147 x3.60078907 0.314119041 x3.602084875 0.3146080673 x3.603380442 0.3150970936 x3.604746819 0.3155861199 x3.606009245 0.3160751462 x3.607306719 0.3165641725 x3.608603716 0.3170531988 x3.609936953 0.3175422251 x3.611235857 0.3180312514 x3.612500191 0.3185202777 x3.613800049 0.319009304 0.3194983304 x3.616435528 0.3199873567 x3.617666483 0.320476383 x3.619003773 0.3209654093 x3.6203053 0.3214544356 x3.621572495 0.3219434619 x3.622875214 0.3224324882 x3.624143362 0.3229215145 x3.625411987 0.3234105408 x3.626716852 0.3238995671 x3.627950907 0.3243885934 x3.629291296 0.3248776197 x3.630561113 0.3253666461 x3.631832123 0.3258556724 x3.633068562 0.3263446987 x3.634410381 0.326833725 x3.635611773 0.3273227513 x3.636919737 0.3278117776 x3.638193369 0.3283008039 x3.639395475 0.3287898302 x3.64070487 0.3292788565 x3.641979218 0.3297678828 x3.643183231 0.3302569091 x3.644458532 0.3307459354 x3.645734072 0.3312349617 x3.646974087 0.3317239881 x3.648180485 0.3322130144 x3.649456978 0.3327020407 x3.650734425 0.333191067 x3.651941061 0.3336800933 x3.653219938 0.3341691196 x3.654462814 0.3346581459 x3.655741453 0.3351471722 x3.656950235 0.3356361985 x3.658158779 0.3361252248 x3.659439802 0.3366142511 x3.660649061 0.3371032774 x3.661859035 0.3375923038 x3.663140774 0.3380813301 x3.664352417 0.3385703564 x3.665563583 0.3390593827 x3.666846514 0.339548409 x3.668058395 0.3400374353 x3.669199228 0.3405264616 x3.670483351 0.3410154879 x3.671696901 0.3415045142 x3.672911406 0.3419935405 x3.674124718 0.3424825668 x3.67533946 0.3429715931 x3.676554441 0.3434606194 0.3439496458 x3.679020882 0.3444386721 x3.680165291 0.3449276984 x3.681382418 0.3454167247 x3.682599068 0.345905751 x3.683816433 0.3463947773 x3.685034037 0.3468838036 x3.686180353 0.3473728299 x3.687363148 0.3478618562 x3.688581705 0.3483508825 x3.689872742 0.3488399088 x3.691056728 0.3493289351 x3.692133665 0.3498179615 x3.693425894 0.3503069878 x3.694574594 0.3507960141 x3.695759773 0.3512850404 x3.696909666 0.3517740667 x3.698132038 0.352263093 x3.699317932 0.3527521193 x3.700540304 0.3532411456 x3.701763868 0.3537301719 x3.70287919 0.3542191982 x3.704031944 0.3547082245 x3.705255985 0.3551972508 x3.706444502 0.3556862772 x3.707598209 0.3561753035 x3.708787441 0.3566643298 x3.709940672 0.3571533561 x3.711130857 0.3576423824 x3.712285757 0.3581314087 x3.713476419 0.358620435 x3.714559317 0.3591094613 x3.715787172 0.3595984876 x3.716906548 0.3600875139 x3.718135834 0.3605765402 x3.719256401 0.3610655665 x3.720413446 0.3615545928 x3.721606731 0.3620436192 x3.722764492 0.3625326455 x3.723886013 0.3630216718 x3.725044489 0.3635106981 x3.72623992 0.3639997244 x3.727362871 0.3644887507 x3.728449583 0.364977777 x3.729646206 0.3654668033 x3.730806112 0.3659558296 x3.731930733 0.3664448559 x3.733127594 0.3669338822 x3.734216213 0.3674229085 x3.735341311 0.3679119349 x3.7364676 0.3684009612 x3.737665892 0.3688899875 x3.738755941 0.3693790138 x3.739882708 0.3698680401 x3.741045952 0.3703570664 x3.742173433 0.3708460927 x3.743301392 0.371335119 x3.744428873 0.3718241453 x3.745521069 0.3723131716 x3.746649981 0.3728021979 x3.747852087 0.3732912242 x3.748944998 0.3737802505 x3.750074625 0.3742692769 x3.751204729 0.3747583032 x3.752262115 0.3752473295 x3.753392935 0.3757363558 x3.754560232 0.3762253821 x3.755618811 0.3767144084 x3.756750345 0.3772034347 x3.757882357 0.377692461 x3.758941889 0.3781814873 x3.760147572 0.3786705136 x3.761244774 0.3791595399 x3.762304544 0.3796485662 x3.763438702 0.3801375926 x3.764499426 0.3806266189 x3.765633345 0.3811156452 x3.766695261 0.3816046715 x3.767830372 0.3820936978 x3.76889205 0.3825827241 x3.770028353 0.3830717504 x3.771164417 0.3835607767 x3.772264004 0.384049803 x3.773326874 0.3845388293 x3.774391174 0.3850278556 x3.775528193 0.3855168819 x3.776666164 0.3860059083 x3.77773118 0.3864949346 x3.778795004 0.3869839609 x3.779860735 0.3874729872 x3.780926228 0.3879620135 x3.78206563 0.3884510398 x3.783131599 0.3889400661 x3.784234524 0.3894290924 x3.78533864 0.3899181187 x3.786405563 0.390407145 x3.787472963 0.3908961713 x3.788540602 0.3913851976 x3.789644957 0.3918742239 x3.790640116 0.3923632503 x3.791708231 0.3928522766 x3.792850971 0.3933413029 x3.793919563 0.3938303292 x3.794988871 0.3943193555 x3.79605937 0.3948083818 x3.797129154 0.3952974081 x3.798199654 0.3957864344 x3.79923296 0.3962754607 x3.800304413 0.396764487 x3.801375628 0.3972535133 0.3977425396 x3.803519011 0.398231566 x3.80459094 0.3987205923 x3.805626392 0.3992096186 x3.806624651 0.3996986449 x3.807771921 0.4001876712 x3.80877161 0.4006766975 x3.809881926 0.4011657238 x3.810881615 0.4016547501 x3.81195569 0.4021437764 x3.81303072 0.4026328027 x3.814030886 0.403121829 x3.815069199 0.4036108553 x3.816144705 0.4040998816 x3.817145586 0.404588908 x3.818259001 0.4050779343 x3.819261074 0.4055669606 x3.820338011 0.4060559869 x3.821414471 0.4065450132 x3.822380304 0.4070340395 x3.823384047 0.4075230658 x3.824461222 0.4080120921 x3.825501919 0.4085011184 x3.826505899 0.4089901447 x3.82758379 0.409479171 x3.828588724 0.4099681973 x3.829631329 0.4104572237 x3.830710411 0.41094625 x3.831715345 0.4114352763 x3.832758427 0.4119243026 x3.833764315 0.4124133289 x3.834807634 0.4129023552 x3.835813522 0.4133913815 x3.836819887 0.4138804078 x3.837864637 0.4143694341 x3.838871479 0.4148584604 x3.839879036 0.4153474867 x3.840924263 0.415836513 x3.841932297 0.4163255394 x3.842977762 0.4168145657 x3.843985796 0.417303592 x3.845032215 0.4177926183 x3.845966101 0.4182816446 x3.84701252 0.4187706709 x3.848022699 0.4192596972 x3.849069357 0.4197487235 x3.850079536 0.4202377498 x3.851014853 0.4207267761 x3.852063179 0.4212158024 x3.853073597 0.4217048287 x3.854048014 0.422193855 x3.855058908 0.4226828814 x3.856108427 0.4231719077 x3.857082844 0.423660934 x3.858094692 0.4241499603 x3.859070063 0.4246389866 x3.860082865 0.4251280129 x3.861057997 0.4256170392 x3.862070799 0.4261060655 x3.863046885 0.4265950918 x3.864060879 0.4270841181 x3.865036726 0.4275731444 x3.86608839 0.4280621707 x3.86702776 0.4285511971 x3.868042707 0.4290402234 x3.869019985 0.4295292497 x3.86999774 0.430018276 x3.871013641 0.4305073023 x3.871991396 0.4309963286 x3.872969627 0.4314853549 x3.873986721 0.4319743812 x3.874965429 0.4324634075 x3.875906706 0.4329524338 x3.876961946 0.4334414601 x3.877865791 0.4339304864 x3.878883839 0.4344195127 x3.879863262 0.4349085391 x3.880843401 0.4353975654 x3.881862402 0.4358865917 x3.8827672 0.436375618 x3.8837111 0.4368646443 x3.884767771 0.4373536706 x3.885749817 0.4377140105 x3.886655569 0.4382019937 x3.887676001 0.4386899769 x3.888657808 0.4391779602 x3.889564991 0.4396659434 x3.890585661 0.4401539266 x3.891493082 0.4406419098 x3.89247632 0.4411298931 x3.893421888 0.4416178763 x3.894405842 0.4421058595 x3.895390272 0.4425938427 x3.896298409 0.443081826 x3.897320747 0.4435698092 x3.898229837 0.4440577924 x3.899214983 0.4445457757 x3.90019989 0.4450337589 x3.901148081 0.4455217421 x3.902058125 0.4460097253 x3.903043985 0.4464977086 x3.903954029 0.4469856918 x3.904978275 0.447473675 x3.905888796 0.4479616582 x3.906876087 0.4484496415 x3.907787323 0.4489376247 x3.908736229 0.4494256079 x3.909724236 0.4499135911 x3.91063571 0.4504015744 x3.911548138 0.4508895576 x3.912536621 0.4513775408 x3.913449049 0.4518655241 x3.914437771 0.4523535073 x3.915389299 0.4528414905 x3.916301727 0.4533294737 x3.917215586 0.453817457 x3.918204784 0.4543054402 x3.919119596 0.4547934234 x3.92010951 0.4552814066 x3.920985699 0.4557693899 x3.921900272 0.4562573731 x3.922814608 0.4567453563 x3.923729658 0.4572333395 x3.924721241 0.4577213228 x3.925636292 0.458209306 x3.926628113 0.4586972892 x3.92750597 0.4591852725 x3.928498507 0.4596732557 x3.929414272 0.4601612389 x3.930330992 0.4606492221 x3.931170464 0.4611372054 x3.932164192 0.4616251886 x3.933081388 0.4621131718 x3.933998823 0.462601155 0.4630891383 x3.935872793 0.4635771215 x3.936828852 0.4640651047 x3.937708616 0.4645530879 x3.938627243 0.4650410712 x3.939545155 0.4655290544 x3.940464735 0.4660170376 x3.941383362 0.4665050209 x3.942302227 0.4669930041 x3.943144798 0.4674809873 x3.944141388 0.4679689705 x3.945061207 0.4684569538 x3.945981741 0.468944937 x3.94690156 0.4694329202 x3.947745323 0.4699209034 x3.948666096 0.4704088867 x3.949587345 0.4708968699 0.4713848531 x3.951429605 0.4718728364 0.4723608196 x3.953196287 0.4728488028 x3.954117537 0.473336786 x3.955039978 0.4738247693 0.4743127525 x3.956808329 0.4748007357 x3.957731009 0.4752887189 x3.958654404 0.4757767022 x3.95957756 0.4762646854 x3.960423708 0.4767526686 x3.961347342 0.4772406518 x3.962194681 0.4777286351 x3.963195086 0.4782166183 x3.964042664 0.4787046015 x3.964890003 0.4791925848 x3.965815067 0.479680568 x3.966739416 0.4801685512 x3.967587233 0.4806565344 x3.968512774 0.4811445177 x3.969360828 0.4816325009 x3.970247984 0.4821204841 x3.971174479 0.4826084673 x3.97202301 0.4830964506 x3.972872496 0.4835844338 x3.973875999 0.484072417 x3.974725246 0.4845604002 0.4850483835 x3.976424456 0.4855363667 x3.977352142 0.4860243499 x3.978241444 0.4865123332 x3.979130983 0.4870003164 x3.979981184 0.4874882996 x3.980870485 0.4879762828 x3.98172164 0.4884642661 x3.982649803 0.4889522493 x3.983501911 0.4894402325 x3.98443079 0.4899282157 x3.985282421 0.490416199 0.4909041822 x3.987025023 0.4913921654 x3.987838984 0.4918801486 x3.988729715 0.4923681319 x3.989582539 0.4928561151 x3.990512609 0.4933440983 x3.991366148 0.4938320816 x3.992257595 0.4943200648 x3.993111134 0.494808048 x3.993965149 0.4952960312 x3.994818687 0.4957840145 x3.995672464 0.4962719977 x3.996526957 0.4967599809 x3.997458458 0.4972479641 x3.998352051 0.4977359474 x3.999129295 0.4982239306 x4.000061512 0.4987119138 x4.000916958 0.4991998971 x4.001771927 0.4996878803 x4.002589226 0.5001758337 x4.003444195 0.5006638169 x4.004300117 0.5011518002 x4.005233765 0.5016397834 x4.006051064 0.5021277666 x4.006868839 0.5026157498 x4.007763863 0.5031037331 x4.008543491 0.5035917163 x4.009478092 0.5040796995 x4.010295868 0.5045676827 x4.011153698 0.505055666 x4.012010098 0.5055436492 x4.012867928 0.5060316324 0.5065196157 x4.014544964 0.5070075989 x4.015402794 0.5074955821 x4.016261101 0.5079835653 x4.017120361 0.5084715486 x4.017939568 0.5089595318 x4.018798828 0.509447515 x4.019579411 0.5099354982 x4.020516872 0.5104234815 x4.021297932 0.5109114647 x4.022118568 0.5113994479 x4.022978306 0.5118874311 x4.02383852 0.5123754144 x4.024737835 0.5128633976 x4.025519371 0.5133513808 x4.026380062 0.5138393641 x4.027162552 0.5143273473 x4.028062344 0.5148153305 x4.028844833 0.5153033137 x4.029706478 0.515791297 x4.030528545 0.5162792802 x4.031390667 0.5167672634 x4.032251835 0.5172552466 x4.033035755 0.5177432299 x4.033857822 0.5182312131 x4.034720421 0.5187191963 x4.035505295 0.5192071795 x4.036328316 0.5196951628 x4.037190914 0.520183146 x4.038053989 0.5206711292 x4.038877487 0.5211591125 x4.039662361 0.5216470957 x4.04052639 0.5221350789 x4.041350365 0.5226230621 x4.042135715 0.5231110454 x4.042999744 0.5235990286 x4.043785572 0.5240870118 x4.0446105 0.524574995 x4.045474529 0.5250629783 x4.046260834 0.5255509615 x4.047086716 0.5260389447 x4.047951698 0.5265269279 x4.048698902 0.5270149112 x4.049485683 0.5275028944 x4.050351143 0.5279908776 x4.051177502 0.5284788609 x4.052043915 0.5289668441 x4.052831173 0.5294548273 x4.053658009 0.5299428105 x4.05444622 0.5304307938 x4.055273056 0.530918777 x4.056139469 0.5314067602 x4.056927681 0.5318947434 x4.057676315 0.5323827267 x4.058465481 0.5328707099 x4.059332848 0.5333586931 x4.060161114 0.5338466763 x4.060949802 0.5343346596 0.5348226428 x4.062488079 0.535310626 x4.063396931 0.5357986093 x4.064186096 0.5362865925 0.5367745757 x4.065765381 0.5372625589 x4.066516399 0.5377505422 x4.067385197 0.5382385254 x4.068175793 0.5387265086 x4.069005489 0.5392144918 x4.069796085 0.5397024751 x4.070627213 0.5401904583 x4.071417809 0.5406784415 x4.072169304 0.5411664248 x4.073039532 0.541654408 x4.073792458 0.5421423912 x4.074583054 0.5426303744 x4.07537508 0.5431183577 x4.076127529 0.5436063409 x4.076919556 0.5440943241 x4.07775116 0.5445823073 x4.078543186 0.5450702906 x4.07933569 0.5455582738 x4.080088615 0.546046257 x4.080961227 0.5465342402 x4.081714153 0.5470222235 x4.082507133 0.5475102067 x4.083261013 0.5479981899 x4.084134102 0.5484861732 x4.084887505 0.5489741564 x4.085681438 0.5494621396 x4.086474895 0.5499501228 x4.087229252 0.5504381061 x4.08806324 0.5509260893 x4.088778019 0.5514140725 x4.08957243 0.5519020557 x4.09032774 0.552390039 x4.091201782 0.5528780222 x4.091956615 0.5533660054 x4.092672825 0.5538539886 x4.093468189 0.5543419719 x4.094302654 0.5548299551 x4.095058441 0.5553179383 x4.095854282 0.5558059216 0.5562939048 x4.097406387 0.556781888 x4.098202705 0.5572698712 x4.098958969 0.5577578545 x4.099755287 0.5582458377 x4.100512028 0.5587338209 0.5592218041 x4.102065563 0.5597097874 x4.102862835 0.5601977706 x4.10366106 0.5606857538 x4.104377747 0.561173737 x4.105175018 0.5616617203 x4.105893135 0.5621497035 x4.10669136 0.5626376867 x4.107409 0.56312567 x4.108207226 0.5636136532 x4.109004974 0.5641016364 x4.109803677 0.5645896196 x4.110521793 0.5650776029 x4.111320496 0.5655655861 x4.112040043 0.5660535693 x4.112839222 0.5665415525 x4.113637924 0.5670295358 x4.114357471 0.567517519 x4.115156651 0.5680055022 x4.115876198 0.5684934855 x4.116675854 0.5689814687 x4.117395878 0.5694694519 x4.118196487 0.5699574351 x4.118916035 0.5704454184 x4.119716167 0.5709334016 x4.120436668 0.5714213848 x4.121237755 0.571909368 x4.121957779 0.5723973513 x4.122678757 0.5728853345 x4.123479843 0.5733733177 0.5738613009 x4.125002861 0.5743492842 x4.125803471 0.5748372674 x4.126525402 0.5753252506 x4.127326965 0.5758132339 x4.12804842 0.5763012171 x4.12885046 0.5767892003 x4.129572392 0.5772771835 x4.1302948 0.5777651668 x4.131016731 0.57825315 x4.131819725 0.5787411332 x4.132542133 0.5792291164 x4.133264065 0.5797170997 x4.134068012 0.5802050829 x4.134790421 0.5806930661 x4.135514259 0.5811810493 x4.136236668 0.5816690326 x4.137040138 0.5821570158 x4.137763977 0.582644999 x4.138487339 0.5831329823 x4.139291286 0.5836209655 0.5841089487 x4.140738964 0.5845969319 x4.14146328 0.5850849152 x4.142267704 0.5855728984 x4.143072605 0.5860608816 x4.143716812 0.5865488648 x4.144441128 0.5870368481 x4.145246029 0.5875248313 x4.145971298 0.5880128145 x4.146696091 0.5885007977 0.588988781 x4.148226738 0.5894767642 x4.148871422 0.5899647474 x4.1496768 0.5904527307 x4.1504035 0.5909407139 x4.15104866 0.5914286971 x4.151854992 0.5919166803 x4.152662277 0.5924046636 x4.153307438 0.5928926468 x4.154033184 0.59338063 x4.154840946 0.5938686132 x4.155566692 0.5943565965 x4.15621376 0.5948445797 x4.15693903 0.5953325629 x4.15766573 0.5958205462 x4.158392906 0.5963085294 x4.159200668 0.5967965126 x4.159928322 0.5972844958 x4.160655499 0.5977724791 x4.161383629 0.5982604623 x4.162111282 0.5987484455 0.5992364287 x4.163485527 0.599724412 x4.164294243 0.6002123952 x4.16502285 0.6007003784 x4.165669918 0.6011883616 x4.166398525 0.6016763449 x4.167207718 0.6021643281 x4.167856216 0.6026523113 x4.168665409 0.6031402946 x4.169394493 0.6036282778 x4.170042515 0.604116261 x4.170771599 0.6046042442 x4.17150116 0.6050922275 x4.172230244 0.6055802107 x4.172959805 0.6060681939 0.6065561771 x4.174419403 0.6070441604 x4.175067425 0.6075321436 x4.175798416 0.6080201268 x4.176527977 0.60850811 x4.177258015 0.6089960933 x4.177906513 0.6094840765 x4.178719044 0.6099720597 x4.179368019 0.610460043 x4.180099964 0.6109480262 x4.180830002 0.6114360094 x4.181480408 0.6119239926 x4.182210922 0.6124119759 x4.182941914 0.6128999591 x4.183673382 0.6133879423 x4.184323311 0.6138759255 x4.185136795 0.6143639088 x4.185787201 0.614851892 x4.186518669 0.6153398752 x4.187251091 0.6158278584 x4.187901974 0.6163158417 x4.188634396 0.6168038249 x4.189285278 0.6172918081 x4.1900177 0.6177797914 x4.190750599 0.6182677746 x4.191483021 0.6187557578 x4.192133904 0.619243741 x4.192867756 0.6197317243 x4.193600178 0.6202197075 x4.194251537 0.6207076907 x4.194985867 0.6211956739 x4.19563818 0.6216836572 x4.196371078 0.6221716404 x4.197104454 0.6226596236 x4.197757244 0.6231476068 x4.19849205 0.6236355901 x4.199143887 0.6241235733 x4.199877739 0.6246115565 x4.200530052 0.6250995398 x4.201265335 0.6257939935 x4.201999187 0.6262819767 x4.202652454 0.6267699599 x4.20338726 0.6272579432 x4.204122543 0.6277459264 x4.204775333 0.6282339096 x4.205429554 0.6287218928 x4.20616436 0.6292098761 x4.206818104 0.6296978593 x4.207472324 0.6301858425 x4.208208084 0.6306738257 x4.208861351 0.631161809 x4.209597111 0.6316497922 x4.210333824 0.6321377754 x4.210987568 0.6326257586 x4.211642265 0.6331137419 x4.212378502 0.6336017251 x4.213033199 0.6340897083 x4.21377039 0.6345776916 x4.214506626 0.6350656748 x4.215079784 0.635553658 x4.215816498 0.6360416412 x4.216553688 0.6365296245 x4.217208862 0.6370176077 x4.21786499 0.6375055909 x4.21860218 0.6379935741 x4.219256878 0.6384815574 x4.219995499 0.6389695406 x4.22065115 0.6394575238 x4.221307755 0.639945507 x4.221963882 0.6404334903 x4.222701073 0.6409214735 x4.223275661 0.6414094567 x4.224095821 0.64189744 x4.22467041 0.6423854232 x4.225409508 0.6428734064 x4.226065636 0.6433613896 x4.226722717 0.6438493729 x4.227461338 0.6443373561 x4.228118896 0.6448253393 x4.228775024 0.6453133225 x4.22943306 0.6458013058 x4.230172157 0.646289289 x4.230829239 0.6467772722 x4.231568813 0.6472652555 x4.232226372 0.6477532387 x4.232801914 0.6482412219 x4.233541965 0.6487292051 x4.234200478 0.6492171884 x4.234858513 0.6497051716 x4.235599041 0.6501931548 x4.23617506 0.650681138 x4.236915112 0.6511691213 x4.2375741 0.6516571045 x4.238232136 0.6521450877 x4.238973618 0.6526330709 x4.239631653 0.6531210542 x4.240290642 0.6536090374 0.6540970206 x4.241608143 0.6545850039 x4.242268562 0.6550729871 x4.242927551 0.6555609703 0.6560489535 x4.244328976 0.6565369368 x4.244905949 0.65702492 x4.245565414 0.6575129032 x4.246308327 0.6580008864 x4.246967793 0.6584888697 x4.247544765 0.6589768529 x4.248205662 0.6594648361 x4.248948097 0.6599528193 x4.249526024 0.6604408026 x4.250268936 0.6609287858 x4.250929356 0.661416769 0.6619047523 0.6623927355 x4.252911091 0.6628807187 x4.253572464 0.6633687019 x4.25423336 0.6638566852 x4.254894733 0.6643446684 x4.25555563 0.6648326516 x4.256217003 0.6653206348 x4.256877899 0.6658086181 x4.257540226 0.6662966013 x4.258202076 0.6667845845 x4.258863449 0.6672725677 0.667760551 x4.260187149 0.6682485342 0.6687365174 x4.261510849 0.6692245007 x4.26209116 0.6697124839 x4.262752533 0.6702004671 x4.26341486 0.6706884503 x4.26407814 0.6711764336 x4.264823437 0.6716644168 x4.265403271 0.6721524 x4.266066551 0.6726403832 x4.266728878 0.6731283665 x4.267308712 0.6736163497 x4.267972469 0.6741043329 x4.268635273 0.6745923162 x4.269382 0.6750802994 x4.269962788 0.6755682826 x4.270626068 0.6760562658 0.6765442491 x4.271953583 0.6770322323 x4.27253437 0.6775202155 x4.273198128 0.6780081987 x4.273779869 0.678496182 x4.274526119 0.6789841652 x4.275190353 0.6794721484 x4.275771618 0.6799601316 x4.276436329 0.6804481149 0.6809360981 x4.277682304 0.6814240813 x4.278347015 0.6819120646 x4.27901268 0.6824000478 x4.279594421 0.682888031 x4.280342102 0.6833760142 x4.28092432 0.6838639975 x4.281589031 0.6843519807 x4.282254219 0.6848399639 x4.282836437 0.6853279471 x4.283585548 0.6858159304 x4.284167767 0.6863039136 x4.284750462 0.6867918968 x4.28541708 0.68727988 x4.286082745 0.6877678633 x4.286748886 0.6882558465 x4.287331581 0.6887438297 x4.287997723 0.689231813 x4.288580418 0.6897197962 x4.289247036 0.6902077794 x4.289913177 0.6906957626 x4.290496826 0.6911837459 x4.291163445 0.6916717291 x4.291831017 0.6921597123 x4.292414188 0.6926476955 x4.293081284 0.6931356788 x4.293747902 0.693623662 x4.294331551 0.6941116452 x4.294999123 0.6945996284 x4.295582771 0.6950876117 x4.29625082 0.6955755949 0.6960635781 x4.297502518 0.6965515614 x4.298170567 0.6970395446 x4.298755169 0.6975275278 x4.299423218 0.698015511 x4.300007343 0.6985034943 x4.300675392 0.6989914775 x4.301259995 0.6994794607 x4.30192852 0.6999674439 0.7004554272 x4.303182125 0.7009434104 0.7014313936 x4.304436207 0.7019193769 x4.305104733 0.7024073601 x4.305606365 0.7028953433 x4.306359768 0.7033833265 x4.306944847 0.7038713098 x4.30761385 0.704359293 x4.308199406 0.7048472762 x4.308785915 0.7053352594 x4.309370995 0.7058232427 x4.310040951 0.7063112259 x4.31062746 0.7067992091 x4.31129694 0.7072871923 x4.31188345 0.7077751756 x4.312552452 0.7082631588 x4.313223839 0.708751142 x4.313725948 0.7092391253 x4.314479828 0.7097271085 x4.314981937 0.7102150917 x4.315652847 0.7107030749 x4.316324234 0.7111910582 x4.316910744 0.7116790414 x4.317581654 0.7121670246 x4.318085194 0.7126550078 x4.318756104 0.7131429911 0.7136309743 x4.3199296 0.7141189575 x4.320601463 0.7146069407 x4.321188927 0.715094924 x4.32186079 0.7155829072 x4.322447777 0.7160708904 x4.323036194 0.7165588737 x4.323707581 0.7170468569 x4.324295998 0.7175348401 x4.324882984 0.7180228233 x4.325555325 0.7185108066 x4.326058865 0.7189987898 x4.326815605 0.719486773 x4.327404022 0.7199747562 x4.327991962 0.7204627395 x4.328580379 0.7209507227 x4.329169273 0.7214387059 x4.329841614 0.7219266891 x4.330430508 0.7224146724 x4.330935478 0.7229026556 x4.331607342 0.7233906388 x4.332281113 0.7238786221 x4.332870483 0.7243666053 0.7248545885 x4.334048748 0.7253425717 x4.334722042 0.725830555 x4.335311413 0.7263185382 0.7268065214 0.7272945046 x4.337080002 0.7277824879 x4.337753296 0.7282704711 x4.33834362 0.7287584543 x4.338932991 0.7292464375 x4.339523792 0.7297344208 x4.340029716 0.730222404 x4.340787888 0.7307103872 x4.341377735 0.7311983705 x4.34196806 0.7316863537 x4.342557907 0.7321743369 x4.343064785 0.7326623201 x4.34373951 0.7331503034 x4.344329357 0.7336382866 x4.345004559 0.7341262698 x4.345595837 0.734614253 x4.346102238 0.7351022363 x4.346777916 0.7355902195 x4.347368717 0.7360782027 x4.347959995 0.736566186 x4.348550797 0.7370541692 x4.349142075 0.7375421524 0.7380301356 0.7385181189 x4.350916386 0.7390061021 0.7394940853 0.7399820685 x4.352775574 0.7404700518 x4.353367329 0.740958035 x4.353874683 0.7414460182 x4.354550838 0.7419340014 x4.35514307 0.7424219847 x4.355650425 0.7429099679 x4.356327534 0.7433979511 x4.356919765 0.7438859344 x4.357512474 0.7443739176 x4.358020306 0.7448619008 x4.358697414 0.745349884 x4.359289169 0.7458378673 x4.359881878 0.7463258505 x4.360475063 0.7468138337 x4.360982895 0.7473018169 x4.361575603 0.7477898002 x4.362253189 0.7482777834 x4.362762451 0.7487657666 x4.363440037 0.7492537498 x4.364032269 0.7497417331 x4.364626884 0.7502297163 x4.365135193 0.7507176995 x4.365727901 0.7512056828 x4.366322041 0.751693666 x4.366915703 0.7521816492 x4.367509842 0.7526696324 x4.368103027 0.7531576157 x4.368697166 0.7536455989 0.7541335821 x4.369884491 0.7546215653 x4.37039423 0.7551095486 x4.371073723 0.7555975318 x4.371668339 0.756085515 x4.372262001 0.7565734982 x4.37277174 0.7570614815 x4.373365879 0.7575494647 x4.373960495 0.7580374479 0.7585254312 x4.37514925 0.7590134144 x4.37574482 0.7595013976 x4.376254559 0.7599893808 x4.376934052 0.7604773641 x4.377444744 0.7609653473 x4.378039837 0.7614533305 0.7619413137 x4.379230976 0.762429297 x4.379826069 0.7629172802 x4.380335808 0.7634052634 x4.381016254 0.7638932467 x4.381527424 0.7643812299 x4.38203764 0.7648692131 x4.382717609 0.7653571963 x4.383229733 0.7658451796 x4.383910656 0.7663331628 x4.384421825 0.766821146 x4.385017872 0.7673091292 x4.385613441 0.7677971125 x4.386124134 0.7682850957 x4.386805534 0.7687730789 x4.387316704 0.7692610621 x4.387913704 0.7697490454 x4.388510227 0.7702370286 x4.389021397 0.7707250118 x4.389618874 0.7712129951 x4.390129566 0.7717009783 x4.390726566 0.7721889615 0.7726769447 x4.39183569 0.773164928 x4.39243269 0.7736529112 x4.393028736 0.7741408944 x4.39362669 0.7746288776 x4.394223213 0.7751168609 x4.394735813 0.7756048441 x4.39533329 0.7760928273 x4.395844936 0.7765808105 x4.396441936 0.7770687938 x4.397040844 0.777556777 x4.397553444 0.7780447602 x4.398236275 0.7785327435 x4.398663521 0.7790207267 x4.399347305 0.7795087099 x4.399859905 0.7799966931 0.7804846764 x4.400970459 0.7809726596 x4.40156889 0.7814606428 x4.40208149 0.781948626 x4.402765751 0.7824366093 x4.403279305 0.7829245925 x4.403877258 0.7834125757 x4.404390335 0.7839005589 x4.404989243 0.7843885422 0.7848765254 x4.406101704 0.7853645086 x4.406699657 0.7858524919 x4.407213688 0.7863404751 x4.407813072 0.7868284583 x4.408412933 0.7873164415 x4.408925533 0.7878044248 x4.409524918 0.788292408 x4.410038948 0.7887803912 x4.410637856 0.7892683744 x4.411152363 0.7897563577 0.7902443409 x4.412351608 0.7907323241 x4.412780285 0.7912203074 x4.413466454 0.7917082906 x4.413980484 0.7921962738 x4.414494991 0.792684257 x4.415094376 0.7931722403 x4.415609837 0.7936602235 x4.416209698 0.7941482067 0.7946361899 x4.41732502 0.7951241732 x4.417925358 0.7956121564 x4.418353558 0.7961001396 x4.419040203 0.7965881228 x4.419555187 0.7970761061 x4.420156479 0.7975640893 x4.420671463 0.7980520725 0.7985400558 x4.421787739 0.799028039 x4.422302723 0.7995160222 0.8000040054 x4.423418999 0.8004919887 x4.423934937 0.8009799719 x4.424536228 0.8014679551 x4.425137997 0.8019559383 x4.425652981 0.8024439216 x4.426254272 0.8029319048 x4.42668438 0.803419888 x4.427286148 0.8039078712 x4.427888393 0.8043958545 x4.428404331 0.8048838377 x4.429005623 0.8053718209 x4.429522991 0.8058598042 x4.430038452 0.8063477874 x4.430640221 0.8068357706 x4.431156635 0.8073237538 0.8078117371 x4.432189941 0.8082997203 x4.432878017 0.8087877035 x4.433394432 0.8092756867 x4.4339118 0.80976367 x4.434514523 0.8102516532 x4.434945107 0.8107396364 x4.435547352 0.8112276196 x4.436150551 0.8117156029 x4.436667442 0.8122035861 x4.437271118 0.8126915693 x4.437701225 0.8131795526 x4.438304901 0.8136675358 x4.438821793 0.814155519 x4.439424992 0.8146435022 x4.439942837 0.8151314855 x4.440459251 0.8156194687 x4.440977573 0.8161074519 x4.441581249 0.8165954351 x4.442098141 0.8170834184 x4.442702293 0.8175714016 x4.443133831 0.8180593848 x4.443737507 0.818547368 x4.444342613 0.8190353513 x4.444773674 0.8195233345 x4.445377827 0.8200113177 x4.445895672 0.820499301 x4.446413994 0.8209872842 x4.447017193 0.8214752674 x4.447449684 0.8219632506 x4.448053837 0.8224512339 x4.448572636 0.8229392171 0.8234272003 x4.44969511 0.8239151835 x4.450213909 0.8244031668 x4.450819969 0.82489115 x4.451251507 0.8253791332 x4.45185709 0.8258671165 x4.452375889 0.8263550997 x4.452894211 0.8268430829 x4.453499794 0.8273310661 x4.454017639 0.8278190494 x4.454537392 0.8283070326 x4.455142498 0.8287950158 x4.455575943 0.829282999 x4.456093788 0.8297709823 x4.456700325 0.8302589655 x4.457218647 0.8307469487 x4.457738876 0.8312349319 x4.458258152 0.8317229152 0.8322108984 x4.45929718 0.8326988816 x4.45990324 0.8331868649 x4.460422993 0.8336748481 x4.460943222 0.8341628313 x4.461549759 0.8346508145 x4.46198225 0.8351387978 x4.462588787 0.835626781 x4.463109016 0.8361147642 x4.463542461 0.8366027474 x4.464149475 0.8370907307 x4.464669228 0.8375787139 x4.465189934 0.8380666971 x4.465796471 0.8385546803 x4.466229916 0.8390426636 x4.466836929 0.8395306468 x4.467356682 0.84001863 x4.467877865 0.8405066133 x4.468398571 0.8409945965 x4.468832493 0.8414825797 x4.469439983 0.8419705629 x4.46996069 0.8424585462 x4.470481873 0.8429465294 x4.471089363 0.8434345126 x4.471523285 0.8439224958 x4.472044468 0.8444104791 x4.472652435 0.8448984623 x4.473086357 0.8453864455 x4.473694324 0.8458744287 x4.4741292 0.846362412 x4.474736691 0.8468503952 x4.475257874 0.8473383784 x4.475692749 0.8478263617 x4.476301193 0.8483143449 x4.476822376 0.8488023281 x4.477344036 0.8492903113 0.8497782946 x4.478301048 0.8502662778 x4.478997231 0.850754261 x4.479432106 0.8512422442 x4.479953289 0.8517302275 x4.480475903 0.8522182107 x4.480997086 0.8527061939 x4.481606483 0.8531941772 x4.482042313 0.8536821604 x4.482564449 0.8541701436 x4.483086109 0.8546581268 0.8551461101 x4.484130859 0.8556340933 0.8561220765 x4.485176086 0.8566100597 0.857098043 x4.486221313 0.8575860262 x4.486657143 0.8580740094 x4.487266541 0.8585619926 x4.487789154 0.8590499759 x4.488312721 0.8595379591 x4.488835335 0.8600259423 x4.489271164 0.8605139256 x4.489881039 0.8610019088 x4.490316868 0.861489892 x4.490840435 0.8619778752 x4.491363525 0.8624658585 x4.491887093 0.8629538417 x4.492497444 0.8634418249 x4.492933273 0.8639298081 x4.493457317 0.8644177914 x4.493980885 0.8649057746 0.8653937578 x4.495028496 0.865881741 x4.495463848 0.8663697243 x4.496075153 0.8668577075 x4.496599674 0.8673456907 x4.49703598 0.867833674 x4.497560024 0.8683216572 x4.498083591 0.8688096404 x4.498520851 0.8692976236 x4.499132156 0.8697856069 x4.499568939 0.8702735901 x4.500180721 0.8707615733 x4.500617504 0.8712495565 x4.501142025 0.8717375398 0.872225523 0.8727135062 x4.502716064 0.8732014894 x4.503240108 0.8736894727 x4.503765106 0.8741774559 x4.504201889 0.8746654391 x4.50472641 0.8754270077 x4.505251408 0.8759160042 0.8764050007 x4.506213665 0.8768939972 x4.506825924 0.8773829937 x4.507264137 0.8778719902 x4.507789135 0.8783609867 0.8788499832 x4.508752346 0.8793389797 x4.509277344 0.8798279762 0.8803169727 x4.510240078 0.8808059692 x4.510854244 0.8812949657 x4.511291504 0.8817839622 x4.511816978 0.8822729588 x4.51234293 0.8827619553 0.8832509518 x4.513306618 0.8837399483 x4.513833046 0.8842289448 x4.514358521 0.8847179413 0.8852069378 x4.515322685 0.8856959343 x4.51584816 0.8861849308 x4.516374588 0.8866739273 0.8871629238 0.8876519203 x4.517865658 0.8881409168 x4.518392086 0.8886299133 0.8891189098 x4.519357204 0.8896079063 x4.519884109 0.8900969028 x4.520410061 0.8905858994 x4.520849228 0.8910748959 x4.521463394 0.8915638924 x4.521903515 0.8920528889 x4.522429466 0.8925418854 x4.522956371 0.8930308819 x4.523396015 0.8935198784 x4.523922443 0.8940088749 x4.52436161 0.8944978714 x4.524888992 0.8949868679 x4.525415897 0.8954758644 x4.525856018 0.8959648609 x4.526382923 0.8964538574 0.8969428539 x4.527349472 0.8974318504 x4.527965546 0.8979208469 x4.528404713 0.8984098434 x4.528844357 0.89889884 x4.529460907 0.8993878365 x4.529811859 0.899876833 x4.530426979 0.9003658295 x4.5308671 0.900854826 0.9013438225 x4.531923294 0.901832819 x4.532362938 0.9023218155 x4.532890797 0.902810812 x4.533330917 0.9032998085 x4.533859253 0.903788805 x4.534387112 0.9042778015 x4.534828663 0.904766798 x4.535356522 0.9052557945 0.905744791 x4.536236286 0.9062337875 x4.536853313 0.906722784 x4.537294388 0.9072117805 x4.537822247 0.9077007771 x4.538262844 0.9081897736 x4.53879118 0.9086787701 x4.539232254 0.9091677666 x4.539761543 0.9096567631 x4.540290356 0.9101457596 x4.540819645 0.9106347561 x4.541259766 0.9111237526 x4.54170084 0.9116127491 x4.542230129 0.9121017456 x4.54267025 0.9125907421 x4.543200493 0.9130797386 x4.543729305 0.9135687351 x4.54417038 0.9140577316 x4.544700146 0.9145467281 x4.54514122 0.9150357246 x4.545670509 0.9155247211 x4.546112537 0.9160137177 x4.546641827 0.9165027142 x4.547083378 0.9169917107 x4.547613144 0.9174807072 x4.548054695 0.9179697037 x4.548584461 0.9184587002 x4.549025536 0.9189476967 x4.549467564 0.9194366932 x4.54999733 0.9199256897 x4.550528049 0.9204146862 x4.550969124 0.9209036827 x4.551499844 0.9213926792 x4.551941395 0.9218816757 x4.552472115 0.9223706722 x4.553002357 0.9228596687 x4.553355694 0.9233486652 x4.553974628 0.9238376617 x4.55441618 0.9243266582 x4.554858685 0.9248156548 x4.555389881 0.9253046513 x4.555831909 0.9257936478 x4.55627346 0.9262826443 x4.556805611 0.9267716408 x4.557246685 0.9272606373 x4.557778358 0.9277496338 x4.558309078 0.9282386303 x4.558751583 0.9287276268 x4.559282303 0.9292166233 x4.559725285 0.9297056198 0.9301946163 x4.560698986 0.9306836128 x4.561141968 0.9311726093 x4.561673641 0.9316616058 x4.562116623 0.9321506023 x4.562559128 0.9326395988 x4.563091278 0.9331285954 x4.563533783 0.9336175919 x4.564065456 0.9341065884 x4.564508438 0.9345955849 0.9350845814 x4.565483093 0.9355735779 x4.56601572 0.9360625744 x4.566458702 0.9365515709 x4.566902637 0.9370405674 x4.567345142 0.9375295639 x4.567788601 0.9380185604 x4.568409443 0.9385075569 x4.568853378 0.9389965534 x4.56929636 0.9394855499 x4.569828987 0.9399745464 x4.570183754 0.9404635429 x4.570716858 0.9409525394 x4.571248531 0.9414415359 x4.571692467 0.9419305325 x4.572135925 0.942419529 x4.572669506 0.9429085255 x4.573023796 0.943397522 x4.5735569 0.9438865185 x4.574001312 0.944375515 x4.574533463 0.9448645115 x4.574977875 0.945353508 0.9458425045 x4.575954914 0.946331501 x4.576399326 0.9468204975 x4.576843262 0.947309494 x4.577376842 0.9477984905 x4.577820778 0.948287487 x4.578265667 0.9487764835 x4.578798771 0.94926548 x4.579243183 0.9497544765 x4.579776287 0.9502434731 x4.580221653 0.9507324696 x4.580666065 0.9512214661 x4.581110954 0.9517104626 x4.581644058 0.9521994591 x4.582088947 0.9526884556 x4.582534313 0.9531774521 x4.583067417 0.9536664486 x4.583512306 0.9541554451 x4.583958149 0.9546444416 x4.584403038 0.9551334381 x4.584936619 0.9556224346 x4.585381985 0.9561114311 x4.585826874 0.9566004276 x4.586272717 0.9570894241 x4.586807251 0.9575784206 x4.587162495 0.9580674171 x4.587697506 0.9585564137 x4.588231564 0.9590454102 x4.588676929 0.9595344067 0.9600234032 x4.589568615 0.9605123997 x4.590013504 0.9610013962 x4.590548038 0.9614903927 x4.590993881 0.9619793892 0.9624683857 x4.591974735 0.9629573822 x4.592331409 0.9634463787 x4.592866421 0.9639353752 x4.593400955 0.9644243717 x4.593758106 0.9649133682 x4.594293118 0.9654023647 x4.59473896 0.9658913612 x4.595185757 0.9663803577 x4.595630169 0.9668693542 x4.596077919 0.9673583508 x4.596612453 0.9678473473 x4.597058773 0.9683363438 x4.597504616 0.9688253403 x4.597951889 0.9693143368 x4.598487377 0.9698033333 x4.598844051 0.9702923298 x4.599379539 0.9707813263 x4.599826336 0.9712703228 0.9717593193 0.9722483158 x4.601255417 0.9727373123 x4.601613045 0.9732263088 x4.60214901 0.9737153053 x4.602596283 0.9742043018 x4.603042603 0.9746932983 x4.603489876 0.9751822948 x4.603936195 0.9756712914 x4.604383469 0.9761602879 0.9766492844 x4.605366707 0.9771382809 x4.60581398 0.9776272774 0.9781162739 x4.60670805 0.9786052704 x4.607155323 0.9790942669 x4.607692242 0.9795832634 x4.60804987 0.9800722599 x4.608497143 0.9805612564 x4.609033585 0.9810502529 x4.609481812 0.9815392494 x4.609929562 0.9820282459 x4.610376358 0.9825172424 x4.610824585 0.9830062389 x4.611271858 0.9834952354 0.9839842319 x4.612166882 0.9844732285 x4.612614155 0.984962225 x4.613152027 0.9854512215 x4.613599777 0.985940218 0.9864292145 0.986918211 0.9874072075 x4.615391254 0.987896204 0.9883852005 x4.616287231 0.988874197 x4.616735458 0.9893631935 0.98985219 0.9903411865 x4.618169785 0.990830183 x4.618528843 0.9913191795 x4.61897707 0.991808176 0.9922971725 x4.619874001 0.9927861691 x4.620322227 0.9932751656 x4.620861053 0.9937641621 x4.621219158 0.9942531586 x4.621757507 0.9947421551 x4.622206211 0.9952311516 x4.622655392 0.9957201481 x4.623104095 0.9962091446 0.9966981411 0.9971871376 0.9976761341 x4.624899387 0.9981651306 x4.625258446 0.9986541271 x4.625796795 0.9991431236 x4.626245975 0.9996321201 x4.626694679 1.000121117}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup5
  xpos 1687
  ypos -144
 }
 ColorLookup {
  lut {master {curve 0 x0.0004885200178 0.2387765646 0.4148833752 0.5420714617 0.6412561536 0.7223628759 x0.002931120107 0.7907615304 0.8497875929 0.901545465 0.9475708604 0.9889578223 x0.00537372008 1.026453614 x0.005862240214 1.060686827 1.092133164 x0.006839280017 1.121196389 x0.007327800151 1.148180604 1.173315167 1.196839452 1.2189219 1.239685535 1.25934577 x0.0102589 1.27796483 x0.01074740011 1.295690775 1.312517881 1.328612924 1.343970418 1.358654141 1.372731566 x0.01367860008 1.386248708 x0.01416710019 1.399241447 1.411761403 1.423766017 1.435409069 1.446580768 1.457397461 1.467849374 1.477956772 1.487740874 1.497267246 1.506456375 1.51536119 x0.02002930082 1.524064898 x0.0205178 1.532444 1.540672779 1.548612595 1.556410909 1.563942194 1.571295142 1.578481674 1.585468531 1.592283487 1.598956227 1.60543716 1.611786366 1.617986917 1.624068141 x0.02735709958 1.629997015 x0.02784560062 1.635787487 1.641469955 1.64702785 1.652442455 1.657778025 1.662984014 1.668141246 1.673118591 1.678028345 1.682837605 1.687577724 1.692216158 1.696750879 1.701264262 1.705623031 1.709926248 1.714139819 1.718313217 1.722379088 1.726404071 1.730370283 1.734244347 1.738059402 1.741814256 x0.03957010061 1.745526195 x0.04005860165 1.749126434 1.752716899 1.756246448 1.759713888 1.763136506 1.766479731 1.769794703 1.773046494 1.776251912 1.779445887 1.782541275 1.785589814 1.788643479 1.791632295 1.794573307 1.797448993 1.800329208 1.803143859 1.805909991 1.808662534 1.811383724 1.814073801 1.816696882 1.819288135 1.821829915 1.824356914 1.826870203 1.829350829 1.831799269 1.834178925 x0.05471419916 1.836580157 x0.0552027002 1.838912129 1.841265321 1.843531609 1.845800281 1.848036051 1.850237966 1.85240674 1.854578257 1.856697321 1.858801126 1.860925078 1.862960339 1.86501658 1.86700201 1.869007945 1.870942473 1.872915745 1.874854684 1.876758695 1.878628373 1.880481243 1.882317424 1.884137511 1.885940671 1.887727022 1.889496446 1.891212583 1.892985225 1.894685745 1.896350861 1.8980546 1.899703741 1.901336312 1.902970076 1.904567957 1.906167269 1.907712102 1.909313917 1.910842538 1.912372589 1.913903594 1.915360808 1.916857004 1.918354154 1.919777632 1.92125833 1.922664881 1.924072981 x0.07865169644 1.925481796 x0.07914020121 1.926853895 1.92824614 1.92960155 1.930957913 1.932296395 1.933635473 1.934919119 1.936222315 1.937508225 1.938793898 1.94008112 1.941349864 1.942581773 1.943814158 1.945028782 1.946262717 1.94742167 1.948638082 1.949817896 1.95099771 1.952159524 1.953283668 1.954446793 1.955610275 1.956698895 1.957787275 1.958895802 1.960004807 1.96107614 1.962167025 1.963240027 1.96431303 1.965329051 1.966383815 1.967401266 1.968418837 1.969456434 1.970436811 1.971456051 1.97241807 1.973419428 1.974420905 1.975384116 1.976348519 1.977274299 1.978239059 1.979146719 1.980073929 1.981020927 1.981948853 1.982838392 1.983767509 1.984638929 1.985549092 1.986440659 1.987313032 1.988166571 1.98901999 1.989874244 1.990709305 1.991583347 1.992419124 x0.1094280034 1.993216515 x0.1099169999 1.994072676 1.994909525 1.995668411 1.996505857 1.997304916 1.998123288 1.998864532 1.999644876 2.000444889 2.00122571 2.001948357 2.002768755 2.003511667 2.004235029 2.00495863 2.005702257 2.006445885 2.0071702 2.007914543 2.008620262 2.009306192 2.010050774 2.010737658 2.01142478 2.012131214 2.012838125 2.013486147 2.014193535 2.014842272 2.015549898 2.016179323 2.016848087 2.017497778 2.018167019 2.01881671 2.019447327 2.020117044 2.020748138 2.021378994 2.02195096 2.022602081 2.023233891 2.023826122 2.02445817 2.025030851 2.025643349 2.026256084 2.026849031 2.027422667 2.02801609 2.028609991 2.029164076 2.029758215 2.030312777 2.030926704 2.031442165 2.032036543 2.032572031 2.033107519 2.033682585 2.03421855 2.034754515 2.03529048 2.035826921 2.036362886 2.036899328 2.037436247 2.037932873 2.038469791 2.038967133 2.039464712 2.03998208 2.040479422 2.04097724 2.041475058 2.041993141 2.042511225 2.042969704 2.043447971 2.043946266 2.044425011 2.044903517 2.0453825 2.045841455 2.046340466 2.046799898 2.047278881 2.047738075 2.048157692 2.048617363 2.049057245 2.049536943 2.049956799 2.050416708 2.050857067 2.051316977 x0.1568150073 2.051777601 x0.1573030055 2.052178144 2.052618504 2.052998781 2.053459644 2.053880453 2.054281235 2.054742098 2.055142879 2.055544138 2.055965185 2.056366205 2.056787968 2.057168722 2.05761075 2.057971716 2.058353424 2.058794975 2.059156895 2.059538364 2.059900045 2.060302019 2.060683966 2.061085939 2.061447859 2.061830282 2.062192202 2.062574148 2.062936544 2.063339233 2.063661098 2.064023972 2.064406395 2.064768791 2.065110922 2.065453529 2.065856457 2.06615901 2.066522121 2.066884756 2.067227125 2.067590475 2.067913294 2.068235874 2.068558693 2.068922043 2.069244862 2.069588184 2.069911242 2.070234537 2.070557594 2.070921421 2.071203947 2.071527243 2.071890831 2.072174072 2.072497606 2.072820902 2.073104143 2.073387384 2.07375145 2.074014187 2.074378729 2.074641705 2.074965239 2.075289249 2.075572968 2.075876474 2.076139688 2.076463938 2.076787949 2.07707119 2.077355385 2.077639103 2.077963352 2.078226805 2.07857132 2.078834772 2.079119205 2.079402685 2.07968688 2.080011606 2.080295563 2.080579519 2.080843687 2.081127405 2.081431866 2.081696033 2.081980705 2.082265139 2.082549095 2.082834005 2.083057165 2.083402872 2.08366704 2.083910942 2.084195375 2.084480047 2.084764719 2.085049629 2.085273266 2.085557699 2.085842609 2.086107731 2.08637166 2.086616039 2.086921453 2.087206364 2.087450504 2.087674618 2.088000536 2.088224411 2.088510036 2.088754416 2.088998556 2.089284182 2.089528799 2.089793444 2.0900383 2.090283155 2.090568304 2.090833664 2.091078281 2.091322899 2.091567993 2.091832876 2.092077971 x0.2188570052 2.092302561 x0.2193450034 2.092588186 2.092792273 2.093078136 2.093302727 2.093547821 2.093833685 2.09403801 2.09430337 2.094528198 2.094794035 2.095018625 2.095263958 2.095509529 2.095754385 2.096020222 2.096204042 2.096470118 2.096735954 2.096920013 2.09718585 2.097411156 2.097656727 2.097881317 2.098086119 2.098352194 2.098598242 2.098823071 2.099027872 2.099273443 2.099519014 2.099744558 2.099929094 2.100174665 2.100399971 2.100625277 2.100850582 2.101117134 2.101322412 2.101526976 2.101773024 2.101998568 2.102203608 2.102429152 2.102654934 2.102880239 2.10310626 2.103290796 2.103536844 2.103742123 2.103967905 2.104172945 2.104398966 2.104583979 2.104830027 2.105035067 2.105260849 2.105466604 2.105692387 2.105897665 2.106082678 2.10630846 2.106534481 2.106719494 2.10696578 2.107151031 2.107336044 2.107541323 2.107788086 2.10799408 2.108199596 2.108384371 2.108631134 2.108795881 2.109022141 2.10920763 2.109413385 2.109618664 2.109803915 2.110009909 2.110236645 2.110421419 2.11060667 2.110812902 2.111039162 2.111203909 2.111430407 2.111595154 2.111821651 2.112027884 2.112213135 2.112419128 2.11260438 2.112789869 2.112995863 2.113202333 2.113387823 2.113573551 2.113758802 2.113965034 2.114109039 2.114356995 2.114542484 2.114748716 2.114892721 2.115078688 2.115243673 2.115470648 2.115635633 2.115801096 2.116048574 2.116213799 2.116358042 2.116564751 2.116750479 2.116977215 2.117142677 2.117328644 2.117493868 2.117679596 2.117845058 2.118051767 2.118216991 2.118381977 2.118588686 2.118795633 2.118939877 2.119125843 2.119291544 2.119477272 2.119683981 2.119828939 2.120014668 2.120201111 2.120366573 2.12055254 2.120738983 2.120883465 2.121090412 2.121235371 2.121421576 2.121587038 2.121773481 2.121938705 2.122104406 2.122269869 2.122456074 2.122601271 2.122766972 2.122953176 2.12313962 2.12328434 2.123450279 2.123636723 2.123823166 2.123988628 2.124133825 2.124279022 2.12448597 2.124631166 2.124796867 2.124962807 2.125128269 2.125315189 2.125460148 2.125646591 2.125792027 2.125957727 2.126102686 2.126289606 2.126434565 2.126579762 2.126745701 2.126932621 2.127077818 2.127223015 2.127388716 2.127575636 2.127741575 2.127866507 2.128053188 2.128219366 2.128364563 2.128489017 2.128655195 2.128841639 2.129008055 2.129153252 2.129298449 2.129444122 2.129609823 2.129776716 2.129901171 x0.3131409883 2.130087852 x0.3136300147 2.130233526 2.1303792 2.130524397 2.130690575 2.13083601 2.130981684 2.131127119 2.131293297 2.131438971 2.131584644 2.131750584 2.131917 2.132062435 2.132208109 2.132312059 2.132478476 2.132665396 2.132769823 2.132956743 2.133060932 2.133248329 2.133372784 2.133560419 2.13366437 2.133810282 2.133997202 2.134101629 2.134268045 2.134413481 2.134559393 2.134705305 2.134829998 2.134996653 2.135163069 2.135288239 2.135433912 2.135558844 2.135704517 2.135850191 2.135975122 2.13607955 2.136267185 2.13643384 2.136579752 2.136684179 2.136829853 2.136933804 2.137100458 2.137246609 2.137392759 2.137538671 2.137684345 2.137788534 2.137934446 2.138080835 2.138185024 2.138330936 2.138497829 2.13864398 2.138768673 2.138893843 2.139040232 2.139165163 2.139290571 2.139436245 2.139582396 2.139728546 2.139832973 2.139978647 2.140125275 2.140229702 2.140375614 2.140522003 2.140626192 2.140772104 2.140876532 2.141022921 2.141169071 2.141294479 2.14144063 2.141586781 2.141691446 2.141837358 2.141941786 2.142088175 2.142192602 2.142338753 2.142463923 2.142589569 2.14273572 2.142840147 2.142986536 2.143112183 2.143237114 2.143383741 2.143487692 2.143613815 2.143739223 2.143864393 2.143990278 2.14413619 2.144261837 2.144387245 2.144512892 2.144658804 2.144742966 2.144910574 2.144973278 2.145140409 2.145224094 2.145391464 2.145474911 2.145600796 2.145746946 2.145851851 2.145956278 2.146144629 2.146207333 2.14635396 2.146459103 2.146605492 2.146709919 2.146835566 2.146961212 2.147107601 2.147191763 2.147317171 2.147442579 2.147547483 2.14767313 2.147819757 2.147903681 2.14805007 2.148113012 2.148259878 2.148406506 2.148532391 2.148637056 2.148720741 2.148825884 2.148972034 2.149077177 2.149203062 2.149328709 2.149412394 2.14958024 2.149685144 2.149789572 2.149873972 2.150020361 2.150146484 2.15025115 2.150335073 2.15046072 2.150607824 2.150691748 2.150817394 2.150943279 2.151048183 2.151153088 2.151279211 2.151405096 2.151488781 2.151593924 2.151698589 2.151845455 2.151929617 2.152055264 2.152160406 2.15226531 2.152370214 2.152496338 2.152559042 2.152706146 2.152810812 2.152915955 2.153063297 2.15312624 2.153252125 2.15337801 2.153482914 2.153567076 2.15371418 2.153819323 2.153924227 2.154029131 2.154134274 2.154218197 2.15434432 2.154470444 2.154575586 2.154680014 2.154785633 2.154848576 2.15499568 2.155101061 2.155206203 2.155289888 2.155395031 2.155521154 2.155605555 2.155709982 2.155815601 2.155899763 2.156025887 2.156151772 2.156257153 2.156362534 2.156467438 2.15657258 2.156677723 2.156761646 2.156867027 2.15697217 2.157077312 2.157182455 2.157287836 2.157372236 2.15747714 2.157582283 2.157708406 2.157792807 2.157897949 2.157982349 2.15808773 2.158192635 2.158319235 2.158403158 2.158508301 2.158592701 2.158697844 2.158802986 2.158908367 2.158971786 2.159118652 2.159161091 2.159308434 2.159392834 2.159476995 2.159624338 2.159708738 2.159792662 2.159898043 2.159982443 2.160087824 2.160193443 2.160277367 2.160382509 2.16048789 2.160572052 2.16067791 2.160740852 2.160846233 2.160951376 x0.4377140105 2.161056995 x0.4382019937 2.161162376 2.161225319 2.161373377 2.161457777 2.16152072 2.16160512 2.161731482 2.161837101 2.161879063 2.162026644 2.162090063 2.162195444 2.162301064 2.162385225 2.162490606 2.162575006 2.162659168 2.162764788 2.162849188 2.162891388 2.163017988 2.163144588 2.163207769 2.163312912 2.16337657 2.16350317 2.163608789 2.16367197 2.16377759 2.163883209 2.163967133 2.16407299 2.164136171 2.164241791 2.164326191 2.16443181 2.164515972 2.164600372 2.164685011 2.164790869 2.164853811 2.164959669 2.16506505 2.16510725 2.16521287 2.165318489 2.165402889 2.165466309 2.16555047 2.16565609 2.165761709 2.165867329 2.165930986 2.166036367 2.166099787 2.166226864 2.166290283 2.166395664 2.166501284 2.166564941 2.166649342 2.166754723 2.16681838 2.166903019 2.167008638 2.167071581 2.167156458 2.167261839 2.167367697 2.167410135 2.167536974 2.167621374 2.167684555 2.167769432 2.167832613 2.167938471 2.168023109 2.168107748 2.168171406 2.168255329 2.168382406 2.168466806 2.168551683 2.168615103 2.16869998 2.168784142 2.168869019 2.168931723 2.1690166 2.169143677 2.169186115 2.169312954 2.169376612 2.169440031 2.169524908 2.169587851 2.169694424 2.169799805 2.169842243 2.169947863 2.170053244 2.170095921 2.170202017 2.170307636 2.170371532 2.170434713 2.170519352 2.170603991 2.170688629 2.170773029 2.170836926 2.170942545 2.170984983 2.171069622 2.171196699 2.171217918 2.171344995 2.171387196 2.171493292 2.17159915 2.171662807 2.171726227 2.171810865 2.171895742 2.171980619 2.17202282 2.172128916 2.172213316 2.172276974 2.172361851 2.17246747 2.172531128 2.172636986 2.172700644 2.172742844 2.17284894 2.172954798 2.172976017 2.173082113 2.173145533 2.173251629 2.173293829 2.173400164 2.173463583 2.173548222 2.173569441 2.173717737 2.173760414 2.173824072 2.173930168 2.174035788 2.174077988 2.174141884 2.17424798 2.17429018 2.174396276 2.174502373 2.174544811 2.174608707 2.174714088 2.174778461 2.174820662 2.174926519 2.174990177 2.175075054 2.175117254 2.175223589 2.175287008 2.175329924 2.175435543 2.175499439 2.175605297 2.175690174 2.17575407 2.175838709 2.175902605 2.175966024 2.176050901 2.176114559 2.176178217 2.176263094 2.17632699 2.176411629 2.176454306 2.176539421 2.17662406 2.176687717 2.176772594 2.176835775 2.17689991 2.177006006 2.177069664 2.177154541 2.17719698 2.177260876 2.177345991 2.17740941 2.177473307 2.177579403 2.17766428 2.177706957 2.177791834 2.177834272 2.177919149 2.177982807 2.178089142 2.17813158 2.178195477 2.178259373 2.178301573 2.178407431 2.178492546 2.178556442 2.178619862 2.178704977 2.178768873 2.178832531 2.178896666 2.178981304 2.17906642 2.179087639 2.179172516 2.179257631 2.179321289 2.179384947 2.179490805 2.179555178 2.179597616 2.179661512 2.179703951 2.179810286 2.179874182 2.179959059 2.180022955 2.180065393 2.18012929 2.180214167 2.180277824 2.180341482 2.180426836 2.180469275 2.180532932 2.180639505 2.180682182 2.180745602 2.180852175 2.180894613 2.180958271 2.181001186 2.181107521 2.181150198 2.181234598 2.181256294 2.181362629 2.181426525 2.181490183 2.181532621 2.181617975 2.181681871 2.181745768 2.181830645 2.181894064 2.181958437 2.182022095 2.18210721 2.182149887 2.182213545 2.182277441 2.182362318 2.182384014 2.182490587 2.182532787 2.182618141 2.182639599 2.182724237 2.182788134 2.18285203 2.182894468 2.182979584 2.183065176 2.183107615 2.183192968 2.183213949 2.183320522 2.183363199 2.183427095 2.18353343 2.183597565 2.183661222 2.183703899 2.183767796 2.183831692 2.183895588 2.183938265 2.184002161 2.1840868 2.184151173 2.184193373 2.184257269 2.184321165 2.184406757 2.184449196 2.184534311 2.184576988 2.184619427 2.184683561 2.184768677 2.184832811 2.18487525 2.184960604 2.185002804 2.185109615 2.185152292 2.185216427 2.185301542 2.185322762 2.185407877 2.185429573 2.185471773 2.185578346 2.1856215 2.185685158 2.185727358 2.185791254 2.185877085 2.185940981 2.186004877 2.186047792 2.18611145 2.186154127 2.186260939 2.186303377 2.186367512 2.186452866 2.186474085 2.1865592 2.186623096 2.186666012 2.18672967 2.186793566 2.186836481 2.186900377 2.186985731 2.187049627 2.187091827 2.187134743 2.187199354 2.187262774 2.187305927 2.187369823 2.187454939 2.187476397 2.18756175 2.187625647 2.187689543 2.187711 2.187774897 2.187838793 2.187902689 2.187945604 2.188009501 2.188095093 2.188158989 2.188158989 2.188244343 2.188308477 2.188372612 2.188393593 2.188478947 2.188521862 2.188585758 2.188649416 2.188713789 2.188777685 2.188842058 2.188884497 2.188948631 2.188991308 2.189033985 2.18909812 2.189161777 2.189247847 2.189290047 2.189354181 x0.6257939935 2.189397097 x0.6262819767 2.189460993 2.18950367 2.189567327 2.189610481 2.189631462 2.189716816 2.189781189 2.189845085 2.189866781 2.189994812 2.189994812 2.190037489 2.190122843 2.190165758 2.190251112 2.19027257 2.190357685 2.1904006 2.190464735 2.19052887 2.190571785 2.190635681 2.190699577 2.190742254 2.19078517 2.190827608 2.1909132 2.190956116 2.190999031 2.19104147 2.191105366 2.191148281 2.191212177 2.191276073 2.191319227 2.191383123 2.191426516 2.191468954 2.191575527 2.191596985 2.191639662 2.191682577 2.191789389 2.191789389 2.1918962 2.191939116 2.191960335 2.192046165 2.192067385 2.192109823 2.192174196 2.192259789 2.192302704 2.192323923 2.192409277 2.192430735 2.192494631 2.192537546 2.192623138 2.192644596 2.192708731 2.192751408 2.192794085 2.192858458 2.192901134 2.192965269 2.193050861 2.193114996 2.193114996 2.193179369 2.193222046 2.193285942 2.193328619 2.193435669 2.193435669 2.193500042 2.19354248 2.193585396 2.19364953 2.193692207 2.193734884 2.193799496 2.19386363 2.193906546 2.193949223 2.194013357 2.194077492 2.194120169 2.194184303 2.19422698 2.194270134 2.194291592 2.194377422 2.194441557 2.194441557 2.194505453 2.194591045 2.194612265 2.194655657 2.194719553 2.19476223 2.194826365 2.19486928 2.194933653 2.194976568 2.195040464 2.19508338 2.195126295 2.19516921 2.195211887 2.195275784 2.195340157 2.19538331 2.19540453 2.19549036 2.195533037 2.195575476 2.195640087 2.195661306 2.195725918 2.195768595 2.195768595 2.195875645 2.195918322 2.195939779 2.196004152 2.196046591 2.196132421 2.196154118 2.196175337 2.19623971 2.196282625 2.19634676 2.196389437 2.196453571 2.196496725 2.19656086 2.196624994 2.19666791 2.196710825 2.196710825 2.196796417 2.196817875 2.196882248 2.196924925 2.196967602 2.197031975 2.197053671 2.197139502 2.197139502 2.197203398 2.197268009 2.197310448 2.197353363 2.197417974 2.19746089 2.197503567 2.197524786 2.197589397 2.197610617 2.197696209 2.197739124 2.19778204 2.197824955 2.19788909 2.197953701 2.197953701 2.198039293 2.198060513 2.198125124 2.198168039 2.198210478 2.198210478 2.198275089 2.198317766 2.198360682 2.198425055 2.198489666 2.198532343 2.19857502 2.198596716 2.198639631 2.198704004 2.198746443 2.198746443 2.19885397 2.198896885 2.19896102 2.198982716 2.199025631 2.199068546 2.199132681 2.199132681 2.199218273 2.199261427 2.199325562 2.199347258 2.199390173 2.19943285 2.199475765 2.199540138 2.199583054 2.19960475 2.199647427 2.199690342 2.199754477 2.199775934 2.199862003 2.199883223 2.199926376 2.199969292 2.200033426 2.200076342 2.200097561 2.200140715 2.200183868 2.200247765 2.200291157 2.200334072 2.200376749 2.200398207 2.200462818 2.200505257 2.20054841 2.200591564 2.200612545 2.200677156 2.200720072 2.200762987 2.200784445 2.200827599 2.200870275 2.200934649 2.200999022 2.201041937 2.201084852 2.20110631 2.201149464 2.201213837 2.20125699 2.201299667 2.201320887 2.201363802 2.201428413 2.201450109 2.201514721 2.201514721 2.201578617 2.201621532 2.201664686 2.201729059 2.201750278 2.201793432 2.201836348 2.201879501 2.201900482 2.201965332 2.202008009 2.202029228 2.20209384 2.202115536 2.202180147 2.202222824 2.202265739 2.202308893 2.202330351 2.202394247 2.202415943 2.202459097 2.202544928 2.202587843 2.202587843 2.202609539 2.202695608 2.202695608 2.202759981 2.202802896 2.202845812 2.202909946 2.202931643 2.202952862 2.202996016 2.203060627 2.203081846 2.203125 2.203167677 2.203210592 2.2032969 2.2032969 2.203339577 2.20338273 2.20340395 2.203490019 2.203511715 2.203533173 2.203597546 2.203619003 2.203683615 2.203705072 2.203769684 2.203833818 2.203833818 2.203855515 2.203941584 2.203920126 2.203984261 2.204027414 2.204070568 2.204113007 2.204156399 2.204199076 2.204220533 2.204264164 2.204306841 2.204349995 2.20439291 2.204457521 2.204457521 2.204521894 2.204564571 2.204629421 2.204629421 2.204672098 2.20471549 2.204736471 2.204779625 2.204844236 2.204865694 2.204908848 2.204994917 2.204994917 2.205037832 2.205080986 2.205102444 2.205166817 2.205188513 2.205209494 2.205252886 2.205317259 2.205317259 2.205382109 2.205425024 2.205489635 2.205532551 2.205532551 2.20555377 2.205596924 2.205661297 2.205682993 2.205747366 2.205811739 2.20579052 2.205854893 2.205898046 2.205919504 2.20596242 2.206005573 2.206048489 2.206070185 2.206134796 2.206134796 2.206177473 2.206220865 2.206242323 2.206306934 2.20634985 2.20634985 2.206414461 2.206457376 2.206479073 2.206521749 2.206543446 2.20660758 2.206629515 2.206715822 2.206715822 2.206758261 2.206823349 2.206823349 2.206887245 2.206908941 2.206930637 2.206973791 2.207038403 2.207038403 2.207103014 2.207146168 2.207146168 2.207189083 2.207253695 2.207253695 2.207318306 2.207318306 2.207360983 2.207425833 2.207468748 2.207490444 2.207511902 2.207576275 2.207619667 2.207641125 2.207662106 2.207705736 2.207748652 2.207791805 2.207813263 2.207856417 2.207921028 2.207921028 2.207963705 2.208007097 2.208007097 2.20807147 2.208114862 2.208136082 2.208178997 2.208222389 2.208243847 2.208287001 2.208329916 2.208394527 2.208394527 2.208437681 2.208480358 2.208502054 2.208545208 2.208566904 2.208610058 2.208652735 2.208717585 2.208760738 2.208782434 2.208803654 2.208847046 2.208889961 2.208889961 2.208932638 2.208976269 2.208997488 2.209040642 2.209083796 2.209105492 2.209148407 2.209191561 2.209234476 2.209255934 2.209255934 2.209342241 2.209342241 2.209363461 2.209428549 2.209471226 2.20949316 2.209536076 2.209557533 2.209622622 2.209643602 2.209687233 2.209751129 2.209773302 2.20979476 2.20979476 2.209859371 2.209881067 2.209923983 2.209945679 2.210010052 2.209988594 2.210053205 2.210118294 2.210118294 2.210160971 2.210182428 2.210225821 2.210268736 2.210290432 2.210333347 2.210333347 2.210398436 2.210441351 2.210441351 2.210505962 2.210549116 2.210592031 2.210592031 2.210656643 2.210678339 2.210699797 2.210699797 2.210764647 2.2108078 2.2108078 2.210872173 2.210915565 2.210937262 2.210980415 2.210980415 2.211044788 2.211087942 2.211087942 2.211131096 2.21117425 2.211195707 2.211260557 2.211238861 2.211303473 2.211346865 2.211346865 2.211411476 2.211433172 x0.8754270077 2.211476564 x0.8759160042 2.211519003 2.211562157 2.211583853 2.211583853 2.211627007 2.211627007 2.21167016 2.21173501 2.211777925 2.211799622 2.211842775 2.211864233 2.211885691 2.211929083 2.211950541 2.21201539 2.21203661 2.212080002 2.212080002 2.212122917 2.212166309 2.212166309 2.212166309 2.212274075 2.212274075 2.212317228 2.212338686 2.212382078 2.212424994 2.21244669 2.212490082 2.212532997 2.212554693 2.212597847 2.212597847 2.212641001 2.212662458 2.212705851 2.212770224 2.212748528 2.212813854 2.212813854 2.212878466 2.212878466 2.212921381 2.212964296 2.212985992 2.212985992 2.213072538 2.213093996 2.213136911 2.213136911 2.213202238 2.213202238 2.213245153 2.213266611 2.213288307 2.21335268 2.213374376 2.213374376 2.213418007 2.213460922 2.213460922 2.213525534 2.213590145 2.213590145 2.213633299 2.213655233 2.213676929 2.213719845 2.213741541 2.213784695 2.213784695 2.213827848 2.213849306 2.213892698 2.213935614 2.21395731 2.214000702 2.214000702 2.21402216 2.214043617 2.214129925 2.214108229 2.214151144 2.214173079 2.214237928 2.214237928 2.214302778 2.214324236 2.21434617 2.214389324 2.214432478 2.214453697 2.214497328 2.214497328 2.214540243 2.214561701 2.214583397 2.214648247 2.214669943 2.214669943 2.214713097 2.21475625 2.214777708 2.214777708 2.214842319 2.214842319 2.214885712 2.214928865 2.214928865 2.214993715 2.215037107 2.215037107 2.215080261 2.215101957 2.215144634 2.215166807 2.215188265 2.215253353 2.215253353 2.215296268 2.215317965 2.21536088 2.21536088 2.215404272 2.215447187 2.215469122 2.215490818 2.215533972 2.215533972 2.215577126 2.215598583 2.215598583 2.215684652 2.215706587 2.215749979 2.215706587 2.215793133 2.215814352 2.215857983 2.215857983 2.215857983 2.215922594 2.215944529 2.215966225 2.216030836 2.216052532 2.216073751 2.216073751 2.216117144 2.21613884 2.216160297 2.216203451 2.216225147 2.216268778 2.216289997 2.216333151 2.216355085 2.216355085 2.216398478 2.216441393 2.216506004 2.216506004 2.216506004 2.216571093 2.216614485 2.216614485 2.216635942 2.216679096 2.21672225 2.21672225 2.216744184 2.216765404 2.216830492 2.216830492 2.21685195 2.216895342 2.216938734 2.216960192 2.217003107 2.217003107 2.217003107 2.217046499 2.217067957 2.217111349 2.217154741 2.217176199 2.21721983 2.21721983 2.217262745 2.217262745 2.217305899 2.217327595 2.217370749 2.217392683 2.217414141 2.217478752 2.217500448 2.217500448 2.21754384 2.21754384 2.21760869 2.21760869 2.217652082 2.217652082 2.217716694 2.217716694 2.217759609 2.217803478 2.217824936 2.217868328 2.217846632 2.217911482 2.217911482 2.21797657 2.21797657 2.218019247 2.218041182 2.218084574 2.218041182 2.218127489 2.218127489 2.218148947 2.218192577 2.218192577 2.21823597 2.218300819 2.218300819 2.218300819 2.218365908 2.218365908 2.218409061 2.218430519 2.218409061 2.218517065 2.218495369 2.218538761 2.218538761 2.218582153 2.218625069 2.218647003 2.218690157 2.218690157 2.218733549 2.218754768 2.218776703 2.218798399 2.218841553 2.218841553 2.218906403 2.218906403 2.218906403 2.218971491 2.218992949}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup4
  xpos 1687
  ypos -120
 }
push $N613d4800
 ColorLookup {
  lut {master {curve 0 x0.07829550654 0.0004885200178 x0.1255644411 0.0009770400357 x0.1629182994 0.001465560053 x0.1946251094 0.001954080071 x0.2225365937 0.002442600206 x0.2476679981 0.002931120107 x0.2706490457 0.003419640008 x0.291898936 0.003908160143 x0.3117240667 0.004396679811 x0.3303384185 0.00488519948 x0.3479231894 0.00537372008 x0.3646000922 0.005862240214 x0.3804890811 0.006350760348 x0.3956676722 0.006839280017 x0.4102255404 0.007327800151 x0.4242027104 0.007816320285 x0.4376649261 0.008304839954 x0.4506542981 0.008793359622 x0.4632052779 0.009281879291 x0.4753684998 0.00977039896 x0.4871484637 0.0102589 x0.4985902011 0.01074740011 x0.5097167492 0.01123590022 x0.5205316544 0.01172440033 x0.531072855 0.01221290044 x0.5413467884 0.01270140056 x0.5513679385 0.01318990067 x0.5611649752 0.01367860008 x0.5707364678 0.01416710019 x0.5800936222 0.0146556003 x0.5892787576 0.01514410041 x0.5982437134 0.01563259959 x0.6070277691 0.01612110063 x0.6156557202 0.01660960168 x0.6241110563 0.01709810272 x0.6324145794 0.01758660376 x0.6405571103 0.0180751048 x0.6485680938 0.01856360584 x0.6564334631 0.01905210689 x0.6641718149 0.01954060793 x0.671769917 0.02002930082 x0.6792741418 0.0205178 x0.6866391897 0.02100629918 x0.6938858628 0.02149479836 x0.7010501623 0.02198329754 x0.7080863714 0.02247179672 x0.7150031328 0.0229602959 x0.7218595147 0.02344879508 x0.7286023498 0.02393729426 x0.7352561951 0.02442579344 x0.7418102026 0.02491429262 x0.7482827306 0.0254027918 x0.75467062 0.02589129098 x0.7609781623 0.02637979016 x0.7672176957 0.02686828934 x0.7733713984 0.02735709958 x0.7794440985 0.02784560062 x0.7854563594 0.02833410166 x0.7913903594 0.0288226027 x0.7972437739 0.02931110375 x0.8030458093 0.02979960479 x0.8087865114 0.03028810583 x0.8144559264 0.03077660687 x0.8200684786 0.03126510978 x0.8256142139 0.03175361082 x0.831107378 0.03224211186 x0.8365386128 0.0327306129 x0.8419059515 0.03321911395 x0.8472325802 0.03370761499 x0.8525007367 0.03419611603 x0.8577090502 0.03468461707 x0.8628726602 0.03517311811 x0.8680076599 0.03566161916 x0.8730531931 0.0361501202 x0.8780848384 0.03663862124 x0.8830498457 0.03712712228 x0.8879733086 0.03761562333 x0.8928539753 0.03810412437 x0.897690773 0.03859262541 x0.9025005698 0.03908112645 x0.9072383642 0.03957010061 x0.9119469523 0.04005860165 x0.9166257977 0.04054710269 x0.9212474823 0.04103560373 x0.9258469939 0.04152410477 x0.9304051995 0.04201260582 x0.9349125624 0.04250110686 x0.9393862486 0.0429896079 x0.9438350201 0.04347810894 x0.9482398033 0.04396660998 x0.9526181817 0.04445511103 x0.9569416642 0.04494361207 x0.9612563252 0.04543211311 x0.9655336738 0.04592061415 x0.9697727561 0.0464091152 x0.9739825726 0.04689761624 x0.9781532288 0.04738611728 x0.9823126197 0.04787461832 x0.9864219427 0.04836311936 x0.9905095696 0.04885162041 x0.9945651889 0.04934012145 x0.9985982776 0.04982862249 x1.002598524 0.05031712353 x1.006555438 0.05080562457 x1.01050818 0.05129412562 x1.014426589 0.05178262666 x1.018320084 0.0522711277 x1.022168636 0.05275962874 x1.026031375 0.05324812979 x1.029827952 0.05373663083 x1.033618212 0.05422513187 x1.037391901 0.05471419916 x1.041128278 0.0552027002 x1.044837236 0.05569120124 x1.048528314 0.05617970228 x1.052201509 0.05666820332 x1.055846095 0.05715670437 x1.059471965 0.05764520541 x1.063058376 0.05813370645 x1.066646338 0.05862220749 x1.070214868 0.05911070853 x1.073732138 0.05959920958 x1.077260733 0.06008771062 x1.0807482 0.06057621166 x1.084214926 0.0610647127 x1.087671399 0.06155321375 x1.091117501 0.06204171479 x1.094531417 0.06253021955 x1.097913265 0.06301872432 x1.101283669 0.06350722909 x1.104653597 0.06399573386 x1.107979536 0.06448423862 x1.11131537 0.06497274339 x1.114606619 0.06546124816 x1.117896676 0.06594975293 x1.121152401 0.06643825769 x1.124406576 0.06692676246 x1.127625942 0.06741526723 x1.130832434 0.067903772 x1.134036779 0.06839227676 x1.137205482 0.06888078153 x1.140383363 0.0693692863 x1.14351356 0.06985779107 x1.146653056 0.07034629583 x1.149766564 0.0708348006 x1.152866483 0.07132330537 x1.155928969 0.07181181014 x1.159011006 0.0723003149 x1.162067413 0.07278881967 x1.165085912 0.07327732444 x1.168112397 0.07376582921 x1.171123624 0.07425433397 x1.174108028 0.07474283874 x1.177076936 0.07523134351 x1.180053473 0.07571984828 x1.183002591 0.07620835304 x1.185936093 0.07669685781 x1.188841701 0.07718536258 x1.191766024 0.07767386734 x1.194662452 0.07816237211 x1.197530508 0.07865169644 x1.200405598 0.07914020121 x1.203252435 0.07962870598 x1.206105828 0.08011721075 x1.208930373 0.08060571551 x1.211737752 0.08109422028 x1.214539647 0.08158272505 x1.217336416 0.08207122982 x1.220103383 0.08255973458 x1.222876906 0.08304823935 x1.225620389 0.08353674412 x1.228370309 0.08402524889 x1.231090069 0.08451375365 x1.23380363 0.08500225842 x1.23651123 0.08549076319 x1.239212394 0.08597926795 x1.241883159 0.08646777272 x1.244559646 0.08695627749 x1.247217417 0.08744478226 x1.249868631 0.08793328702 x1.252500772 0.08842179179 x1.255138636 0.08891029656 x1.257757306 0.08939880133 x1.260344386 0.08988730609 x1.26294899 0.09037581086 x1.265546799 0.09086431563 x1.268112659 0.0913528204 x1.270658731 0.09184132516 x1.273222327 0.09232982993 x1.275753617 0.0928183347 x1.278290033 0.09330683947 x1.280806065 0.09379534423 x1.28332746 0.094283849 x1.285828352 0.09477235377 x1.288308978 0.09526085854 x1.290807009 0.0957493633 x1.293284535 0.09623786807 x1.295741558 0.09672637284 x1.298202753 0.09721487761 x1.300643563 0.09770338237 x1.303089142 0.09819188714 x1.305513263 0.09868039191 x1.307929158 0.09916889668 x1.310336709 0.09965740144 x1.312723041 0.1001459062 x1.315139413 0.100634411 x1.317521691 0.1011229157 x1.319895267 0.1016114205 x1.322259903 0.1020999253 x1.324616194 0.10258843 x1.326937556 0.1030769348 x1.32928896 0.1035654396 x1.331631422 0.1040539443 x1.333964944 0.1045424491 x1.336263418 0.1050309539 x1.33857882 0.1055194587 x1.340872049 0.1060079634 x1.343168974 0.1064964682 x1.345430613 0.106984973 x1.347695708 0.1074734777 x1.349991322 0.1079619825 x1.352250934 0.1084504873 x1.354488015 0.108938992 x1.356742024 0.1094280034 x1.358973026 0.1099169999 x1.361207724 0.1104059964 x1.363406181 0.1108949929 x1.365634561 0.1113839895 x1.367840052 0.111872986 x1.370035648 0.1123619825 x1.372234941 0.112850979 x1.374410629 0.1133399755 x1.376589656 0.113828972 x1.378758788 0.1143179685 x1.380917907 0.114806965 x1.383066893 0.1152959615 x1.385232329 0.115784958 x1.387374401 0.1162739545 x1.389492512 0.116762951 x1.391626954 0.1172519475 x1.393751979 0.117740944 x1.395865917 0.1182299405 x1.397969604 0.118718937 x1.400062561 0.1192079335 x1.402158737 0.1196969301 x1.404244184 0.1201859266 x1.406346679 0.1206749231 x1.408410907 0.1211639196 x1.410478234 0.1216529161 x1.412548542 0.1221419126 x1.414594054 0.1226309091 x1.416642547 0.1231199056 x1.418680072 0.1236089021 x1.420720696 0.1240978986 x1.422764301 0.1245868951 x1.424782515 0.1250758916 x1.426804066 0.1255648881 x1.428800225 0.1260538846 x1.430813432 0.1265428811 x1.432815194 0.1270318776 x1.434805751 0.1275208741 x1.436785221 0.1280098706 x1.438767195 0.1284988672 x1.440780044 0.1289878637 x1.442739367 0.1294768602 x1.444687009 0.1299658567 x1.446651697 0.1304548532 x1.448604822 0.1309438497 x1.450546384 0.1314328462 x1.45249033 0.1319218427 x1.454436898 0.1324108392 x1.456386209 0.1328998357 x1.458295465 0.1333888322 x1.460235357 0.1338778287 x1.462135315 0.1343668252 x1.464051604 0.1348558217 x1.465956569 0.1353448182 x1.467849374 0.1358338147 x1.469744682 0.1363228112 x1.47162807 0.1368118078 x1.473528385 0.1373008043 x1.475401998 0.1377898008 x1.47726357 0.1382787973 x1.479127645 0.1387677938 x1.480993748 0.1392567903 x1.482848167 0.1397457868 x1.484719038 0.1402347833 x1.486563325 0.1407237798 x1.488409996 0.1412127763 x1.490244269 0.1417017728 x1.492080808 0.1421907693 x1.493919373 0.1426797658 x1.495731115 0.1431687623 x1.497545123 0.1436577588 x1.499361515 0.1441467553 x1.501179576 0.1446357518 x1.502956033 0.1451247483 x1.504778981 0.1456137449 x1.506574392 0.1461027414 x1.50835669 0.1465917379 x1.510156512 0.1470807344 x1.511914372 0.1475697309 x1.513688445 0.1480587274 x1.515479565 0.1485477239 x1.517243147 0.1490367204 x1.518994093 0.1495257169 x1.520761847 0.1500147134 x1.522516608 0.1505037099 x1.524258375 0.1509927064 x1.526002526 0.1514817029 x1.527763128 0.1519706994 x1.529481292 0.1524596959 x1.531231165 0.1529486924 x1.532953024 0.1534376889 x1.53467679 0.1539266855 x1.536387563 0.154415682 x1.538085103 0.1549046785 x1.539814711 0.155393675 x1.541516185 0.1558826715 x1.543219566 0.156371668 x1.544909596 0.1568150073 x1.546601415 0.1573030055 x1.548294902 0.1577910036 x1.549975395 0.1582790017 x1.551687837 0.1587669998 x1.553356886 0.159254998 x1.555027485 0.1597429961 x1.556684732 0.1602309942 x1.558359027 0.1607189924 x1.560019612 0.1612069905 x1.561682224 0.1616949886 x1.563315868 0.1621829867 x1.564981937 0.1626709849 x1.566619039 0.163158983 x1.568273306 0.1636469811 x1.569913864 0.1641349792 x1.571540594 0.1646229774 x1.573169231 0.1651109755 x1.574799776 0.1655989736 x1.576431751 0.1660869718 x1.578049898 0.1665749699 x1.579669595 0.167062968 x1.581275582 0.1675509661 x1.582883596 0.1680389643 x1.584477305 0.1685269624 x1.586072803 0.1690149605 x1.587685227 0.1695029587 x1.589268446 0.1699909568 x1.590868592 0.1704789549 x1.592454791 0.170966953 x1.594042778 0.1714549512 x1.595616579 0.1719429493 x1.597176313 0.1724309474 x1.598752975 0.1729189456 x1.600347519 0.1734069437 x1.601911545 0.1738949418 x1.603446007 0.1743829399 x1.60501349 0.1748709381 x1.606582284 0.1753589362 x1.608137131 0.1758469343 x1.609677672 0.1763349324 x1.611219406 0.1768229306 x1.612762928 0.1773109287 x1.614292145 0.1777989268 x1.615822554 0.178286925 x1.617370367 0.1787749231 x1.618872523 0.1792629212 x1.620422602 0.1797509193 x1.621943474 0.1802389175 x1.623465538 0.1807269156 x1.624972701 0.1812149137 x1.626497507 0.1817029119 x1.62800777 0.18219091 x1.629503489 0.1826789081 x1.630984306 0.1831669062 x1.632483006 0.1836549044 x1.634014726 0.1841429025 x1.63548398 0.1846309006 x1.636986494 0.1851188987 x1.638458371 0.1856068969 x1.639963508 0.186094895 x1.641438246 0.1865828931 x1.642898083 0.1870708913 x1.644375086 0.1875588894 x1.645837665 0.1880468875 x1.647333503 0.1885348856 x1.648798466 0.1890228838 x1.650248647 0.1895108819 x1.651716232 0.18999888 x1.653153181 0.1904868782 x1.654623032 0.1909748763 x1.656062245 0.1914628744 x1.657518744 0.1919508725 x1.658960223 0.1924388707 x1.660419703 0.1929268688 x1.661863327 0.1934148669 x1.663276315 0.1939028651 x1.664706826 0.1943908632 x1.666138411 0.1948788613 x1.667571425 0.1953668594 x1.668988943 0.1958548576 x1.670424342 0.1963428557 x1.671827793 0.1968308538 x1.673265696 0.1973188519 x1.674671769 0.1978068501 x1.676079035 0.1982948482 x1.677504063 0.1987828463 x1.678897262 0.1992708445 x1.680308342 0.1997588426 x1.681703568 0.2002468407 x1.683117032 0.2007348388 x1.684482098 0.201222837 x1.685864687 0.2017108351 x1.687264919 0.2021988332 x1.688666344 0.2026868314 x1.690052271 0.2031748295 x1.691406488 0.2036628276 x1.692810893 0.2041508257 x1.694183946 0.2046388239 x1.695541501 0.205126822 x1.696916461 0.2056148201 x1.698292613 0.2061028183 x1.699653268 0.2065908164 x1.701031566 0.2070788145 x1.702394485 0.2075668126 x1.703741908 0.2080548108 x1.705073476 0.2085428089 x1.706439495 0.209030807 x1.707806826 0.2095188051 x1.709141493 0.2100068033 x1.710494399 0.2104948014 x1.711831331 0.2109827995 x1.713185668 0.2114707977 x1.714525104 0.2119587958 x1.715865016 0.2124467939 x1.717172503 0.212934792 x1.7185148 0.2134227902 x1.719841242 0.2139107883 x1.721168518 0.2143987864 x1.722480178 0.2148867846 x1.723792791 0.2153747827 x1.725122929 0.2158627808 x1.726437688 0.2163507789 x1.727753162 0.2168387771 x1.729069948 0.2173267752 x1.730370283 0.2178147733 x1.731672049 0.2183027714 x1.732974648 0.2188570052 x1.734312057 0.2193450034 x1.735583186 0.2198330015 x1.736888647 0.2203209996 x1.7381953 0.2208089978 x1.739468694 0.2212969959 x1.740759969 0.221784994 x1.742035627 0.2222729921 x1.743345737 0.2227609903 x1.744606018 0.2232489884 x1.745901346 0.2237369865 x1.747197509 0.2242249846 x1.748460293 0.2247129828 x1.749724388 0.2252009809 x1.750989199 0.225688979 x1.752289057 0.2261769772 x1.753538728 0.2266649753 x1.754806638 0.2271529734 x1.756091714 0.2276409715 x1.757344127 0.2281289697 x1.758597374 0.2286169678 x1.759851217 0.2291049659 x1.761106253 0.2295929641 x1.762362003 0.2300809622 x1.763618946 0.2305689603 x1.764858961 0.2310569584 x1.766117573 0.2315449566 x1.767342329 0.2320329547 x1.768602371 0.2325209528 x1.769863605 0.2330089509 x1.771073699 0.2334969491 x1.772301912 0.2339849472 x1.773548722 0.2344729453 x1.774778605 0.2349609435 x1.776009083 0.2354489416 x1.777223587 0.2359369397 x1.778456211 0.2364249378 x1.779671788 0.236912936 x1.780906081 0.2374009341 x1.782123804 0.2378889322 x1.783341885 0.2383769304 x1.784561396 0.2388649285 x1.785781503 0.2393529266 x1.787002325 0.2398409247 x1.788206577 0.2403289229 x1.789394617 0.240816921 x1.790617585 0.2413049191 x1.79182446 0.2417929173 x1.793014646 0.2422809154 x1.794222951 0.2427689135 x1.795396805 0.2432569116 x1.796624541 0.2437449098 x1.797799945 0.2442329079 x1.798994064 0.244720906 x1.800206304 0.2452089041 x1.801366806 0.2456969023 x1.802545309 0.2461849004 x1.803742647 0.2466728985 x1.804940343 0.2471608967 x1.806121349 0.2476488948 x1.807285786 0.2481368929 x1.808450699 0.248624891 x1.809651732 0.2491128892 x1.810817957 0.2496008873 x1.811985135 0.2500888705 x1.813153148 0.2505768538 x1.814321995 0.251064837 x1.815490961 0.2515528202 x1.816661477 0.2520408034 x1.817832351 0.2525287867 x1.818968296 0.2530167699 x1.820140839 0.2535047531 x1.821278691 0.2539927363 x1.822452307 0.2544807196 x1.823609233 0.2549687028 x1.824749112 0.255456686 x1.82590735 0.2559446692 x1.827048421 0.2564326525 x1.828208327 0.2569206357 x1.829350829 0.2574086189 x1.830511689 0.2578966022 x1.831619978 0.2583845854 x1.832782865 0.2588725686 x1.833928347 0.2593605518 x1.83505702 0.2598485351 x1.836185217 0.2603365183 x1.837315321 0.2608245015 x1.838427663 0.2613124847 x1.839594364 0.261800468 x1.840726137 0.2622884512 x1.841840625 0.2627764344 x1.842955709 0.2632644176 x1.844071507 0.2637524009 x1.845206141 0.2642403841 x1.846323252 0.2647283673 x1.84744072 0.2652163506 x1.84855926 0.2657043338 x1.849678397 0.266192317 x1.850780129 0.2666803002 x1.851882458 0.2671682835 x1.85300386 0.2676562667 x1.854107261 0.2681442499 x1.855212092 0.2686322331 0.2691202164 x1.857404113 0.2696081996 x1.858510733 0.2700961828 x1.859635711 0.270584166 x1.860707045 0.2710721493 x1.861815095 0.2715601325 x1.862905979 0.2720481157 x1.863978982 0.272536099 x1.865107536 0.2730240822 x1.86618185 0.2735120654 x1.867275596 0.2740000486 x1.86836946 0.2744880319 x1.869445562 0.2749760151 x1.870540619 0.2754639983 x1.871618509 0.2759519815 x1.872678161 0.2764399648 x1.873775482 0.276927948 x1.874854684 0.2774159312 x1.875916362 0.2779039145 x1.877015352 0.2783918977 x1.878078222 0.2788798809 x1.879141808 0.2793678641 x1.880206108 0.2798558474 x1.881289363 0.2803438306 x1.882354736 0.2808318138 0.281319797 x1.884486794 0.2818077803 x1.885516882 0.2822957635 x1.886603236 0.2827837467 x1.887653112 0.2832717299 x1.888703704 0.2837597132 x1.889773369 0.2842476964 x1.890806556 0.2847356796 x1.891876817 0.2852236629 x1.892948389 0.2857116461 x1.894001842 0.2861996293 x1.895018697 0.2866876125 x1.89607358 0.2871755958 0.287663579 x1.898165822 0.2881515622 x1.8992033 0.2886395454 x1.900260448 0.2891275287 x1.901299238 0.2896155119 x1.902338862 0.2901034951 x1.90335989 0.2905914783 x1.904400587 0.2910794616 x1.905441642 0.2915674448 x1.906464934 0.292055428 x1.907507181 0.2925434113 x1.908549905 0.2930313945 x1.909556508 0.2935193777 x1.910600185 0.2940073609 x1.91162622 0.2944953442 0.2949833274 x1.913679481 0.2954713106 x1.914706826 0.2959592938 x1.915716171 0.2964472771 x1.916744471 0.2969352603 x1.917755365 0.2974232435 0.2979112267 x1.919777632 0.29839921 x1.920808315 0.2988871932 x1.921839714 0.2993751764 x1.922815084 0.2998631597 x1.92382884 0.3003511429 x1.924861908 0.3008391261 x1.925838828 0.3013271093 x1.926853895 0.3018150926 x1.927851081 0.3023030758 x1.928866982 0.302791059 x1.929865122 0.3032790422 x1.930882215 0.3037670255 x1.931862593 0.3042550087 x1.932880998 0.3047429919 x1.933843017 0.3052309752 x1.93484354 0.3057189584 x1.93584466 0.3062069416 x1.936865211 0.3066949248 x1.937829375 0.3071829081 x1.938832045 0.3076708913 x1.939834833 0.3081588745 x1.940819502 0.3086468577 x1.941785693 0.309134841 x1.942752004 0.3096228242 x1.943757415 0.3101108074 x1.944744229 0.3105987906 x1.945712209 0.3110867739 x1.946699739 0.3115747571 x1.947706819 0.3120627403 x1.948676229 0.3125507236 x1.949627519 0.3131409883 x1.950617194 0.3136300147 x1.951588273 0.314119041 x1.95255959 0.3146080673 x1.953550339 0.3150970936 x1.954504251 0.3155861199 x1.955477238 0.3160751462 x1.956450105 0.3165641725 x1.957405329 0.3170531988 x1.958398819 0.3175422251 x1.959335327 0.3180312514 x1.960310936 0.3185202777 x1.961267352 0.319009304 x1.962243915 0.3194983304 x1.963182211 0.3199873567 x1.964140296 0.320476383 x1.965098739 0.3209654093 x1.966038585 0.3214544356 x1.9669981 0.3219434619 x1.967957973 0.3224324882 x1.968918562 0.3229215145 x1.969860315 0.3234105408 x1.970821381 0.3238995671 x1.971744776 0.3243885934 x1.972726107 0.3248776197 x1.973669529 0.3253666461 x1.974594355 0.3258556724 x1.975557804 0.3263446987 x1.976483464 0.326833725 x1.977428675 0.3273227513 x1.978374481 0.3278117776 0.3283008039 x1.980267286 0.3287898302 x1.981194854 0.3292788565 x1.982122779 0.3297678828 x1.983051538 0.3302569091 x1.983980417 0.3307459354 x1.984910131 0.3312349617 x1.985878348 0.3317239881 x1.986809015 0.3322130144 x1.987700582 0.3327020407 x1.988631845 0.333191067 x1.989583135 0.3336800933 x1.990495563 0.3341691196 x1.991447687 0.3346581459 x1.992341757 0.3351471722 x1.993274808 0.3356361985 x1.994189262 0.3361252248 x1.995123267 0.3366142511 x1.996038675 0.3371032774 x1.996973515 0.3375923038 x1.997869968 0.3380813301 x1.998806119 0.3385703564 x1.999703169 0.3390593827 x2.000620365 0.339548409 x2.001518726 0.3400374353 x2.002436399 0.3405264616 x2.003335714 0.3410154879 x2.004273891 0.3415045142 x2.005173922 0.3419935405 x2.006054401 0.3424825668 x2.006974697 0.3429715931 x2.007875204 0.3434606194 x2.008796215 0.3439496458 x2.009678602 0.3444386721 x2.010600567 0.3449276984 x2.011522055 0.3454167247 x2.012405872 0.345905751 x2.01330924 0.3463947773 x2.014193535 0.3468838036 x2.015097618 0.3473728299 x2.015982389 0.3478618562 x2.016907215 0.3483508825 x2.017773151 0.3488399088 x2.018698692 0.3493289351 x2.019565821 0.3498179615 x2.020452738 0.3503069878 x2.021339893 0.3507960141 x2.022247076 0.3512850404 x2.023135185 0.3517740667 x2.024023533 0.352263093 x2.024912357 0.3527521193 x2.025781393 0.3532411456 x2.02667141 0.3537301719 x2.027560949 0.3542191982 x2.028451443 0.3547082245 x2.029322386 0.3551972508 x2.030213356 0.3556862772 x2.031065464 0.3561753035 x2.031957388 0.3566643298 x2.03283 0.3571533561 x2.03370285 0.3576423824 0.3581314087 x2.035469294 0.358620435 x2.036323309 0.3591094613 x2.03719759 0.3595984876 x2.03805232 0.3600875139 x2.038927555 0.3605765402 x2.039822578 0.3610655665 x2.040678501 0.3615545928 x2.041554689 0.3620436192 x2.042411089 0.3625326455 x2.043268681 0.3630216718 x2.044126034 0.3635106981 x2.044983625 0.3639997244 x2.045861483 0.3644887507 0.364977777 x2.0475986 0.3654668033 x2.048417568 0.3659558296 x2.049297094 0.3664448559 x2.050136805 0.3669338822 x2.051017284 0.3674229085 x2.051857471 0.3679119349 x2.052738428 0.3684009612 x2.053600073 0.3688899875 x2.054421425 0.3693790138 x2.055283308 0.3698680401 x2.056125641 0.3703570664 x2.056968689 0.3708460927 x2.057831287 0.371335119 x2.058674574 0.3718241453 x2.059538364 0.3723131716 x2.060362339 0.3728021979 x2.061226845 0.3732912242 x2.062071085 0.3737802505 x2.062916517 0.3742692769 x2.063761711 0.3747583032 x2.064587355 0.3752473295 x2.065433502 0.3757363558 x2.066300154 0.3762253821 x2.067106724 0.3767144084 x2.067953825 0.3772034347 x2.068781137 0.377692461 x2.069628954 0.3781814873 x2.070456505 0.3786705136 x2.071305275 0.3791595399 x2.072133541 0.3796485662 x2.072962523 0.3801375926 x2.073791981 0.3806266189 x2.074641705 0.3811156452 x2.075471163 0.3816046715 x2.076281548 0.3820936978 x2.077111959 0.3825827241 x2.077943087 0.3830717504 0.3835607767 x2.079605579 0.384049803 x2.080417395 0.3845388293 x2.081228971 0.3850278556 x2.082061768 0.3855168819 x2.082915068 0.3860059083 x2.083707571 0.3864949346 x2.084520817 0.3869839609 x2.085354567 0.3874729872 x2.086168051 0.3879620135 x2.087002754 0.3884510398 x2.08781743 0.3889400661 x2.08861208 0.3894290924 x2.089426756 0.3899181187 x2.090262413 0.390407145 x2.091078281 0.3908961713 x2.091894388 0.3913851976 x2.092710733 0.3918742239 x2.093507051 0.3923632503 0.3928522766 x2.095120907 0.3933413029 x2.095938683 0.3938303292 x2.096735954 0.3943193555 x2.097554207 0.3948083818 x2.098352194 0.3952974081 x2.099171162 0.3957864344 x2.099969625 0.3962754607 x2.100789547 0.396764487 x2.101567984 0.3972535133 x2.102387905 0.3977425396 x2.103188515 0.398231566 x2.103967905 0.3987205923 x2.104768515 0.3992096186 x2.105590105 0.3996986449 x2.106390715 0.4001876712 x2.107192278 0.4006766975 x2.107973337 0.4011657238 x2.108775377 0.4016547501 x2.109556913 0.4021437764 x2.110380411 0.4026328027 x2.111162901 0.403121829 x2.111924887 0.4036108553 x2.112748861 0.4040998816 x2.113511562 0.404588908 x2.11431551 0.4050779343 x2.11509943 0.4055669606 x2.115904093 0.4060559869 x2.116688728 0.4065450132 0.4070340395 x2.118258238 0.4075230658 x2.119043589 0.4080120921 0.4085011184 x2.120614529 0.4089901447 x2.121401072 0.409479171 x2.122166634 0.4099681973 x2.122973919 0.4104572237 x2.123740196 0.41094625 x2.124527454 0.4114352763 x2.125294685 0.4119243026 x2.126081944 0.4124133289 x2.126869917 0.4129023552 x2.127617121 0.4133913815 x2.128406048 0.4138804078 x2.129194736 0.4143694341 x2.12998414 0.4148584604 x2.13075304 0.4153474867 x2.131521702 0.415836513 x2.132270336 0.4163255394 x2.133060932 0.4168145657 x2.133851767 0.417303592 x2.134580374 0.4177926183 x2.135392189 0.4182816446 x2.136121273 0.4187706709 x2.136892319 0.4192596972 x2.137663603 0.4197487235 x2.138435125 0.4202377498 x2.139227867 0.4207267761 x2.139978647 0.4212158024 x2.140730381 0.4217048287 x2.141503096 0.422193855 0.4226828814 x2.143028259 0.4231719077 x2.143801689 0.423660934 x2.144554377 0.4241499603 x2.145307779 0.4246389866 x2.146060944 0.4251280129 x2.146814585 0.4256170392 0.4261060655 x2.148322582 0.4265950918 x2.149119139 0.4270841181 x2.149831772 0.4275731444 x2.150586605 0.4280621707 x2.151362658 0.4285511971 x2.152097464 0.4290402234 x2.152873993 0.4295292497 x2.153609276 0.430018276 x2.154365301 0.4305073023 x2.155142784 0.4309963286 x2.155857325 0.4314853549 x2.156614304 0.4319743812 x2.157372236 0.4324634075 x2.158108234 0.4329524338 x2.158866167 0.4334414601 x2.159624338 0.4339304864 x2.160361767 0.4344195127 0.4349085391 x2.161837101 0.4353975654 x2.162596226 0.4358865917 x2.163355589 0.436375618 x2.164093971 0.4368646443 x2.164811611 0.4373536706 x2.16555047 0.4377140105 x2.166290283 0.4382019937 x2.167050838 0.4386899769 x2.167769432 0.4391779602 x2.168509245 0.4396659434 x2.169228554 0.4401539266 x2.170011282 0.4406419098 x2.170710087 0.4411298931 x2.171451092 0.4416178763 x2.172213316 0.4421058595 x2.172933817 0.4425938427 x2.173675299 0.443081826 x2.174396276 0.4435698092 x2.175138712 0.4440577924 x2.175859928 0.4445457757 0.4450337589 x2.177303553 0.4455217421 x2.178046465 0.4460097253 x2.178768873 0.4464977086 x2.179512739 0.4469856918 x2.180235386 0.447473675 x2.180958271 0.4479616582 x2.181703091 0.4484496415 x2.182426691 0.4489376247 0.4494256079 x2.183874369 0.4499135911 x2.184598207 0.4504015744 x2.185322762 0.4508895576 x2.186047792 0.4513775408 x2.186772346 0.4518655241 x2.187476397 0.4523535073 x2.188201666 0.4528414905 x2.188927412 0.4533294737 x2.189631462 0.453817457 x2.190379381 0.4543054402 x2.191063166 0.4547934234 x2.191789389 0.4552814066 x2.19251585 0.4557693899 x2.193222046 0.4562573731 x2.193906546 0.4567453563 x2.194655657 0.4572333395 x2.19538331 0.4577213228 x2.196068048 0.458209306 x2.196796417 0.4586972892 x2.197503567 0.4591852725 x2.198210478 0.4596732557 x2.198918343 0.4601612389 x2.199647427 0.4606492221 x2.200355291 0.4611372054 x2.201041937 0.4616251886 x2.201771975 0.4621131718 x2.202480793 0.462601155 x2.203189373 0.4630891383 x2.203876972 0.4635771215 x2.204586267 0.4640651047 x2.205274582 0.4645530879 x2.206005573 0.4650410712 x2.206715822 0.4655290544 x2.207425833 0.4660170376 x2.208114862 0.4665050209 x2.208803654 0.4669930041 x2.209514618 0.4674809873 x2.210225821 0.4679689705 x2.210915565 0.4684569538 x2.211627007 0.468944937 x2.212338686 0.4694329202 x2.213029385 0.4699209034 x2.213698387 0.4704088867 x2.214410543 0.4708968699 x2.215101957 0.4713848531 x2.215793133 0.4718728364 x2.216484547 0.4723608196 x2.217197895 0.4728488028 x2.217868328 0.473336786 x2.218582153 0.4738247693 x2.219274282 0.4743127525 x2.219945431 0.4748007357 x2.220638275 0.4752887189 x2.221352577 0.4757767022 x2.222024202 0.4762646854 x2.222718 0.4767526686 x2.223389864 0.4772406518 x2.22410512 0.4777286351 x2.224799395 0.4782166183 x2.225471973 0.4787046015 x2.226166248 0.4791925848 x2.226861 0.479680568 x2.22755599 0.4801685512 x2.228229284 0.4806565344 x2.228924751 0.4811445177 x2.229598522 0.4816325009 x2.230272532 0.4821204841 x2.230968475 0.4826084673 x2.2316432 0.4830964506 0.4835844338 x2.233014584 0.484072417 x2.233689308 0.4845604002 x2.234364748 0.4850483835 x2.23501873 0.4855363667 x2.235716105 0.4860243499 0.4865123332 x2.237067699 0.4870003164 x2.237744331 0.4874882996 x2.238420248 0.4879762828 x2.239118814 0.4884642661 x2.239796162 0.4889522493 x2.240473032 0.4894402325 x2.241150379 0.4899282157 x2.241806269 0.490416199 x2.242483854 0.4909041822 x2.243161678 0.4913921654 x2.243817806 0.4918801486 x2.244496107 0.4923681319 x2.245174885 0.4928561151 x2.245853186 0.4933440983 x2.246510267 0.4938320816 x2.247189522 0.4943200648 x2.247824907 0.494808048 x2.2485044 0.4952960312 x2.249184132 0.4957840145 x2.249864101 0.4962719977 x2.250522137 0.4967599809 x2.251180649 0.4972479641 x2.251883268 0.4977359474 x2.252519369 0.4982239306 x2.253178596 0.4987119138 x2.253838062 0.4991998971 x2.254541159 0.4996878803 x2.255178928 0.5001758337 x2.255838156 0.5006638169 x2.256498337 0.5011518002 x2.257158041 0.5016397834 x2.257818699 0.5021277666 x2.258479118 0.5026157498 x2.259140015 0.5031037331 x2.259778976 0.5035917163 x2.260440111 0.5040796995 x2.261101007 0.5045676827 x2.26178503 0.505055666 x2.262424469 0.5055436492 x2.263086081 0.5060316324 x2.263726473 0.5065196157 x2.264410496 0.5070075989 x2.26505065 0.5074955821 x2.26569128 0.5079835653 x2.266354084 0.5084715486 x2.267017126 0.5089595318 x2.26767993 0.509447515 x2.268321276 0.5099354982 0.5104234815 x2.269604683 0.5109114647 x2.270290375 0.5113994479 x2.270932436 0.5118874311 x2.271552324 0.5123754144 x2.272194862 0.5128633976 x2.272881508 0.5133513808 x2.273524284 0.5138393641 x2.274167299 0.5143273473 x2.274788141 0.5148153305 x2.275431156 0.5153033137 x2.276074409 0.515791297 x2.276762724 0.5162792802 x2.277362108 0.5167672634 x2.278028488 0.5172552466 x2.278672457 0.5177432299 x2.279338837 0.5182312131 x2.279961109 0.5187191963 x2.280606031 0.5192071795 x2.281250715 0.5196951628 x2.281896114 0.520183146 x2.282541037 0.5206711292 x2.283186197 0.5211591125 x2.283787251 0.5216470957 x2.284455776 0.5221350789 x2.285079479 0.5226230621 x2.285725832 0.5231110454 x2.286371946 0.5235990286 x2.287018299 0.5240870118 x2.287642717 0.524574995 0.5250629783 x2.288914204 0.5255509615 x2.289539099 0.5260389447 x2.290209055 0.5265269279 x2.290812016 0.5270149112 x2.291459322 0.5275028944 x2.292107582 0.5279908776 x2.292733192 0.5284788609 x2.29333663 0.5289668441 x2.293985128 0.5294548273 x2.294589043 0.5299428105 x2.29523778 0.5304307938 x2.295886993 0.530918777 x2.296491146 0.5314067602 x2.297140598 0.5318947434 0.5323827267 x2.298394918 0.5328707099 x2.299000263 0.5333586931 x2.299650192 0.5338466763 0.5343346596 x2.300905943 0.5348226428 0.535310626 x2.302139997 0.5357986093 x2.302768469 0.5362865925 x2.30341959 0.5367745757 x2.304025888 0.5372625589 x2.304654837 0.5377505422 x2.305284262 0.5382385254 x2.305890799 0.5387265086 x2.306542873 0.5392144918 x2.307150126 0.5397024751 0.5401904583 x2.308387518 0.5406784415 0.5411664248 x2.309625387 0.541654408 x2.310233355 0.5421423912 x2.31086421 0.5426303744 0.5431183577 x2.31210351 0.5436063409 x2.312712193 0.5440943241 x2.313321114 0.5445823073 x2.313952446 0.5450702906 x2.314584017 0.5455582738 x2.315193415 0.546046257 x2.315802574 0.5465342402 x2.31641221 0.5470222235 x2.317022324 0.5475102067 x2.317654133 0.5479981899 x2.318264961 0.5484861732 x2.318852186 0.5489741564 x2.319463015 0.5494621396 x2.320073605 0.5499501228 x2.320706844 0.5504381061 x2.321317434 0.5509260893 x2.321905851 0.5514140725 x2.322539568 0.5519020557 x2.32315135 0.552390039 x2.323740482 0.5528780222 x2.324352026 0.5533660054 x2.324986219 0.5538539886 x2.32557559 0.5543419719 x2.326187849 0.5548299551 x2.326777458 0.5553179383 x2.327390194 0.5558059216 x2.328002691 0.5562939048 x2.328615427 0.556781888 x2.329228401 0.5572698712 0.5577578545 x2.330431938 0.5582458377 x2.331022978 0.5587338209 x2.33163619 0.5592218041 x2.33224988 0.5597097874 x2.33281827 0.5601977706 x2.333432436 0.5606857538 0.561173737 x2.334638357 0.5616617203 x2.335252523 0.5621497035 x2.335844755 0.5626376867 x2.336436749 0.56312567 x2.337051868 0.5636136532 x2.33762145 0.5641016364 x2.338236809 0.5645896196 x2.338851929 0.5650776029 x2.339422226 0.5655655861 x2.340038061 0.5660535693 x2.340631008 0.5665415525 x2.34124732 0.5670295358 x2.341817856 0.567517519 x2.342434406 0.5680055022 x2.343005419 0.5684934855 x2.343621969 0.5689814687 x2.344216347 0.5694694519 x2.344810247 0.5699574351 x2.345404387 0.5704454184 x2.345976114 0.5709334016 x2.34657073 0.5714213848 0.571909368 x2.347783089 0.5723973513 x2.348355293 0.5728853345 x2.348927736 0.5733733177 x2.349545956 0.5738613009 x2.350141525 0.5743492842 x2.350714445 0.5748372674 x2.351310253 0.5753252506 0.5758132339 x2.352479458 0.5763012171 x2.353075504 0.5767892003 x2.353672028 0.5772771835 x2.354245663 0.5777651668 x2.354841948 0.57825315 x2.35539341 0.5787411332 x2.35599041 0.5792291164 x2.356610298 0.5797170997 x2.357184649 0.5802050829 x2.357759237 0.5806930661 x2.358334064 0.5811810493 x2.358931303 0.5816690326 x2.359506369 0.5821570158 x2.360081673 0.582644999 x2.360656261 0.5831329823 x2.361277819 0.5836209655 x2.361853361 0.5841089487 0.5845969319 x2.363028049 0.5850849152 x2.363603354 0.5855728984 x2.364179611 0.5860608816 x2.364732981 0.5865488648 x2.365331888 0.5870368481 x2.365908623 0.5875248313 x2.36648488 0.5880128145 x2.367061615 0.5885007977 x2.367638588 0.588988781 x2.368238449 0.5894767642 x2.368769646 0.5899647474 x2.369347095 0.5904527307 0.5909407139 0.5914286971 x2.371103048 0.5919166803 x2.37165761 0.5924046636 x2.372235298 0.5928926468 x2.37283659 0.59338063 x2.37336874 0.5938686132 x2.373970509 0.5943565965 x2.374525547 0.5948445797 x2.375127554 0.5953325629 x2.375683069 0.5958205462 x2.376262188 0.5963085294 x2.376817942 0.5967965126 x2.377397299 0.5972844958 x2.377953529 0.5977724791 x2.378532887 0.5982604623 x2.379112482 0.5987484455 x2.379668713 0.5992364287 x2.380249262 0.599724412 x2.380829096 0.6002123952 x2.381362915 0.6007003784 x2.381942987 0.6011883616 x2.382523775 0.6016763449 x2.383057833 0.6021643281 x2.383661747 0.6026523113 x2.384196281 0.6031402946 x2.384777308 0.6036282778 x2.385358572 0.604116261 x2.385916471 0.6046042442 x2.386474609 0.6050922275 0.6055802107 x2.387614489 0.6060681939 x2.388173342 0.6065561771 x2.38873148 0.6070441604 x2.38929081 0.6075321436 x2.389849663 0.6080201268 x2.390432119 0.60850811 x2.390990734 0.6089960933 x2.391527414 0.6094840765 x2.392086506 0.6099720597 x2.392669678 0.610460043 x2.393205881 0.6109480262 x2.393789291 0.6114360094 x2.394349098 0.6119239926 x2.394886017 0.6124119759 x2.395469189 0.6128999591 x2.396006584 0.6133879423 x2.396567345 0.6138759255 x2.397127628 0.6143639088 x2.397688866 0.614851892 x2.398226261 0.6153398752 x2.398810387 0.6158278584 x2.399348021 0.6163158417 x2.399909496 0.6168038249 x2.400447369 0.6172918081 x2.401032448 0.6177797914 x2.401571035 0.6182677746 x2.402132511 0.6187557578 x2.402671099 0.619243741 x2.403233051 0.6197317243 0.6202197075 x2.404357433 0.6207076907 x2.404873371 0.6211956739 x2.405436039 0.6216836572 x2.406022072 0.6221716404 x2.406561375 0.6226596236 x2.407100916 0.6231476068 x2.407640696 0.6236355901 x2.408180237 0.6241235733 x2.408743382 0.6246115565 x2.409307241 0.6250995398 x2.40984726 0.6257939935 x2.410387516 0.6262819767 x2.410928011 0.6267699599 x2.411491632 0.6272579432 x2.412032366 0.6277459264 0.6282339096 0.6287218928 x2.413655043 0.6292098761 x2.414219618 0.6296978593 x2.414760828 0.6301858425 x2.415325642 0.6306738257 x2.41586709 0.631161809 x2.416384935 0.6316497922 x2.416926861 0.6321377754 x2.417492151 0.6326257586 x2.418034077 0.6331137419 x2.418576479 0.6336017251 x2.419118404 0.6340897083 0.6345776916 x2.420227051 0.6350656748 x2.420722246 0.635553658 x2.421288252 0.6360416412 x2.421830893 0.6365296245 x2.422373772 0.6370176077 x2.422917128 0.6375055909 x2.423460007 0.6379935741 x2.423979998 0.6384815574 x2.424523115 0.6389695406 x2.425066948 0.6394575238 x2.425610542 0.639945507 x2.426130533 0.6404334903 x2.426674366 0.6409214735 0.6414094567 x2.42776227 0.64189744 x2.428282976 0.6423854232 x2.428827047 0.6428734064 x2.429371834 0.6433613896 0.6438493729 x2.430437565 0.6443373561 x2.430982351 0.6448253393 x2.431527376 0.6453133225 x2.432048798 0.6458013058 x2.432593822 0.646289289 x2.433091879 0.6467772722 x2.433660984 0.6472652555 x2.434182644 0.6477532387 x2.434704542 0.6482412219 x2.435250282 0.6487292051 x2.435772419 0.6492171884 x2.436318398 0.6497051716 x2.436841011 0.6501931548 x2.437363386 0.650681138 x2.437909842 0.6511691213 x2.438432455 0.6516571045 x2.438979149 0.6521450877 x2.439478397 0.6526330709 x2.44002533 0.6531210542 x2.44052434 0.6536090374 x2.441071749 0.6540970206 x2.441595078 0.6545850039 0.6550729871 x2.442642212 0.6555609703 x2.443213463 0.6560489535 x2.443713427 0.6565369368 0.65702492 x2.444761753 0.6575129032 x2.445285797 0.6580008864 x2.44581008 0.6584888697 x2.446358442 0.6589768529 x2.446858883 0.6594648361 x2.447383404 0.6599528193 x2.447932005 0.6604408026 x2.448409557 0.6609287858 x2.448958397 0.661416769 x2.449483633 0.6619047523 x2.449984312 0.6623927355 x2.450534105 0.6628807187 x2.451059103 0.6633687019 x2.451560497 0.6638566852 x2.452110291 0.6643446684 x2.452636003 0.6648326516 x2.453114271 0.6653206348 x2.453687906 0.6658086181 x2.454190254 0.6662966013 x2.454692364 0.6667845845 x2.455218792 0.6672725677 0.667760551 x2.456247807 0.6682485342 x2.456774235 0.6687365174 x2.457300901 0.6692245007 x2.457827806 0.6697124839 x2.458306789 0.6702004671 x2.458858013 0.6706884503 x2.459385395 0.6711764336 x2.459888458 0.6716644168 x2.460391998 0.6721524 x2.460895061 0.6726403832 x2.461423159 0.6731283665 x2.461926699 0.6736163497 x2.462454796 0.6741043329 0.6745923162 x2.46348691 0.6750802994 x2.464015007 0.6755682826 0.6760562658 x2.465047598 0.6765442491 x2.46555233 0.6770322323 x2.466056824 0.6775202155 x2.466584921 0.6780081987 x2.467066288 0.678496182 x2.467595339 0.6789841652 x2.468123913 0.6794721484 x2.46862936 0.6799601316 x2.469134569 0.6804481149 0.6809360981 x2.470169306 0.6814240813 x2.470650673 0.6819120646 x2.471156597 0.6824000478 x2.471686125 0.682888031 x2.472216368 0.6833760142 x2.472698212 0.6838639975 x2.473227978 0.6843519807 x2.473686218 0.6848399639 x2.4742167 0.6853279471 x2.474722862 0.6858159304 0.6863039136 x2.475759983 0.6867918968 x2.476266384 0.68727988 x2.476749659 0.6877678633 x2.477280378 0.6882558465 x2.477763176 0.6887438297 x2.478270531 0.689231813 x2.478777409 0.6897197962 x2.479284525 0.6902077794 x2.47981596 0.6906957626 x2.480299711 0.6911837459 x2.480807066 0.6916717291 x2.48129034 0.6921597123 x2.48179841 0.6926476955 x2.482306242 0.6931356788 0.693623662 x2.483322144 0.6941116452 x2.48383069 0.6945996284 x2.484338522 0.6950876117 x2.48479867 0.6955755949 x2.485307455 0.6960635781 x2.485815763 0.6965515614 x2.486300468 0.6970395446 x2.486833334 0.6975275278 x2.487342358 0.698015511 x2.48785162 0.6985034943 x2.488312244 0.6989914775 x2.488821268 0.6994794607 x2.489306211 0.6999674439 x2.489815474 0.7004554272 x2.490325451 0.7009434104 x2.490859032 0.7014313936 x2.49132061 0.7019193769 x2.491830111 0.7024073601 x2.492316008 0.7028953433 x2.492825985 0.7033833265 x2.493287086 0.7038713098 x2.493797779 0.704359293 x2.494332314 0.7048472762 x2.49479413 0.7053352594 x2.495304585 0.7058232427 x2.49579072 0.7063112259 x2.496301413 0.7067992091 x2.496788263 0.7072871923 x2.497274876 0.7077751756 x2.497761726 0.7082631588 x2.4982481 0.708751142 x2.498759508 0.7092391253 x2.499246359 0.7097271085 x2.499733925 0.7102150917 x2.500245333 0.7107030749 x2.50073266 0.7111910582 x2.501219749 0.7116790414 x2.501707315 0.7121670246 0.7126550078 0.7131429911 x2.50317049 0.7136309743 x2.503682375 0.7141189575 x2.504146099 0.7146069407 x2.504658461 0.715094924 x2.505146503 0.7155829072 x2.505610228 0.7160708904 x2.506123066 0.7165588737 x2.506587505 0.7170468569 x2.507100344 0.7175348401 x2.507588863 0.7180228233 x2.508077621 0.7185108066 x2.508566141 0.7189987898 x2.509055138 0.719486773 x2.509519577 0.7199747562 x2.510033131 0.7204627395 x2.510522366 0.7209507227 0.7214387059 x2.511452198 0.7219266891 x2.51196599 0.7224146724 x2.512455463 0.7229026556 x2.512920856 0.7233906388 x2.513434887 0.7238786221 x2.51390028 0.7243666053 x2.514389992 0.7248545885 x2.514855385 0.7253425717 x2.515370131 0.725830555 x2.515836 0.7263185382 x2.516325951 0.7268065214 x2.516792297 0.7272945046 x2.517258167 0.7277824879 x2.517773151 0.7282704711 x2.51823926 0.7287584543 x2.518730402 0.7292464375 x2.519220591 0.7297344208 x2.519687176 0.730222404 x2.520202875 0.7307103872 x2.520669699 0.7311983705 0.7316863537 x2.521627665 0.7321743369 x2.52209425 0.7326623201 x2.52258563 0.7331503034 x2.523052931 0.7336382866 x2.52352047 0.7341262698 x2.524011374 0.734614253 x2.524503469 0.7351022363 0.7355902195 x2.525463104 0.7360782027 x2.525930882 0.736566186 x2.526398182 0.7370541692 x2.526890755 0.7375421524 x2.527358294 0.7380301356 x2.527851105 0.7385181189 x2.528318882 0.7390061021 x2.528786898 0.7394940853 x2.529279947 0.7399820685 x2.529723406 0.7404700518 x2.530216455 0.740958035 x2.530684948 0.7414460182 0.7419340014 x2.531646252 0.7424219847 x2.532115459 0.7429099679 x2.532584429 0.7433979511 x2.533077717 0.7438859344 x2.533521891 0.7443739176 x2.534015656 0.7448619008 x2.534484863 0.745349884 0.7458378673 x2.535422802 0.7463258505 x2.535892725 0.7468138337 x2.536362171 0.7473018169 x2.536856174 0.7477898002 x2.537325859 0.7482777834 x2.537771225 0.7487657666 x2.53824091 0.7492537498 x2.538735151 0.7497417331 x2.539205551 0.7502297163 x2.539675474 0.7507176995 0.7512056828 x2.540616035 0.751693666 x2.541086435 0.7521816492 x2.541581631 0.7526696324 x2.542002439 0.7531576157 x2.542473316 0.7536455989 x2.542968273 0.7541335821 x2.543439388 0.7546215653 0.7551095486 x2.544356346 0.7555975318 x2.544827223 0.756085515 x2.545274019 0.7565734982 x2.54576993 0.7570614815 x2.546191454 0.7575494647 x2.546687603 0.7580374479 x2.547158718 0.7585254312 x2.547630548 0.7590134144 x2.54810214 0.7595013976 x2.548549175 0.7599893808 0.7604773641 x2.549492836 0.7609653473 x2.549914837 0.7614533305 x2.550411701 0.7619413137 x2.550884485 0.762429297 x2.551356077 0.7629172802 x2.551803827 0.7634052634 x2.552276134 0.7638932467 x2.55274868 0.7643812299 x2.553170919 0.7648692131 x2.553669214 0.7653571963 x2.554116726 0.7658451796 x2.554564714 0.7663331628 x2.555037737 0.766821146 0.7673091292 x2.555959225 0.7677971125 x2.556432009 0.7682850957 x2.55685544 0.7687730789 x2.557328939 0.7692610621 x2.557801962 0.7697490454 x2.558250904 0.7702370286 x2.558724403 0.7707250118 x2.559198141 0.7712129951 x2.559647083 0.7717009783 x2.560120583 0.7721889615 x2.560544968 0.7726769447 x2.561018705 0.773164928 x2.561442852 0.7736529112 x2.561941862 0.7741408944 x2.562366247 0.7746288776 x2.562840939 0.7751168609 x2.563315153 0.7756048441 x2.563764811 0.7760928273 x2.56423974 0.7765808105 x2.564663887 0.7770687938 x2.565138817 0.777556777 x2.565588713 0.7780447602 x2.566038847 0.7785327435 x2.566488504 0.7790207267 x2.566963673 0.7795087099 x2.567388773 0.7799966931 x2.567838907 0.7804846764 x2.568314552 0.7809726596 x2.568739653 0.7814606428 x2.569215298 0.781948626 x2.569666147 0.7824366093 x2.57011652 0.7829245925 x2.570591927 0.7834125757 x2.571043015 0.7839005589 x2.571494341 0.7843885422 x2.571919918 0.7848765254 x2.572395802 0.7853645086 x2.572846889 0.7858524919 x2.573298216 0.7863404751 x2.573724985 0.7868284583 x2.574175596 0.7873164415 x2.57465291 0.7878044248 x2.575103998 0.788292408 x2.575555325 0.7887803912 x2.576007366 0.7892683744 x2.576458931 0.7897563577 x2.576910973 0.7902443409 x2.577362537 0.7907323241 x2.577789545 0.7912203074 x2.578241825 0.7917082906 x2.57869339 0.7921962738 x2.579146147 0.792684257 x2.579598427 0.7931722403 0.7936602235 x2.580477476 0.7941482067 x2.58093071 0.7946361899 x2.581383228 0.7951241732 x2.581810474 0.7956121564 x2.582288742 0.7961001396 x2.582741261 0.7965881228 x2.583194494 0.7970761061 x2.583596945 0.7975640893 x2.584050179 0.7980520725 x2.584528446 0.7985400558 x2.584956646 0.799028039 x2.585384369 0.7995160222 x2.585837841 0.8000040054 x2.586266041 0.8004919887 x2.586745024 0.8009799719 x2.5871737 0.8014679551 x2.587627172 0.8019559383 x2.588055611 0.8024439216 0.8029319048 x2.588963509 0.803419888 x2.589391947 0.8039078712 x2.589821339 0.8043958545 x2.590275288 0.8048838377 x2.590704203 0.8053718209 0.8058598042 x2.591612816 0.8063477874 x2.59206748 0.8068357706 x2.5924716 0.8073237538 x2.592926264 0.8078117371 x2.593355417 0.8082997203 x2.59381032 0.8087877035 x2.594239712 0.8092756867 x2.594695091 0.80976367 x2.595149994 0.8102516532 x2.595579863 0.8107396364 0.8112276196 x2.596464396 0.8117156029 x2.596894741 0.8122035861 x2.597324371 0.8126915693 x2.597754717 0.8131795526 x2.598210335 0.8136675358 x2.59864068 0.814155519 x2.599096537 0.8146435022 x2.599501848 0.8151314855 x2.599931955 0.8156194687 x2.60038805 0.8161074519 0.8165954351 x2.601300001 0.8170834184 x2.60170579 0.8175714016 x2.602136374 0.8180593848 x2.602592945 0.818547368 x2.603049278 0.8190353513 x2.603480101 0.8195233345 x2.603886366 0.8200113177 x2.604342699 0.820499301 x2.604773998 0.8209872842 x2.605205536 0.8214752674 x2.605662107 0.8219632506 x2.606093884 0.8224512339 x2.606474161 0.8229392171 x2.606931686 0.8234272003 x2.607363462 0.8239151835 0.8244031668 x2.608227253 0.82489115 0.8253791332 x2.609091043 0.8258671165 x2.609548569 0.8263550997 x2.609980822 0.8268430829 0.8273310661 x2.610845566 0.8278190494 x2.611277819 0.8283070326 0.8287950158 x2.61211729 0.829282999 x2.61255002 0.8297709823 0.8302589655 x2.613415241 0.8307469487 x2.613848209 0.8312349319 x2.614306688 0.8317229152 x2.614739418 0.8322108984 x2.615172386 0.8326988816 x2.61558032 0.8331868649 x2.61601305 0.8336748481 x2.616421461 0.8341628313 x2.616854429 0.8346508145 x2.617313385 0.8351387978 x2.61769557 0.835626781 x2.618154526 0.8361147642 x2.618588209 0.8366027474 x2.61899662 0.8370907307 x2.619430065 0.8375787139 x2.619838476 0.8380666971 x2.620272398 0.8385546803 x2.620732069 0.8390426636 x2.621140003 0.8395306468 x2.621574402 0.84001863 x2.62198329 0.8405066133 x2.62241745 0.8409945965 0.8414825797 x2.623286009 0.8419705629 x2.623694658 0.8424585462 x2.624129295 0.8429465294 0.8434345126 x2.624998331 0.8439224958 x2.625381947 0.8444104791 x2.625816822 0.8448984623 0.8453864455 x2.626661062 0.8458744287 x2.627096176 0.846362412 x2.627531052 0.8468503952 x2.627940655 0.8473383784 0.8478263617 x2.62878561 0.8483143449 x2.629220724 0.8488023281 x2.629630566 0.8492903113 x2.630065918 0.8497782946 x2.630475998 0.8502662778 x2.630911589 0.850754261 x2.63132143 0.8512422442 x2.631757736 0.8517302275 x2.632167578 0.8522182107 x2.632578135 0.8527061939 x2.632988453 0.8531941772 x2.633424282 0.8536821604 x2.633834839 0.8541701436 x2.634270668 0.8546581268 x2.634707212 0.8551461101 x2.635118008 0.8556340933 x2.635528564 0.8561220765 x2.635939598 0.8566100597 x2.636350393 0.857098043 x2.636786699 0.8575860262 x2.637223482 0.8580740094 x2.637634516 0.8585619926 x2.638071299 0.8590499759 x2.638456583 0.8595379591 x2.638893604 0.8600259423 x2.639279127 0.8605139256 x2.639716148 0.8610019088 x2.640153408 0.861489892 x2.640565157 0.8619778752 x2.640976429 0.8624658585 x2.641388416 0.8629538417 x2.641799927 0.8634418249 x2.642211199 0.8639298081 x2.642648935 0.8644177914 x2.643034935 0.8649057746 x2.643473148 0.8653937578 x2.64388442 0.865881741 x2.644296408 0.8663697243 x2.644708872 0.8668577075 x2.645147085 0.8673456907 x2.645533323 0.867833674 x2.645971537 0.8683216572 x2.646358252 0.8688096404 x2.646796227 0.8692976236 x2.647183418 0.8697856069 x2.647647381 0.8702735901 x2.648034096 0.8707615733 x2.648421049 0.8712495565 x2.648859262 0.8717375398 x2.649272442 0.872225523 x2.649711132 0.8727135062 x2.650098562 0.8732014894 x2.650511503 0.8736894727 x2.650924206 0.8741774559 x2.651363373 0.8746654391 x2.651750803 0.8754270077 x2.652163982 0.8759160042 x2.6525774 0.8764050007 x2.65296483 0.8768939972 x2.653404474 0.8773829937 x2.653817654 0.8778719902 x2.654231548 0.8783609867 x2.65461874 0.8788499832 x2.655032873 0.8793389797 x2.655446768 0.8798279762 x2.655860186 0.8803169727 x2.656274557 0.8808059692 x2.65668869 0.8812949657 x2.657102585 0.8817839622 x2.65749073 0.8822729588 x2.657904863 0.8827619553 x2.658319235 0.8832509518 x2.658707857 0.8837399483 x2.659147978 0.8842289448 x2.659562588 0.8847179413 x2.659924984 0.8852069378 x2.66036582 0.8856959343 x2.660754442 0.8861849308 x2.661169052 0.8866739273 x2.661557913 0.8871629238 x2.66199851 0.8876519203 x2.662387609 0.8881409168 x2.66277647 0.8886299133 x2.663217068 0.8891189098 x2.663606167 0.8896079063 x2.664021492 0.8900969028 x2.664411068 0.8905858994 x2.664825916 0.8910748959 x2.665215969 0.8915638924 x2.665631056 0.8920528889 x2.666020393 0.8925418854 x2.66643548 0.8930308819 x2.666851521 0.8935198784 x2.667240858 0.8940088749 x2.667630672 0.8944978714 x2.668072462 0.8949868679 x2.668488026 0.8954758644 x2.668878317 0.8959648609 x2.66926837 0.8964538574 x2.669709682 0.8969428539 x2.670099974 0.8974318504 x2.670490026 0.8979208469 x2.670880318 0.8984098434 x2.671296597 0.89889884 x2.671713114 0.8993878365 x2.672103167 0.899876833 x2.672493458 0.9003658295 x2.672884464 0.900854826 x2.673300743 0.9013438225 x2.67369175 0.901832819 x2.674108505 0.9023218155 x2.674498796 0.902810812 x2.674915314 0.9032998085 x2.675306559 0.903788805 x2.675697565 0.9042778015 x2.676087856 0.904766798 x2.676531315 0.9052557945 x2.676922321 0.905744791 x2.677313566 0.9062337875 x2.677704334 0.906722784 x2.678122282 0.9072117805 x2.678487301 0.9077007771 x2.678904295 0.9081897736 x2.679296255 0.9086787701 x2.679713964 0.9091677666 x2.680131197 0.9096567631 x2.680522919 0.9101457596 x2.680914164 0.9106347561 x2.681306124 0.9111237526 x2.681697845 0.9116127491 0.9121017456 0.9125907421 x2.682873249 0.9130797386 x2.683291674 0.9135687351 x2.683683634 0.9140577316 0.9145467281 x2.684467793 0.9150357246 x2.684859753 0.9155247211 x2.685252428 0.9160137177 x2.685696602 0.9165027142 x2.686089039 0.9169917107 x2.686481953 0.9174807072 x2.686847687 0.9179697037 x2.687266827 0.9184587002 x2.687633276 0.9189476967 x2.688051939 0.9194366932 x2.688445091 0.9199256897 x2.688837528 0.9204146862 x2.689256907 0.9209036827 x2.689623117 0.9213926792 x2.690042257 0.9218816757 x2.69043541 0.9223706722 x2.690802574 0.9228596687 x2.691195726 0.9233486652 x2.691614628 0.9238376617 x2.691981792 0.9243266582 x2.692374468 0.9248156548 x2.692742348 0.9253046513 x2.693135977 0.9257936478 x2.693529367 0.9262826443 x2.693922281 0.9267716408 x2.694316387 0.9272606373 x2.694710016 0.9277496338 x2.695103168 0.9282386303 x2.695523739 0.9287276268 x2.695917606 0.9292166233 x2.696285248 0.9297056198 x2.696704865 0.9301946163 x2.697073221 0.9306836128 x2.697492838 0.9311726093 x2.697860956 0.9316616058 x2.698255301 0.9321506023 x2.698622942 0.9326395988 x2.699017286 0.9331285954 x2.699411869 0.9336175919 x2.699805737 0.9341065884 x2.700200796 0.9345955849 x2.700568676 0.9350845814 x2.70096302 0.9355735779 x2.701384306 0.9360625744 x2.701752663 0.9365515709 x2.702147245 0.9370405674 x2.702515602 0.9375295639 x2.702910662 0.9380185604 x2.703305244 0.9385075569 x2.703673601 0.9389965534 x2.704068899 0.9394855499 x2.704463482 0.9399745464 x2.704832792 0.9404635429 x2.705227852 0.9409525394 x2.705623627 0.9414415359 x2.706018209 0.9419305325 x2.706413746 0.942419529 0.9429085255 x2.707151651 0.943397522 x2.707547665 0.9438865185 x2.707969189 0.944375515 x2.708338499 0.9448645115 x2.708734035 0.945353508 x2.709103346 0.9458425045 x2.709473133 0.946331501 x2.70986867 0.9468204975 x2.710264921 0.947309494 x2.710607767 0.9477984905 x2.711030245 0.948287487 x2.711400032 0.9487764835 x2.711796284 0.94926548 x2.712192297 0.9497544765 x2.712561846 0.9502434731 x2.712931871 0.9507324696 x2.713328123 0.9512214661 x2.713724613 0.9517104626 x2.7140944 0.9521994591 x2.714491129 0.9526884556 x2.714861393 0.9531774521 x2.715258121 0.9536664486 x2.715627909 0.9541554451 x2.715998411 0.9546444416 x2.71639514 0.9551334381 x2.716765642 0.9556224346 x2.717162371 0.9561114311 x2.717532635 0.9566004276 x2.71792984 0.9570894241 x2.718300343 0.9575784206 x2.718671322 0.9580674171 x2.71906805 0.9585564137 x2.719412565 0.9590454102 x2.719809771 0.9595344067 x2.720207214 0.9600234032 x2.720551014 0.9605123997 x2.720975876 0.9610013962 x2.721346617 0.9614903927 x2.721744299 0.9619793892 x2.722088814 0.9624683857 x2.722486734 0.9629573822 x2.722831011 0.9634463787 x2.723229408 0.9639353752 x2.723626614 0.9644243717 x2.723971844 0.9649133682 x2.724369049 0.9654023647 x2.724740744 0.9658913612 0.9663803577 x2.725510597 0.9668693542 0.9673583508 x2.726254225 0.9678473473 x2.726651907 0.9683363438 x2.726997375 0.9688253403 x2.727395535 0.9693143368 x2.727794409 0.9698033333 x2.728139639 0.9702923298 x2.728511333 0.9707813263 x2.728910208 0.9712703228 x2.729282141 0.9717593193 x2.729654551 0.9722483158 x2.730025768 0.9727373123 x2.730398893 0.9732263088 x2.730770826 0.9737153053 x2.731169939 0.9742043018 x2.731542349 0.9746932983 x2.731888294 0.9751822948 x2.73228693 0.9756712914 x2.732633114 0.9761602879 x2.733032465 0.9766492844 x2.733404875 0.9771382809 x2.733777761 0.9776272774 x2.734177113 0.9781162739 x2.734523535 0.9786052704 x2.734922647 0.9790942669 x2.73526907 0.9795832634 x2.735668659 0.9800722599 x2.736014843 0.9805612564 x2.736414671 0.9810502529 x2.736761332 0.9815392494 x2.73713398 0.9820282459 x2.737507343 0.9825172424 0.9830062389 x2.738254309 0.9834952354 x2.738653898 0.9839842319 x2.739000559 0.9844732285 x2.739373684 0.984962225 x2.739747524 0.9854512215 x2.740120888 0.985940218 x2.740494728 0.9864292145 0.986918211 x2.741241932 0.9874072075 x2.741615534 0.987896204 x2.741963148 0.9883852005 x2.742363453 0.988874197 x2.742710829 0.9893631935 x2.743111134 0.98985219 x2.743458748 0.9903411865 x2.743858814 0.990830183 x2.744207144 0.9913191795 x2.744607449 0.991808176 x2.744927883 0.9922971725 x2.745302677 0.9927861691 x2.745676756 0.9932751656 x2.746024609 0.9937641621 x2.74645257 0.9942531586 x2.746800184 0.9947421551 x2.74717474 0.9952311516 x2.747549057 0.9957201481 x2.74789691 0.9962091446 x2.748271704 0.9966981411 x2.748619556 0.9971871376 x2.749021053 0.9976761341 x2.749369144 0.9981651306 x2.749770641 0.9986541271 x2.75009203 0.9991431236 x2.750466824 0.9996321201 x2.750842333 1.000121117}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos 1501
  ypos -148
 }
 ColorLookup {
  lut {master {curve 1.917556391e-10 x0.0004885200178 0.01101249643 0.03012449853 0.05091736093 0.07222466916 0.09369381517 x0.002931120107 0.1147837862 0.1352083236 0.154974997 0.1741122454 0.1926739067 x0.00537372008 0.2107997537 x0.005862240214 0.2285152227 0.2458462417 x0.006839280017 0.2628082931 x0.007327800151 0.2794222534 0.295704484 0.3116717935 0.3273342848 0.3426583707 0.3574382365 x0.0102589 0.3716773391 x0.01074740011 0.3854033649 0.3986460268 0.4114357233 0.4237933755 0.4357380867 0.4472988844 x0.01367860008 0.4584957659 x0.01416710019 0.4693424404 0.4798580706 0.490062505 0.4999658167 0.509581387 0.5189210773 0.5279995799 0.5368291736 0.5454137325 0.5537807345 0.5619380474 0.5698615909 x0.02002930082 0.5776066184 x0.0205178 0.5851511955 0.5925141573 0.5996920466 0.6067116857 0.6135718226 0.6202651858 0.6268154979 0.6332104802 0.6394630075 0.645586431 0.651601851 0.657453239 0.6631352901 0.6686494946 x0.02735709958 0.6740237474 x0.02784560062 0.6792407632 0.6843030453 0.6892470121 0.6940152645 0.698672235 0.7032013535 0.7075997591 0.7119068503 0.7160640359 0.7201321721 0.7240740657 0.7279301882 0.7316631079 0.7353066802 0.73888129 0.7423419952 0.7457017303 0.7489954829 0.7522004247 0.7553226948 0.7583684325 0.7613368034 0.7642341256 0.7670520544 x0.03957010061 0.7698046565 x0.04005860165 0.7724991441 0.7751038671 0.7776638865 0.7801635861 0.7825942636 0.7849631906 0.7872854471 0.7895443439 0.7917476296 0.7939026952 0.7960088253 0.7980578542 0.800064981 0.8020456433 0.8039759398 0.8059110045 0.8077633381 0.8096041679 0.8114172816 0.8131945133 0.814935565 0.8166562319 0.8183566332 0.8200041652 0.8216469288 0.8232444525 0.8248208165 0.8263678551 0.8278931975 0.8293970823 x0.05471419916 0.8308710456 x0.0552027002 0.8323394656 0.8337613344 0.83517766 0.8365467787 0.8379265666 0.839259088 0.8405857086 0.8418727517 0.8431702852 0.8444366455 0.8456633091 0.846883595 0.8480972648 0.8492792249 0.850446403 0.8515982628 0.8527351022 0.853856504 0.8549541235 0.8560366035 0.857103467 0.8581550121 0.8591908813 0.860211134 0.8612241745 0.8622128367 0.8631942272 0.8641515374 0.8651096821 0.8660436869 0.8669698238 0.8678715825 0.8687827587 0.8696606755 0.8705310822 0.8713937998 0.8722403049 0.8730788231 0.8739097118 0.8747245073 0.8755310774 0.8763213754 0.8771036267 0.8778781891 0.8786273599 0.8793859482 0.8801107407 0.8808531761 x0.07865169644 0.8815791011 x0.07914020121 0.8822883368 0.882989347 0.8836823702 0.8843671083 0.8850352168 0.8857035637 0.8863638639 0.8870072961 0.8876512647 0.8882695436 0.8888967633 0.8895071745 0.8901177645 0.8907204866 0.8913232088 0.8919177055 0.8925126195 0.8930904269 0.8936684132 0.8942384124 0.894808352 0.8953613639 0.8959233761 0.8964683414 0.8970133066 0.8975411654 0.8980871439 0.8986244202 0.8991444111 0.8996558189 0.9001851678 0.9006884694 0.9012007117 0.9016956687 0.902199924 0.9026865363 0.9031735063 0.9036605358 0.904147923 0.9046268463 0.9050881863 0.9055675268 0.9060293436 0.9064824581 0.9069448709 0.9073983431 0.9078522921 0.9082973003 0.9087517262 0.9091793895 0.9096162319 0.9100445509 0.9104729295 0.910910368 0.9113212228 0.9117412567 0.9121615291 0.9125639796 0.9129668474 0.9133785963 0.9137816429 0.914193809 x0.1094280034 0.914588213 x0.1099169999 0.9149829745 0.9153598547 0.9157367349 0.9161228538 0.9165091515 0.9168775678 0.9172551632 0.9176328778 0.91798383 0.9183710217 0.918731153 0.9190824628 0.9194429517 0.9198036194 0.9201644063 0.9205071926 0.9208410978 0.9212023616 0.9215365648 0.9218800068 0.9222143292 0.9225307107 0.9228835702 0.9232003689 0.9235263467 0.9238430858 0.9241783023 0.9245045185 0.9248127341 0.925139308 0.9254475236 0.9257559776 0.9260647297 0.926373601 0.9266731739 0.9269821048 0.9272819161 0.9275730848 0.9278821349 0.9281733632 0.9284553528 0.9287558794 0.9290288091 0.9293295741 0.9296119213 0.929885447 0.9301680326 0.930459857 0.9307336807 0.9309891462 0.93126297 0.9315369129 0.9318109155 0.932084918 0.9323408008 0.9325966239 0.9328801036 0.9331271052 0.9333924651 0.9336486459 0.9338960052 0.9341429472 0.9344086051 0.9346559048 0.934885025 0.9351325631 0.9353799224 0.9356368184 0.9358660579 0.9361047149 0.9363524318 0.9365911484 0.9368298054 0.9370595217 0.9372799397 0.9375189543 0.9377578497 0.9379784465 0.9381991625 0.9384382367 0.9386683702 0.9388891459 0.9391009212 0.939321816 0.9395427704 0.9397546053 0.9399663806 0.9401878119 0.9403998256 0.9406118393 0.9408237934 0.9410360456 0.9412481189 0.941441834 0.9416542649 0.9418480396 x0.1568150073 0.9420419931 x0.1573030055 0.9422636032 0.9424577355 0.9426516294 0.9428548813 0.9430490732 0.9432338476 0.9434373975 0.9436315894 0.9438350201 0.9440016747 0.9441958666 0.9443902969 0.944575429 0.9447698593 0.9449457526 0.9451311231 0.9453164935 0.945501864 0.9456871748 0.9458633065 0.9460487366 0.946215868 0.9463918805 0.9465774298 0.9467539191 0.9469208121 0.9470973015 0.9472736716 0.9474408627 0.9476171732 0.947784543 0.9479423165 0.9481188655 0.9482956529 0.9484536052 0.9486207962 0.9487883449 0.9489557147 0.9491230845 0.9492813945 0.9494395852 0.9496163726 0.9497558475 0.949914217 0.9500911236 0.9502402544 0.9503986239 0.9505569339 0.9507059455 0.9508643746 0.9510228634 0.9511719942 0.951330483 0.9514983296 0.9516288638 0.9517874718 0.9519366026 0.952086091 0.9522447586 0.9523940682 0.9525434375 0.952683568 0.9528329968 0.9529823661 0.9531130195 0.9532626867 0.953412056 0.9535428882 0.9536924362 0.9538327456 0.9539729953 0.9541225433 0.9542534351 0.9544032216 0.9545528889 0.9546838403 0.9548242688 0.9549365044 0.9550863504 0.955226779 0.9553578496 0.9554889202 0.9556294084 0.9557605386 0.955891788 0.9560229182 0.9561634064 0.9562853575 0.9564352036 0.9565571547 0.956669569 0.9568103552 0.9569511414 0.9570636749 0.9572044015 0.9573168755 0.9574389458 0.9575796127 0.9577015638 0.9578143358 0.9579550624 0.9580771327 0.9581992626 0.9583213329 0.9584434032 0.9585654736 0.9586877227 0.9587910175 0.9589133859 0.9590354562 0.9591577053 0.9592798948 0.9594022036 0.9595242739 0.9596278071 0.9597501159 0.9598631263 0.9599853158 0.9601076245 0.9602109194 0.9603334665 0.9604370594 0.960549891 0.9606724977 0.960776031 0.9608889818 x0.2188570052 0.9610114098 x0.2193450034 0.961124301 0.961209178 0.9613316059 0.9614447355 0.9615484476 0.9616615772 0.9617746472 0.9618781805 0.9619914293 0.9620953202 0.9622083902 0.9623119831 0.9624252915 0.9625196457 0.9626234174 0.9627367258 0.9628403187 0.9629536867 0.9630479217 0.9631424546 0.9632462859 0.9633595943 0.9634539485 0.9635484219 0.9636523128 0.9637468457 0.9638600945 0.9639545083 0.9640490413 0.9641624093 0.9642569423 0.9643514156 0.9644458294 0.9645406008 0.9646539092 0.9647485018 0.9648430943 0.9649375677 0.9650321007 0.9651267529 0.9652212858 0.965315938 0.9654104114 0.9655053616 0.9656092525 0.965703845 0.9657985568 0.9658933878 0.9659689665 0.9660636783 0.9661487341 0.9662435651 0.9663382769 0.9664234519 0.9665086865 0.9666129947 0.9666982293 0.9667929411 0.9668686986 0.9669635296 0.9670677185 0.9671530724 0.9672288895 0.9673236012 0.9674089551 0.9675038457 0.9675796032 0.9676650763 0.9677504301 0.9678452015 0.9679307342 0.9680064917 0.9680824876 0.9681677818 0.9682532549 0.9683479667 0.9684335589 0.9685094357 0.9685949683 0.9686803818 0.9687563181 0.9688416719 0.9689176679 0.9690032005 0.9690697193 0.969174087 0.969250083 0.9693166018 0.9694021344 0.9694876075 0.9695636034 0.9696491957 0.9697347879 0.9698010683 0.9698867798 0.9699628949 0.970048368 0.9701151252 0.9701814651 0.9702669978 0.9703336358 0.9704192877 0.9704953432 0.9705808759 0.9706569314 0.9707141519 0.9707996845 0.970885396 0.9709519744 0.9710184932 0.9711043239 0.971170783 0.9712565541 0.9713230729 0.9713895917 0.9714565277 0.9715421796 0.9716088772 0.9716849923 0.971761167 0.9718277454 0.971903801 0.9719612002 0.9720373154 0.9721230865 0.9721707702 0.9722563624 0.9723231792 0.9723994136 0.9724661112 0.9725328684 0.9725994468 0.9726759195 0.97273314 0.9728091955 0.9728760123 0.9729521871 0.9730191827 0.9730857611 0.9731525183 0.9732097387 0.9732767344 0.9733625054 0.9734196067 0.9734672308 0.9735531211 0.9736104608 0.9736772776 0.9737439752 0.9738108516 0.973868072 0.9739348292 0.9739922285 0.9740590453 0.9741258621 0.974183023 0.9742691517 0.9743263125 0.9743931293 0.9744505286 0.9744980931 0.9745650887 0.9746415019 0.9746987224 0.9747655988 0.9748228192 0.974870801 0.9749472737 0.9750140905 0.9750715494 0.9751380682 0.9751955271 0.9752528071 0.9753199816 0.9753677249 0.9754250646 0.9755015969 0.9755492806 0.9756066203 0.97566396 0.9757309556 0.9757884145 0.9758457541 0.9759126902 0.9759508967 0.9760178924 0.9760752916 0.9761326313 0.9761996269 0.9762570262 0.9763143659 0.976362288 x0.3131409883 0.9764196277 x0.3136300147 0.9764770269 0.9765344858 0.9765919447 0.9766589403 0.9766973853 0.9767546058 0.9768217206 0.9768791199 0.9769173861 0.9769748449 0.9770514965 0.9770994186 0.9771376848 0.9771950841 0.977252543 0.9773100615 0.9773579836 0.9774248004 0.9774729013 0.977530241 0.9775876999 0.9776260853 0.9776836038 0.9777410626 0.9777986407 0.9778464437 0.9778848886 0.9779615402 0.977999866 0.9780573249 0.9780955911 0.9781532288 0.978210628 0.9782489538 0.9783257842 0.9783642292 0.9784217477 0.9784600139 0.978517592 0.9785653949 0.9786135554 0.9786709547 0.9787188768 0.9787669778 0.9788148999 0.9788628817 0.9789107442 0.9789587855 0.9790067673 0.9790546298 0.9791122079 0.9791505933 0.9792081714 0.9792656302 0.9793040752 0.9793617725 0.9794000983 0.9794386029 0.9794961214 0.9795441031 0.9795920849 0.979640007 0.979678452 0.9797361493 0.9797745943 0.9798320532 0.9798704386 0.9799184799 0.9799762368 0.9800146222 0.9800721407 0.9801107049 0.9801492095 0.9801971316 0.9802355766 0.9802930951 0.9803315997 0.9803699851 0.9804276824 0.9804660678 0.9805142283 0.980571866 0.9805909395 0.9806486964 0.980696857 0.9807351232 0.9807832837 0.9808217287 0.9808793664 0.9809179306 0.980956316 0.9810042381 0.9810234904 0.9810811877 0.9811293483 0.981186986 0.9812061787 0.9812639356 0.9812928438 0.9813311696 0.9813889861 0.9814274311 0.9814754128 0.9815140963 0.9815620184 0.9815813303 0.9816390276 0.9816775322 0.9817255735 0.9817641377 0.9818025231 0.9818505645 0.9818890691 0.9819372892 0.9819756746 0.982014358 0.9820432067 0.9821009636 0.982139349 0.9821681976 0.9822260141 0.9822549224 0.9822933674 0.9823415279 0.9823800325 0.9824184775 0.9824473858 0.9825051427 0.9825341105 0.9825918078 0.9826205969 0.9826590419 0.9826977849 0.9827459455 0.9827843904 0.9828132987 0.9828518629 0.9829000831 0.9829385877 0.9829770923 0.9830060601 0.9830445051 0.9830926061 0.9831312299 0.9831601381 0.9832083583 0.9832274914 0.9832853675 0.9833142757 0.9833623767 0.9834010005 0.9834396839 0.9834682941 0.9835070372 0.9835358858 0.983584106 0.9836227298 0.9836420417 0.9836901426 0.983738482 0.9837576151 0.9838058949 0.9838443398 0.9838732481 0.9839215875 0.9839408398 0.9839890003 0.9840276837 0.9840468168 0.9840949774 0.9841241241 0.984162569 0.9841915965 0.9842397571 0.9842783809 0.9843072295 0.9843459129 0.984374702 0.9844230413 0.9844423532 0.9844808578 0.9845293164 0.9845579863 0.9845967889 0.9846448898 0.9846737981 0.9846933484 0.9847222567 0.9847608209 0.984809041 0.9848282337 0.9848764539 0.9849054217 0.9849345088 0.984982729 0.9850020409 0.9850503206 0.9850696325 0.9851177931 0.9851467013 0.985185504 0.9852143526 0.9852433801 0.9852819443 0.9853110909 0.9853592515 0.9853785634 0.9854074717 0.9854557514 0.9854848385 0.9855040312 0.9855524898 0.9855813384 0.9856005907 0.9856489897 0.9856778383 0.985706985 0.98574543 0.9857745767 0.9858034849 0.9858422875 0.985871017 0.985900104 0.9859290719 0.9859677553 0.9859967828 0.986025691 0.9860644341 0.9861030579 0.9861222506 0.9861514568 0.986190021 0.9862189889 0.9862480164 0.9862769842 0.9863059521 0.986354351 0.9863736629 0.9864028096 0.9864510298 0.9864702225 0.9865090251 0.9865282774 0.9865571856 0.9866056442 0.9866250157 0.9866539836 0.9866830111 0.9867119193 0.9867410064 0.9867797494 0.9868087769 0.9868376851 0.9868667126 x0.4377140105 0.9868957996 x0.4382019937 0.9869248271 0.9869633913 0.98699224 0.9870020747 0.9870312214 0.9870794415 0.9871084094 0.9871377349 0.9871761203 0.9872053266 0.9872148633 0.9872632623 0.9872922897 0.9873116016 0.9873504639 0.9873696566 0.9873985648 0.9874277115 0.9874567389 0.9874857664 0.9875148535 0.9875439405 0.987582624 0.9875923991 0.987621367 0.9876696467 0.9876794219 0.987708509 0.9877374768 0.9877663851 0.9878051281 0.9878149033 0.9878633618 0.9878729582 0.9879019856 0.9879311323 0.9879601002 0.9879891872 0.9880183339 0.9880473018 0.9880763292 0.9881054759 0.9881439805 0.9881535769 0.9881829023 0.9882118702 0.9882408977 0.9882699251 0.9882990718 0.9883280993 0.9883570671 0.9883861542 0.9883958101 0.9884248972 0.9884540439 0.9884829521 0.9885120988 0.9885314703 0.9885605574 0.9885992408 0.9886186719 0.9886478186 0.9886767268 0.9887058735 0.9887350202 0.9887445569 0.9887735248 0.9888026714 0.9888317585 0.9888609052 0.9888706207 0.9889190197 0.9889286757 0.9889771938 0.9889867902 0.9889965057 0.9890256524 0.9890547991 0.9890837669 0.9891323447 0.9891418815 0.9891516566 0.9892001152 0.9892292023 0.9892387986 0.9892680049 0.9892971516 0.989326179 0.9893552661 0.9893843532 0.9893938899 0.9894036055 0.9894328117 0.9894618988 0.9894910455 0.9895200729 0.9895297885 0.9895685315 0.9895976782 0.9896169901 0.9896363616 0.9896655679 0.9896946549 0.9897042513 0.989733398 0.9897625446 0.9897915721 0.9898012877 0.9898303747 0.9898595214 0.9898884892 0.9898982644 0.9899274111 0.9899564385 0.989985466 0.9899953008 0.9900243282 0.9900437593 0.990072906 0.9901020527 0.9901311994 0.9901407957 0.9901698828 0.9901990891 0.9902088642 0.9902377725 0.9902668595 0.9902766347 0.9903056622 0.9903252125 0.9903542995 0.9903834462 0.9904124737 0.9904221892 0.9904513955 0.990480423 0.9904900789 0.990519464 0.9905388355 0.9905579686 0.9905775189 0.9906064868 0.9906163812 0.9906455278 0.9906745553 0.990703702 0.9907230139 0.9907327294 0.9907618761 0.990791142 0.9908007383 0.990829885 0.9908590317 0.9908783436 0.9909075499 0.990917325 0.9909464717 0.9909756184 0.9909851551 0.9910145402 0.9910339117 0.9910630584 0.9910725355 0.9911019802 0.9911309481 0.9911405444 0.9911600947 0.9911794662 0.9911990166 0.9912279844 0.9912571311 0.9912669063 0.9912960529 0.9913058877 0.9913251996 0.9913543463 0.991364181 0.9913930893 0.991422236 0.9914320111 0.9914516211 0.9914807081 0.9915099144 0.9915196896 0.9915388227 0.991558373 0.9915777445 0.9916068912 0.9916360974 0.9916556478 0.9916653037 0.9916750193 0.991723597 0.9917333126 0.9917526841 0.9917623401 0.9917916656 0.9918207526 0.9918305278 0.9918498993 0.9918597341 0.9919083118 0.9918984175 0.9919374585 0.9919470549 0.9919763207 0.9919859767 0.9920151234 0.9920347333 0.9920636415 0.9920734167 0.9921028018 0.9921219945 0.9921317697 0.9921415448 0.9921706915 0.992200017 0.9922194481 0.9922291636 0.9922581911 0.9922776818 0.9922776818 0.9922970533 0.9923262596 0.9923554063 0.9923652411 0.992384553 0.9924138188 0.9924234748 0.9924526215 0.9924722314 0.9924817681 0.992511034 0.9925305247 0.9925401807 0.992549777 0.9925791621 0.9925887585 0.9926276803 0.9926374555 0.9926666021 0.9926859736 0.9926959872 0.9927055836 0.9927347302 0.9927541018 0.9927834868 0.9927736521 0.9928027987 0.9928223491 0.9928514361 0.9928612113 0.9928808212 0.9928904772 0.9929196239 0.9929294586 0.9929487109 0.9929779768 0.9929974675 0.9930072427 0.9930363894 0.9930459857 0.993065536 0.9930753112 0.9931045175 0.9931142926 0.9931336641 0.9931630492 0.993172586 0.9931919575 0.9932019711 0.9932309389 0.9932504892 0.9932601452 0.9932894707 0.9932992458 0.9933185577 0.9933283925 0.9933380485 0.9933576584 0.9933868051 0.993396461 0.9934159517 0.9934450984 0.9934548736 0.9934742451 0.9934840798 0.9935132265 0.9935327172 0.9935423732 0.9935718179 0.9935814738 0.9936009049 0.9936107397 0.9936301112 0.9936398268 0.9936690331 0.9936885834 0.9936982393 0.9937276244 0.9937276244 0.9937372208 0.9937761426 0.9937859774 0.993815124 0.9938248992 0.9938442707 0.9938542247 0.993863821 0.9938833117 0.9939125776 0.9939222336 0.9939416051 0.9939514995 0.9939709902 0.9939807653 0.9940099716 0.9940197468 0.9940389991 0.994058609 0.9940683246 0.9940974712 0.9941074252 0.9941268563 0.9941365719 0.994146347 0.9941657186 0.9941949248 0.9941949248 0.9942242503 0.9942436814 0.9942533374 0.9942826033 0.9942826033 0.9943118691 0.9943217039 0.9943313599 0.9943508506 0.9943606257 0.9943802357 0.9943897724 0.9944093823 0.9944190979 0.9944484234 0.9944484234 0.9944775701 0.99449718 0.99449718 0.9945360422 0.9945360422 0.9945651889 0.994574964 0.9945944548 0.9946042895 0.9946140051 0.9946333766 0.9946432114 0.9946628213 0.9946725368 0.994691968 0.9947211742 0.9947309494 0.9947505593 0.9947603345 0.9947603345 0.9947894812 0.9947992563 0.9948186874 0.9948381782 0.9948479533 0.9948579073 0.9948772192 0.9948869944 0.9949162006 0.9949355721 0.9949455261 0.9949455261 0.9949551821 0.9949843287 0.9949843287 0.9950136542 0.9950330257 0.9950429797 0.9950624108 x0.6257939935 0.9950723052 x0.6262819767 0.9950915575 0.9951014519 0.9951210618 0.9951306581 0.9951402545 0.9951599836 0.9951891303 0.9951891303 0.9952183962 0.9952281713 0.9952281713 0.9952574968 0.9952574968 0.9952867031 0.9952867031 0.9952965975 0.9953257442 0.9953257442 0.9953548908 0.9953548908 0.9953842759 0.9954036474 0.9954134822 0.995423317 0.9954428077 0.995452404 0.9954720736 0.9954816699 0.9955012798 0.9955109954 0.9955109954 0.9955403209 0.9955403209 0.9955695868 0.9955695868 0.9955989122 0.9956085682 0.9956085682 0.9956377149 0.9956573844 0.9956672192 0.9956672192 0.9956768751 0.9956963062 0.9957257509 0.9957257509 0.9957352877 0.9957548976 0.9957646728 0.9957745075 0.9957940578 0.9958036542 0.9958232641 0.9958428144 0.9958524704 0.9958720803 0.9958817363 0.995891571 0.995911181 0.9959208369 0.9959403276 0.9959500432 0.9959500432 0.9959794283 0.9959794283 0.9960087538 0.9960087538 0.9960183501 0.9960379004 0.9960671663 0.9960575104 0.996096611 0.996096611 0.9961063862 0.9961256385 0.9961355329 0.9961452484 0.9961647391 0.9961647391 0.996194303 0.996194303 0.9962234497 0.9962234497 0.9962331057 0.996252656 0.9962624311 0.9962722063 0.9962918162 0.996311307 0.9963210821 0.9963210821 0.9963306785 0.9963502288 0.9963600636 0.9963796735 0.9964088798 0.996399045 0.9964186549 0.9964186549 0.9964478612 0.9964478612 0.9964772463 0.9964772463 0.9964869618 0.9965064526 0.9965261817 0.9965358377 0.9965456128 0.9965456128 0.9965749383 0.9965749383 0.9965846539 0.9966041446 0.9966237545 0.9966333508 0.996643126 0.996643126 0.9966627955 0.9966920018 0.9966920018 0.996701777 0.9967117906 0.9967311621 0.9967311621 0.9967604876 0.9967604876 0.9967702031 0.996789813 0.9968093634 0.9968189597 0.9968287945 0.9968484044 0.9968484044 0.9968581796 0.9968774915 0.9968875647 0.9969069362 0.9969167113 0.9969167113 0.9969363213 0.996946156 0.9969655871 0.9969753027 0.9969851375 0.9969851375 0.9970046282 0.9970145226 0.9970338941 0.9970437288 0.9970632792 0.9970730543 0.9970730543 0.9970828891 0.9971023202 0.9971219301 0.9971316457 0.9971316457 0.9971610308 0.9971610308 0.9971804023 0.9971902966 0.9972000718 0.9972000718 0.9972099066 0.9972294569 0.9972294569 0.9972390532 0.9972586632 0.9972782135 0.9972881079 0.9972977042 0.9973171949 0.9973171949 0.9973270893 0.9973466992 0.997356534 0.997356534 0.9973758459 0.9973856807 0.9973956347 0.9973956347 0.9974150658 0.9974248409 0.9974444509 0.9974540472 0.9974737167 0.9974737167 0.9974834919 0.9975031018 0.997512877 0.997512877 0.9975322485 0.9975420833 0.9975616336 0.997571528 0.997571528 0.9975811839 0.9976007342 0.9976106286 0.9976106286 0.9976301193 0.9976397753 0.9976595044 0.9976497293 0.9976690412 0.9976790547 0.9976790547 0.9976985455 0.997708261 0.9977278709 0.9977377057 0.9977377057 0.9977570772 0.997766912 0.9977865219 0.9978061318 0.9977962971 0.997815907 0.9978255033 0.9978450537 0.9978450537 0.9978548884 0.9978744984 0.9978843331 0.9978843331 0.9979039431 0.9979136586 0.9979136586 0.997923553 0.9979431033 0.9979528785 0.9979723096 0.9979625344 0.9979820251 0.9979820251 0.9980016351 0.9980114698 0.9980309606 0.998021245 0.9980407357 0.9980602264 0.9980505705 0.9980701208 0.9980798364 0.9980995059 0.9980995059 0.998128891 0.998128891 0.9981385469 0.9981385469 0.9981482625 0.9981677532 0.9981876016 0.9981777072 0.9981971383 0.9981971383 0.9982265234 0.9982265234 0.9982363582 0.9982363582 0.9982559681 0.9982657433 0.9982853532 0.9982755184 0.9982951283 0.9983144999 0.9983144999 0.9983243942 0.9983440042 0.9983536601 0.9983536601 0.9983733892 0.9983635545 0.9983831644 0.9983929992 0.9984123111 0.9984123111 0.9984223247 0.9984223247 0.9984417558 0.9984516501 0.9984516501 0.9984711409 0.998480916 0.998480916 0.998490572 0.9985104203 0.9985104203 0.9985396266 0.9985396266 0.9985592365 0.9985494614 0.9985688329 0.9985787868 0.9985787868 0.9985982776 0.9986080527 0.9986080527 0.9986178279 0.9986376166 0.9986570477 0.9986472726 0.9986669421 0.9986669421 0.9986864328 0.9986766577 0.998696208 0.9987159371 0.9987257123 0.9987257123 0.998735249 0.998735249 0.998754859 0.9987646937 0.9987646937 0.9987842441 0.9987940788 0.9988136292 0.9988136292 0.9988234639 0.9988234639 0.9988430738 0.998852849 0.998852849 0.9988723397 0.9988821149 0.9988821149 0.9988919497 0.9988919497 0.9989017248 0.9989212751 0.9989212751 0.9989311695 0.9989506602 0.9989506602 0.9989702106 0.9989799261 0.9989799261 0.9989898205 0.9989898205 0.9990093708 0.9990289807 0.9990192056 0.9990388155 0.9990388155 0.9990583062 0.9990485907 0.9990682006 0.9990877509 0.9990779161 0.9990975857 0.999107182 0.999107182 0.9991268516 0.9991366267 0.9991366267 0.9991464019 0.9991660118 0.9991660118 0.9991758466 0.9991758466 0.9991952777 0.9991952777 0.9992052317 0.9992246628 0.9992246628 0.9992346168 0.9992541075 0.9992541075 0.9992638826 0.9992638826 0.9992737174 0.9992934465 0.9992934465 0.9992934465 0.9993226528 0.9993226528 0.9993226528 0.9993422627 0.9993520379 0.9993520379 0.9993716478 0.9993813634 0.9993813634 0.9993913174 0.9993913174 0.9994107485 0.9994107485 0.9994205236 0.9994205236 0.9994401336 0.9994500279 0.9994695187 0.9994598031 0.999479413 0.999479413 0.999479413 0.9994891882 0.9995086193 0.9995086193 0.9995186329 0.9995382428 0.9995382428 0.9995479584 0.9995479584 0.9995675683 0.9995675683 0.9995772839 0.9995772839 0.9995968938 0.9996067882 0.9996067882 0.9996067882 0.9996165037 0.999636054 0.999636054 0.999655664 0.9996458888 0.9996654391 0.9996752739 0.9996752739 0.9996948838 0.9996948838 0.999704659 0.999704659 0.9997243285 0.9997340441 0.9997340441 0.9997535348 0.9997535348 0.9997634888 0.9997634888 0.9997829199 0.9997927547 0.9997927547 0.9997927547 0.9998124242 0.9998221397 0.9998221397 0.9998320341 0.9998320341 0.9998320341 0.9998514056 0.9998614192 0.9998809695 0.9998809695 0.9998908639 0.9998908639 0.9998908639 0.9999104142 0.9999201894 0.9999201894 0.9999398589 0.9999300241 0.9999495745 0.9999495745 0.9999592304 0.9999592304 0.9999592304 0.9999986291 0.9999886751 0.9999986291 0.9999886751 0.9999886751 0.9999986291 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 x0.8754270077 0.9999886751 x0.8759160042 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751 0.9999886751}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup3
  xpos 1501
  ypos -124
 }
set N6136f400 [stack 0]
push $N6136f400
 Switch {
  inputs 3
  which {{parent.gamutBounds}}
  name boundsSwitch1
  xpos 1501
  ypos -65
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply2
  label "Mult by 100 to put in absolute nits"
  xpos 1501
  ypos -21
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle2
  xpos 1501
  ypos 21
 }
push $N610a0800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1350
  ypos 34
 }
 Dot {
  name Dot13
  xpos 1384
  ypos 90
 }
set N6136e400 [stack 0]
 Dot {
  name Dot2
  xpos 635
  ypos 124
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle3
  xpos 601
  ypos 191
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_C
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_C.green 1 1 rgba.green 0 1"
  name Shuffle4
  xpos 601
  ypos 215
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle5
  xpos 601
  ypos 239
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy1
  xpos 601
  ypos 429
 }
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit1
  xpos 601
  ypos 461
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle6
  xpos 601
  ypos 485
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.green 0 1 zcam_C.alpha 0 3"
  name Shuffle7
  xpos 601
  ypos 509
 }
 Read {
  inputs 0
  file_type exr
  file "\[value Write19.file]"
  origset true
  version 5147
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read95
  xpos 877
  ypos 139
 }
 Colorspace {
  primary_in DCI-P3
  colorspace_out CIE-XYZ
  name Colorspace3
  xpos 877
  ypos 236
 }
 Multiply {
  value 1000
  name Multiply5
  label "Mult by 100 to put in absolute nits"
  xpos 877
  ypos 260
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_P3gamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 4120
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read93
  xpos 793
  ypos 138
 }
 Colorspace {
  primary_in DCI-P3
  colorspace_out CIE-XYZ
  name Colorspace2
  xpos 793
  ypos 235
 }
 Multiply {
  value 100
  name Multiply4
  label "Mult by 100 to put in absolute nits"
  xpos 793
  ypos 259
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  name Read68
  xpos 697
  ypos 141
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 697
  ypos 234
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 697
  ypos 258
 }
 Switch {
  inputs 3
  which {{parent.gamutBounds}}
  name boundsSwitch
  xpos 788
  ypos 370
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 788
  ypos 394
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N612f9000 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N61273800 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N61273800
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6129a400 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6129a400
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N61271c00 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N61271800 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N61271c00
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N61270c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N61270800 [stack 0]
push $N61271c00
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N61270400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N615ffc00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N615ff800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N615ff400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N61271800
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N61271c00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N61271c00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N61271c00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N612f9000
push $N61271800
push $N61270c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N615fd800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N615fd800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N61271800
push $N61270800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N615fc400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N615fc400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N61271800
push $N61270400
push $N61270c00
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N61592800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N61592400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N61592400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N615ff800
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N61592800
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N615ff800
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N615ff400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N61592800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N61270800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N615ffc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N61270c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N61270400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N61271800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N612f9000
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N618c5000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N618c4400 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N618c4400
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N61842800 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N61841c00 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N61841c00
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N61841c00
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N61840c00 [stack 0]
push $N61840c00
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N61842800
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N617fdc00 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N617fdc00
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N617fdc00
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N61866400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N617fcc00 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N61866400
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N617fc400 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N61866400
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N617af400 [stack 0]
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N617ae800 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N61865d00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N617fcc00
push $N617fc400
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N617acc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N617acc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N61865d00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N61736800 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N61736800
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N61864f00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N61864f00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N618c5000
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N618c5000
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N618c5000
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N61865d00
push $N618c5000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N61842800
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N617af400
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N617ae800
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N61866400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 788
  ypos 446
 }
push $N6136e400
 Dot {
  name Dot1
  xpos 1015
  ypos 127
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 432
 }
set N6166b000 [stack 0]
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/226*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit2
  xpos 1069
  ypos 480
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr {{parent.clipToLimit1.thr}}
 }
push $N6166b000
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit
  xpos 977
  ypos 477
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr {{parent.clipToLimit1.thr}}
 }
set N6166a800 [stack 0]
push $N6166a800
 Switch {
  inputs 3
  which {{parent.gamutBounds}}
  name boundsSwitch2
  xpos 983
  ypos 514
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 983
  ypos 548
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 983
  ypos 572
 }
push $N6136e400
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1350
  ypos 754
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy2
  xpos 1350
  ypos 796
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1350
  ypos 848
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N61668c00 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N619f3400 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N619f3400
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N61a12b00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N61a12b00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N619f1800 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N619f1400 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N619f1800
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N619f0800 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N619f0400 [stack 0]
push $N619f1800
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6198fc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6198f800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6198f400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6198f000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N619f1400
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N619f1800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N619f1800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N619f1800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N61668c00
push $N619f1400
push $N619f0800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6198d400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6198d400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N619f1400
push $N619f0400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N61d1fc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N61d1fc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N619f1400
push $N6198fc00
push $N619f0800
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N61d1e400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N61d1e000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N61d1e000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6198f400
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N61d1e400
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6198f400
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6198f000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N61d1e400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N619f0400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6198f800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N619f0800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6198fc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N619f1400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N61668c00
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N61c44c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N61bd7c00 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N61bd7c00
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N61bd6400 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N61bd5800 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N61bd5800
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N61bd5800
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N61bd4800 [stack 0]
push $N61bd4800
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N61bd6400
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N61b81800 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N61b81800
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N61b81800
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N61bb6b00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N61b80800 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N61bb6b00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N61b37c00 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N61bb6b00
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N61b37000 [stack 0]
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N61b36400 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N61bb6400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N61b80800
push $N61b37c00
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N61b34800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N61b34800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N61bb6400
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N61abe400 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N61abe400
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N61bb5600 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N61bb5600
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N61c44c00
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N61c44c00
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N61c44c00
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N61bb6400
push $N61c44c00
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N61bd6400
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N61b37000
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N61b36400
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N61bb6b00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1350
  ypos 900
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1350
  ypos 942
 }
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out sRGB
  primary_out DCI-P3
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1350
  ypos 966
 }
 Output {
  name Output1
  xpos 1350
  ypos 1073
 }
push $N613d4800
 Sampler {
  lut {red {curve 0 x0.000488519785 0.3155371845 0.4557278752 0.5572770834 0.6389417648 0.7080863714 x0.00293111871 0.7684537172 0.8222920299 0.8710434437 0.9156916738 0.9569416642 x0.005373717751 0.9953647256 x0.00586223742 1.031342387 1.065215945 x0.006839277223 1.097246885 x0.007327796891 1.127625942 1.1565516 1.18417263 1.210611701 1.235978842 1.260344386 x0.01025891583 1.283829927 x0.0107474355 1.306484222 1.328353047 1.349516273 1.370035648 1.389927149 1.409237504 x0.01367855445 1.428004384 x0.01416707411 1.446283937 1.464051604 1.48137033 1.49829185 1.5147686 1.530887127 1.546601415 1.562017918 1.577063084 1.591817141 1.606268764 1.620422602 x0.020029312 1.634301901 x0.02051783167 1.647912741 1.661279559 1.674377203 1.687264919 1.699935555 1.712349534 1.724600911 1.736634016 1.748460293 1.760126472 1.771592498 1.782871962 1.793977737 1.804940343 x0.02735710889 1.815739393 x0.02784562856 1.826370597 1.836866736 1.847224355 1.857404113 1.867494464 1.877436757 1.887247682 1.896924973 1.906464934 1.915921926 1.925237656 1.934447169 1.943548679 1.95255959 1.961439729 1.970244527 1.978953481 1.987545848 1.996038675 2.004450083 2.012759447 2.020984411 2.029144049 2.03719759 x0.03957010433 2.045162678 x0.040058624 2.053059101 2.060864925 2.068619251 2.076281548 2.083870173 2.091404915 2.098843336 2.106226444 2.113511562 2.12078023 2.127949238 2.135038137 2.14212966 2.149119139 2.156025887 2.162891388 2.169694424 2.176475286 2.183150291 2.189781189 2.19634676 2.202888489 2.209363461 2.215793133 2.222175837 2.22851181 2.234778881 2.241019249 2.247189522 2.25331068 x0.05471421778 2.259382725 x0.05520273745 2.265448332 2.271441936 2.277362108 2.283297777 2.289182186 2.295014143 2.300793648 2.306542873 2.312238693 2.317880869 2.323513746 2.329114676 2.334638357 2.340174913 2.345633268 2.351080894 2.356472492 2.361853361 2.367154121 2.372467041 2.377744913 2.382941723 2.388173342 2.393322468 2.398459673 2.40358448 2.40862608 2.413655043 2.418670177 2.423672676 2.428614616 2.43354249 2.438432455 2.44328475 2.448122978 2.452923059 2.45770812 2.462454796 2.467186451 2.471879005 2.476556301 2.481193542 2.485815763 2.490422487 2.494988441 2.499538898 2.504073143 2.508566141 x0.07865168899 2.513042927 x0.07914020866 2.517478943 2.52192235 2.526324272 2.530684948 2.535052776 2.539403677 2.543687105 2.548002958 2.552276134 2.556531668 2.56071949 2.564938545 2.569140196 2.573298216 2.577437878 2.58155942 2.585661888 2.589745522 2.59381032 2.597856045 2.601883173 2.605916023 2.609879017 2.613848209 2.617797136 2.621752977 2.62563777 2.629528046 2.633424282 2.637274742 2.641130924 2.644966602 2.648756266 2.6525774 2.656352282 2.660132408 2.663840055 2.667604685 2.671296597 2.674993753 2.678669691 2.682324409 2.68598485 2.689623117 2.693240643 2.696862698 2.700411081 2.703990221 2.707547665 2.711082935 2.714622974 2.718168259 2.721664429 2.725112438 2.728617907 2.732074499 2.73550868 2.738947153 2.742363453 2.745757341 2.749154568 2.752530098 x0.1094284356 2.755882502 x0.1099169552 2.759266376 2.762599945 2.765884399 2.769225597 2.772544146 2.775812864 2.779085636 2.782361746 2.785614491 2.78884387 2.792077541 2.795287371 2.798473835 2.801690578 2.804884672 2.808027029 2.811200142 2.814322233 2.817447424 2.820576668 2.823709011 2.826790094 2.8298738 2.832961321 2.836052895 2.839091778 2.842161894 2.845179319 2.84820056 2.851196766 2.854224205 2.857198954 2.860204458 2.863157511 2.866113901 2.869073391 2.872035503 2.87497282 2.877885103 2.880800486 2.883718491 2.886611462 2.889507771 2.892377853 2.895223618 2.898099184 2.90092206 2.903803587 2.906632423 2.909463167 2.912240028 2.915048122 2.917829752 2.92064333 2.92343092 2.926192522 2.928928137 2.931723833 2.934435606 2.937179804 2.939925194 2.942616463 2.945339203 2.948035479 2.9507339 2.953434706 2.956051826 2.958786964 2.961437225 2.964003801 2.966688395 2.969346285 2.971977234 2.974582195 2.977189064 2.97979784 2.982409239 2.985023022 2.987551451 2.990169525 2.992760897 2.99529624 2.997833729 3.000373125 3.002914906 3.005458832 3.00797534 3.010523558 3.012985468 3.015508413 3.017974854 3.020442724 3.022972107 3.025503397 3.027947903 3.030365467 x0.1568148583 3.032814503 x0.157303378 3.035265684 3.037747383 3.040143013 3.042599678 3.04496932 3.0474298 3.049892426 3.0522089 3.054615498 3.057054043 3.059434652 3.06175828 3.064142942 3.066529274 3.06885767 3.071247816 3.073609829 3.07594347 3.078249693 3.080557108 3.082895994 3.085206509 3.087519407 3.089893818 3.092089415 3.094377041 3.096636295 3.098987579 3.101189852 3.103544474 3.105749846 3.108107805 3.110346556 3.112527132 3.114768267 3.116951942 3.119227171 3.121413231 3.123661995 3.125880957 3.128072023 3.130294323 3.132518768 3.134683132 3.136941195 3.139048338 3.14121747 3.143388271 3.145529985 3.147704363 3.149939775 3.152024984 3.154203415 3.156290531 3.158410788 3.160562277 3.1626544 3.164870501 3.166903734 3.169060707 3.17109704 3.173257351 3.175295353 3.177366018 3.17946887 3.181604147 3.183709621 3.185723782 3.187770367 3.189848661 3.191928625 3.193947315 3.195999384 3.198083401 3.200137138 3.202099562 3.204124928 3.206152201 3.208180428 3.210178137 3.212208748 3.214209318 3.21624279 3.218245745 3.22021842 3.222224951 3.224168539 3.226176023 3.228123188 3.230102062 3.232051373 3.234032631 3.235984087 3.237999439 3.23988986 3.241844416 3.243768454 3.245725393 3.247652769 3.249612093 3.251477242 3.253470659 3.255370378 3.257238626 3.259172201 3.261107445 3.263011694 3.264884949 3.26675868 3.268634319 3.27057457 3.272387981 3.274298906 3.276178837 3.278059244 3.279909372 3.281728029 3.283612251 3.285465956 3.28731966 3.289142609 3.290999174 3.292888403 3.294682503 3.296541929 3.298337698 x0.2188568711 3.300134897 x0.2193453908 3.301996946 3.303796291 3.30559659 3.307461739 3.309199333 3.311067104 3.312871695 3.314676523 3.316450357 3.318257093 3.320065022 3.321776867 3.323585987 3.325365305 3.327112913 3.328892708 3.330641508 3.332424164 3.334207058 3.335958719 3.337743998 3.339400053 3.341186762 3.342909575 3.344633102 3.346358061 3.348083019 3.349809408 3.351602077 3.353330374 3.355059147 3.356724262 3.358454466 3.360153675 3.361886024 3.363586903 3.365255594 3.36692524 3.368628502 3.370365143 3.372004986 3.373743296 3.375384092 3.377058744 3.378767252 3.38041091 3.382120848 3.383766174 3.38544488 3.387091398 3.388738871 3.390387297 3.392036676 3.393686056 3.395336628 3.396988153 3.398640633 3.400293827 3.401881218 3.403535366 3.405091763 3.40674758 3.408405066 3.409996033 3.411621332 3.413280964 3.414808273 3.416435719 3.418030977 3.419593334 3.421257019 3.422821283 3.424385548 3.42605114 3.427617788 3.429184437 3.430785656 3.43235445 3.433923244 3.435493708 3.437096834 3.438668728 3.440173864 3.441813231 3.443320036 3.444893837 3.446401834 3.4480443 3.449553251 3.451130629 3.45264101 3.45421958 3.455798626 3.457277775 3.458790779 3.460371733 3.461885929 3.463435173 3.464951515 3.466468096 3.467951059 3.469536781 3.471055031 3.472540617 3.474060535 3.475547075 3.477068186 3.478556156 3.480078697 3.481567621 3.483057737 3.484514475 3.486005783 3.487497568 3.489023685 3.490448952 3.491942406 3.493436813 3.494898558 3.496393442 3.497889996 3.499318123 3.500747919 3.502245665 3.503744841 3.505176067 3.506641388 3.508108139 3.509541035 3.510974646 3.512476921 3.513843298 3.515347481 3.516782761 3.518219233 3.519656181 3.521060467 3.522498131 3.523936749 3.525375843 3.526781797 3.528290987 3.529663563 3.531070709 3.532513142 3.533955574 3.535296202 3.536740303 3.538150311 3.539595604 3.540938377 3.542384148 3.543796301 3.545175076 3.546519756 3.547899485 3.549383163 3.550729275 3.552110195 3.55345726 3.554874897 3.556257248 3.557675362 3.559023619 3.560408831 3.561758995 3.563109636 3.564530611 3.565882444 3.567234039 3.568622112 3.569974899 3.571329355 3.572683573 3.574038267 3.575393915 3.57675004 3.578036785 3.579463005 3.580821037 3.582178593 3.583537102 3.584826946 3.586186171 3.58754611 3.588836908 3.590162992 3.591454506 3.592816353 3.594178677 3.595472336 3.596801043 x0.313141197 3.598094702 x0.3136297166 3.59945941 3.60078907 3.602084875 3.603380442 3.604746819 3.606009245 3.607306719 3.608603716 3.609936953 3.611235857 3.612500191 3.613800049 3.615099907 3.616435528 3.617666483 3.619003773 3.6203053 3.621572495 3.622875214 3.624143362 3.625411987 3.626716852 3.627950907 3.629291296 3.630561113 3.631832123 3.633068562 3.634410381 3.635611773 3.636919737 3.638193369 3.639395475 3.64070487 3.641979218 3.643183231 3.644458532 3.645734072 3.646974087 3.648180485 3.649456978 3.650734425 3.651941061 3.653219938 3.654462814 3.655741453 3.656950235 3.658158779 3.659439802 3.660649061 3.661859035 3.663140774 3.664352417 3.665563583 3.666846514 3.668058395 3.669199228 3.670483351 3.671696901 3.672911406 3.674124718 3.67533946 3.676554441 3.677769423 3.679020882 3.680165291 3.681382418 3.682599068 3.683816433 3.685034037 3.686180353 3.687363148 3.688581705 3.689872742 3.691056728 3.692133665 3.693425894 3.694574594 3.695759773 3.696909666 3.698132038 3.699317932 3.700540304 3.701763868 3.70287919 3.704031944 3.705255985 3.706444502 3.707598209 3.708787441 3.709940672 3.711130857 3.712285757 3.713476419 3.714559317 3.715787172 3.716906548 3.718135834 3.719256401 3.720413446 3.721606731 3.722764492 3.723886013 3.725044489 3.72623992 3.727362871 3.728449583 3.729646206 3.730806112 3.731930733 3.733127594 3.734216213 3.735341311 3.7364676 3.737665892 3.738755941 3.739882708 3.741045952 3.742173433 3.743301392 3.744428873 3.745521069 3.746649981 3.747852087 3.748944998 3.750074625 3.751204729 3.752262115 3.753392935 3.754560232 3.755618811 3.756750345 3.757882357 3.758941889 3.760147572 3.761244774 3.762304544 3.763438702 3.764499426 3.765633345 3.766695261 3.767830372 3.76889205 3.770028353 3.771164417 3.772264004 3.773326874 3.774391174 3.775528193 3.776666164 3.77773118 3.778795004 3.779860735 3.780926228 3.78206563 3.783131599 3.784234524 3.78533864 3.786405563 3.787472963 3.788540602 3.789644957 3.790640116 3.791708231 3.792850971 3.793919563 3.794988871 3.79605937 3.797129154 3.798199654 3.79923296 3.800304413 3.801375628 3.802446842 3.803519011 3.80459094 3.805626392 3.806624651 3.807771921 3.80877161 3.809881926 3.810881615 3.81195569 3.81303072 3.814030886 3.815069199 3.816144705 3.817145586 3.818259001 3.819261074 3.820338011 3.821414471 3.822380304 3.823384047 3.824461222 3.825501919 3.826505899 3.82758379 3.828588724 3.829631329 3.830710411 3.831715345 3.832758427 3.833764315 3.834807634 3.835813522 3.836819887 3.837864637 3.838871479 3.839879036 3.840924263 3.841932297 3.842977762 3.843985796 3.845032215 3.845966101 3.84701252 3.848022699 3.849069357 3.850079536 3.851014853 3.852063179 3.853073597 3.854048014 3.855058908 3.856108427 3.857082844 3.858094692 3.859070063 3.860082865 3.861057997 3.862070799 3.863046885 3.864060879 3.865036726 3.86608839 3.86702776 3.868042707 3.869019985 3.86999774 3.871013641 3.871991396 3.872969627 3.873986721 3.874965429 3.875906706 3.876961946 3.877865791 3.878883839 3.879863262 3.880843401 3.881862402 3.8827672 3.8837111 3.884767771 x0.4377137423 3.885749817 x0.4382022619 3.886655569 3.887676001 3.888657808 3.889564991 3.890585661 3.891493082 3.89247632 3.893421888 3.894405842 3.895390272 3.896298409 3.897320747 3.898229837 3.899214983 3.90019989 3.901148081 3.902058125 3.903043985 3.903954029 3.904978275 3.905888796 3.906876087 3.907787323 3.908736229 3.909724236 3.91063571 3.911548138 3.912536621 3.913449049 3.914437771 3.915389299 3.916301727 3.917215586 3.918204784 3.919119596 3.92010951 3.920985699 3.921900272 3.922814608 3.923729658 3.924721241 3.925636292 3.926628113 3.92750597 3.928498507 3.929414272 3.930330992 3.931170464 3.932164192 3.933081388 3.933998823 3.934916258 3.935872793 3.936828852 3.937708616 3.938627243 3.939545155 3.940464735 3.941383362 3.942302227 3.943144798 3.944141388 3.945061207 3.945981741 3.94690156 3.947745323 3.948666096 3.949587345 3.950508595 3.951429605 3.952350616 3.953196287 3.954117537 3.955039978 3.95596242 3.956808329 3.957731009 3.958654404 3.95957756 3.960423708 3.961347342 3.962194681 3.963195086 3.964042664 3.964890003 3.965815067 3.966739416 3.967587233 3.968512774 3.969360828 3.970247984 3.971174479 3.97202301 3.972872496 3.973875999 3.974725246 3.975574493 3.976424456 3.977352142 3.978241444 3.979130983 3.979981184 3.980870485 3.98172164 3.982649803 3.983501911 3.98443079 3.985282421 3.986134052 3.987025023 3.987838984 3.988729715 3.989582539 3.990512609 3.991366148 3.992257595 3.993111134 3.993965149 3.994818687 3.995672464 3.996526957 3.997458458 3.998352051 3.999129295 4.000061512 4.000916958 4.001771927 4.002589226 4.003444195 4.004300117 4.005233765 4.006051064 4.006868839 4.007763863 4.008543491 4.009478092 4.010295868 4.011153698 4.012010098 4.012867928 4.013725758 4.014544964 4.015402794 4.016261101 4.017120361 4.017939568 4.018798828 4.019579411 4.020516872 4.021297932 4.022118568 4.022978306 4.02383852 4.024737835 4.025519371 4.026380062 4.027162552 4.028062344 4.028844833 4.029706478 4.030528545 4.031390667 4.032251835 4.033035755 4.033857822 4.034720421 4.035505295 4.036328316 4.037190914 4.038053989 4.038877487 4.039662361 4.04052639 4.041350365 4.042135715 4.042999744 4.043785572 4.0446105 4.045474529 4.046260834 4.047086716 4.047951698 4.048698902 4.049485683 4.050351143 4.051177502 4.052043915 4.052831173 4.053658009 4.05444622 4.055273056 4.056139469 4.056927681 4.057676315 4.058465481 4.059332848 4.060161114 4.060949802 4.061738491 4.062488079 4.063396931 4.064186096 4.064975262 4.065765381 4.066516399 4.067385197 4.068175793 4.069005489 4.069796085 4.070627213 4.071417809 4.072169304 4.073039532 4.073792458 4.074583054 4.07537508 4.076127529 4.076919556 4.07775116 4.078543186 4.07933569 4.080088615 4.080961227 4.081714153 4.082507133 4.083261013 4.084134102 4.084887505 4.085681438 4.086474895 4.087229252 4.08806324 4.088778019 4.08957243 4.09032774 4.091201782 4.091956615 4.092672825 4.093468189 4.094302654 4.095058441 4.095854282 4.096650124 4.097406387 4.098202705 4.098958969 4.099755287 4.100512028 4.101268768 4.102065563 4.102862835 4.10366106 4.104377747 4.105175018 4.105893135 4.10669136 4.107409 4.108207226 4.109004974 4.109803677 4.110521793 4.111320496 4.112040043 4.112839222 4.113637924 4.114357471 4.115156651 4.115876198 4.116675854 4.117395878 4.118196487 4.118916035 4.119716167 4.120436668 4.121237755 4.121957779 4.122678757 4.123479843 4.12428093 4.125002861 4.125803471 4.126525402 4.127326965 4.12804842 4.12885046 4.129572392 4.1302948 4.131016731 4.131819725 4.132542133 4.133264065 4.134068012 4.134790421 4.135514259 4.136236668 4.137040138 4.137763977 4.138487339 4.139291286 4.140095234 4.140738964 4.14146328 4.142267704 4.143072605 4.143716812 4.144441128 4.145246029 4.145971298 4.146696091 4.147420883 4.148226738 4.148871422 4.1496768 4.1504035 4.15104866 4.151854992 4.152662277 4.153307438 4.154033184 4.154840946 4.155566692 4.15621376 4.15693903 4.15766573 4.158392906 4.159200668 4.159928322 4.160655499 4.161383629 4.162111282 4.162838936 4.163485527 4.164294243 4.16502285 4.165669918 4.166398525 4.167207718 4.167856216 4.168665409 4.169394493 4.170042515 4.170771599 4.17150116 4.172230244 4.172959805 4.173689365 4.174419403 4.175067425 4.175798416 4.176527977 4.177258015 4.177906513 4.178719044 4.179368019 4.180099964 4.180830002 4.181480408 4.182210922 4.182941914 4.183673382 4.184323311 4.185136795 4.185787201 4.186518669 4.187251091 4.187901974 4.188634396 4.189285278 4.1900177 4.190750599 4.191483021 4.192133904 4.192867756 4.193600178 4.194251537 4.194985867 4.19563818 4.196371078 4.197104454 4.197757244 4.19849205 4.199143887 4.199877739 4.200530052 x0.6257938743 4.201265335 x0.6262823939 4.201999187 4.202652454 4.20338726 4.204122543 4.204775333 4.205429554 4.20616436 4.206818104 4.207472324 4.208208084 4.208861351 4.209597111 4.210333824 4.210987568 4.211642265 4.212378502 4.213033199 4.21377039 4.214506626 4.215079784 4.215816498 4.216553688 4.217208862 4.21786499 4.21860218 4.219256878 4.219995499 4.22065115 4.221307755 4.221963882 4.222701073 4.223275661 4.224095821 4.22467041 4.225409508 4.226065636 4.226722717 4.227461338 4.228118896 4.228775024 4.22943306 4.230172157 4.230829239 4.231568813 4.232226372 4.232801914 4.233541965 4.234200478 4.234858513 4.235599041 4.23617506 4.236915112 4.2375741 4.238232136 4.238973618 4.239631653 4.240290642 4.240949631 4.241608143 4.242268562 4.242927551 4.24358654 4.244328976 4.244905949 4.245565414 4.246308327 4.246967793 4.247544765 4.248205662 4.248948097 4.249526024 4.250268936 4.250929356 4.251589775 4.252250195 4.252911091 4.253572464 4.25423336 4.254894733 4.25555563 4.256217003 4.256877899 4.257540226 4.258202076 4.258863449 4.259524822 4.260187149 4.260849476 4.261510849 4.26209116 4.262752533 4.26341486 4.26407814 4.264823437 4.265403271 4.266066551 4.266728878 4.267308712 4.267972469 4.268635273 4.269382 4.269962788 4.270626068 4.271289349 4.271953583 4.27253437 4.273198128 4.273779869 4.274526119 4.275190353 4.275771618 4.276436329 4.27710104 4.277682304 4.278347015 4.27901268 4.279594421 4.280342102 4.28092432 4.281589031 4.282254219 4.282836437 4.283585548 4.284167767 4.284750462 4.28541708 4.286082745 4.286748886 4.287331581 4.287997723 4.288580418 4.289247036 4.289913177 4.290496826 4.291163445 4.291831017 4.292414188 4.293081284 4.293747902 4.294331551 4.294999123 4.295582771 4.29625082 4.296918869 4.297502518 4.298170567 4.298755169 4.299423218 4.300007343 4.300675392 4.301259995 4.30192852 4.302597046 4.303182125 4.303767204 4.304436207 4.305104733 4.305606365 4.306359768 4.306944847 4.30761385 4.308199406 4.308785915 4.309370995 4.310040951 4.31062746 4.31129694 4.31188345 4.312552452 4.313223839 4.313725948 4.314479828 4.314981937 4.315652847 4.316324234 4.316910744 4.317581654 4.318085194 4.318756104 4.319427013 4.3199296 4.320601463 4.321188927 4.32186079 4.322447777 4.323036194 4.323707581 4.324295998 4.324882984 4.325555325 4.326058865 4.326815605 4.327404022 4.327991962 4.328580379 4.329169273 4.329841614 4.330430508 4.330935478 4.331607342 4.332281113 4.332870483 4.333459854 4.334048748 4.334722042 4.335311413 4.335900784 4.336490154 4.337080002 4.337753296 4.33834362 4.338932991 4.339523792 4.340029716 4.340787888 4.341377735 4.34196806 4.342557907 4.343064785 4.34373951 4.344329357 4.345004559 4.345595837 4.346102238 4.346777916 4.347368717 4.347959995 4.348550797 4.349142075 4.349733353 4.350324631 4.350916386 4.351508141 4.352099895 4.352775574 4.353367329 4.353874683 4.354550838 4.35514307 4.355650425 4.356327534 4.356919765 4.357512474 4.358020306 4.358697414 4.359289169 4.359881878 4.360475063 4.360982895 4.361575603 4.362253189 4.362762451 4.363440037 4.364032269 4.364626884 4.365135193 4.365727901 4.366322041 4.366915703 4.367509842 4.368103027 4.368697166 4.369291306 4.369884491 4.37039423 4.371073723 4.371668339 4.372262001 4.37277174 4.373365879 4.373960495 4.374555111 4.37514925 4.37574482 4.376254559 4.376934052 4.377444744 4.378039837 4.37863493 4.379230976 4.379826069 4.380335808 4.381016254 4.381527424 4.38203764 4.382717609 4.383229733 4.383910656 4.384421825 4.385017872 4.385613441 4.386124134 4.386805534 4.387316704 4.387913704 4.388510227 4.389021397 4.389618874 4.390129566 4.390726566 4.391323566 4.39183569 4.39243269 4.393028736 4.39362669 4.394223213 4.394735813 4.39533329 4.395844936 4.396441936 4.397040844 4.397553444 4.398236275 4.398663521 4.399347305 4.399859905 4.400372505 4.400970459 4.40156889 4.40208149 4.402765751 4.403279305 4.403877258 4.404390335 4.404989243 4.40558815 4.406101704 4.406699657 4.407213688 4.407813072 4.408412933 4.408925533 4.409524918 4.410038948 4.410637856 4.411152363 4.41166687 4.412351608 4.412780285 4.413466454 4.413980484 4.414494991 4.415094376 4.415609837 4.416209698 4.416809559 4.41732502 4.417925358 4.418353558 4.419040203 4.419555187 4.420156479 4.420671463 4.421186447 4.421787739 4.422302723 4.422817707 4.423418999 4.423934937 4.424536228 4.425137997 4.425652981 4.426254272 4.42668438 4.427286148 4.427888393 4.428404331 4.429005623 4.429522991 4.430038452 4.430640221 4.431156635 4.43167305 4.432189941 4.432878017 4.433394432 4.4339118 4.434514523 4.434945107 4.435547352 4.436150551 4.436667442 4.437271118 4.437701225 4.438304901 4.438821793 4.439424992 4.439942837 4.440459251 4.440977573 4.441581249 4.442098141 4.442702293 4.443133831 4.443737507 4.444342613 4.444773674 4.445377827 4.445895672 4.446413994 4.447017193 4.447449684 4.448053837 4.448572636 4.449091434 4.44969511 4.450213909 4.450819969 4.451251507 4.45185709 4.452375889 4.452894211 4.453499794 4.454017639 4.454537392 4.455142498 4.455575943 4.456093788 4.456700325 4.457218647 4.457738876 4.458258152 4.458777428 4.45929718 4.45990324 4.460422993 4.460943222 4.461549759 4.46198225 4.462588787 4.463109016 4.463542461 4.464149475 4.464669228 4.465189934 4.465796471 4.466229916 4.466836929 4.467356682 4.467877865 4.468398571 4.468832493 4.469439983 4.46996069 4.470481873 4.471089363 4.471523285 4.472044468 4.472652435 4.473086357 4.473694324 4.4741292 4.474736691 4.475257874 4.475692749 4.476301193 4.476822376 4.477344036 4.477865696 4.478301048 4.478997231 4.479432106 4.479953289 4.480475903 4.480997086 4.481606483 4.482042313 4.482564449 4.483086109 4.483607769 4.484130859 4.48465395 4.485176086 4.485698223 4.486221313 4.486657143 4.487266541 4.487789154 4.488312721 4.488835335 4.489271164 4.489881039 4.490316868 4.490840435 4.491363525 4.491887093 4.492497444 4.492933273 4.493457317 4.493980885 4.494504452 4.495028496 4.495463848 4.496075153 4.496599674 4.49703598 4.497560024 4.498083591 4.498520851 4.499132156 4.499568939 4.500180721 4.500617504 4.501142025 4.501666546 4.502191067 4.502716064 4.503240108 4.503765106 4.504201889 x0.8754274845 4.50472641 x0.8759160042 4.505251408 4.505776405 4.506213665 4.506825924 4.507264137 4.507789135 4.508314133 4.508752346 4.509277344 4.509802341 4.510240078 4.510854244 4.511291504 4.511816978 4.51234293 4.512868881 4.513306618 4.513833046 4.514358521 4.514883995 4.515322685 4.51584816 4.516374588 4.516901016 4.517427444 4.517865658 4.518392086 4.518918514 4.519357204 4.519884109 4.520410061 4.520849228 4.521463394 4.521903515 4.522429466 4.522956371 4.523396015 4.523922443 4.52436161 4.524888992 4.525415897 4.525856018 4.526382923 4.526909828 4.527349472 4.527965546 4.528404713 4.528844357 4.529460907 4.529811859 4.530426979 4.5308671 4.53130722 4.531923294 4.532362938 4.532890797 4.533330917 4.533859253 4.534387112 4.534828663 4.535356522 4.53588438 4.536236286 4.536853313 4.537294388 4.537822247 4.538262844 4.53879118 4.539232254 4.539761543 4.540290356 4.540819645 4.541259766 4.54170084 4.542230129 4.54267025 4.543200493 4.543729305 4.54417038 4.544700146 4.54514122 4.545670509 4.546112537 4.546641827 4.547083378 4.547613144 4.548054695 4.548584461 4.549025536 4.549467564 4.54999733 4.550528049 4.550969124 4.551499844 4.551941395 4.552472115 4.553002357 4.553355694 4.553974628 4.55441618 4.554858685 4.555389881 4.555831909 4.55627346 4.556805611 4.557246685 4.557778358 4.558309078 4.558751583 4.559282303 4.559725285 4.560168266 4.560698986 4.561141968 4.561673641 4.562116623 4.562559128 4.563091278 4.563533783 4.564065456 4.564508438 4.56495142 4.565483093 4.56601572 4.566458702 4.566902637 4.567345142 4.567788601 4.568409443 4.568853378 4.56929636 4.569828987 4.570183754 4.570716858 4.571248531 4.571692467 4.572135925 4.572669506 4.573023796 4.5735569 4.574001312 4.574533463 4.574977875 4.575422287 4.575954914 4.576399326 4.576843262 4.577376842 4.577820778 4.578265667 4.578798771 4.579243183 4.579776287 4.580221653 4.580666065 4.581110954 4.581644058 4.582088947 4.582534313 4.583067417 4.583512306 4.583958149 4.584403038 4.584936619 4.585381985 4.585826874 4.586272717 4.586807251 4.587162495 4.587697506 4.588231564 4.588676929 4.589122295 4.589568615 4.590013504 4.590548038 4.590993881 4.591439724 4.591974735 4.592331409 4.592866421 4.593400955 4.593758106 4.594293118 4.59473896 4.595185757 4.595630169 4.596077919 4.596612453 4.597058773 4.597504616 4.597951889 4.598487377 4.598844051 4.599379539 4.599826336 4.600273132 4.600719929 4.601255417 4.601613045 4.60214901 4.602596283 4.603042603 4.603489876 4.603936195 4.604383469 4.604830742 4.605366707 4.60581398 4.606261253 4.60670805 4.607155323 4.607692242 4.60804987 4.608497143 4.609033585 4.609481812 4.609929562 4.610376358 4.610824585 4.611271858 4.611719131 4.612166882 4.612614155 4.613152027 4.613599777 4.614047527 4.614495277 4.614943027 4.615391254 4.615839481 4.616287231 4.616735458 4.617183685 4.617631912 4.618169785 4.618528843 4.61897707 4.619425297 4.619874001 4.620322227 4.620861053 4.621219158 4.621757507 4.622206211 4.622655392 4.623104095 4.623552799 4.624001503 4.624450207 4.624899387 4.625258446 4.625796795 4.626245975 4.626694679}
    green {curve 0 x0.000488519785 0.3155371845 0.4557278752 0.5572770834 0.6389417648 0.7080863714 x0.00293111871 0.7684537172 0.8222920299 0.8710434437 0.9156916738 0.9569416642 x0.005373717751 0.9953647256 x0.00586223742 1.031342387 1.065215945 x0.006839277223 1.097246885 x0.007327796891 1.127625942 1.1565516 1.18417263 1.210611701 1.235978842 1.260344386 x0.01025891583 1.283829927 x0.0107474355 1.306484222 1.328353047 1.349516273 1.370035648 1.389927149 1.409237504 x0.01367855445 1.428004384 x0.01416707411 1.446283937 1.464051604 1.48137033 1.49829185 1.5147686 1.530887127 1.546601415 1.562017918 1.577063084 1.591817141 1.606268764 1.620422602 x0.020029312 1.634301901 x0.02051783167 1.647912741 1.661279559 1.674377203 1.687264919 1.699935555 1.712349534 1.724600911 1.736634016 1.748460293 1.760126472 1.771592498 1.782871962 1.793977737 1.804940343 x0.02735710889 1.815739393 x0.02784562856 1.826370597 1.836866736 1.847224355 1.857404113 1.867494464 1.877436757 1.887247682 1.896924973 1.906464934 1.915921926 1.925237656 1.934447169 1.943548679 1.95255959 1.961439729 1.970244527 1.978953481 1.987545848 1.996038675 2.004450083 2.012759447 2.020984411 2.029144049 2.03719759 x0.03957010433 2.045162678 x0.040058624 2.053059101 2.060864925 2.068619251 2.076281548 2.083870173 2.091404915 2.098843336 2.106226444 2.113511562 2.12078023 2.127949238 2.135038137 2.14212966 2.149119139 2.156025887 2.162891388 2.169694424 2.176475286 2.183150291 2.189781189 2.19634676 2.202888489 2.209363461 2.215793133 2.222175837 2.22851181 2.234778881 2.241019249 2.247189522 2.25331068 x0.05471421778 2.259382725 x0.05520273745 2.265448332 2.271441936 2.277362108 2.283297777 2.289182186 2.295014143 2.300793648 2.306542873 2.312238693 2.317880869 2.323513746 2.329114676 2.334638357 2.340174913 2.345633268 2.351080894 2.356472492 2.361853361 2.367154121 2.372467041 2.377744913 2.382941723 2.388173342 2.393322468 2.398459673 2.40358448 2.40862608 2.413655043 2.418670177 2.423672676 2.428614616 2.43354249 2.438432455 2.44328475 2.448122978 2.452923059 2.45770812 2.462454796 2.467186451 2.471879005 2.476556301 2.481193542 2.485815763 2.490422487 2.494988441 2.499538898 2.504073143 2.508566141 x0.07865168899 2.513042927 x0.07914020866 2.517478943 2.52192235 2.526324272 2.530684948 2.535052776 2.539403677 2.543687105 2.548002958 2.552276134 2.556531668 2.56071949 2.564938545 2.569140196 2.573298216 2.577437878 2.58155942 2.585661888 2.589745522 2.59381032 2.597856045 2.601883173 2.605916023 2.609879017 2.613848209 2.617797136 2.621752977 2.62563777 2.629528046 2.633424282 2.637274742 2.641130924 2.644966602 2.648756266 2.6525774 2.656352282 2.660132408 2.663840055 2.667604685 2.671296597 2.674993753 2.678669691 2.682324409 2.68598485 2.689623117 2.693240643 2.696862698 2.700411081 2.703990221 2.707547665 2.711082935 2.714622974 2.718168259 2.721664429 2.725112438 2.728617907 2.732074499 2.73550868 2.738947153 2.742363453 2.745757341 2.749154568 2.752530098 x0.1094284356 2.755882502 x0.1099169552 2.759266376 2.762599945 2.765884399 2.769225597 2.772544146 2.775812864 2.779085636 2.782361746 2.785614491 2.78884387 2.792077541 2.795287371 2.798473835 2.801690578 2.804884672 2.808027029 2.811200142 2.814322233 2.817447424 2.820576668 2.823709011 2.826790094 2.8298738 2.832961321 2.836052895 2.839091778 2.842161894 2.845179319 2.84820056 2.851196766 2.854224205 2.857198954 2.860204458 2.863157511 2.866113901 2.869073391 2.872035503 2.87497282 2.877885103 2.880800486 2.883718491 2.886611462 2.889507771 2.892377853 2.895223618 2.898099184 2.90092206 2.903803587 2.906632423 2.909463167 2.912240028 2.915048122 2.917829752 2.92064333 2.92343092 2.926192522 2.928928137 2.931723833 2.934435606 2.937179804 2.939925194 2.942616463 2.945339203 2.948035479 2.9507339 2.953434706 2.956051826 2.958786964 2.961437225 2.964003801 2.966688395 2.969346285 2.971977234 2.974582195 2.977189064 2.97979784 2.982409239 2.985023022 2.987551451 2.990169525 2.992760897 2.99529624 2.997833729 3.000373125 3.002914906 3.005458832 3.00797534 3.010523558 3.012985468 3.015508413 3.017974854 3.020442724 3.022972107 3.025503397 3.027947903 3.030365467 x0.1568148583 3.032814503 x0.157303378 3.035265684 3.037747383 3.040143013 3.042599678 3.04496932 3.0474298 3.049892426 3.0522089 3.054615498 3.057054043 3.059434652 3.06175828 3.064142942 3.066529274 3.06885767 3.071247816 3.073609829 3.07594347 3.078249693 3.080557108 3.082895994 3.085206509 3.087519407 3.089893818 3.092089415 3.094377041 3.096636295 3.098987579 3.101189852 3.103544474 3.105749846 3.108107805 3.110346556 3.112527132 3.114768267 3.116951942 3.119227171 3.121413231 3.123661995 3.125880957 3.128072023 3.130294323 3.132518768 3.134683132 3.136941195 3.139048338 3.14121747 3.143388271 3.145529985 3.147704363 3.149939775 3.152024984 3.154203415 3.156290531 3.158410788 3.160562277 3.1626544 3.164870501 3.166903734 3.169060707 3.17109704 3.173257351 3.175295353 3.177366018 3.17946887 3.181604147 3.183709621 3.185723782 3.187770367 3.189848661 3.191928625 3.193947315 3.195999384 3.198083401 3.200137138 3.202099562 3.204124928 3.206152201 3.208180428 3.210178137 3.212208748 3.214209318 3.21624279 3.218245745 3.22021842 3.222224951 3.224168539 3.226176023 3.228123188 3.230102062 3.232051373 3.234032631 3.235984087 3.237999439 3.23988986 3.241844416 3.243768454 3.245725393 3.247652769 3.249612093 3.251477242 3.253470659 3.255370378 3.257238626 3.259172201 3.261107445 3.263011694 3.264884949 3.26675868 3.268634319 3.27057457 3.272387981 3.274298906 3.276178837 3.278059244 3.279909372 3.281728029 3.283612251 3.285465956 3.28731966 3.289142609 3.290999174 3.292888403 3.294682503 3.296541929 3.298337698 x0.2188568711 3.300134897 x0.2193453908 3.301996946 3.303796291 3.30559659 3.307461739 3.309199333 3.311067104 3.312871695 3.314676523 3.316450357 3.318257093 3.320065022 3.321776867 3.323585987 3.325365305 3.327112913 3.328892708 3.330641508 3.332424164 3.334207058 3.335958719 3.337743998 3.339400053 3.341186762 3.342909575 3.344633102 3.346358061 3.348083019 3.349809408 3.351602077 3.353330374 3.355059147 3.356724262 3.358454466 3.360153675 3.361886024 3.363586903 3.365255594 3.36692524 3.368628502 3.370365143 3.372004986 3.373743296 3.375384092 3.377058744 3.378767252 3.38041091 3.382120848 3.383766174 3.38544488 3.387091398 3.388738871 3.390387297 3.392036676 3.393686056 3.395336628 3.396988153 3.398640633 3.400293827 3.401881218 3.403535366 3.405091763 3.40674758 3.408405066 3.409996033 3.411621332 3.413280964 3.414808273 3.416435719 3.418030977 3.419593334 3.421257019 3.422821283 3.424385548 3.42605114 3.427617788 3.429184437 3.430785656 3.43235445 3.433923244 3.435493708 3.437096834 3.438668728 3.440173864 3.441813231 3.443320036 3.444893837 3.446401834 3.4480443 3.449553251 3.451130629 3.45264101 3.45421958 3.455798626 3.457277775 3.458790779 3.460371733 3.461885929 3.463435173 3.464951515 3.466468096 3.467951059 3.469536781 3.471055031 3.472540617 3.474060535 3.475547075 3.477068186 3.478556156 3.480078697 3.481567621 3.483057737 3.484514475 3.486005783 3.487497568 3.489023685 3.490448952 3.491942406 3.493436813 3.494898558 3.496393442 3.497889996 3.499318123 3.500747919 3.502245665 3.503744841 3.505176067 3.506641388 3.508108139 3.509541035 3.510974646 3.512476921 3.513843298 3.515347481 3.516782761 3.518219233 3.519656181 3.521060467 3.522498131 3.523936749 3.525375843 3.526781797 3.528290987 3.529663563 3.531070709 3.532513142 3.533955574 3.535296202 3.536740303 3.538150311 3.539595604 3.540938377 3.542384148 3.543796301 3.545175076 3.546519756 3.547899485 3.549383163 3.550729275 3.552110195 3.55345726 3.554874897 3.556257248 3.557675362 3.559023619 3.560408831 3.561758995 3.563109636 3.564530611 3.565882444 3.567234039 3.568622112 3.569974899 3.571329355 3.572683573 3.574038267 3.575393915 3.57675004 3.578036785 3.579463005 3.580821037 3.582178593 3.583537102 3.584826946 3.586186171 3.58754611 3.588836908 3.590162992 3.591454506 3.592816353 3.594178677 3.595472336 3.596801043 x0.313141197 3.598094702 x0.3136297166 3.59945941 3.60078907 3.602084875 3.603380442 3.604746819 3.606009245 3.607306719 3.608603716 3.609936953 3.611235857 3.612500191 3.613800049 3.615099907 3.616435528 3.617666483 3.619003773 3.6203053 3.621572495 3.622875214 3.624143362 3.625411987 3.626716852 3.627950907 3.629291296 3.630561113 3.631832123 3.633068562 3.634410381 3.635611773 3.636919737 3.638193369 3.639395475 3.64070487 3.641979218 3.643183231 3.644458532 3.645734072 3.646974087 3.648180485 3.649456978 3.650734425 3.651941061 3.653219938 3.654462814 3.655741453 3.656950235 3.658158779 3.659439802 3.660649061 3.661859035 3.663140774 3.664352417 3.665563583 3.666846514 3.668058395 3.669199228 3.670483351 3.671696901 3.672911406 3.674124718 3.67533946 3.676554441 3.677769423 3.679020882 3.680165291 3.681382418 3.682599068 3.683816433 3.685034037 3.686180353 3.687363148 3.688581705 3.689872742 3.691056728 3.692133665 3.693425894 3.694574594 3.695759773 3.696909666 3.698132038 3.699317932 3.700540304 3.701763868 3.70287919 3.704031944 3.705255985 3.706444502 3.707598209 3.708787441 3.709940672 3.711130857 3.712285757 3.713476419 3.714559317 3.715787172 3.716906548 3.718135834 3.719256401 3.720413446 3.721606731 3.722764492 3.723886013 3.725044489 3.72623992 3.727362871 3.728449583 3.729646206 3.730806112 3.731930733 3.733127594 3.734216213 3.735341311 3.7364676 3.737665892 3.738755941 3.739882708 3.741045952 3.742173433 3.743301392 3.744428873 3.745521069 3.746649981 3.747852087 3.748944998 3.750074625 3.751204729 3.752262115 3.753392935 3.754560232 3.755618811 3.756750345 3.757882357 3.758941889 3.760147572 3.761244774 3.762304544 3.763438702 3.764499426 3.765633345 3.766695261 3.767830372 3.76889205 3.770028353 3.771164417 3.772264004 3.773326874 3.774391174 3.775528193 3.776666164 3.77773118 3.778795004 3.779860735 3.780926228 3.78206563 3.783131599 3.784234524 3.78533864 3.786405563 3.787472963 3.788540602 3.789644957 3.790640116 3.791708231 3.792850971 3.793919563 3.794988871 3.79605937 3.797129154 3.798199654 3.79923296 3.800304413 3.801375628 3.802446842 3.803519011 3.80459094 3.805626392 3.806624651 3.807771921 3.80877161 3.809881926 3.810881615 3.81195569 3.81303072 3.814030886 3.815069199 3.816144705 3.817145586 3.818259001 3.819261074 3.820338011 3.821414471 3.822380304 3.823384047 3.824461222 3.825501919 3.826505899 3.82758379 3.828588724 3.829631329 3.830710411 3.831715345 3.832758427 3.833764315 3.834807634 3.835813522 3.836819887 3.837864637 3.838871479 3.839879036 3.840924263 3.841932297 3.842977762 3.843985796 3.845032215 3.845966101 3.84701252 3.848022699 3.849069357 3.850079536 3.851014853 3.852063179 3.853073597 3.854048014 3.855058908 3.856108427 3.857082844 3.858094692 3.859070063 3.860082865 3.861057997 3.862070799 3.863046885 3.864060879 3.865036726 3.86608839 3.86702776 3.868042707 3.869019985 3.86999774 3.871013641 3.871991396 3.872969627 3.873986721 3.874965429 3.875906706 3.876961946 3.877865791 3.878883839 3.879863262 3.880843401 3.881862402 3.8827672 3.8837111 3.884767771 x0.4377137423 3.885749817 x0.4382022619 3.886655569 3.887676001 3.888657808 3.889564991 3.890585661 3.891493082 3.89247632 3.893421888 3.894405842 3.895390272 3.896298409 3.897320747 3.898229837 3.899214983 3.90019989 3.901148081 3.902058125 3.903043985 3.903954029 3.904978275 3.905888796 3.906876087 3.907787323 3.908736229 3.909724236 3.91063571 3.911548138 3.912536621 3.913449049 3.914437771 3.915389299 3.916301727 3.917215586 3.918204784 3.919119596 3.92010951 3.920985699 3.921900272 3.922814608 3.923729658 3.924721241 3.925636292 3.926628113 3.92750597 3.928498507 3.929414272 3.930330992 3.931170464 3.932164192 3.933081388 3.933998823 3.934916258 3.935872793 3.936828852 3.937708616 3.938627243 3.939545155 3.940464735 3.941383362 3.942302227 3.943144798 3.944141388 3.945061207 3.945981741 3.94690156 3.947745323 3.948666096 3.949587345 3.950508595 3.951429605 3.952350616 3.953196287 3.954117537 3.955039978 3.95596242 3.956808329 3.957731009 3.958654404 3.95957756 3.960423708 3.961347342 3.962194681 3.963195086 3.964042664 3.964890003 3.965815067 3.966739416 3.967587233 3.968512774 3.969360828 3.970247984 3.971174479 3.97202301 3.972872496 3.973875999 3.974725246 3.975574493 3.976424456 3.977352142 3.978241444 3.979130983 3.979981184 3.980870485 3.98172164 3.982649803 3.983501911 3.98443079 3.985282421 3.986134052 3.987025023 3.987838984 3.988729715 3.989582539 3.990512609 3.991366148 3.992257595 3.993111134 3.993965149 3.994818687 3.995672464 3.996526957 3.997458458 3.998352051 3.999129295 4.000061512 4.000916958 4.001771927 4.002589226 4.003444195 4.004300117 4.005233765 4.006051064 4.006868839 4.007763863 4.008543491 4.009478092 4.010295868 4.011153698 4.012010098 4.012867928 4.013725758 4.014544964 4.015402794 4.016261101 4.017120361 4.017939568 4.018798828 4.019579411 4.020516872 4.021297932 4.022118568 4.022978306 4.02383852 4.024737835 4.025519371 4.026380062 4.027162552 4.028062344 4.028844833 4.029706478 4.030528545 4.031390667 4.032251835 4.033035755 4.033857822 4.034720421 4.035505295 4.036328316 4.037190914 4.038053989 4.038877487 4.039662361 4.04052639 4.041350365 4.042135715 4.042999744 4.043785572 4.0446105 4.045474529 4.046260834 4.047086716 4.047951698 4.048698902 4.049485683 4.050351143 4.051177502 4.052043915 4.052831173 4.053658009 4.05444622 4.055273056 4.056139469 4.056927681 4.057676315 4.058465481 4.059332848 4.060161114 4.060949802 4.061738491 4.062488079 4.063396931 4.064186096 4.064975262 4.065765381 4.066516399 4.067385197 4.068175793 4.069005489 4.069796085 4.070627213 4.071417809 4.072169304 4.073039532 4.073792458 4.074583054 4.07537508 4.076127529 4.076919556 4.07775116 4.078543186 4.07933569 4.080088615 4.080961227 4.081714153 4.082507133 4.083261013 4.084134102 4.084887505 4.085681438 4.086474895 4.087229252 4.08806324 4.088778019 4.08957243 4.09032774 4.091201782 4.091956615 4.092672825 4.093468189 4.094302654 4.095058441 4.095854282 4.096650124 4.097406387 4.098202705 4.098958969 4.099755287 4.100512028 4.101268768 4.102065563 4.102862835 4.10366106 4.104377747 4.105175018 4.105893135 4.10669136 4.107409 4.108207226 4.109004974 4.109803677 4.110521793 4.111320496 4.112040043 4.112839222 4.113637924 4.114357471 4.115156651 4.115876198 4.116675854 4.117395878 4.118196487 4.118916035 4.119716167 4.120436668 4.121237755 4.121957779 4.122678757 4.123479843 4.12428093 4.125002861 4.125803471 4.126525402 4.127326965 4.12804842 4.12885046 4.129572392 4.1302948 4.131016731 4.131819725 4.132542133 4.133264065 4.134068012 4.134790421 4.135514259 4.136236668 4.137040138 4.137763977 4.138487339 4.139291286 4.140095234 4.140738964 4.14146328 4.142267704 4.143072605 4.143716812 4.144441128 4.145246029 4.145971298 4.146696091 4.147420883 4.148226738 4.148871422 4.1496768 4.1504035 4.15104866 4.151854992 4.152662277 4.153307438 4.154033184 4.154840946 4.155566692 4.15621376 4.15693903 4.15766573 4.158392906 4.159200668 4.159928322 4.160655499 4.161383629 4.162111282 4.162838936 4.163485527 4.164294243 4.16502285 4.165669918 4.166398525 4.167207718 4.167856216 4.168665409 4.169394493 4.170042515 4.170771599 4.17150116 4.172230244 4.172959805 4.173689365 4.174419403 4.175067425 4.175798416 4.176527977 4.177258015 4.177906513 4.178719044 4.179368019 4.180099964 4.180830002 4.181480408 4.182210922 4.182941914 4.183673382 4.184323311 4.185136795 4.185787201 4.186518669 4.187251091 4.187901974 4.188634396 4.189285278 4.1900177 4.190750599 4.191483021 4.192133904 4.192867756 4.193600178 4.194251537 4.194985867 4.19563818 4.196371078 4.197104454 4.197757244 4.19849205 4.199143887 4.199877739 4.200530052 x0.6257938743 4.201265335 x0.6262823939 4.201999187 4.202652454 4.20338726 4.204122543 4.204775333 4.205429554 4.20616436 4.206818104 4.207472324 4.208208084 4.208861351 4.209597111 4.210333824 4.210987568 4.211642265 4.212378502 4.213033199 4.21377039 4.214506626 4.215079784 4.215816498 4.216553688 4.217208862 4.21786499 4.21860218 4.219256878 4.219995499 4.22065115 4.221307755 4.221963882 4.222701073 4.223275661 4.224095821 4.22467041 4.225409508 4.226065636 4.226722717 4.227461338 4.228118896 4.228775024 4.22943306 4.230172157 4.230829239 4.231568813 4.232226372 4.232801914 4.233541965 4.234200478 4.234858513 4.235599041 4.23617506 4.236915112 4.2375741 4.238232136 4.238973618 4.239631653 4.240290642 4.240949631 4.241608143 4.242268562 4.242927551 4.24358654 4.244328976 4.244905949 4.245565414 4.246308327 4.246967793 4.247544765 4.248205662 4.248948097 4.249526024 4.250268936 4.250929356 4.251589775 4.252250195 4.252911091 4.253572464 4.25423336 4.254894733 4.25555563 4.256217003 4.256877899 4.257540226 4.258202076 4.258863449 4.259524822 4.260187149 4.260849476 4.261510849 4.26209116 4.262752533 4.26341486 4.26407814 4.264823437 4.265403271 4.266066551 4.266728878 4.267308712 4.267972469 4.268635273 4.269382 4.269962788 4.270626068 4.271289349 4.271953583 4.27253437 4.273198128 4.273779869 4.274526119 4.275190353 4.275771618 4.276436329 4.27710104 4.277682304 4.278347015 4.27901268 4.279594421 4.280342102 4.28092432 4.281589031 4.282254219 4.282836437 4.283585548 4.284167767 4.284750462 4.28541708 4.286082745 4.286748886 4.287331581 4.287997723 4.288580418 4.289247036 4.289913177 4.290496826 4.291163445 4.291831017 4.292414188 4.293081284 4.293747902 4.294331551 4.294999123 4.295582771 4.29625082 4.296918869 4.297502518 4.298170567 4.298755169 4.299423218 4.300007343 4.300675392 4.301259995 4.30192852 4.302597046 4.303182125 4.303767204 4.304436207 4.305104733 4.305606365 4.306359768 4.306944847 4.30761385 4.308199406 4.308785915 4.309370995 4.310040951 4.31062746 4.31129694 4.31188345 4.312552452 4.313223839 4.313725948 4.314479828 4.314981937 4.315652847 4.316324234 4.316910744 4.317581654 4.318085194 4.318756104 4.319427013 4.3199296 4.320601463 4.321188927 4.32186079 4.322447777 4.323036194 4.323707581 4.324295998 4.324882984 4.325555325 4.326058865 4.326815605 4.327404022 4.327991962 4.328580379 4.329169273 4.329841614 4.330430508 4.330935478 4.331607342 4.332281113 4.332870483 4.333459854 4.334048748 4.334722042 4.335311413 4.335900784 4.336490154 4.337080002 4.337753296 4.33834362 4.338932991 4.339523792 4.340029716 4.340787888 4.341377735 4.34196806 4.342557907 4.343064785 4.34373951 4.344329357 4.345004559 4.345595837 4.346102238 4.346777916 4.347368717 4.347959995 4.348550797 4.349142075 4.349733353 4.350324631 4.350916386 4.351508141 4.352099895 4.352775574 4.353367329 4.353874683 4.354550838 4.35514307 4.355650425 4.356327534 4.356919765 4.357512474 4.358020306 4.358697414 4.359289169 4.359881878 4.360475063 4.360982895 4.361575603 4.362253189 4.362762451 4.363440037 4.364032269 4.364626884 4.365135193 4.365727901 4.366322041 4.366915703 4.367509842 4.368103027 4.368697166 4.369291306 4.369884491 4.37039423 4.371073723 4.371668339 4.372262001 4.37277174 4.373365879 4.373960495 4.374555111 4.37514925 4.37574482 4.376254559 4.376934052 4.377444744 4.378039837 4.37863493 4.379230976 4.379826069 4.380335808 4.381016254 4.381527424 4.38203764 4.382717609 4.383229733 4.383910656 4.384421825 4.385017872 4.385613441 4.386124134 4.386805534 4.387316704 4.387913704 4.388510227 4.389021397 4.389618874 4.390129566 4.390726566 4.391323566 4.39183569 4.39243269 4.393028736 4.39362669 4.394223213 4.394735813 4.39533329 4.395844936 4.396441936 4.397040844 4.397553444 4.398236275 4.398663521 4.399347305 4.399859905 4.400372505 4.400970459 4.40156889 4.40208149 4.402765751 4.403279305 4.403877258 4.404390335 4.404989243 4.40558815 4.406101704 4.406699657 4.407213688 4.407813072 4.408412933 4.408925533 4.409524918 4.410038948 4.410637856 4.411152363 4.41166687 4.412351608 4.412780285 4.413466454 4.413980484 4.414494991 4.415094376 4.415609837 4.416209698 4.416809559 4.41732502 4.417925358 4.418353558 4.419040203 4.419555187 4.420156479 4.420671463 4.421186447 4.421787739 4.422302723 4.422817707 4.423418999 4.423934937 4.424536228 4.425137997 4.425652981 4.426254272 4.42668438 4.427286148 4.427888393 4.428404331 4.429005623 4.429522991 4.430038452 4.430640221 4.431156635 4.43167305 4.432189941 4.432878017 4.433394432 4.4339118 4.434514523 4.434945107 4.435547352 4.436150551 4.436667442 4.437271118 4.437701225 4.438304901 4.438821793 4.439424992 4.439942837 4.440459251 4.440977573 4.441581249 4.442098141 4.442702293 4.443133831 4.443737507 4.444342613 4.444773674 4.445377827 4.445895672 4.446413994 4.447017193 4.447449684 4.448053837 4.448572636 4.449091434 4.44969511 4.450213909 4.450819969 4.451251507 4.45185709 4.452375889 4.452894211 4.453499794 4.454017639 4.454537392 4.455142498 4.455575943 4.456093788 4.456700325 4.457218647 4.457738876 4.458258152 4.458777428 4.45929718 4.45990324 4.460422993 4.460943222 4.461549759 4.46198225 4.462588787 4.463109016 4.463542461 4.464149475 4.464669228 4.465189934 4.465796471 4.466229916 4.466836929 4.467356682 4.467877865 4.468398571 4.468832493 4.469439983 4.46996069 4.470481873 4.471089363 4.471523285 4.472044468 4.472652435 4.473086357 4.473694324 4.4741292 4.474736691 4.475257874 4.475692749 4.476301193 4.476822376 4.477344036 4.477865696 4.478301048 4.478997231 4.479432106 4.479953289 4.480475903 4.480997086 4.481606483 4.482042313 4.482564449 4.483086109 4.483607769 4.484130859 4.48465395 4.485176086 4.485698223 4.486221313 4.486657143 4.487266541 4.487789154 4.488312721 4.488835335 4.489271164 4.489881039 4.490316868 4.490840435 4.491363525 4.491887093 4.492497444 4.492933273 4.493457317 4.493980885 4.494504452 4.495028496 4.495463848 4.496075153 4.496599674 4.49703598 4.497560024 4.498083591 4.498520851 4.499132156 4.499568939 4.500180721 4.500617504 4.501142025 4.501666546 4.502191067 4.502716064 4.503240108 4.503765106 4.504201889 x0.8754274845 4.50472641 x0.8759160042 4.505251408 4.505776405 4.506213665 4.506825924 4.507264137 4.507789135 4.508314133 4.508752346 4.509277344 4.509802341 4.510240078 4.510854244 4.511291504 4.511816978 4.51234293 4.512868881 4.513306618 4.513833046 4.514358521 4.514883995 4.515322685 4.51584816 4.516374588 4.516901016 4.517427444 4.517865658 4.518392086 4.518918514 4.519357204 4.519884109 4.520410061 4.520849228 4.521463394 4.521903515 4.522429466 4.522956371 4.523396015 4.523922443 4.52436161 4.524888992 4.525415897 4.525856018 4.526382923 4.526909828 4.527349472 4.527965546 4.528404713 4.528844357 4.529460907 4.529811859 4.530426979 4.5308671 4.53130722 4.531923294 4.532362938 4.532890797 4.533330917 4.533859253 4.534387112 4.534828663 4.535356522 4.53588438 4.536236286 4.536853313 4.537294388 4.537822247 4.538262844 4.53879118 4.539232254 4.539761543 4.540290356 4.540819645 4.541259766 4.54170084 4.542230129 4.54267025 4.543200493 4.543729305 4.54417038 4.544700146 4.54514122 4.545670509 4.546112537 4.546641827 4.547083378 4.547613144 4.548054695 4.548584461 4.549025536 4.549467564 4.54999733 4.550528049 4.550969124 4.551499844 4.551941395 4.552472115 4.553002357 4.553355694 4.553974628 4.55441618 4.554858685 4.555389881 4.555831909 4.55627346 4.556805611 4.557246685 4.557778358 4.558309078 4.558751583 4.559282303 4.559725285 4.560168266 4.560698986 4.561141968 4.561673641 4.562116623 4.562559128 4.563091278 4.563533783 4.564065456 4.564508438 4.56495142 4.565483093 4.56601572 4.566458702 4.566902637 4.567345142 4.567788601 4.568409443 4.568853378 4.56929636 4.569828987 4.570183754 4.570716858 4.571248531 4.571692467 4.572135925 4.572669506 4.573023796 4.5735569 4.574001312 4.574533463 4.574977875 4.575422287 4.575954914 4.576399326 4.576843262 4.577376842 4.577820778 4.578265667 4.578798771 4.579243183 4.579776287 4.580221653 4.580666065 4.581110954 4.581644058 4.582088947 4.582534313 4.583067417 4.583512306 4.583958149 4.584403038 4.584936619 4.585381985 4.585826874 4.586272717 4.586807251 4.587162495 4.587697506 4.588231564 4.588676929 4.589122295 4.589568615 4.590013504 4.590548038 4.590993881 4.591439724 4.591974735 4.592331409 4.592866421 4.593400955 4.593758106 4.594293118 4.59473896 4.595185757 4.595630169 4.596077919 4.596612453 4.597058773 4.597504616 4.597951889 4.598487377 4.598844051 4.599379539 4.599826336 4.600273132 4.600719929 4.601255417 4.601613045 4.60214901 4.602596283 4.603042603 4.603489876 4.603936195 4.604383469 4.604830742 4.605366707 4.60581398 4.606261253 4.60670805 4.607155323 4.607692242 4.60804987 4.608497143 4.609033585 4.609481812 4.609929562 4.610376358 4.610824585 4.611271858 4.611719131 4.612166882 4.612614155 4.613152027 4.613599777 4.614047527 4.614495277 4.614943027 4.615391254 4.615839481 4.616287231 4.616735458 4.617183685 4.617631912 4.618169785 4.618528843 4.61897707 4.619425297 4.619874001 4.620322227 4.620861053 4.621219158 4.621757507 4.622206211 4.622655392 4.623104095 4.623552799 4.624001503 4.624450207 4.624899387 4.625258446 4.625796795 4.626245975 4.626694679}
    blue {curve 0 x0.000488519785 0.3155371845 0.4557278752 0.5572770834 0.6389417648 0.7080863714 x0.00293111871 0.7684537172 0.8222920299 0.8710434437 0.9156916738 0.9569416642 x0.005373717751 0.9953647256 x0.00586223742 1.031342387 1.065215945 x0.006839277223 1.097246885 x0.007327796891 1.127625942 1.1565516 1.18417263 1.210611701 1.235978842 1.260344386 x0.01025891583 1.283829927 x0.0107474355 1.306484222 1.328353047 1.349516273 1.370035648 1.389927149 1.409237504 x0.01367855445 1.428004384 x0.01416707411 1.446283937 1.464051604 1.48137033 1.49829185 1.5147686 1.530887127 1.546601415 1.562017918 1.577063084 1.591817141 1.606268764 1.620422602 x0.020029312 1.634301901 x0.02051783167 1.647912741 1.661279559 1.674377203 1.687264919 1.699935555 1.712349534 1.724600911 1.736634016 1.748460293 1.760126472 1.771592498 1.782871962 1.793977737 1.804940343 x0.02735710889 1.815739393 x0.02784562856 1.826370597 1.836866736 1.847224355 1.857404113 1.867494464 1.877436757 1.887247682 1.896924973 1.906464934 1.915921926 1.925237656 1.934447169 1.943548679 1.95255959 1.961439729 1.970244527 1.978953481 1.987545848 1.996038675 2.004450083 2.012759447 2.020984411 2.029144049 2.03719759 x0.03957010433 2.045162678 x0.040058624 2.053059101 2.060864925 2.068619251 2.076281548 2.083870173 2.091404915 2.098843336 2.106226444 2.113511562 2.12078023 2.127949238 2.135038137 2.14212966 2.149119139 2.156025887 2.162891388 2.169694424 2.176475286 2.183150291 2.189781189 2.19634676 2.202888489 2.209363461 2.215793133 2.222175837 2.22851181 2.234778881 2.241019249 2.247189522 2.25331068 x0.05471421778 2.259382725 x0.05520273745 2.265448332 2.271441936 2.277362108 2.283297777 2.289182186 2.295014143 2.300793648 2.306542873 2.312238693 2.317880869 2.323513746 2.329114676 2.334638357 2.340174913 2.345633268 2.351080894 2.356472492 2.361853361 2.367154121 2.372467041 2.377744913 2.382941723 2.388173342 2.393322468 2.398459673 2.40358448 2.40862608 2.413655043 2.418670177 2.423672676 2.428614616 2.43354249 2.438432455 2.44328475 2.448122978 2.452923059 2.45770812 2.462454796 2.467186451 2.471879005 2.476556301 2.481193542 2.485815763 2.490422487 2.494988441 2.499538898 2.504073143 2.508566141 x0.07865168899 2.513042927 x0.07914020866 2.517478943 2.52192235 2.526324272 2.530684948 2.535052776 2.539403677 2.543687105 2.548002958 2.552276134 2.556531668 2.56071949 2.564938545 2.569140196 2.573298216 2.577437878 2.58155942 2.585661888 2.589745522 2.59381032 2.597856045 2.601883173 2.605916023 2.609879017 2.613848209 2.617797136 2.621752977 2.62563777 2.629528046 2.633424282 2.637274742 2.641130924 2.644966602 2.648756266 2.6525774 2.656352282 2.660132408 2.663840055 2.667604685 2.671296597 2.674993753 2.678669691 2.682324409 2.68598485 2.689623117 2.693240643 2.696862698 2.700411081 2.703990221 2.707547665 2.711082935 2.714622974 2.718168259 2.721664429 2.725112438 2.728617907 2.732074499 2.73550868 2.738947153 2.742363453 2.745757341 2.749154568 2.752530098 x0.1094284356 2.755882502 x0.1099169552 2.759266376 2.762599945 2.765884399 2.769225597 2.772544146 2.775812864 2.779085636 2.782361746 2.785614491 2.78884387 2.792077541 2.795287371 2.798473835 2.801690578 2.804884672 2.808027029 2.811200142 2.814322233 2.817447424 2.820576668 2.823709011 2.826790094 2.8298738 2.832961321 2.836052895 2.839091778 2.842161894 2.845179319 2.84820056 2.851196766 2.854224205 2.857198954 2.860204458 2.863157511 2.866113901 2.869073391 2.872035503 2.87497282 2.877885103 2.880800486 2.883718491 2.886611462 2.889507771 2.892377853 2.895223618 2.898099184 2.90092206 2.903803587 2.906632423 2.909463167 2.912240028 2.915048122 2.917829752 2.92064333 2.92343092 2.926192522 2.928928137 2.931723833 2.934435606 2.937179804 2.939925194 2.942616463 2.945339203 2.948035479 2.9507339 2.953434706 2.956051826 2.958786964 2.961437225 2.964003801 2.966688395 2.969346285 2.971977234 2.974582195 2.977189064 2.97979784 2.982409239 2.985023022 2.987551451 2.990169525 2.992760897 2.99529624 2.997833729 3.000373125 3.002914906 3.005458832 3.00797534 3.010523558 3.012985468 3.015508413 3.017974854 3.020442724 3.022972107 3.025503397 3.027947903 3.030365467 x0.1568148583 3.032814503 x0.157303378 3.035265684 3.037747383 3.040143013 3.042599678 3.04496932 3.0474298 3.049892426 3.0522089 3.054615498 3.057054043 3.059434652 3.06175828 3.064142942 3.066529274 3.06885767 3.071247816 3.073609829 3.07594347 3.078249693 3.080557108 3.082895994 3.085206509 3.087519407 3.089893818 3.092089415 3.094377041 3.096636295 3.098987579 3.101189852 3.103544474 3.105749846 3.108107805 3.110346556 3.112527132 3.114768267 3.116951942 3.119227171 3.121413231 3.123661995 3.125880957 3.128072023 3.130294323 3.132518768 3.134683132 3.136941195 3.139048338 3.14121747 3.143388271 3.145529985 3.147704363 3.149939775 3.152024984 3.154203415 3.156290531 3.158410788 3.160562277 3.1626544 3.164870501 3.166903734 3.169060707 3.17109704 3.173257351 3.175295353 3.177366018 3.17946887 3.181604147 3.183709621 3.185723782 3.187770367 3.189848661 3.191928625 3.193947315 3.195999384 3.198083401 3.200137138 3.202099562 3.204124928 3.206152201 3.208180428 3.210178137 3.212208748 3.214209318 3.21624279 3.218245745 3.22021842 3.222224951 3.224168539 3.226176023 3.228123188 3.230102062 3.232051373 3.234032631 3.235984087 3.237999439 3.23988986 3.241844416 3.243768454 3.245725393 3.247652769 3.249612093 3.251477242 3.253470659 3.255370378 3.257238626 3.259172201 3.261107445 3.263011694 3.264884949 3.26675868 3.268634319 3.27057457 3.272387981 3.274298906 3.276178837 3.278059244 3.279909372 3.281728029 3.283612251 3.285465956 3.28731966 3.289142609 3.290999174 3.292888403 3.294682503 3.296541929 3.298337698 x0.2188568711 3.300134897 x0.2193453908 3.301996946 3.303796291 3.30559659 3.307461739 3.309199333 3.311067104 3.312871695 3.314676523 3.316450357 3.318257093 3.320065022 3.321776867 3.323585987 3.325365305 3.327112913 3.328892708 3.330641508 3.332424164 3.334207058 3.335958719 3.337743998 3.339400053 3.341186762 3.342909575 3.344633102 3.346358061 3.348083019 3.349809408 3.351602077 3.353330374 3.355059147 3.356724262 3.358454466 3.360153675 3.361886024 3.363586903 3.365255594 3.36692524 3.368628502 3.370365143 3.372004986 3.373743296 3.375384092 3.377058744 3.378767252 3.38041091 3.382120848 3.383766174 3.38544488 3.387091398 3.388738871 3.390387297 3.392036676 3.393686056 3.395336628 3.396988153 3.398640633 3.400293827 3.401881218 3.403535366 3.405091763 3.40674758 3.408405066 3.409996033 3.411621332 3.413280964 3.414808273 3.416435719 3.418030977 3.419593334 3.421257019 3.422821283 3.424385548 3.42605114 3.427617788 3.429184437 3.430785656 3.43235445 3.433923244 3.435493708 3.437096834 3.438668728 3.440173864 3.441813231 3.443320036 3.444893837 3.446401834 3.4480443 3.449553251 3.451130629 3.45264101 3.45421958 3.455798626 3.457277775 3.458790779 3.460371733 3.461885929 3.463435173 3.464951515 3.466468096 3.467951059 3.469536781 3.471055031 3.472540617 3.474060535 3.475547075 3.477068186 3.478556156 3.480078697 3.481567621 3.483057737 3.484514475 3.486005783 3.487497568 3.489023685 3.490448952 3.491942406 3.493436813 3.494898558 3.496393442 3.497889996 3.499318123 3.500747919 3.502245665 3.503744841 3.505176067 3.506641388 3.508108139 3.509541035 3.510974646 3.512476921 3.513843298 3.515347481 3.516782761 3.518219233 3.519656181 3.521060467 3.522498131 3.523936749 3.525375843 3.526781797 3.528290987 3.529663563 3.531070709 3.532513142 3.533955574 3.535296202 3.536740303 3.538150311 3.539595604 3.540938377 3.542384148 3.543796301 3.545175076 3.546519756 3.547899485 3.549383163 3.550729275 3.552110195 3.55345726 3.554874897 3.556257248 3.557675362 3.559023619 3.560408831 3.561758995 3.563109636 3.564530611 3.565882444 3.567234039 3.568622112 3.569974899 3.571329355 3.572683573 3.574038267 3.575393915 3.57675004 3.578036785 3.579463005 3.580821037 3.582178593 3.583537102 3.584826946 3.586186171 3.58754611 3.588836908 3.590162992 3.591454506 3.592816353 3.594178677 3.595472336 3.596801043 x0.313141197 3.598094702 x0.3136297166 3.59945941 3.60078907 3.602084875 3.603380442 3.604746819 3.606009245 3.607306719 3.608603716 3.609936953 3.611235857 3.612500191 3.613800049 3.615099907 3.616435528 3.617666483 3.619003773 3.6203053 3.621572495 3.622875214 3.624143362 3.625411987 3.626716852 3.627950907 3.629291296 3.630561113 3.631832123 3.633068562 3.634410381 3.635611773 3.636919737 3.638193369 3.639395475 3.64070487 3.641979218 3.643183231 3.644458532 3.645734072 3.646974087 3.648180485 3.649456978 3.650734425 3.651941061 3.653219938 3.654462814 3.655741453 3.656950235 3.658158779 3.659439802 3.660649061 3.661859035 3.663140774 3.664352417 3.665563583 3.666846514 3.668058395 3.669199228 3.670483351 3.671696901 3.672911406 3.674124718 3.67533946 3.676554441 3.677769423 3.679020882 3.680165291 3.681382418 3.682599068 3.683816433 3.685034037 3.686180353 3.687363148 3.688581705 3.689872742 3.691056728 3.692133665 3.693425894 3.694574594 3.695759773 3.696909666 3.698132038 3.699317932 3.700540304 3.701763868 3.70287919 3.704031944 3.705255985 3.706444502 3.707598209 3.708787441 3.709940672 3.711130857 3.712285757 3.713476419 3.714559317 3.715787172 3.716906548 3.718135834 3.719256401 3.720413446 3.721606731 3.722764492 3.723886013 3.725044489 3.72623992 3.727362871 3.728449583 3.729646206 3.730806112 3.731930733 3.733127594 3.734216213 3.735341311 3.7364676 3.737665892 3.738755941 3.739882708 3.741045952 3.742173433 3.743301392 3.744428873 3.745521069 3.746649981 3.747852087 3.748944998 3.750074625 3.751204729 3.752262115 3.753392935 3.754560232 3.755618811 3.756750345 3.757882357 3.758941889 3.760147572 3.761244774 3.762304544 3.763438702 3.764499426 3.765633345 3.766695261 3.767830372 3.76889205 3.770028353 3.771164417 3.772264004 3.773326874 3.774391174 3.775528193 3.776666164 3.77773118 3.778795004 3.779860735 3.780926228 3.78206563 3.783131599 3.784234524 3.78533864 3.786405563 3.787472963 3.788540602 3.789644957 3.790640116 3.791708231 3.792850971 3.793919563 3.794988871 3.79605937 3.797129154 3.798199654 3.79923296 3.800304413 3.801375628 3.802446842 3.803519011 3.80459094 3.805626392 3.806624651 3.807771921 3.80877161 3.809881926 3.810881615 3.81195569 3.81303072 3.814030886 3.815069199 3.816144705 3.817145586 3.818259001 3.819261074 3.820338011 3.821414471 3.822380304 3.823384047 3.824461222 3.825501919 3.826505899 3.82758379 3.828588724 3.829631329 3.830710411 3.831715345 3.832758427 3.833764315 3.834807634 3.835813522 3.836819887 3.837864637 3.838871479 3.839879036 3.840924263 3.841932297 3.842977762 3.843985796 3.845032215 3.845966101 3.84701252 3.848022699 3.849069357 3.850079536 3.851014853 3.852063179 3.853073597 3.854048014 3.855058908 3.856108427 3.857082844 3.858094692 3.859070063 3.860082865 3.861057997 3.862070799 3.863046885 3.864060879 3.865036726 3.86608839 3.86702776 3.868042707 3.869019985 3.86999774 3.871013641 3.871991396 3.872969627 3.873986721 3.874965429 3.875906706 3.876961946 3.877865791 3.878883839 3.879863262 3.880843401 3.881862402 3.8827672 3.8837111 3.884767771 x0.4377137423 3.885749817 x0.4382022619 3.886655569 3.887676001 3.888657808 3.889564991 3.890585661 3.891493082 3.89247632 3.893421888 3.894405842 3.895390272 3.896298409 3.897320747 3.898229837 3.899214983 3.90019989 3.901148081 3.902058125 3.903043985 3.903954029 3.904978275 3.905888796 3.906876087 3.907787323 3.908736229 3.909724236 3.91063571 3.911548138 3.912536621 3.913449049 3.914437771 3.915389299 3.916301727 3.917215586 3.918204784 3.919119596 3.92010951 3.920985699 3.921900272 3.922814608 3.923729658 3.924721241 3.925636292 3.926628113 3.92750597 3.928498507 3.929414272 3.930330992 3.931170464 3.932164192 3.933081388 3.933998823 3.934916258 3.935872793 3.936828852 3.937708616 3.938627243 3.939545155 3.940464735 3.941383362 3.942302227 3.943144798 3.944141388 3.945061207 3.945981741 3.94690156 3.947745323 3.948666096 3.949587345 3.950508595 3.951429605 3.952350616 3.953196287 3.954117537 3.955039978 3.95596242 3.956808329 3.957731009 3.958654404 3.95957756 3.960423708 3.961347342 3.962194681 3.963195086 3.964042664 3.964890003 3.965815067 3.966739416 3.967587233 3.968512774 3.969360828 3.970247984 3.971174479 3.97202301 3.972872496 3.973875999 3.974725246 3.975574493 3.976424456 3.977352142 3.978241444 3.979130983 3.979981184 3.980870485 3.98172164 3.982649803 3.983501911 3.98443079 3.985282421 3.986134052 3.987025023 3.987838984 3.988729715 3.989582539 3.990512609 3.991366148 3.992257595 3.993111134 3.993965149 3.994818687 3.995672464 3.996526957 3.997458458 3.998352051 3.999129295 4.000061512 4.000916958 4.001771927 4.002589226 4.003444195 4.004300117 4.005233765 4.006051064 4.006868839 4.007763863 4.008543491 4.009478092 4.010295868 4.011153698 4.012010098 4.012867928 4.013725758 4.014544964 4.015402794 4.016261101 4.017120361 4.017939568 4.018798828 4.019579411 4.020516872 4.021297932 4.022118568 4.022978306 4.02383852 4.024737835 4.025519371 4.026380062 4.027162552 4.028062344 4.028844833 4.029706478 4.030528545 4.031390667 4.032251835 4.033035755 4.033857822 4.034720421 4.035505295 4.036328316 4.037190914 4.038053989 4.038877487 4.039662361 4.04052639 4.041350365 4.042135715 4.042999744 4.043785572 4.0446105 4.045474529 4.046260834 4.047086716 4.047951698 4.048698902 4.049485683 4.050351143 4.051177502 4.052043915 4.052831173 4.053658009 4.05444622 4.055273056 4.056139469 4.056927681 4.057676315 4.058465481 4.059332848 4.060161114 4.060949802 4.061738491 4.062488079 4.063396931 4.064186096 4.064975262 4.065765381 4.066516399 4.067385197 4.068175793 4.069005489 4.069796085 4.070627213 4.071417809 4.072169304 4.073039532 4.073792458 4.074583054 4.07537508 4.076127529 4.076919556 4.07775116 4.078543186 4.07933569 4.080088615 4.080961227 4.081714153 4.082507133 4.083261013 4.084134102 4.084887505 4.085681438 4.086474895 4.087229252 4.08806324 4.088778019 4.08957243 4.09032774 4.091201782 4.091956615 4.092672825 4.093468189 4.094302654 4.095058441 4.095854282 4.096650124 4.097406387 4.098202705 4.098958969 4.099755287 4.100512028 4.101268768 4.102065563 4.102862835 4.10366106 4.104377747 4.105175018 4.105893135 4.10669136 4.107409 4.108207226 4.109004974 4.109803677 4.110521793 4.111320496 4.112040043 4.112839222 4.113637924 4.114357471 4.115156651 4.115876198 4.116675854 4.117395878 4.118196487 4.118916035 4.119716167 4.120436668 4.121237755 4.121957779 4.122678757 4.123479843 4.12428093 4.125002861 4.125803471 4.126525402 4.127326965 4.12804842 4.12885046 4.129572392 4.1302948 4.131016731 4.131819725 4.132542133 4.133264065 4.134068012 4.134790421 4.135514259 4.136236668 4.137040138 4.137763977 4.138487339 4.139291286 4.140095234 4.140738964 4.14146328 4.142267704 4.143072605 4.143716812 4.144441128 4.145246029 4.145971298 4.146696091 4.147420883 4.148226738 4.148871422 4.1496768 4.1504035 4.15104866 4.151854992 4.152662277 4.153307438 4.154033184 4.154840946 4.155566692 4.15621376 4.15693903 4.15766573 4.158392906 4.159200668 4.159928322 4.160655499 4.161383629 4.162111282 4.162838936 4.163485527 4.164294243 4.16502285 4.165669918 4.166398525 4.167207718 4.167856216 4.168665409 4.169394493 4.170042515 4.170771599 4.17150116 4.172230244 4.172959805 4.173689365 4.174419403 4.175067425 4.175798416 4.176527977 4.177258015 4.177906513 4.178719044 4.179368019 4.180099964 4.180830002 4.181480408 4.182210922 4.182941914 4.183673382 4.184323311 4.185136795 4.185787201 4.186518669 4.187251091 4.187901974 4.188634396 4.189285278 4.1900177 4.190750599 4.191483021 4.192133904 4.192867756 4.193600178 4.194251537 4.194985867 4.19563818 4.196371078 4.197104454 4.197757244 4.19849205 4.199143887 4.199877739 4.200530052 x0.6257938743 4.201265335 x0.6262823939 4.201999187 4.202652454 4.20338726 4.204122543 4.204775333 4.205429554 4.20616436 4.206818104 4.207472324 4.208208084 4.208861351 4.209597111 4.210333824 4.210987568 4.211642265 4.212378502 4.213033199 4.21377039 4.214506626 4.215079784 4.215816498 4.216553688 4.217208862 4.21786499 4.21860218 4.219256878 4.219995499 4.22065115 4.221307755 4.221963882 4.222701073 4.223275661 4.224095821 4.22467041 4.225409508 4.226065636 4.226722717 4.227461338 4.228118896 4.228775024 4.22943306 4.230172157 4.230829239 4.231568813 4.232226372 4.232801914 4.233541965 4.234200478 4.234858513 4.235599041 4.23617506 4.236915112 4.2375741 4.238232136 4.238973618 4.239631653 4.240290642 4.240949631 4.241608143 4.242268562 4.242927551 4.24358654 4.244328976 4.244905949 4.245565414 4.246308327 4.246967793 4.247544765 4.248205662 4.248948097 4.249526024 4.250268936 4.250929356 4.251589775 4.252250195 4.252911091 4.253572464 4.25423336 4.254894733 4.25555563 4.256217003 4.256877899 4.257540226 4.258202076 4.258863449 4.259524822 4.260187149 4.260849476 4.261510849 4.26209116 4.262752533 4.26341486 4.26407814 4.264823437 4.265403271 4.266066551 4.266728878 4.267308712 4.267972469 4.268635273 4.269382 4.269962788 4.270626068 4.271289349 4.271953583 4.27253437 4.273198128 4.273779869 4.274526119 4.275190353 4.275771618 4.276436329 4.27710104 4.277682304 4.278347015 4.27901268 4.279594421 4.280342102 4.28092432 4.281589031 4.282254219 4.282836437 4.283585548 4.284167767 4.284750462 4.28541708 4.286082745 4.286748886 4.287331581 4.287997723 4.288580418 4.289247036 4.289913177 4.290496826 4.291163445 4.291831017 4.292414188 4.293081284 4.293747902 4.294331551 4.294999123 4.295582771 4.29625082 4.296918869 4.297502518 4.298170567 4.298755169 4.299423218 4.300007343 4.300675392 4.301259995 4.30192852 4.302597046 4.303182125 4.303767204 4.304436207 4.305104733 4.305606365 4.306359768 4.306944847 4.30761385 4.308199406 4.308785915 4.309370995 4.310040951 4.31062746 4.31129694 4.31188345 4.312552452 4.313223839 4.313725948 4.314479828 4.314981937 4.315652847 4.316324234 4.316910744 4.317581654 4.318085194 4.318756104 4.319427013 4.3199296 4.320601463 4.321188927 4.32186079 4.322447777 4.323036194 4.323707581 4.324295998 4.324882984 4.325555325 4.326058865 4.326815605 4.327404022 4.327991962 4.328580379 4.329169273 4.329841614 4.330430508 4.330935478 4.331607342 4.332281113 4.332870483 4.333459854 4.334048748 4.334722042 4.335311413 4.335900784 4.336490154 4.337080002 4.337753296 4.33834362 4.338932991 4.339523792 4.340029716 4.340787888 4.341377735 4.34196806 4.342557907 4.343064785 4.34373951 4.344329357 4.345004559 4.345595837 4.346102238 4.346777916 4.347368717 4.347959995 4.348550797 4.349142075 4.349733353 4.350324631 4.350916386 4.351508141 4.352099895 4.352775574 4.353367329 4.353874683 4.354550838 4.35514307 4.355650425 4.356327534 4.356919765 4.357512474 4.358020306 4.358697414 4.359289169 4.359881878 4.360475063 4.360982895 4.361575603 4.362253189 4.362762451 4.363440037 4.364032269 4.364626884 4.365135193 4.365727901 4.366322041 4.366915703 4.367509842 4.368103027 4.368697166 4.369291306 4.369884491 4.37039423 4.371073723 4.371668339 4.372262001 4.37277174 4.373365879 4.373960495 4.374555111 4.37514925 4.37574482 4.376254559 4.376934052 4.377444744 4.378039837 4.37863493 4.379230976 4.379826069 4.380335808 4.381016254 4.381527424 4.38203764 4.382717609 4.383229733 4.383910656 4.384421825 4.385017872 4.385613441 4.386124134 4.386805534 4.387316704 4.387913704 4.388510227 4.389021397 4.389618874 4.390129566 4.390726566 4.391323566 4.39183569 4.39243269 4.393028736 4.39362669 4.394223213 4.394735813 4.39533329 4.395844936 4.396441936 4.397040844 4.397553444 4.398236275 4.398663521 4.399347305 4.399859905 4.400372505 4.400970459 4.40156889 4.40208149 4.402765751 4.403279305 4.403877258 4.404390335 4.404989243 4.40558815 4.406101704 4.406699657 4.407213688 4.407813072 4.408412933 4.408925533 4.409524918 4.410038948 4.410637856 4.411152363 4.41166687 4.412351608 4.412780285 4.413466454 4.413980484 4.414494991 4.415094376 4.415609837 4.416209698 4.416809559 4.41732502 4.417925358 4.418353558 4.419040203 4.419555187 4.420156479 4.420671463 4.421186447 4.421787739 4.422302723 4.422817707 4.423418999 4.423934937 4.424536228 4.425137997 4.425652981 4.426254272 4.42668438 4.427286148 4.427888393 4.428404331 4.429005623 4.429522991 4.430038452 4.430640221 4.431156635 4.43167305 4.432189941 4.432878017 4.433394432 4.4339118 4.434514523 4.434945107 4.435547352 4.436150551 4.436667442 4.437271118 4.437701225 4.438304901 4.438821793 4.439424992 4.439942837 4.440459251 4.440977573 4.441581249 4.442098141 4.442702293 4.443133831 4.443737507 4.444342613 4.444773674 4.445377827 4.445895672 4.446413994 4.447017193 4.447449684 4.448053837 4.448572636 4.449091434 4.44969511 4.450213909 4.450819969 4.451251507 4.45185709 4.452375889 4.452894211 4.453499794 4.454017639 4.454537392 4.455142498 4.455575943 4.456093788 4.456700325 4.457218647 4.457738876 4.458258152 4.458777428 4.45929718 4.45990324 4.460422993 4.460943222 4.461549759 4.46198225 4.462588787 4.463109016 4.463542461 4.464149475 4.464669228 4.465189934 4.465796471 4.466229916 4.466836929 4.467356682 4.467877865 4.468398571 4.468832493 4.469439983 4.46996069 4.470481873 4.471089363 4.471523285 4.472044468 4.472652435 4.473086357 4.473694324 4.4741292 4.474736691 4.475257874 4.475692749 4.476301193 4.476822376 4.477344036 4.477865696 4.478301048 4.478997231 4.479432106 4.479953289 4.480475903 4.480997086 4.481606483 4.482042313 4.482564449 4.483086109 4.483607769 4.484130859 4.48465395 4.485176086 4.485698223 4.486221313 4.486657143 4.487266541 4.487789154 4.488312721 4.488835335 4.489271164 4.489881039 4.490316868 4.490840435 4.491363525 4.491887093 4.492497444 4.492933273 4.493457317 4.493980885 4.494504452 4.495028496 4.495463848 4.496075153 4.496599674 4.49703598 4.497560024 4.498083591 4.498520851 4.499132156 4.499568939 4.500180721 4.500617504 4.501142025 4.501666546 4.502191067 4.502716064 4.503240108 4.503765106 4.504201889 x0.8754274845 4.50472641 x0.8759160042 4.505251408 4.505776405 4.506213665 4.506825924 4.507264137 4.507789135 4.508314133 4.508752346 4.509277344 4.509802341 4.510240078 4.510854244 4.511291504 4.511816978 4.51234293 4.512868881 4.513306618 4.513833046 4.514358521 4.514883995 4.515322685 4.51584816 4.516374588 4.516901016 4.517427444 4.517865658 4.518392086 4.518918514 4.519357204 4.519884109 4.520410061 4.520849228 4.521463394 4.521903515 4.522429466 4.522956371 4.523396015 4.523922443 4.52436161 4.524888992 4.525415897 4.525856018 4.526382923 4.526909828 4.527349472 4.527965546 4.528404713 4.528844357 4.529460907 4.529811859 4.530426979 4.5308671 4.53130722 4.531923294 4.532362938 4.532890797 4.533330917 4.533859253 4.534387112 4.534828663 4.535356522 4.53588438 4.536236286 4.536853313 4.537294388 4.537822247 4.538262844 4.53879118 4.539232254 4.539761543 4.540290356 4.540819645 4.541259766 4.54170084 4.542230129 4.54267025 4.543200493 4.543729305 4.54417038 4.544700146 4.54514122 4.545670509 4.546112537 4.546641827 4.547083378 4.547613144 4.548054695 4.548584461 4.549025536 4.549467564 4.54999733 4.550528049 4.550969124 4.551499844 4.551941395 4.552472115 4.553002357 4.553355694 4.553974628 4.55441618 4.554858685 4.555389881 4.555831909 4.55627346 4.556805611 4.557246685 4.557778358 4.558309078 4.558751583 4.559282303 4.559725285 4.560168266 4.560698986 4.561141968 4.561673641 4.562116623 4.562559128 4.563091278 4.563533783 4.564065456 4.564508438 4.56495142 4.565483093 4.56601572 4.566458702 4.566902637 4.567345142 4.567788601 4.568409443 4.568853378 4.56929636 4.569828987 4.570183754 4.570716858 4.571248531 4.571692467 4.572135925 4.572669506 4.573023796 4.5735569 4.574001312 4.574533463 4.574977875 4.575422287 4.575954914 4.576399326 4.576843262 4.577376842 4.577820778 4.578265667 4.578798771 4.579243183 4.579776287 4.580221653 4.580666065 4.581110954 4.581644058 4.582088947 4.582534313 4.583067417 4.583512306 4.583958149 4.584403038 4.584936619 4.585381985 4.585826874 4.586272717 4.586807251 4.587162495 4.587697506 4.588231564 4.588676929 4.589122295 4.589568615 4.590013504 4.590548038 4.590993881 4.591439724 4.591974735 4.592331409 4.592866421 4.593400955 4.593758106 4.594293118 4.59473896 4.595185757 4.595630169 4.596077919 4.596612453 4.597058773 4.597504616 4.597951889 4.598487377 4.598844051 4.599379539 4.599826336 4.600273132 4.600719929 4.601255417 4.601613045 4.60214901 4.602596283 4.603042603 4.603489876 4.603936195 4.604383469 4.604830742 4.605366707 4.60581398 4.606261253 4.60670805 4.607155323 4.607692242 4.60804987 4.608497143 4.609033585 4.609481812 4.609929562 4.610376358 4.610824585 4.611271858 4.611719131 4.612166882 4.612614155 4.613152027 4.613599777 4.614047527 4.614495277 4.614943027 4.615391254 4.615839481 4.616287231 4.616735458 4.617183685 4.617631912 4.618169785 4.618528843 4.61897707 4.619425297 4.619874001 4.620322227 4.620861053 4.621219158 4.621757507 4.622206211 4.622655392 4.623104095 4.623552799 4.624001503 4.624450207 4.624899387 4.625258446 4.625796795 4.626245975 4.626694679}}
  name Sampler1
  xpos 1732
  ypos -285
 }
end_group
set N60c87200 [stack 0]
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle34
 xpos 1224
 ypos 2258
}
PositionToPoints2 {
 display textured
 render_mode textured
 P_channel rgb
 detail 1
 name PositionToPoints4
 xpos 1516
 ypos 2139
}
Scene {
 inputs 2
 name Scene1
 xpos 1600
 ypos 2084
}
push $N60c87200
Expression {
 expr0 r(x+100,y)
 name Expression11
 xpos 734
 ypos 2215
}
Read {
 inputs 0
 file_type exr
 file "\[value Write4.file]"
 origset true
 version 2072
 name Read68
 xpos 492
 ypos 1685
}
set N61de9c00 [stack 0]
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/sRGBgamutBound_tempImg.png
 file_type png
 checkHashOnRead false
 version 1047
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write6
 xpos 606
 ypos 1836
}
push $N60c87200
EXPTool {
 mode Stops
 red -6.3
 green -6.3
 blue -6.3
 name Exposure5
 xpos 615
 ypos 2207
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/sRGBgamutBound_MLimitExample.png
 file_type png
 checkHashOnRead false
 version 1048
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write7
 xpos 615
 ypos 2231
}
push $N60455000
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace24
 label "XYZ to sRGB Prims"
 xpos 1276
 ypos 1386
}
Multiply {
 value 100
 name Multiply12
 label "Div by 100 to go from nits"
 xpos 1276
 ypos 1418
}
push $N60c87200
Dot {
 name Dot15
 xpos 1422
 ypos 2313
}
Crop {
 box {0 -74 {width} {height}}
 reformat true
 crop false
 name Crop3
 xpos 1388
 ypos 2331
 disable true
}
Rectangle {
 opacity 0.955
 area {782.4000244 6 1137.599976 67.80000305}
 color 0
 name Rectangle3
 xpos 1388
 ypos 2355
}
Text2 {
 font_size_toolbar 30
 font_width_toolbar 100
 font_height_toolbar 100
 message "ZCAMishDRT 0.3"
 old_message {{90 67 65 77 105 115 104 68 82 84 32 48 46 51}
   }
 box {0 16 1920 55}
 xjustify center
 yjustify center
 transforms {{0 2}
   }
 font_size_values {{0 30 1 30 2 30 3 30 4 30 5 30 6 30 7 30 8 30 9 30 10 30 11 30 12 30 13 30 0 99 1 99 2 99 3 99 4 99 5 99 6 99 7 99 8 99 9 99}
   }
 cursor_position 14
 font {{ Helvetica : Regular : Helvetica.ttc : 0 }}
 font_size 30
 center {960 540}
 cursor_initialised true
 autofit_bbox false
 initial_cursor_position {{717.6001587 112.7998962}
   }
 group_animations {{0} imported: 0 selected: items: "root transform/"}
 animation_layers {{1 11 960 540 0 0 1 1 0 0 0 0}
   }
 name Text1
 xpos 1397
 ypos 2383
}
set N61d7b400 [stack 0]
Colorspace {
 colorspace_out sRGB
 name Colorspace31
 xpos 1397
 ypos 2481
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/comparisons/ZCAMishDRTv03_solo_v001/ZCAMishDRTv03_solo_v001.####.jpg
 colorspace texture_paint
 raw true
 file_type jpeg
 create_directories true
 checkHashOnRead false
 version 8
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write8
 xpos 1397
 ypos 2505
}
PositionToPoints2 {
 inputs 0
 display textured
 render_mode textured
 P_channel rgb
 name PositionToPoints8
 xpos 3397
 ypos 2203
}
Cube {
 inputs 0
 display wireframe
 rows 1
 columns 1
 cube {0 0 0 1 1 1}
 name Cube2
 xpos 2587
 ypos 2073
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/jedsmith_colorchecker24_streaks_flat.aces.exr"
 format "1152 576 0 0 1152 576 1 "
 origset true
 name Read61
 xpos 2327
 ypos 1949
}
Group {
 name ZCAMishDRT1
 xpos 2327
 ypos 2074
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 illuminant_in l "" -STARTLINE T Colorspace30.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T Colorspace30.primary_in}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
}
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read1
  xpos 829
  ypos 237
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 829
  ypos 317
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 829
  ypos 341
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 829
  ypos 383
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N61d78800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N620db000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N620db000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N620f9600 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N620f9600
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N620d9400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N620d9000 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N620d9400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N620d8400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6206bc00 [stack 0]
push $N620d9400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6206b800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6206b400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6206b000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6206ac00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N620d9000
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N620d9400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N620d9400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N620d9400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N61d78800
push $N620d9000
push $N620d8400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N62069000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N62069000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N620d9000
push $N6206bc00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N61ffb800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N61ffb800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N620d9000
push $N6206b800
push $N620d8400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N61ffa000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N61ff9c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N61ff9c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6206b000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N61ffa000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6206b000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6206ac00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N61ffa000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6206bc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6206b400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N620d8400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6206b800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N620d9000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N61d78800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N61f20800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N61eaf800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N61eaf800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N61eae000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N61ead400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N61ead400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N61ead400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N61eac400 [stack 0]
push $N61eac400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N61eae000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N61e65400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N61e65400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N61e65400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6201d600 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N61e64400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6201d600
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6235f800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6201d600
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6235ec00 [stack 0]
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6235e000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6201cf00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N61e64400
push $N6235f800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6235c400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6235c400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6201cf00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N62302000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N62302000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6201c100 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6201c100
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N61f20800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N61f20800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N61f20800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6201cf00
push $N61f20800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N61eae000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6235ec00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6235e000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6201d600
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 829
  ypos 442
 }
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -41
 }
 Colorspace {
  primary_in ACES
  colorspace_out CIE-XYZ
  name Colorspace30
  label "ACES to XYZ"
  xpos 1344
  ypos -1
 }
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos 31
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos 107
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6261e400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6261d000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6261d000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N625f5d00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N625f5d00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N625bb000 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N625bac00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N625bb000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N625ba000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N625b9c00 [stack 0]
push $N625bb000
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N625b9800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N625b9400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N625b9000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N625b8c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N625bac00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N625bb000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N625bb000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N625bb000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6261e400
push $N625bac00
push $N625ba000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N62542c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N62542c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N625bac00
push $N625b9c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N62541800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N62541800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N625bac00
push $N625b9800
push $N625ba000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N624cfc00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N624cf800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N624cf800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N625b9000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N624cfc00
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N625b9000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N625b8c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N624cfc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N625b9c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N625b9400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N625ba000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N625b9800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N625bac00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6261e400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N623f2400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N623f1800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N623f1800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6277fc00 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6277f000 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6277f000
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6277f000
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6277e000 [stack 0]
push $N6277e000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6277fc00
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N62743000 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N62743000
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N62743000
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6251dd00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N62742000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6251dd00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N62741800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6251dd00
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N62740c00 [stack 0]
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N626efc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6251d600 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N62742000
push $N62741800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N626ee000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N626ee000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6251d600
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N62a67c00 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N62a67c00
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6251c800 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6251c800
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N623f2400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N623f2400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N623f2400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6251d600
push $N623f2400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6277fc00
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N62740c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N626efc00
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6251dd00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N626a4f00 [stack 0]
 Ramp {
  replace true
  p0 {0 0}
  p1 {{width} 0}
  color 5
  name Ramp1
  xpos 1208
  ypos 168
 }
set N62a05c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle1
  xpos 1208
  ypos 220
 }
set N62a05800 [stack 0]
push $N62a05c00
push $N626a4f00
 Multiply {
  inputs 1+1
  channels zcam_M
  value 0
  name Multiply1
  xpos 1344
  ypos 215
  disable true
 }
 Merge2 {
  inputs 2
  operation multiply
  Achannels none
  Bchannels none
  output none
  also_merge zcam_M
  name Multiply
  xpos 1344
  ypos 276
 }
 Clamp {
  channels zcam_M
  maximum 100
  name Clamp1
  xpos 1344
  ypos 308
 }
set N62a04c00 [stack 0]
 Dot {
  name Dot13
  xpos 1376
  ypos 487
 }
set N62a04800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 409
 }
set N6299b400 [stack 0]
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit2
  xpos 1064
  ypos 470
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.765
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 1064
  ypos 499
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 1193
  ypos 550
 }
push $N62a04800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1354
  ypos 595
  disable true
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1354
  ypos 663
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N62999800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N62998400 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N62998400
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N629b8100 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N629b8100
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N62932400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N62932000 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N62932400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N62931400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N62931000 [stack 0]
push $N62932400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N62930c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N62930800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N62930400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N628a7c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N62932000
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N62932400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N62932400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N62932400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N62999800
push $N62932000
push $N62931400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N628a6000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N628a6000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N62932000
push $N62931000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N628a4c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N628a4c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N62932000
push $N62930c00
push $N62931400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6284b000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6284ac00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6284ac00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N62930400
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6284b000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N62930400
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N628a7c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6284b000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N62931000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N62930800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N62931400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N62930c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N62932000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N62999800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N62b71800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N62b70c00 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N62b70c00
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N62b13000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N62b12400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N62b12400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N62b12400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N62b11400 [stack 0]
push $N62b11400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N62b13000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N62ac2400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N62ac2400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N62ac2400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N628fc100 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N62ac1400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N628fc100
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N62ac0c00 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N628fc100
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N62e6bc00 [stack 0]
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N62e6b000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N62e53900 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N62ac1400
push $N62ac0c00
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N62e69400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N62e69400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N62e53900
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N62de7000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N62de7000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N62e52b00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N62e52b00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N62b71800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N62b71800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N62b71800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N62e53900
push $N62b71800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N62b13000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N62e6bc00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N62e6b000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N628fc100
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1354
  ypos 715
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1354
  ypos 757
 }
 Colorspace {
  colorspace_in CIE-XYZ
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1354
  ypos 781
 }
 Output {
  name Output1
  xpos 1354
  ypos 888
 }
push $N6299b400
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*width),(r/100*height))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit3
  xpos 981
  ypos 546
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
push $N62a05800
push $N62a04c00
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy1
  xpos 1344
  ypos 348
  disable true
 }
set N62d1f800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle51
  xpos 1588
  ypos 227
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply20
  label "Div by 100 to go from nits"
  xpos 1588
  ypos 251
 }
 ColorLookup {
  channels all
  lut {master {curve x0.02407439426 0 x0.04948588461 5.620706361e-06 x0.0808724314 5.995634638e-05 x0.1089436561 0.0002520732232 x0.1538826674 0.0009655252215 x0.1705526412 0.001552375033 x0.1965807676 0.003411091166 x0.2212548852 0.005432802252 x0.2435974032 0.008078291081 x0.2744711637 0.01258628722 x0.335355252 0.02872310206 x0.3656598926 0.0391706787 x0.4067366123 0.05722413212 x0.451582104 0.08477441967 x0.5436673164 0.1626682729 x0.6915633678 0.3178558648 x0.7352961302 0.3736175299 x0.8164004087 0.4692641795 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos 1588
  ypos 293
 }
 Gamma {
  value 2.2
  name Gamma2
  xpos 1588
  ypos 325
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply21
  label "Mult by 100 to put in absolute nits"
  xpos 1588
  ypos 357
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle52
  xpos 1588
  ypos 399
 }
push $N62d1f800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1344
  ypos 390
 }
end_group
set N62151d00 [stack 0]
PositionToPoints2 {
 display textured
 render_mode textured
 P_channel rgb
 name PositionToPoints7
 xpos 2462
 ypos 2096
}
Scene {
 inputs 2
 name Scene2
 xpos 2538
 ypos 2141
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/original/jed-smith/jedsmith_colorchecker24_streaks_flat.aces.exr"
 format "1152 576 0 0 1152 576 1 "
 origset true
 name Read62
 xpos 2797
 ypos 1939
}
Reformat {
 inputs 0
 type "to box"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 box_width 1920
 box_height 154
 box_fixed true
 name Reformat13
 xpos 2929
 ypos 1668
}
Ramp {
 p0 {0 0}
 p1 {{width} 0}
 name Ramp3
 xpos 2929
 ypos 1710
}
set N62d1c400 [stack 0]
Grade {
 multiply {0 0 1 1}
 multiply_panelDropped true
 name Grade3
 xpos 3445
 ypos 1818
}
set N62cbbc00 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace3
 xpos 3552
 ypos 1840
}
Colorspace {
 illuminant_in ACES
 primary_in ACES
 primary_out ACES
 name Colorspace33
 xpos 3552
 ypos 1864
}
Text {
 message "AP1\n0:0:1"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text11
 xpos 3552
 ypos 1892
 disable true
}
push $N62cbbc00
Colorspace {
 primary_out ACES
 name Colorspace25
 xpos 3445
 ypos 1842
}
Text {
 message "709\n0:0:1"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text12
 xpos 3445
 ypos 1894
 disable true
}
push $N62d1c400
Grade {
 multiply {0 1 0 1}
 multiply_panelDropped true
 name Grade8
 xpos 3235
 ypos 1822
}
set N62cb9c00 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace5
 xpos 3339
 ypos 1838
}
Colorspace {
 illuminant_in ACES
 primary_in ACES
 primary_out ACES
 name Colorspace34
 xpos 3339
 ypos 1862
}
Text {
 message "AP1\n0:1:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text13
 xpos 3339
 ypos 1898
 disable true
}
push $N62cb9c00
Colorspace {
 primary_out ACES
 name Colorspace29
 xpos 3235
 ypos 1846
}
Text {
 message "709\n0:1:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text14
 xpos 3235
 ypos 1898
 disable true
}
push $N62d1c400
Grade {
 multiply {1 0 0 1}
 multiply_panelDropped true
 name Grade10
 xpos 3018
 ypos 1824
}
set N62c4b800 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace6
 xpos 3126
 ypos 1846
}
Colorspace {
 illuminant_in ACES
 primary_in ACES
 primary_out ACES
 name Colorspace32
 xpos 3126
 ypos 1870
}
Text {
 message "AP1\n1:0:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text15
 xpos 3126
 ypos 1898
 disable true
}
push $N62c4b800
Colorspace {
 primary_out ACES
 name Colorspace30
 xpos 3018
 ypos 1848
}
Text {
 message "709\n1:0:0"
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text16
 xpos 3018
 ypos 1900
 disable true
}
push $N62d1c400
Text {
 message 1:1:1
 font "/Library/Fonts/Arial Unicode.ttf"
 size 40
 xjustify center
 yjustify center
 box {56 466 216 610}
 center {1024 778}
 color 0
 name Text17
 xpos 2929
 ypos 1874
}
ContactSheet {
 inputs 7
 width {{input.width*columns}}
 height {{input.height*rows}}
 rows 7
 columns 1
 roworder TopBottom
 name ContactSheet7
 xpos 2929
 ypos 1970
}
FrameHold {
 firstFrame 5
 name FrameHold2
 xpos 2929
 ypos 2037
}
set N62c10f00 [stack 0]
Group {
 name ZCAMishDRT2
 xpos 2731
 ypos 2161
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 illuminant_in l "" -STARTLINE T Colorspace30.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T Colorspace30.primary_in}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
}
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read1
  xpos 829
  ypos 237
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 829
  ypos 317
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 829
  ypos 341
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 829
  ypos 383
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N62fab400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N62faa000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N62faa000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N62bd0100 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N62bd0100
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N62fa8400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N62f47c00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N62fa8400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N62f47000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N62f46c00 [stack 0]
push $N62fa8400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N62f46800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N62f46400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N62f46000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N62f45c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N62f47c00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N62fa8400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N62fa8400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N62fa8400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N62fab400
push $N62f47c00
push $N62f47000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N62ed7c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N62ed7c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N62f47c00
push $N62f46c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N62ed6800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N62ed6800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N62f47c00
push $N62f46800
push $N62f47000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N62ed5000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N62ed4c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N62ed4c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N62f46000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N62ed5000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N62f46000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N62f45c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N62ed5000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N62f46c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N62f46400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N62f47000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N62f46800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N62f47c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N62fab400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6318b400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6318a800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6318a800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N63189000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N63188400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N63188400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N63188400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6313b000 [stack 0]
push $N6313b000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N63189000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N63138400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N63138400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N63138400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N62f4c100 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N630eb000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N62f4c100
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N630ea800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N62f4c100
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N630e9c00 [stack 0]
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N630e9000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6308f900 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N630eb000
push $N630ea800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N63083000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N63083000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6308f900
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N63081000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N63081000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6308eb00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6308eb00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6318b400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6318b400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6318b400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6308f900
push $N6318b400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N63189000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N630e9c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N630e9000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N62f4c100
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 829
  ypos 442
 }
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -41
 }
 Colorspace {
  primary_in ACES
  colorspace_out CIE-XYZ
  name Colorspace30
  label "ACES to XYZ"
  xpos 1344
  ypos -1
 }
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos 31
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos 107
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N633a5400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N63327c00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N63327c00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N63370800 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N63370800
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N63326000 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N63325c00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N63326000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N63325000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N63324c00 [stack 0]
push $N63326000
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N63324800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N63324400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N632b7c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N632b7800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N63325c00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N63326000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N63326000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N63326000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N633a5400
push $N63325c00
push $N63325000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N632b5c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N632b5c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N63325c00
push $N63324c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N632b4800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N632b4800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N63325c00
push $N63324800
push $N63325000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N63646c00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N63646800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N63646800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N632b7c00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N63646c00
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N632b7c00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N632b7800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N63646c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N63324c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N63324400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N63325000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N63324800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N63325c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N633a5400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N63579400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N63578800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N63578800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N63506c00 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N63506000 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N63506000
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N63506000
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N63505000 [stack 0]
push $N63505000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N63506c00
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N634c2000 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N634c2000
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N634c2000
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N63688800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N634c1000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N63688800
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N634c0800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N63688800
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6346b800 [stack 0]
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6346ac00 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N63688100 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N634c1000
push $N634c0800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N63469000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N63469000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N63688100
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N633eec00 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N633eec00
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6342f200 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6342f200
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N63579400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N63579400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N63579400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N63688100
push $N63579400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N63506c00
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6346b800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6346ac00
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N63688800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N63373900 [stack 0]
 Ramp {
  replace true
  p0 {0 0}
  p1 {{width} 0}
  color 1.5
  name Ramp1
  xpos 1208
  ypos 175
 }
set N63780c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle1
  xpos 1208
  ypos 206
 }
set N63780800 [stack 0]
push $N63780c00
push $N63373900
 Multiply {
  inputs 1+1
  channels zcam_M
  value 0
  name Multiply1
  xpos 1344
  ypos 199
  disable true
 }
 Merge2 {
  inputs 2
  operation multiply
  Achannels none
  Bchannels none
  output none
  also_merge zcam_M
  name Multiply
  xpos 1349
  ypos 248
 }
 Clamp {
  channels zcam_M
  maximum 100
  name Clamp1
  xpos 1349
  ypos 280
 }
set N6371f800 [stack 0]
 Dot {
  name Dot13
  xpos 1376
  ypos 487
 }
set N6371f400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 409
 }
set N6371e400 [stack 0]
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit2
  xpos 1064
  ypos 470
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.765
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 1064
  ypos 499
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 1193
  ypos 550
 }
push $N6371f400
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1354
  ypos 595
  disable true
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1354
  ypos 663
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6371c800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N63a9f000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N63a9f000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N636beb00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N636beb00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N63a9d400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N63a9d000 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N63a9d400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N63a9c400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N63a3bc00 [stack 0]
push $N63a9d400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N63a3b800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N63a3b400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N63a3b000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N63a3ac00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N63a9d000
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N63a9d400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N63a9d400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N63a9d400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6371c800
push $N63a9d000
push $N63a9c400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N63a39000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N63a39000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N63a9d000
push $N63a3bc00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N639c7800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N639c7800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N63a9d000
push $N63a3b800
push $N63a9c400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N639c6000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N639c5c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N639c5c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N63a3b000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N639c6000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N63a3b000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N63a3ac00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N639c6000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N63a3bc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N63a3b400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N63a9c400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N63a3b800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N63a9d000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6371c800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N638f4800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6387b800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6387b800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6387a000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N63879400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N63879400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N63879400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N63878400 [stack 0]
push $N63878400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6387a000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N63831400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N63831400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N63831400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6385ab00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N63830400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6385ab00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N637df800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6385ab00
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N637dec00 [stack 0]
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N637de000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6385a400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N63830400
push $N637df800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N637dc400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N637dc400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6385a400
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N63b6e000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N63b6e000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N63859600 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N63859600
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N638f4800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N638f4800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N638f4800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6385a400
push $N638f4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6387a000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N637dec00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N637de000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6385ab00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1354
  ypos 715
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1354
  ypos 757
 }
 Colorspace {
  colorspace_in CIE-XYZ
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1354
  ypos 781
 }
 Output {
  name Output1
  xpos 1354
  ypos 888
 }
push $N6371e400
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*width),(r/100*height))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit3
  xpos 981
  ypos 546
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
push $N63780800
push $N6371f800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy1
  xpos 1349
  ypos 334
 }
set N63e8e800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle51
  xpos 1588
  ypos 227
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply20
  label "Div by 100 to go from nits"
  xpos 1588
  ypos 251
 }
 ColorLookup {
  channels all
  lut {master {curve x0.02407439426 0 x0.04948588461 5.620706361e-06 x0.0808724314 5.995634638e-05 x0.1089436561 0.0002520732232 x0.1538826674 0.0009655252215 x0.1705526412 0.001552375033 x0.1965807676 0.003411091166 x0.2212548852 0.005432802252 x0.2435974032 0.008078291081 x0.2744711637 0.01258628722 x0.335355252 0.02872310206 x0.3656598926 0.0391706787 x0.4067366123 0.05722413212 x0.451582104 0.08477441967 x0.5436673164 0.1626682729 x0.6915633678 0.3178558648 x0.7352961302 0.3736175299 x0.8164004087 0.4692641795 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos 1588
  ypos 293
 }
 Gamma {
  value 2.2
  name Gamma2
  xpos 1588
  ypos 325
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply21
  label "Mult by 100 to put in absolute nits"
  xpos 1588
  ypos 357
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle52
  xpos 1588
  ypos 399
 }
push $N63e8e800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1345
  ypos 390
 }
end_group
Group {
 name PlotChromaticity1
 xpos 2731
 ypos 2196
 addUserKnob {20 PlotChromaticity_tab l PlotChromaticity}
 addUserKnob {6 use_gpu l "Use GPU if available" +STARTLINE}
 use_gpu true
 addUserKnob {26 ""}
 addUserKnob {6 plot_input l "plot input" t "Enable plotting of the input pixels" +STARTLINE}
 plot_input true
 addUserKnob {41 input_gamut l gamut t "Set the gamut that the input colors are encoded in" -STARTLINE T GamutToXYZ.gamut}
 addUserKnob {4 diagram l in t "Choose the type of chromaticity diagram: \nCIE 1931 xy Chromaticity Diagram\nCIE 1976 u' v' Uniform Chromaticity Scale Diagram" -STARTLINE M {"CIE 1931 xy" "CIE 1976 u' v'" "" ""}}
 diagram "CIE 1976 u' v'"
 addUserKnob {6 enable_sample_color l "sample color" t "Enable plotting of the sampled color" +STARTLINE}
 enable_sample_color true
 addUserKnob {41 sample_color l color t "sample and plot selected color" T SampleColor.color}
 addUserKnob {22 follow_viewer l "follow viewer" t "Follow the selected viewer node. This causes this node to automatically connect to whatever the followed viewer is connected to.\n\nThis is useful if you want to have a 2nd viewer showing a chromaticity plot for whever you're looking at in your main viewer." T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to follow.')\nelse:\n    v\['knobChanged'].setValue('v = nuke.activeViewer().node()\\nif v and v.name() == nuke.thisNode().name():\\n    con = v.input(nuke.activeViewer().activeInput())\\n    plt = nuke.toNode(\"\{0\}\")\\n    plt.setInput(0, con)'.format(n.name()))" +STARTLINE}
 addUserKnob {22 unfollow_viewer l "unfollow viewer" -STARTLINE T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to unfollow.')\nelse:\n    v\['knobChanged'].setValue('')"}
 addUserKnob {26 plot_dimensions_label l " " T "<b>Chromaticity Diagram"}
 addUserKnob {3 resolution l " resolution" t "resolution to output"}
 resolution 2048
 addUserKnob {7 right_margin l "right margin" R 1 1.5}
 right_margin 1.1
 addUserKnob {7 left_margin l "left margin" R 0 0.2}
 left_margin 0.1
 addUserKnob {6 draw_spectral_locus l "spectrum locus" t "draw the spectrum locus: the boundary of color the human eye can see." +STARTLINE}
 draw_spectral_locus true
 addUserKnob {6 draw_line_of_purples l "line of purples" t "draw the \"line of purples\"" -STARTLINE}
 draw_line_of_purples true
 addUserKnob {6 draw_planckian_locus l "planckian locus" t "Display the planckian locus or the blackbody locus." +STARTLINE}
 addUserKnob {6 gamut_grid l "gamut grid" t "Display a gamut boundary with a grid or dot pattern" +STARTLINE}
 addUserKnob {41 gamut_gamutgrid l "" t "gamut for gamutgrid" -STARTLINE T RGBToXYZ_GamutGrid.gamut}
 addUserKnob {4 gamut_grid_style l style t "Choose the style to display the gamut plot" -STARTLINE M {grid dots "" "" "" ""}}
 addUserKnob {4 distribution l dist t "Which chromaticity space should the overlays be constructed in? \n\nYxy is familiar, but not very perceptually uniform.\n\nu'v' is designed to be more perceptually uniform." -STARTLINE M {"1931 Yxy" "1976 u'v'" "" ""}}
 addUserKnob {7 density t "Density of the grid or points" R 10 100}
 density 50
 addUserKnob {6 gamut_a l "gamut a" t "Display a gamut outline" +STARTLINE}
 gamut_a true
 addUserKnob {41 gamut_a_1 l "" -STARTLINE T RGBToXYZ_GamutA.gamut}
 addUserKnob {6 gamut_b l "gamut b" t "Display a gamut outline" +STARTLINE}
 addUserKnob {41 gamut_b_1 l "" -STARTLINE T RGBToXYZ_GamutB.gamut}
 addUserKnob {6 gamut_c l "gamut c" t "Display a gamut outline" +STARTLINE}
 gamut_c true
 addUserKnob {41 gamut_c_1 l "" -STARTLINE T RGBToXYZ_GamutC.gamut}
 addUserKnob {6 draw_pointers_gamut l "pointer's gamut" t "DrawPointer's gamut boundary" +STARTLINE}
 addUserKnob {6 draw_pointers_samples l "pointers sample colors" t "show the individual pointer gamut samples" -STARTLINE}
 addUserKnob {6 draw_macbeth_chart l "macbeth chart" t "draw a ColorChecker24 aka Macbeth Chart" +STARTLINE}
 addUserKnob {6 coordinate_system l "coordinate system" t "Draw CIE xy coordinate grid x and y axes" +STARTLINE}
 coordinate_system true
 addUserKnob {6 map_overlays_to_input_gamut l "map overlays to input gamut" t "This maps the overlays like the spectral locus, pointer's gamut, and the gamut overlay to the working gamut instead of keeping them as XYZ.\n\nFor example if the input gamut is ACEScg, these overlays will be mapped to that. Note that this can cause most of the overlays to be negative or highly saturated which might harm the visual appearance." +STARTLINE}
 map_overlays_to_input_gamut true
}
 Group {
  inputs 0
  name GamutGrid1
  xpos -920
  ypos -201
  postage_stamp true
  addUserKnob {20 GamutGrid}
  addUserKnob {3 style}
  style {{!parent.gamut_grid_style}}
  addUserKnob {3 distribution -STARTLINE}
  distribution {{parent.distribution}}
  addUserKnob {7 density R 10 150}
  density {{parent.density}}
  addUserKnob {26 ""}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {12 wxy}
  wxy {{parent.RGBToXYZ_GamutGrid.wxy} {parent.RGBToXYZ_GamutGrid.wxy}}
 }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   centerSaturation 1
   fillFormat false
   area {-170 -158 682 670}
   name ColorWheel4
   xpos -260
   ypos -15
   postage_stamp false
  }
  Crop {
   box {0 0 {width} {height}}
   crop false
   name Crop2
   xpos -260
   ypos 27
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat3
   xpos -260
   ypos 110
  }
set N63e2bc00 [stack 0]
push $N63e2bc00
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   roworder TopBottom
   name ContactSheet2
   xpos -260
   ypos 169
  }
  Dot {
   name Dot1
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -226
   ypos 246
  }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   fillFormat false
   area {40 40 472 472}
   name ColorWheel1
   xpos -40
   ypos -664
   postage_stamp false
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat1
   xpos -40
   ypos -628
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   name Crop1
   xpos -40
   ypos -602
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos -526
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos -415
  }
  Colorspace {
   colorspace_in CIE-XYZ
   colorspace_out CIE-Yxy
   name Colorspace1
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -341
  }
set N63e29400 [stack 0]
  Dot {
   name Dot2
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos -331
  }
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression5
   label "CIE Yxy to CIELuv"
   xpos -590
   ypos -304
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 "(-(degrees(atan2(g-white.x, b-white.y))-180)+270)%360/360"
   expr2 "hypot(g-white.x, b-white.y)"
   expr3 a
   name Expression3
   xpos -590
   ypos -261
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{"parent.distribution ? 4*parent.wxy.x / ( -2 * parent.wxy.x + 12 * parent.wxy.y + 3) : parent.wxy"} {"parent.distribution ? 9*parent.wxy.y / ( -2*parent.wxy.x + 12*parent.wxy.y + 3) : parent.wxy"}}
  }
set N63e28800 [stack 0]
  Posterize {
   channels rgb
   Colors {{rint(parent.density/3*2)}}
   name Posterize1
   xpos -590
   ypos -191
  }
set N63e28400 [stack 0]
push $N63e28800
  Dot {
   name Dot15
   xpos -446
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy1
   xpos -480
   ypos -154
  }
push $N63e28400
push $N63e28800
  Dot {
   name Dot16
   xpos -666
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy2
   xpos -700
   ypos -153
  }
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   center true
   roworder TopBottom
   name ContactSheet3
   xpos -590
   ypos -106
  }
  Expression {
   expr0 r
   expr1 cos(radians(g*360))*b+white.x
   expr2 sin(radians(g*360))*b+white.y
   expr3 a
   name Expression19
   xpos -590
   ypos -58
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{parent.Expression3.white} {parent.Expression3.white}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression2
   label "CIELuv to CIE Yxy"
   xpos -590
   ypos -16
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace2
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -590
   ypos 32
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix1
   label "XYZ to RGB"
   xpos -590
   ypos 81
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin2
   xpos -590
   ypos 119
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp1
   xpos -590
   ypos 152
  }
  Premult {
   name Premult1
   xpos -590
   ypos 194
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge2
   xpos -590
   ypos 242
  }
  Fill {
   output alpha
   name Fill1
   xpos -590
   ypos 297
  }
  Dot {
   name Dot3
   label " GRID"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos 378
  }
push $N63e2bc00
push $N63e29400
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression4
   label "CIE Yxy to CIELuv"
   xpos -40
   ypos -280
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 rint(g*Colors)/Colors
   expr2 rint(b*Colors)/Colors
   expr3 a
   name Expression1
   label rint
   xpos -40
   ypos -232
   addUserKnob {20 User}
   addUserKnob {7 Colors R 1 256}
   Colors {{parent.density}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression6
   label "CIELuv to CIE Yxy"
   xpos -40
   ypos -184
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace3
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -112
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix3
   label "XYZ to RGB"
   xpos -40
   ypos -57
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp4
   xpos -40
  }
  Premult {
   name Premult2
   xpos -40
   ypos 55
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge1
   xpos -40
   ypos 110
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin1
   xpos -40
   ypos 273
  }
  Dot {
   name Dot4
   label " DOTS"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 378
  }
  Switch {
   inputs 2
   which {{parent.style}}
   name Switch1
   xpos -257
   ypos 483
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix2
   label "RGB to XYZ"
   xpos -257
   ypos 560
  }
  Output {
   name Output
   xpos -257
   ypos 740
  }
  ColorWheel {
   inputs 0
   format "256 256 0 0 256 256 1 square_256"
   area {40 40 472 472}
   name ColorWheel2
   xpos -37
   ypos -705
   postage_stamp false
  }
 end_group
set N63e3b900 [stack 0]
 Group {
  name RGBToXYZ_GamutGrid
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos -184
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorWheel {
  inputs 0
  format "512 512 0 0 512 512 1 square_512"
  centerSaturation 1
  fillFormat false
  area {-196 -184 708 696}
  name ColorWheel1
  xpos -920
  ypos 5
 }
 Crop {
  box {0 0 {width} {height}}
  name Crop1
  xpos -920
  ypos 87
 }
 BlackOutside {
  name BlackOutside3
  xpos -920
  ypos 134
 }
set N63cdf000 [stack 0]
 Group {
  name RGBToXYZ_GamutC
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1140
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r+input.width} {parent.ReformatBox4.box_width-input.height}}
  name Position6
  xpos -1140
  ypos 254
 }
push $N63cdf000
 Group {
  name RGBToXYZ_GamutB
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height*2}}
  name Position5
  xpos -1030
  ypos 254
 }
push $N63cdf000
 Group {
  name RGBToXYZ_GamutA
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -920
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position4
  xpos -920
  ypos 254
 }
push $N63e3b900
 Reformat {
  type scale
  scale 0.8
  turn true
  filter impulse
  black_outside true
  name Reformat2
  xpos -920
  ypos -129
 }
 BlackOutside {
  name BlackOutside2
  xpos -920
  ypos -106
 }
 Position {
  translate {{Rectangle1.area.r} {parent.Position3.translate.y-input.height}}
  name Position2
  xpos -920
  ypos -81
 }
 Group {
  inputs 0
  name ColorChecker24_After_November_2014
  label "CIE XYZ D50"
  xpos -920
  ypos -352
  addUserKnob {20 colorchecker_tab l "ColorChecker24 - After November 2014"}
  addUserKnob {3 patch_resolution}
  patch_resolution 48
 }
  Group {
   inputs 0
   name bluish_green
   selected true
   xpos 622
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.30451114 0.4143554688 0.344352688 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "bluish green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 6
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_flower
   xpos 512
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2419823988 0.2287175998 0.3282104382 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue flower"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 5
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name foliage
   xpos 402
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1114392339 0.1346792679 0.05239320311 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob foliage
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 4
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_sky
   xpos 292
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1652470004 0.1785519348 0.2546024121 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue sky"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 3
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name light_skin
   xpos 180
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3811104477 0.336202304 0.1852590702 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "light skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 2
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 135
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name dark_skin
   xpos 70
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1136398927 0.09832436105 0.047793811 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "dark skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 1
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 290
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 290
    ypos 158
   }
   Output {
    name Output
    xpos 290
    ypos 230
   }
  end_group
  Group {
   inputs 0
   name orange_yellow
   xpos 622
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4769723742 0.4293377578 0.06005041429 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "orange yellow"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 12
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow_green
   xpos 512
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3427379502 0.4331759409 0.08330791241 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "yellow green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 11
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purple
   xpos 401
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08353888545 0.06276662955 0.1042075686 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob purple
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 10
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name moderate_red
   xpos 290
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2915036416 0.188999956 0.09736350318 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "moderate red"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 9
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purplish_blue
   xpos 180
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1200518326 0.1091090233 0.2874447494 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "purplish blue"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 8
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name orange
   xpos 74
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4073691399 0.3126416159 0.05130591012 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob orange
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 7
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name cyan
   xpos 622
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1247966941 0.180609913 0.2913392383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob cyan
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 18
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name magenta
   xpos 512
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.299122798 0.1895114577 0.2213469194 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob magenta
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 17
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow
   xpos 399
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5888922356 0.5992976803 0.07077420003 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob yellow
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 16
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 182
   }
  end_group
  Group {
   inputs 0
   name red
   xpos 292
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2143728424 0.127800835 0.03868150726 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob red
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 15
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name green
   xpos 182
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1413517689 0.2233437582 0.07287461742 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob green
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 14
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue
   xpos 72
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.06809095613 0.05596214063 0.2077405936 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob blue
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 13
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name black_2
   xpos 623
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.03042544265 0.03151319431 0.02656724434 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "black 2 (1.5 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 24
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_3
   xpos 512
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08448968042 0.08817234828 0.07391630753 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 3.5 (1.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 23
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_5
   xpos 403
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1835495863 0.1906228754 0.1566717383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 5 (.70 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 22
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_6
   xpos 292
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3495921991 0.3648652066 0.3013565492 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 6.5 (.44 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 21
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_8
   xpos 179
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5665335579 0.5899709702 0.4828473821 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 8 (.23 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 20
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name white_9
   xpos 70
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.8436985288 0.8806903203 0.6936778752 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "white 9.5 (.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 19
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 134
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  ContactSheet {
   inputs 24
   width {{"rint(parent.patch_resolution * 6 + gap * 7)"}}
   height {{"rint(parent.patch_resolution * 4 + gap * 5)"}}
   rows 4
   columns 6
   startframe 1
   endframe 1
   name ContactSheet
   xpos 620
   ypos 206
  }
  Unpremult {
   name Unpremult1
   xpos 620
   ypos 278
  }
  Output {
   name Output
   xpos 620
   ypos 446
  }
 end_group
 BlackOutside {
  name BlackOutside4
  xpos -920
  ypos -298
 }
 Position {
  translate {{parent.Reformat1.box_width*3+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position7
  xpos -920
  ypos -273
 }
 Constant {
  inputs 0
  format "256 256 0 0 256 256 1 square_256"
  name Constant5
  xpos -700
  ypos -1354
  postage_stamp false
 }
 Dot {
  name Dot25
  xpos -666
  ypos -1302
 }
set N6421f400 [stack 0]
 Dot {
  name Dot27
  xpos -1546
  ypos -1302
 }
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox1
  xpos -1580
  ypos -994
 }
 Ramp {
  p0 {0 0}
  p1 {{input.width} 0}
  color {{p1}}
  name Ramp3
  xpos -1580
  ypos -898
 }
 ColorLookup {
  lut {master {}
    red {curve 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914}
    green {curve 0.433 0.464 0.513 0.611 0.576 0.46 0.426 0.412 0.404 0.397 0.384 0.374 0.346 0.333 0.311 0.287 0.257 0.23 0.21 0.219 0.208 0.211 0.208 0.187 0.191 0.187 0.18 0.164 0.17 0.177 0.175 0.188 0.252 0.325 0.385 0.416 0.433 0.487 0.532 0.588 0.637 0.634 0.549 0.506 0.49 0.458 0.426 0.412 0.397 0.365 0.337 0.301 0.262 0.221 0.192 0.164 0.167 0.162 0.176 0.179 0.148 0.156 0.142 0.148 0.138 0.145 0.145 0.161 0.197 0.256 0.324 0.393 0.451 0.487 0.508 0.538 0.587 0.634 0.659 0.611 0.552 0.526 0.484 0.452 0.428 0.406 0.371 0.334 0.293 0.243 0.204 0.177 0.151 0.151 0.162 0.158 0.161 0.142 0.141 0.129 0.134 0.14 0.156 0.166 0.192 0.221 0.265 0.325 0.392 0.451 0.508 0.48 0.513 0.554 0.597 0.63 0.634 0.58 0.546 0.499 0.466 0.434 0.408 0.372 0.332 0.288 0.242 0.202 0.179 0.16 0.157 0.162 0.157 0.159 0.149 0.153 0.147 0.154 0.164 0.18 0.199 0.226 0.25 0.279 0.325 0.38 0.439 0.48 0.436 0.468 0.502 0.541 0.57 0.605 0.594 0.555 0.511 0.473 0.439 0.409 0.371 0.332 0.288 0.252 0.217 0.196 0.181 0.178 0.185 0.176 0.173 0.168 0.176 0.178 0.19 0.202 0.214 0.235 0.254 0.27 0.291 0.323 0.366 0.41 0.436 0.396 0.414 0.438 0.465 0.485 0.527 0.566 0.557 0.523 0.478 0.442 0.409 0.371 0.334 0.294 0.265 0.244 0.223 0.225 0.212 0.218 0.211 0.211 0.207 0.214 0.217 0.229 0.237 0.244 0.264 0.275 0.285 0.3 0.321 0.348 0.376 0.396 0.357 0.368 0.377 0.391 0.402 0.431 0.481 0.503 0.521 0.482 0.444 0.409 0.372 0.337 0.307 0.286 0.27 0.257 0.247 0.251 0.257 0.255 0.254 0.25 0.258 0.259 0.265 0.269 0.278 0.284 0.292 0.297 0.305 0.317 0.33 0.344 0.357 0.321 0.322 0.328 0.332 0.333 0.346 0.365 0.389 0.411 0.459 0.443 0.399 0.352 0.327 0.313 0.304 0.3 0.294 0.295 0.294 0.293 0.292 0.291 0.295 0.3 0.301 0.302 0.304 0.304 0.304 0.305 0.307 0.309 0.312 0.313 0.316 0.321}
    blue {curve 0.26 0.281 0.298 0.306 0.342 0.365 0.39 0.381 0.392 0.416 0.413 0.43 0.448 0.446 0.433 0.425 0.419 0.394 0.362 0.328 0.305 0.298 0.286 0.247 0.26 0.219 0.199 0.168 0.178 0.14 0.11 0.084 0.104 0.158 0.18 0.225 0.26 0.235 0.26 0.28 0.298 0.327 0.372 0.395 0.417 0.43 0.435 0.455 0.488 0.479 0.521 0.522 0.515 0.49 0.436 0.383 0.331 0.295 0.282 0.258 0.219 0.208 0.179 0.168 0.141 0.129 0.106 0.094 0.095 0.112 0.127 0.165 0.199 0.235 0.226 0.258 0.28 0.298 0.316 0.361 0.399 0.427 0.446 0.461 0.482 0.52 0.521 0.553 0.563 0.573 0.524 0.454 0.389 0.33 0.295 0.266 0.247 0.214 0.195 0.168 0.178 0.142 0.14 0.128 0.129 0.126 0.131 0.144 0.167 0.199 0.226 0.238 0.266 0.289 0.31 0.329 0.351 0.395 0.428 0.453 0.475 0.494 0.533 0.542 0.568 0.584 0.576 0.53 0.451 0.385 0.331 0.299 0.266 0.245 0.22 0.206 0.184 0.174 0.167 0.166 0.166 0.173 0.172 0.165 0.172 0.187 0.208 0.238 0.258 0.28 0.3 0.321 0.343 0.362 0.391 0.427 0.458 0.482 0.503 0.546 0.554 0.573 0.582 0.546 0.499 0.431 0.375 0.33 0.304 0.275 0.254 0.234 0.225 0.212 0.209 0.206 0.203 0.21 0.215 0.212 0.204 0.208 0.214 0.231 0.258 0.277 0.294 0.31 0.328 0.348 0.372 0.397 0.427 0.462 0.487 0.51 0.544 0.558 0.559 0.556 0.503 0.444 0.402 0.355 0.329 0.309 0.289 0.275 0.26 0.254 0.245 0.245 0.241 0.238 0.249 0.249 0.245 0.241 0.242 0.246 0.258 0.277 0.295 0.305 0.315 0.327 0.339 0.359 0.39 0.421 0.461 0.491 0.515 0.54 0.546 0.522 0.478 0.429 0.393 0.368 0.345 0.325 0.313 0.303 0.295 0.286 0.284 0.279 0.277 0.274 0.277 0.277 0.28 0.276 0.273 0.274 0.279 0.285 0.295 0.311 0.314 0.316 0.32 0.323 0.331 0.346 0.367 0.397 0.468 0.513 0.494 0.425 0.388 0.372 0.348 0.336 0.331 0.326 0.32 0.316 0.314 0.312 0.309 0.321 0.32 0.319 0.305 0.317 0.316 0.316 0.315 0.316 0.317 0.319 0.321 0.311}
    alpha {}}
  name ColorLookup7
  label "Pointers Samples Yxy\nSource: https://www.rit.edu/cos/colorscience/rc_useful_data.php"
  xpos -1580
  ypos -790
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace12
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1580
  ypos -688
 }
 Fill {
  output alpha
  name Fill5
  xpos -1580
  ypos -639
 }
 BlackOutside {
  name BlackOutside7
  xpos -1580
  ypos -562
 }
 Position {
  translate {6 {parent.Position1.translate.y-input.height}}
  name Position3
  xpos -1580
  ypos -538
 }
 Dot {
  name Dot15
  xpos -1546
  ypos -414
 }
push $N6421f400
 Reformat {
  type "to box"
  box_width 2048
  box_height 2048
  box_fixed true
  name ReformatBox4
  xpos -700
  ypos -1258
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression7
  xpos -700
  ypos -1209
 }
 Dot {
  name Dot10
  xpos -666
  ypos -1158
 }
set N641cb800 [stack 0]
 Dot {
  name Dot26
  xpos -886
  ypos -1158
 }
set N641cb400 [stack 0]
 Dot {
  name Dot23
  xpos -1106
  ypos -1158
 }
set N641cb000 [stack 0]
 Dot {
  name Dot12
  xpos -1326
  ypos -1158
 }
 Mirror2 {
  flip true
  flop true
  name Mirror2_1
  xpos -1360
  ypos -1042
 }
 Reformat {
  type "to box"
  box_width 512
  box_height {{box_width}}
  box_fixed true
  name Reformat1
  xpos -1360
  ypos -994
 }
 Gamma {
  channels rgb
  value 2
  name Gamma1
  xpos -1360
  ypos -898
 }
 Multiply {
  channels rgb
  value 8000
  name Multiply1
  label "\[value value]"
  xpos -1360
  ypos -811
 }
 ColorLookup {
  lut {master {}
    red {curve R 0.4830000103 x50 0.5045000315 0.5260000229 0.5475000143 0.5690000057 0.5904999971 0.6119999886 0.63349998 0.6549999714 0.6805312037 0.7087500095 0.7315937281 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.75459373 0.7845000029 0.8144062757 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8009687662 0.74150002 0.6820312142 0.6549999714 0.6684374809 0.6980000138 0.7275624871 0.7409999967 0.7315937281 0.7087500095 0.6805312037 0.6549999714 0.629468739 0.6012499928 0.5784062743 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5555624962 0.5260000229 0.4964375198 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4964375198 0.5260000229 0.5555624962 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5653046966 0.5555624962 0.5417890549 0.5260000229 0.5102109313 0.4964375198 0.4866953194 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4695625007 0.4400000274 0.4104375243 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.4104375243 0.4400000274 0.4695625007 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103}
    green {curve R 0.6589999795 x50 0.6542205811 0.6484853029 0.6414804459 0.6340000033 0.6249843836 0.6147499681 0.6041406393 0.5939999819 0.5844687223 0.575124979 0.5659687519 0.5569999814 0.5484530926 0.5402500033 0.5319218636 0.5230000019 0.5131718516 0.5027499795 0.4922031164 0.4819999933 0.4722187519 0.4626249969 0.4532187581 0.4440000057 0.4351093769 0.4265000224 0.4178906381 0.4090000093 0.3997343779 0.3902499974 0.380640626 0.3709999919 0.3614374995 0.3518749774 0.3421249986 0.3319999874 0.321398437 0.3104375005 0.2992577851 0.2879999876 0.2764999866 0.2647500038 0.2531249821 0.2419999987 0.2312265635 0.2206875086 0.2108047009 0.202000007 0.1947187632 0.1886250079 0.1829687506 0.1770000011 0.1693515629 0.1608124971 0.1538671851 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1527187377 0.1564999968 0.1602812558 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1612187475 0.1595000029 0.1577812582 0.1570000052 0.1573124975 0.1579999924 0.1586875021 0.1589999944 0.1575781256 0.1543750018 0.1509843767 0.1490000039 0.1485625058 0.1484999955 0.1484375 0.1480000019 0.1467812508 0.1449999958 0.1432187557 0.1420000046 0.1415625066 0.1414999962 0.1414375007 0.1410000026 0.1397656202 0.1378750056 0.1357968748 0.1340000033 0.1323750019 0.1307500005 0.1295000017 0.1289999932 0.130031243 0.1324999928 0.1354687512 0.1379999965 0.1402187496 0.1424999982 0.1442812532 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1464921832 0.1503124982 0.1554765552 0.1609999985 0.1673984379 0.1749375015 0.1822578013 0.1879999936 0.1906718612 0.1913749874 0.1926406175 0.1969999969 0.2064140588 0.2199375033 0.2357421964 0.2520000041 0.2688750029 0.2871249914 0.3058125079 0.324000001 0.3417187631 0.359375 0.3765937686 0.3930000067 0.4082968831 0.4227499962 0.4368281364 0.451000005 0.4659531415 0.4812500179 0.4956718981 0.5080000162 0.5169296861 0.5234375 0.5297265649 0.5379999876 0.5491171479 0.5618124604 0.5751015544 0.5879999995 0.6009531021 0.6142500043 0.6266719103 0.6370000243 0.6457066536 0.6532088518 0.6575522423 0.6589999795}
    blue {curve R 0.3160000145 x50 0.324739933 0.3330312669 0.3418398499 0.351000011 0.3607422113 0.3709374964 0.3811640739 0.3910000026 0.4003046751 0.4093124866 0.4181640446 0.4269999862 0.4359609187 0.4449374974 0.453695327 0.4620000124 0.4697890878 0.4771875143 0.4842422009 0.4909999967 0.4971874952 0.5028749704 0.5086249709 0.5149999857 0.5227031112 0.53125 0.5394218564 0.5460000038 0.5502656102 0.5530000329 0.5552343726 0.5580000281 0.561632812 0.5655625463 0.5694609284 0.5730000138 0.5765469074 0.5801249743 0.5828906298 0.5839999914 0.5838750005 0.5830000043 0.5806249976 0.5759999752 0.5682968497 0.5576249957 0.5446406007 0.5299999714 0.5128515363 0.4931874871 0.4729296863 0.4539999962 0.4368359447 0.420437485 0.4045703113 0.3889999986 0.3731718659 0.3573749959 0.3426406384 0.3300000131 0.3193906248 0.310375005 0.3034218848 0.298999995 0.2972500026 0.2969999909 0.2967499793 0.2949999869 0.2899531126 0.2821249962 0.2734843791 0.2660000026 0.2602812648 0.2552500069 0.2503437698 0.2450000048 0.2380000055 0.2300000042 0.2232500017 0.2199999988 0.2195625007 0.2194999903 0.2194374949 0.2189999968 0.2183593661 0.2176249921 0.2163281292 0.2140000015 0.2101874948 0.205249995 0.1999374926 0.1949999928 0.1904453039 0.185937494 0.1817109436 0.1780000031 0.1754062474 0.1736250073 0.1715312451 0.1679999977 0.1620937437 0.1546249986 0.147093758 0.1410000026 0.1372031271 0.1347499937 0.1324218661 0.1289999932 0.1237656176 0.1174999923 0.1112343743 0.1059999987 0.1021796837 0.09918750077 0.09660156071 0.09399999678 0.09089062363 0.0876249969 0.0850468725 0.08399999887 0.08524999768 0.0882499963 0.09187500179 0.09499999881 0.09706249833 0.09875000268 0.1008125022 0.1040000021 0.1084140688 0.1136875004 0.1198671907 0.1270000041 0.1355390698 0.145312503 0.1554296911 0.1650000066 0.1739453226 0.1826875061 0.1910859346 0.199000001 0.2061250061 0.2126249969 0.2190624923 0.2259999961 0.2338827997 0.2423124909 0.2505859137 0.2579999864 0.2642968595 0.26987499 0.2750156224 0.2800000012 0.2847812474 0.2892500162 0.2935937643 0.2980000079 0.3025000095 0.3070000112 0.3115000129 0.3160000145}
    alpha {}}
  name ColorLookup5
  label "Pointer's Gamut Boundary Yxy\ninterpolated: incr 50 - 0 to 8000"
  xpos -1360
  ypos -775
 }
 Multiply {
  channels rgb
  value {0.31 1 1 1}
  name Multiply2
  label "dim boundary"
  xpos -1360
  ypos -725
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace5
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1360
  ypos -688
 }
 Fill {
  output alpha
  name Fill4
  xpos -1360
  ypos -639
 }
 BlackOutside {
  name BlackOutside1
  xpos -1360
  ypos -562
 }
 Position {
  translate {6 {ReformatBox4.box_width-input.width}}
  name Position1
  xpos -1360
  ypos -538
 }
 Dot {
  name Dot24
  xpos -1326
  ypos -486
 }
push $N641cb000
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox2
  xpos -1140
  ypos -994
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression1
  xpos -1140
  ypos -898
 }
set N64172c00 [stack 0]
 Dot {
  name Dot8
  xpos -996
  ypos -894
 }
 ColorLookup {
  lut {master {curve L 0 s0 t0.9499999881 C k x0.308139503 1 s0}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos -1030
  ypos -849
 }
 Dot {
  name Dot14
  xpos -996
  ypos -750
 }
push $N64172c00
 Multiply {
  channels rgb
  value 269
  name Multiply5
  label "\[value value]"
  xpos -1140
  ypos -856
 }
 ColorLookup {
  lut {master {}
    red {curve C 1.8783474 1.85965741 1.8410753 1.82260251 1.80424976 1.78602886 1.76794314 1.75000143 1.73221421 1.71458244 1.69711792 1.67982578 1.66271067 1.6457777 1.62903571 1.6124835 1.59613538 1.57998943 1.56404996 1.54832447 1.5328095 1.51751649 1.50244594 1.48759735 1.47297573 1.45858264 1.44442391 1.43049574 1.41680288 1.40334678 1.39012623 1.37714779 1.36440396 1.35190022 1.33963728 1.32761216 1.31582856 1.30428183 1.29297352 1.28190565 1.27107596 1.2604804 1.25012183 1.23999798 1.23010659 1.22044563 1.21101499 1.20181489 1.19284034 1.18408906 1.17556167 1.16725397 1.15916491 1.15129638 1.14363372 1.13618886 1.12895167 1.12192106 1.11509454 1.10846853 1.10204577 1.09580922 1.08977199 1.08392429 1.07826447 1.07278681 1.06749392 1.06237841 1.05743873 1.05267084 1.04807138 1.04364109 1.03937256 1.03526449 1.03131545 1.02751946 1.02387333 1.02037668 1.01702523 1.01381445 1.01074362 1.00780725 1.00500631 1.00233305 0.99978602 0.99736285 0.9950608 0.99287677 0.99080539 0.98884678 0.98699367 0.9852494 0.98361033 0.98206747 0.98062134 0.97926998 0.97800934 0.97683728 0.97575116 0.97474778 0.97382426 0.97297859 0.97220623 0.97150886 0.97087657 0.97031689 0.96981871 0.96938527 0.96900952 0.96869147 0.96842706 0.96821606 0.96805781 0.96794283 0.96787858 0.96785843 0.96787864 0.96793604 0.96803701 0.96817231 0.96833968 0.96854311 0.96877253 0.96903455 0.96932232 0.96963543 0.96997368 0.97033387 0.97071254 0.9711163 0.97153723 0.97197378 0.97242606 0.97289121 0.97337079 0.97386622 0.97437072 0.97488332 0.97540969 0.97594237 0.97647977 0.97702706 0.97757769 0.97813445 0.97869468 0.97925854 0.97982538 0.98039114 0.98096472 0.98153675 0.98210776 0.98267955 0.98325121 0.98382008 0.98438704 0.9849571 0.98552132 0.98608243 0.98664182 0.98719966 0.98775077 0.98829895 0.98884273 0.98938417 0.98991877 0.9904511 0.99097681 0.99149919 0.99201453 0.99252397 0.99303031 0.99353105 0.99402624 0.99451613 0.99499857 0.99547589 0.99594522 0.99641174 0.99687338 0.99732745 0.99777603 0.9982177 0.99865389 0.999084 0.99950838 0.99992663 1.00033772 1.00074494 1.00114489 1.00153947 1.00192833 1.00231075 1.00268865 1.00305855 1.00342607 1.00378489 1.00413895 1.00448751 1.00483036 1.00517035 1.00550389 1.00583148 1.00615203 1.00646758 1.00678015 1.00708604 1.00738645 1.00768471 1.00797844 1.0082655 1.00854778 1.00882483 1.00909901 1.00936711 1.00963116 1.00989032 1.0101465 1.01039672 1.01064491 1.01088691 1.0111258 1.01135957 1.01158977 1.01181614 1.01203847 1.01225793 1.01247287 1.01268291 1.01289058 1.01309609 1.01329684 1.01349473 1.0136888 1.0138787 1.01406395 1.01424909 1.01442885 1.01460576 1.01478052 1.01495218 1.01512218 1.01528883 1.01545072 1.01561022 1.01576698 1.01592219 1.01607502 1.01622343 1.01636875 1.0165143 1.01665616 1.01679492 1.0169313 1.01706588 1.01719737 1.01732695 1.01745498 1.01757956 1.01770294 1.01782393 1.01794255 1.0180583 1.01817465 1.01828551 1.01839495 1.01850486 1.01861191 1.01871693 1.01882088 1.01891339}
    green {curve C 1}
    blue {curve C 0.00879261 0.00962762 0.010532 0.01151017 0.01256675 0.01370643 0.01493413 0.01625487 0.01767381 0.01919618 0.02082733 0.02257277 0.02443803 0.02642871 0.02855051 0.03080913 0.0332104 0.0357601 0.03846392 0.04132775 0.04435719 0.04755813 0.05093599 0.05449668 0.0582453 0.0621875 0.06632853 0.07067341 0.07522713 0.07999477 0.08498063 0.09018957 0.09562518 0.10129225 0.10719412 0.11333443 0.11971687 0.12634411 0.133219 0.14034435 0.14772213 0.15535444 0.16324303 0.17138906 0.179794 0.18845794 0.197382 0.20656651 0.21601067 0.22571453 0.23567709 0.24589771 0.25637382 0.26710594 0.2780903 0.28932518 0.30080822 0.3125369 0.32450783 0.33671761 0.34916404 0.36183971 0.37474373 0.38787127 0.40121818 0.41477671 0.42854655 0.44251823 0.45668846 0.47105014 0.48559928 0.50033116 0.5152359 0.5303098 0.5455451 0.56093836 0.5764783 0.59215891 0.60797763 0.62392306 0.63999057 0.65616876 0.6724565 0.68884456 0.70532417 0.72188419 0.73852479 0.7552371 0.77200818 0.78883314 0.80570388 0.82261622 0.83956301 0.8565321 0.87351894 0.89051074 0.90751225 0.92450547 0.94148719 0.95845115 0.97538745 0.99229181 1.00915313 1.02597356 1.04273522 1.05944169 1.07608175 1.09265125 1.10914159 1.12555146 1.14187002 1.15809321 1.1742171 1.190238 1.20614767 1.22194457 1.23762202 1.2531724 1.26859927 1.28389311 1.29905295 1.31407428 1.32895291 1.34368753 1.35827363 1.3727088 1.38699389 1.40111876 1.41508293 1.42889357 1.44254065 1.45602405 1.46934104 1.48249614 1.49548101 1.50830269 1.5209527 1.53343177 1.54574537 1.5578897 1.56985986 1.5816654 1.59329891 1.60476208 1.61605716 1.62718153 1.63813758 1.64892519 1.65955138 1.67000985 1.68030369 1.69043732 1.70040607 1.71021223 1.71985734 1.72934508 1.73867714 1.74785423 1.75688136 1.76575518 1.77447391 1.78304338 1.79146802 1.79975164 1.80788386 1.81587982 1.82373333 1.83144975 1.83902776 1.84647095 1.85378456 1.86096811 1.86802399 1.87495112 1.88175035 1.88842535 1.89497983 1.90141833 1.90774179 1.91394711 1.92004013 1.92602086 1.93188739 1.93765306 1.94330883 1.94886208 1.95430994 1.95965815 1.96490622 1.97005856 1.97511387 1.98007631 1.98494554 1.98972344 1.99441445 1.99901712 2.00353193 2.00796437 2.01231384 2.01658392 2.02076721 2.02487659 2.02890825 2.03286695 2.03675175 2.04056406 2.04430199 2.04797506 2.05157685 2.05511236 2.0585804 2.06198287 2.06532407 2.06860161 2.07181907 2.07497644 2.07807779 2.0811162 2.08409977 2.08702946 2.08990335 2.09272337 2.09549189 2.0982089 2.10087585 2.10349345 2.10606146 2.1085825 2.11105394 2.11348104 2.11586332 2.11820364 2.12050176 2.12275648 2.12496805 2.127141 2.12927723 2.13136625 2.13341999 2.13543844 2.13741732 2.13936305 2.1412704 2.1431427 2.14498401 2.14678812 2.14856291 2.1503005 2.15200949 2.15368938 2.15533352 2.15695238 2.15853977 2.16009951 2.16162968 2.16313291 2.16460824 2.16605687 2.16747928 2.16887903 2.17024994 2.1715951 2.17291784 2.17421341 2.17548871 2.17674041 2.17797112 2.17918396 2.18036819 2.18143296}
    alpha {}}
  name ColorLookup3
  label "Planckian Locus 0-269"
  xpos -1140
  ypos -808
 }
 Multiply {
  inputs 1+1
  channels rgb
  value 0
  maskChannelMask rgba.red
  invert_mask true
  name Multiply3
  label dim
  xpos -1140
  ypos -760
 }
 BlackOutside {
  name BlackOutside6
  xpos -1140
  ypos -706
 }
 Position {
  translate {6 {parent.Position2.translate.y-input.height}}
  name Position8
  xpos -1140
  ypos -682
 }
 Dot {
  name Dot28
  xpos -1106
  ypos -654
 }
push $N641cb400
 Dot {
  name Dot4
  xpos -886
  ypos -1086
 }
set N64170400 [stack 0]
 Rectangle {
  replace true
  area {0 0 6 {height}}
  name Rectangle1
  xpos -810
  ypos -1089
 }
 BlackOutside {
  name BlackOutside5
  xpos -810
  ypos -1041
 }
push $N64170400
 Radial {
  inputs 1+1
  replace true
  area {-5422 -3542 7470 5590}
  softness 0
  ramp linear
  color {0.0719 0.02604 0.0001 1}
  p1 {0 0}
  color0 {0.039378 0.001097 0.188331 1}
  p0 {0 2048}
  name Radial1
  xpos -920
  ypos -1041
 }
 Dot {
  name Dot9
  xpos -886
  ypos -894
 }
push $N641cb800
 Gamma {
  channels rgba
  value 0.5
  name Gamma2
  xpos -700
  ypos -1120
 }
 Expression {
  temp_name0 start
  temp_expr0 360
  temp_name1 end
  temp_expr1 830
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 r*(end-start)+start
  channel1 none
  channel2 none
  expr3 1
  name Expression2
  label "360nm to 830nm"
  xpos -700
  ypos -1096
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 6.97e-06 7.81e-06 8.77e-06 9.84e-06 1.104e-05 1.239e-05 1.389e-05 1.556e-05 1.744e-05 1.958e-05 2.202e-05 2.484e-05 2.804e-05 3.153e-05 3.522e-05 3.9e-05 4.283e-05 4.691e-05 5.159e-05 5.718e-05 6.4e-05 7.234e-05 8.221e-05 9.351e-05 0.00010614 0.00012 0.00013498 0.00015149 0.00017021 0.00019182 0.000217 0.00024691 0.00028124 0.00031852 0.00035727 0.000396 0.00043371 0.00047302 0.00051788 0.00057222 0.00064 0.00072456 0.0008255 0.00094116 0.00106988 0.00121 0.00136209 0.00153075 0.00172037 0.00193532 0.00218 0.0024548 0.002764 0.0031178 0.0035264 0.004 0.00454624 0.00515932 0.00582928 0.00654616 0.0073 0.00808651 0.00890872 0.00976768 0.01066443 0.0116 0.01257317 0.01358272 0.01462968 0.01571509 0.01684 0.01800736 0.01921448 0.02045392 0.02171824 0.023 0.02429461 0.02561024 0.02695857 0.02835125 0.0298 0.03131083 0.03288368 0.03452112 0.03622571 0.038 0.03984667 0.041768 0.043766 0.04584267 0.048 0.05024368 0.05257304 0.05498056 0.05745872 0.06 0.06260197 0.06527752 0.06804208 0.07091109 0.0739 0.077016 0.0802664 0.0836668 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name ColorLookup4
  label "CIE 1931 2 Degree Standard Observer\n360nm to 830nm"
  xpos -700
  ypos -1030
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeLineOfPurples
  xpos -700
  ypos -897
  disable {{!parent.draw_line_of_purples}}
 }
 Fill {
  color {0 0 0 1}
  name Disable_SpectralLocus
  xpos -700
  ypos -826
  disable {{parent.draw_spectral_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePlanckianLocus
  xpos -700
  ypos -658
  disable {{!parent.draw_planckian_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut
  xpos -700
  ypos -489
  disable {{!parent.draw_pointers_gamut}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut_Samples
  xpos -700
  ypos -417
  disable {{!draw_pointers_samples}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeMacbeth
  xpos -700
  ypos -273
  disable {{!parent.draw_macbeth_chart}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutGrid
  xpos -700
  ypos -81
  disable {{!parent.gamut_grid}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutA
  xpos -700
  ypos 255
  disable {{!parent.gamut_a}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutB
  xpos -700
  ypos 279
  disable {{!parent.gamut_b}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutC
  xpos -700
  ypos 303
  disable {{!parent.gamut_c}}
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 450
 }
set N640a3400 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 450
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace6
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -590
  ypos 488
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression5
  label "CIE Yxy to CIELuv"
  xpos -590
  ypos 536
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 618
 }
push $N640a3400
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  invert true
  name ColorMatrix1
  label "XYZ to working"
  xpos -700
  ypos 488
  disable {{!map_overlays_to_input_gamut}}
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_grid\" iterate pixelWise b2e7b5f8a89bdb0629aa8cc2eae387ef3436f24cb0af642eeba41235874506c4 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 6 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== \"draw_axes\" Bool 1 AA== \"grid_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 6 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 \"draw_axes\" 1 1 \"grid_color\" 4 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_grid : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n  bool draw_axes;\n  float4 grid_color;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  void draw_grid() \{\n    // grid width in pixels. expresses a 0 to 1 range in CIE xy\n    float grid_width = 1.0f * outsize + offset;\n    // draw grid lines\n    float i = offset;\n    while (i <= grid_width && i > 0.0f) \{\n      write_aa(offset, i, grid_color);\n      write_aa(i, offset, grid_color);\n      i += 1.0;\n    \}\n    // cross-hatching interval in pixels\n    float hatch_interval = (grid_width - offset) * 0.1f;\n    // cross-hatch length in pixels\n    float hatch_width = outsize * 0.01f;\n    i = offset;\n    while (i <= grid_width) \{\n      i += hatch_interval;\n      float j = 0.0;\n      while (j <= hatch_width/2) \{\n        write_aa(offset+j, i, grid_color);\n        write_aa(offset-j, i, grid_color);\n        write_aa(i, offset+j, grid_color);\n        write_aa(i, offset-j, grid_color);\n        j += 1.0;\n      \}\n    \}\n  \}\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n\n    // draw CIExy coordinate system axes\n    if (draw_axes && pos.x == 0 && pos.y == 0) \{\n      draw_grid();\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_grid_padding {{parent.PlotChromaticities.PlotChromaticity_padding}}
  PlotChromaticity_grid_left_margin {{parent.PlotChromaticities.PlotChromaticity_left_margin}}
  PlotChromaticity_grid_tolerance 0.8
  PlotChromaticity_grid_antialias true
  PlotChromaticity_grid_draw_axes {{parent.coordinate_system}}
  PlotChromaticity_grid_grid_color {0.15 0 0.005 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotInput2
  xpos -700
  ypos 608
 }
 FrameHold {
  firstFrame 1
  name FrameHold1
  xpos -700
  ypos 680
  cached true
 }
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 762
 }
 Input {
  inputs 0
  name Input
  xpos 620
  ypos -1426
 }
 AddChannels {
  name AddChannels1
  xpos 620
  ypos -1360
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat
  xpos 620
  ypos -1282
  disable {{!parent.resample_input}}
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name CropBBox
  xpos 620
  ypos -1257
 }
 Dot {
  name Dot7
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 162
 }
set N6404fc00 [stack 0]
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "256 256 0 0 256 256 1 square_256"
  name Constant2
  xpos 400
  ypos 38
  postage_stamp false
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat1
  xpos 400
  ypos 64
  disable {{!parent.resample_input}}
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input0]"}}
  name Switch1
  xpos 400
  ypos 158
 }
 Fill {
  output rgb
  color 0.18
  name SampleColor
  xpos 290
  ypos 158
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name Crop2
  xpos 290
  ypos 184
 }
 Fill {
  output alpha
  name Fill3
  xpos 290
  ypos 224
 }
 Dot {
  name Dot6
  xpos 324
  ypos 282
 }
set N6404e000 [stack 0]
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  name ColorMatrix4
  label "working to XYZ"
  xpos 180
  ypos 272
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace1
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 180
  ypos 320
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression6
  label "CIE Yxy to CIELuv"
  xpos 180
  ypos 368
  disable {{!parent.diagram}}
 }
push $N6404e000
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_sample\" iterate pixelWise 20e14b615a937bac78c1a771cbdfd10cc7c5fb6c487f65d0bb2d6633e404b958 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 3 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== 3 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_sample : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  void process(int2 pos) \{\n    // only process the first pixel\n    if (pos.x > 0 && pos.y > 0) return;\n\n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    int2 p = int2(round(out_coord.x), round(out_coord.y));\n    if (dst.bounds.inside(p.x, p.y)) \{\n      for (int k=0; k<3; k++) \{\n        dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n      \}\n      dst(p.x, p.y, 3) = 1.0f;\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_sample_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_sample_left_margin {{parent.left_margin}}
  PlotChromaticity_sample_tolerance 1
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities1
  xpos 290
  ypos 368
 }
 Dot {
  name Dot22
  xpos 324
  ypos 450
 }
set N6404cc00 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048}}
  name Dilate1
  label "\[value size]"
  xpos 290
  ypos 488
 }
set N6404c800 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048*2}}
  name Dilate2
  label "\[value size]"
  xpos 180
  ypos 488
 }
push $N6404cc00
 Dot {
  name Dot21
  xpos -6
  ypos 450
 }
 FilterErode {
  channels rgba
  size {{-Output.width/2048/5}}
  filter triangle
  name FilterErode1
  label "\[value size]"
  xpos -40
  ypos 489
 }
set N63feb800 [stack 0]
 Dilate {
  channels rgba
  size {0 {parent.Dilate3.size.w}}
  name Dilate4
  label "\[value size]"
  xpos -40
  ypos 584
 }
push $N63feb800
 Dilate {
  channels rgba
  size {{Output.width*plus_size/100} 0}
  name Dilate3
  label "\[value size]"
  xpos 70
  ypos 488
  addUserKnob {20 User}
  addUserKnob {7 plus_size R 0 4}
  plus_size 0.8
 }
 Merge2 {
  inputs 2
  operation screen
  bbox B
  name Merge9
  xpos 70
  ypos 591
 }
 Merge2 {
  inputs 2
  operation stencil
  bbox B
  name Merge10
  xpos 180
  ypos 591
 }
 Group {
  name HueRotate
  xpos 180
  ypos 639
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -24
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos 15
  }
  Colorspace {
   colorspace_out HSV
   name Colorspace1
   xpos -40
   ypos 72
  }
  Add {
   channels {rgba.red -rgba.green -rgba.blue none}
   value 0.5
   name Add1
   xpos -40
   ypos 111
  }
  Fill {
   output {-rgba.red -rgba.green rgba.blue none}
   name Fill1
   xpos -40
   ypos 147
  }
  Colorspace {
   colorspace_in HSV
   name Colorspace2
   xpos -40
   ypos 183
  }
  Premult {
   name Premult1
   xpos -40
   ypos 231
  }
  Output {
   name Output1
   xpos -40
   ypos 302
  }
 end_group
push $N6404c800
 Merge2 {
  inputs 2
  bbox B
  name Merge8
  xpos 290
  ypos 638
 }
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 690
 }
push $N6404fc00
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 162
 }
 Group {
  name GamutToXYZ
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos 730
  ypos 247
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 730
  ypos 296
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression4
  label "CIE Yxy to CIELuv"
  xpos 730
  ypos 344
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot13
  label " Pos"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 546
 }
push $N6404fc00
 Dot {
  name Dot16
  label " Col"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 450
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity\" iterate pixelWise 3e86399c7642fe5c35c23528a644f88a8bf13f967de084ae6842f8be55098c6b 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 4 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== 4 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_left_margin {{parent.left_margin}}
  PlotChromaticity_tolerance 2
  PlotChromaticity_antialias true
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities
  xpos 620
  ypos 536
  disable {{!parent.plot_input}}
 }
 Fill {
  color 0
  name BLACK
  tile_color 0x111111ff
  xpos 620
  ypos 591
  disable {{parent.plot_input}}
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge7
  xpos 620
  ypos 686
  disable {{!parent.enable_sample_color}}
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 620
  ypos 758
 }
 Output {
  name Output
  xpos 620
  ypos 1046
 }
end_group
Write {
 file /Users/afry/GitHub/nukeZCAM/images/comparisons/ZCAMishDRTv03_709andAP1Arcs_v001.jpg
 file_type jpeg
 checkHashOnRead false
 version 3
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write10
 xpos 2731
 ypos 2248
}
push $N62151d00
Group {
 name PlotChromaticity
 xpos 2327
 ypos 2134
 addUserKnob {20 PlotChromaticity_tab l PlotChromaticity}
 addUserKnob {6 use_gpu l "Use GPU if available" +STARTLINE}
 use_gpu true
 addUserKnob {26 ""}
 addUserKnob {6 plot_input l "plot input" t "Enable plotting of the input pixels" +STARTLINE}
 plot_input true
 addUserKnob {41 input_gamut l gamut t "Set the gamut that the input colors are encoded in" -STARTLINE T GamutToXYZ.gamut}
 addUserKnob {4 diagram l in t "Choose the type of chromaticity diagram: \nCIE 1931 xy Chromaticity Diagram\nCIE 1976 u' v' Uniform Chromaticity Scale Diagram" -STARTLINE M {"CIE 1931 xy" "CIE 1976 u' v'" "" ""}}
 diagram "CIE 1976 u' v'"
 addUserKnob {6 enable_sample_color l "sample color" t "Enable plotting of the sampled color" +STARTLINE}
 enable_sample_color true
 addUserKnob {41 sample_color l color t "sample and plot selected color" T SampleColor.color}
 addUserKnob {22 follow_viewer l "follow viewer" t "Follow the selected viewer node. This causes this node to automatically connect to whatever the followed viewer is connected to.\n\nThis is useful if you want to have a 2nd viewer showing a chromaticity plot for whever you're looking at in your main viewer." T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to follow.')\nelse:\n    v\['knobChanged'].setValue('v = nuke.activeViewer().node()\\nif v and v.name() == nuke.thisNode().name():\\n    con = v.input(nuke.activeViewer().activeInput())\\n    plt = nuke.toNode(\"\{0\}\")\\n    plt.setInput(0, con)'.format(n.name()))" +STARTLINE}
 addUserKnob {22 unfollow_viewer l "unfollow viewer" -STARTLINE T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to unfollow.')\nelse:\n    v\['knobChanged'].setValue('')"}
 addUserKnob {26 plot_dimensions_label l " " T "<b>Chromaticity Diagram"}
 addUserKnob {3 resolution l " resolution" t "resolution to output"}
 resolution 2048
 addUserKnob {7 right_margin l "right margin" R 1 1.5}
 right_margin 1.1
 addUserKnob {7 left_margin l "left margin" R 0 0.2}
 left_margin 0.1
 addUserKnob {6 draw_spectral_locus l "spectrum locus" t "draw the spectrum locus: the boundary of color the human eye can see." +STARTLINE}
 draw_spectral_locus true
 addUserKnob {6 draw_line_of_purples l "line of purples" t "draw the \"line of purples\"" -STARTLINE}
 draw_line_of_purples true
 addUserKnob {6 draw_planckian_locus l "planckian locus" t "Display the planckian locus or the blackbody locus." +STARTLINE}
 addUserKnob {6 gamut_grid l "gamut grid" t "Display a gamut boundary with a grid or dot pattern" +STARTLINE}
 addUserKnob {41 gamut_gamutgrid l "" t "gamut for gamutgrid" -STARTLINE T RGBToXYZ_GamutGrid.gamut}
 addUserKnob {4 gamut_grid_style l style t "Choose the style to display the gamut plot" -STARTLINE M {grid dots "" "" "" ""}}
 addUserKnob {4 distribution l dist t "Which chromaticity space should the overlays be constructed in? \n\nYxy is familiar, but not very perceptually uniform.\n\nu'v' is designed to be more perceptually uniform." -STARTLINE M {"1931 Yxy" "1976 u'v'" "" ""}}
 addUserKnob {7 density t "Density of the grid or points" R 10 100}
 density 50
 addUserKnob {6 gamut_a l "gamut a" t "Display a gamut outline" +STARTLINE}
 gamut_a true
 addUserKnob {41 gamut_a_1 l "" -STARTLINE T RGBToXYZ_GamutA.gamut}
 addUserKnob {6 gamut_b l "gamut b" t "Display a gamut outline" +STARTLINE}
 addUserKnob {41 gamut_b_1 l "" -STARTLINE T RGBToXYZ_GamutB.gamut}
 addUserKnob {6 gamut_c l "gamut c" t "Display a gamut outline" +STARTLINE}
 gamut_c true
 addUserKnob {41 gamut_c_1 l "" -STARTLINE T RGBToXYZ_GamutC.gamut}
 addUserKnob {6 draw_pointers_gamut l "pointer's gamut" t "DrawPointer's gamut boundary" +STARTLINE}
 addUserKnob {6 draw_pointers_samples l "pointers sample colors" t "show the individual pointer gamut samples" -STARTLINE}
 addUserKnob {6 draw_macbeth_chart l "macbeth chart" t "draw a ColorChecker24 aka Macbeth Chart" +STARTLINE}
 addUserKnob {6 coordinate_system l "coordinate system" t "Draw CIE xy coordinate grid x and y axes" +STARTLINE}
 coordinate_system true
 addUserKnob {6 map_overlays_to_input_gamut l "map overlays to input gamut" t "This maps the overlays like the spectral locus, pointer's gamut, and the gamut overlay to the working gamut instead of keeping them as XYZ.\n\nFor example if the input gamut is ACEScg, these overlays will be mapped to that. Note that this can cause most of the overlays to be negative or highly saturated which might harm the visual appearance." +STARTLINE}
 map_overlays_to_input_gamut true
}
 Group {
  inputs 0
  name GamutGrid1
  xpos -920
  ypos -201
  postage_stamp true
  addUserKnob {20 GamutGrid}
  addUserKnob {3 style}
  style {{!parent.gamut_grid_style}}
  addUserKnob {3 distribution -STARTLINE}
  distribution {{parent.distribution}}
  addUserKnob {7 density R 10 150}
  density {{parent.density}}
  addUserKnob {26 ""}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {12 wxy}
  wxy {{parent.RGBToXYZ_GamutGrid.wxy} {parent.RGBToXYZ_GamutGrid.wxy}}
 }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   centerSaturation 1
   fillFormat false
   area {-170 -158 682 670}
   name ColorWheel4
   xpos -260
   ypos -15
   postage_stamp false
  }
  Crop {
   box {0 0 {width} {height}}
   crop false
   name Crop2
   xpos -260
   ypos 27
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat3
   xpos -260
   ypos 110
  }
set N6433b400 [stack 0]
push $N6433b400
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   roworder TopBottom
   name ContactSheet2
   xpos -260
   ypos 169
  }
  Dot {
   name Dot1
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -226
   ypos 246
  }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   fillFormat false
   area {40 40 472 472}
   name ColorWheel1
   xpos -40
   ypos -664
   postage_stamp false
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat1
   xpos -40
   ypos -628
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   name Crop1
   xpos -40
   ypos -602
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos -526
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos -415
  }
  Colorspace {
   colorspace_in CIE-XYZ
   colorspace_out CIE-Yxy
   name Colorspace1
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -341
  }
set N64338c00 [stack 0]
  Dot {
   name Dot2
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos -331
  }
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression5
   label "CIE Yxy to CIELuv"
   xpos -590
   ypos -304
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 "(-(degrees(atan2(g-white.x, b-white.y))-180)+270)%360/360"
   expr2 "hypot(g-white.x, b-white.y)"
   expr3 a
   name Expression3
   xpos -590
   ypos -261
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{"parent.distribution ? 4*parent.wxy.x / ( -2 * parent.wxy.x + 12 * parent.wxy.y + 3) : parent.wxy"} {"parent.distribution ? 9*parent.wxy.y / ( -2*parent.wxy.x + 12*parent.wxy.y + 3) : parent.wxy"}}
  }
set N646e3c00 [stack 0]
  Posterize {
   channels rgb
   Colors {{rint(parent.density/3*2)}}
   name Posterize1
   xpos -590
   ypos -191
  }
set N646e3800 [stack 0]
push $N646e3c00
  Dot {
   name Dot15
   xpos -446
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy1
   xpos -480
   ypos -154
  }
push $N646e3800
push $N646e3c00
  Dot {
   name Dot16
   xpos -666
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy2
   xpos -700
   ypos -153
  }
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   center true
   roworder TopBottom
   name ContactSheet3
   xpos -590
   ypos -106
  }
  Expression {
   expr0 r
   expr1 cos(radians(g*360))*b+white.x
   expr2 sin(radians(g*360))*b+white.y
   expr3 a
   name Expression19
   xpos -590
   ypos -58
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{parent.Expression3.white} {parent.Expression3.white}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression2
   label "CIELuv to CIE Yxy"
   xpos -590
   ypos -16
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace2
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -590
   ypos 32
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix1
   label "XYZ to RGB"
   xpos -590
   ypos 81
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin2
   xpos -590
   ypos 119
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp1
   xpos -590
   ypos 152
  }
  Premult {
   name Premult1
   xpos -590
   ypos 194
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge2
   xpos -590
   ypos 242
  }
  Fill {
   output alpha
   name Fill1
   xpos -590
   ypos 297
  }
  Dot {
   name Dot3
   label " GRID"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos 378
  }
push $N6433b400
push $N64338c00
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression4
   label "CIE Yxy to CIELuv"
   xpos -40
   ypos -280
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 rint(g*Colors)/Colors
   expr2 rint(b*Colors)/Colors
   expr3 a
   name Expression1
   label rint
   xpos -40
   ypos -232
   addUserKnob {20 User}
   addUserKnob {7 Colors R 1 256}
   Colors {{parent.density}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression6
   label "CIELuv to CIE Yxy"
   xpos -40
   ypos -184
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace3
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -112
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix3
   label "XYZ to RGB"
   xpos -40
   ypos -57
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp4
   xpos -40
  }
  Premult {
   name Premult2
   xpos -40
   ypos 55
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge1
   xpos -40
   ypos 110
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin1
   xpos -40
   ypos 273
  }
  Dot {
   name Dot4
   label " DOTS"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 378
  }
  Switch {
   inputs 2
   which {{parent.style}}
   name Switch1
   xpos -257
   ypos 483
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix2
   label "RGB to XYZ"
   xpos -257
   ypos 560
  }
  Output {
   name Output
   xpos -257
   ypos 740
  }
  ColorWheel {
   inputs 0
   format "256 256 0 0 256 256 1 square_256"
   area {40 40 472 472}
   name ColorWheel2
   xpos -37
   ypos -705
   postage_stamp false
  }
 end_group
set N6437e400 [stack 0]
 Group {
  name RGBToXYZ_GamutGrid
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos -184
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorWheel {
  inputs 0
  format "512 512 0 0 512 512 1 square_512"
  centerSaturation 1
  fillFormat false
  area {-196 -184 708 696}
  name ColorWheel1
  xpos -920
  ypos 5
 }
 Crop {
  box {0 0 {width} {height}}
  name Crop1
  xpos -920
  ypos 87
 }
 BlackOutside {
  name BlackOutside3
  xpos -920
  ypos 134
 }
set N64606800 [stack 0]
 Group {
  name RGBToXYZ_GamutC
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1140
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r+input.width} {parent.ReformatBox4.box_width-input.height}}
  name Position6
  xpos -1140
  ypos 254
 }
push $N64606800
 Group {
  name RGBToXYZ_GamutB
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height*2}}
  name Position5
  xpos -1030
  ypos 254
 }
push $N64606800
 Group {
  name RGBToXYZ_GamutA
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -920
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position4
  xpos -920
  ypos 254
 }
push $N6437e400
 Reformat {
  type scale
  scale 0.8
  turn true
  filter impulse
  black_outside true
  name Reformat2
  xpos -920
  ypos -129
 }
 BlackOutside {
  name BlackOutside2
  xpos -920
  ypos -106
 }
 Position {
  translate {{Rectangle1.area.r} {parent.Position3.translate.y-input.height}}
  name Position2
  xpos -920
  ypos -81
 }
 Group {
  inputs 0
  name ColorChecker24_After_November_2014
  label "CIE XYZ D50"
  xpos -920
  ypos -352
  addUserKnob {20 colorchecker_tab l "ColorChecker24 - After November 2014"}
  addUserKnob {3 patch_resolution}
  patch_resolution 48
 }
  Group {
   inputs 0
   name bluish_green
   selected true
   xpos 622
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.30451114 0.4143554688 0.344352688 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "bluish green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 6
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_flower
   xpos 512
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2419823988 0.2287175998 0.3282104382 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue flower"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 5
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name foliage
   xpos 402
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1114392339 0.1346792679 0.05239320311 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob foliage
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 4
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_sky
   xpos 292
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1652470004 0.1785519348 0.2546024121 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue sky"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 3
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name light_skin
   xpos 180
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3811104477 0.336202304 0.1852590702 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "light skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 2
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 135
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name dark_skin
   xpos 70
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1136398927 0.09832436105 0.047793811 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "dark skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 1
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 290
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 290
    ypos 158
   }
   Output {
    name Output
    xpos 290
    ypos 230
   }
  end_group
  Group {
   inputs 0
   name orange_yellow
   xpos 622
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4769723742 0.4293377578 0.06005041429 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "orange yellow"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 12
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow_green
   xpos 512
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3427379502 0.4331759409 0.08330791241 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "yellow green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 11
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purple
   xpos 401
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08353888545 0.06276662955 0.1042075686 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob purple
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 10
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name moderate_red
   xpos 290
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2915036416 0.188999956 0.09736350318 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "moderate red"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 9
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purplish_blue
   xpos 180
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1200518326 0.1091090233 0.2874447494 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "purplish blue"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 8
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name orange
   xpos 74
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4073691399 0.3126416159 0.05130591012 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob orange
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 7
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name cyan
   xpos 622
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1247966941 0.180609913 0.2913392383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob cyan
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 18
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name magenta
   xpos 512
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.299122798 0.1895114577 0.2213469194 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob magenta
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 17
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow
   xpos 399
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5888922356 0.5992976803 0.07077420003 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob yellow
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 16
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 182
   }
  end_group
  Group {
   inputs 0
   name red
   xpos 292
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2143728424 0.127800835 0.03868150726 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob red
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 15
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name green
   xpos 182
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1413517689 0.2233437582 0.07287461742 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob green
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 14
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue
   xpos 72
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.06809095613 0.05596214063 0.2077405936 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob blue
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 13
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name black_2
   xpos 623
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.03042544265 0.03151319431 0.02656724434 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "black 2 (1.5 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 24
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_3
   xpos 512
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08448968042 0.08817234828 0.07391630753 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 3.5 (1.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 23
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_5
   xpos 403
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1835495863 0.1906228754 0.1566717383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 5 (.70 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 22
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_6
   xpos 292
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3495921991 0.3648652066 0.3013565492 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 6.5 (.44 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 21
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_8
   xpos 179
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5665335579 0.5899709702 0.4828473821 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 8 (.23 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 20
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name white_9
   xpos 70
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.8436985288 0.8806903203 0.6936778752 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "white 9.5 (.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 19
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 134
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  ContactSheet {
   inputs 24
   width {{"rint(parent.patch_resolution * 6 + gap * 7)"}}
   height {{"rint(parent.patch_resolution * 4 + gap * 5)"}}
   rows 4
   columns 6
   startframe 1
   endframe 1
   name ContactSheet
   xpos 620
   ypos 206
  }
  Unpremult {
   name Unpremult1
   xpos 620
   ypos 278
  }
  Output {
   name Output
   xpos 620
   ypos 446
  }
 end_group
 BlackOutside {
  name BlackOutside4
  xpos -920
  ypos -298
 }
 Position {
  translate {{parent.Reformat1.box_width*3+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position7
  xpos -920
  ypos -273
 }
 Constant {
  inputs 0
  format "256 256 0 0 256 256 1 square_256"
  name Constant5
  xpos -700
  ypos -1354
  postage_stamp false
 }
 Dot {
  name Dot25
  xpos -666
  ypos -1302
 }
set N6472ac00 [stack 0]
 Dot {
  name Dot27
  xpos -1546
  ypos -1302
 }
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox1
  xpos -1580
  ypos -994
 }
 Ramp {
  p0 {0 0}
  p1 {{input.width} 0}
  color {{p1}}
  name Ramp3
  xpos -1580
  ypos -898
 }
 ColorLookup {
  lut {master {}
    red {curve 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914}
    green {curve 0.433 0.464 0.513 0.611 0.576 0.46 0.426 0.412 0.404 0.397 0.384 0.374 0.346 0.333 0.311 0.287 0.257 0.23 0.21 0.219 0.208 0.211 0.208 0.187 0.191 0.187 0.18 0.164 0.17 0.177 0.175 0.188 0.252 0.325 0.385 0.416 0.433 0.487 0.532 0.588 0.637 0.634 0.549 0.506 0.49 0.458 0.426 0.412 0.397 0.365 0.337 0.301 0.262 0.221 0.192 0.164 0.167 0.162 0.176 0.179 0.148 0.156 0.142 0.148 0.138 0.145 0.145 0.161 0.197 0.256 0.324 0.393 0.451 0.487 0.508 0.538 0.587 0.634 0.659 0.611 0.552 0.526 0.484 0.452 0.428 0.406 0.371 0.334 0.293 0.243 0.204 0.177 0.151 0.151 0.162 0.158 0.161 0.142 0.141 0.129 0.134 0.14 0.156 0.166 0.192 0.221 0.265 0.325 0.392 0.451 0.508 0.48 0.513 0.554 0.597 0.63 0.634 0.58 0.546 0.499 0.466 0.434 0.408 0.372 0.332 0.288 0.242 0.202 0.179 0.16 0.157 0.162 0.157 0.159 0.149 0.153 0.147 0.154 0.164 0.18 0.199 0.226 0.25 0.279 0.325 0.38 0.439 0.48 0.436 0.468 0.502 0.541 0.57 0.605 0.594 0.555 0.511 0.473 0.439 0.409 0.371 0.332 0.288 0.252 0.217 0.196 0.181 0.178 0.185 0.176 0.173 0.168 0.176 0.178 0.19 0.202 0.214 0.235 0.254 0.27 0.291 0.323 0.366 0.41 0.436 0.396 0.414 0.438 0.465 0.485 0.527 0.566 0.557 0.523 0.478 0.442 0.409 0.371 0.334 0.294 0.265 0.244 0.223 0.225 0.212 0.218 0.211 0.211 0.207 0.214 0.217 0.229 0.237 0.244 0.264 0.275 0.285 0.3 0.321 0.348 0.376 0.396 0.357 0.368 0.377 0.391 0.402 0.431 0.481 0.503 0.521 0.482 0.444 0.409 0.372 0.337 0.307 0.286 0.27 0.257 0.247 0.251 0.257 0.255 0.254 0.25 0.258 0.259 0.265 0.269 0.278 0.284 0.292 0.297 0.305 0.317 0.33 0.344 0.357 0.321 0.322 0.328 0.332 0.333 0.346 0.365 0.389 0.411 0.459 0.443 0.399 0.352 0.327 0.313 0.304 0.3 0.294 0.295 0.294 0.293 0.292 0.291 0.295 0.3 0.301 0.302 0.304 0.304 0.304 0.305 0.307 0.309 0.312 0.313 0.316 0.321}
    blue {curve 0.26 0.281 0.298 0.306 0.342 0.365 0.39 0.381 0.392 0.416 0.413 0.43 0.448 0.446 0.433 0.425 0.419 0.394 0.362 0.328 0.305 0.298 0.286 0.247 0.26 0.219 0.199 0.168 0.178 0.14 0.11 0.084 0.104 0.158 0.18 0.225 0.26 0.235 0.26 0.28 0.298 0.327 0.372 0.395 0.417 0.43 0.435 0.455 0.488 0.479 0.521 0.522 0.515 0.49 0.436 0.383 0.331 0.295 0.282 0.258 0.219 0.208 0.179 0.168 0.141 0.129 0.106 0.094 0.095 0.112 0.127 0.165 0.199 0.235 0.226 0.258 0.28 0.298 0.316 0.361 0.399 0.427 0.446 0.461 0.482 0.52 0.521 0.553 0.563 0.573 0.524 0.454 0.389 0.33 0.295 0.266 0.247 0.214 0.195 0.168 0.178 0.142 0.14 0.128 0.129 0.126 0.131 0.144 0.167 0.199 0.226 0.238 0.266 0.289 0.31 0.329 0.351 0.395 0.428 0.453 0.475 0.494 0.533 0.542 0.568 0.584 0.576 0.53 0.451 0.385 0.331 0.299 0.266 0.245 0.22 0.206 0.184 0.174 0.167 0.166 0.166 0.173 0.172 0.165 0.172 0.187 0.208 0.238 0.258 0.28 0.3 0.321 0.343 0.362 0.391 0.427 0.458 0.482 0.503 0.546 0.554 0.573 0.582 0.546 0.499 0.431 0.375 0.33 0.304 0.275 0.254 0.234 0.225 0.212 0.209 0.206 0.203 0.21 0.215 0.212 0.204 0.208 0.214 0.231 0.258 0.277 0.294 0.31 0.328 0.348 0.372 0.397 0.427 0.462 0.487 0.51 0.544 0.558 0.559 0.556 0.503 0.444 0.402 0.355 0.329 0.309 0.289 0.275 0.26 0.254 0.245 0.245 0.241 0.238 0.249 0.249 0.245 0.241 0.242 0.246 0.258 0.277 0.295 0.305 0.315 0.327 0.339 0.359 0.39 0.421 0.461 0.491 0.515 0.54 0.546 0.522 0.478 0.429 0.393 0.368 0.345 0.325 0.313 0.303 0.295 0.286 0.284 0.279 0.277 0.274 0.277 0.277 0.28 0.276 0.273 0.274 0.279 0.285 0.295 0.311 0.314 0.316 0.32 0.323 0.331 0.346 0.367 0.397 0.468 0.513 0.494 0.425 0.388 0.372 0.348 0.336 0.331 0.326 0.32 0.316 0.314 0.312 0.309 0.321 0.32 0.319 0.305 0.317 0.316 0.316 0.315 0.316 0.317 0.319 0.321 0.311}
    alpha {}}
  name ColorLookup7
  label "Pointers Samples Yxy\nSource: https://www.rit.edu/cos/colorscience/rc_useful_data.php"
  xpos -1580
  ypos -790
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace12
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1580
  ypos -688
 }
 Fill {
  output alpha
  name Fill5
  xpos -1580
  ypos -639
 }
 BlackOutside {
  name BlackOutside7
  xpos -1580
  ypos -562
 }
 Position {
  translate {6 {parent.Position1.translate.y-input.height}}
  name Position3
  xpos -1580
  ypos -538
 }
 Dot {
  name Dot15
  xpos -1546
  ypos -414
 }
push $N6472ac00
 Reformat {
  type "to box"
  box_width 2048
  box_height 2048
  box_fixed true
  name ReformatBox4
  xpos -700
  ypos -1258
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression7
  xpos -700
  ypos -1209
 }
 Dot {
  name Dot10
  xpos -666
  ypos -1158
 }
set N64adb000 [stack 0]
 Dot {
  name Dot26
  xpos -886
  ypos -1158
 }
set N64adac00 [stack 0]
 Dot {
  name Dot23
  xpos -1106
  ypos -1158
 }
set N64ada800 [stack 0]
 Dot {
  name Dot12
  xpos -1326
  ypos -1158
 }
 Mirror2 {
  flip true
  flop true
  name Mirror2_1
  xpos -1360
  ypos -1042
 }
 Reformat {
  type "to box"
  box_width 512
  box_height {{box_width}}
  box_fixed true
  name Reformat1
  xpos -1360
  ypos -994
 }
 Gamma {
  channels rgb
  value 2
  name Gamma1
  xpos -1360
  ypos -898
 }
 Multiply {
  channels rgb
  value 8000
  name Multiply1
  label "\[value value]"
  xpos -1360
  ypos -811
 }
 ColorLookup {
  lut {master {}
    red {curve R 0.4830000103 x50 0.5045000315 0.5260000229 0.5475000143 0.5690000057 0.5904999971 0.6119999886 0.63349998 0.6549999714 0.6805312037 0.7087500095 0.7315937281 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.75459373 0.7845000029 0.8144062757 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8009687662 0.74150002 0.6820312142 0.6549999714 0.6684374809 0.6980000138 0.7275624871 0.7409999967 0.7315937281 0.7087500095 0.6805312037 0.6549999714 0.629468739 0.6012499928 0.5784062743 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5555624962 0.5260000229 0.4964375198 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4964375198 0.5260000229 0.5555624962 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5653046966 0.5555624962 0.5417890549 0.5260000229 0.5102109313 0.4964375198 0.4866953194 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4695625007 0.4400000274 0.4104375243 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.4104375243 0.4400000274 0.4695625007 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103}
    green {curve R 0.6589999795 x50 0.6542205811 0.6484853029 0.6414804459 0.6340000033 0.6249843836 0.6147499681 0.6041406393 0.5939999819 0.5844687223 0.575124979 0.5659687519 0.5569999814 0.5484530926 0.5402500033 0.5319218636 0.5230000019 0.5131718516 0.5027499795 0.4922031164 0.4819999933 0.4722187519 0.4626249969 0.4532187581 0.4440000057 0.4351093769 0.4265000224 0.4178906381 0.4090000093 0.3997343779 0.3902499974 0.380640626 0.3709999919 0.3614374995 0.3518749774 0.3421249986 0.3319999874 0.321398437 0.3104375005 0.2992577851 0.2879999876 0.2764999866 0.2647500038 0.2531249821 0.2419999987 0.2312265635 0.2206875086 0.2108047009 0.202000007 0.1947187632 0.1886250079 0.1829687506 0.1770000011 0.1693515629 0.1608124971 0.1538671851 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1527187377 0.1564999968 0.1602812558 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1612187475 0.1595000029 0.1577812582 0.1570000052 0.1573124975 0.1579999924 0.1586875021 0.1589999944 0.1575781256 0.1543750018 0.1509843767 0.1490000039 0.1485625058 0.1484999955 0.1484375 0.1480000019 0.1467812508 0.1449999958 0.1432187557 0.1420000046 0.1415625066 0.1414999962 0.1414375007 0.1410000026 0.1397656202 0.1378750056 0.1357968748 0.1340000033 0.1323750019 0.1307500005 0.1295000017 0.1289999932 0.130031243 0.1324999928 0.1354687512 0.1379999965 0.1402187496 0.1424999982 0.1442812532 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1464921832 0.1503124982 0.1554765552 0.1609999985 0.1673984379 0.1749375015 0.1822578013 0.1879999936 0.1906718612 0.1913749874 0.1926406175 0.1969999969 0.2064140588 0.2199375033 0.2357421964 0.2520000041 0.2688750029 0.2871249914 0.3058125079 0.324000001 0.3417187631 0.359375 0.3765937686 0.3930000067 0.4082968831 0.4227499962 0.4368281364 0.451000005 0.4659531415 0.4812500179 0.4956718981 0.5080000162 0.5169296861 0.5234375 0.5297265649 0.5379999876 0.5491171479 0.5618124604 0.5751015544 0.5879999995 0.6009531021 0.6142500043 0.6266719103 0.6370000243 0.6457066536 0.6532088518 0.6575522423 0.6589999795}
    blue {curve R 0.3160000145 x50 0.324739933 0.3330312669 0.3418398499 0.351000011 0.3607422113 0.3709374964 0.3811640739 0.3910000026 0.4003046751 0.4093124866 0.4181640446 0.4269999862 0.4359609187 0.4449374974 0.453695327 0.4620000124 0.4697890878 0.4771875143 0.4842422009 0.4909999967 0.4971874952 0.5028749704 0.5086249709 0.5149999857 0.5227031112 0.53125 0.5394218564 0.5460000038 0.5502656102 0.5530000329 0.5552343726 0.5580000281 0.561632812 0.5655625463 0.5694609284 0.5730000138 0.5765469074 0.5801249743 0.5828906298 0.5839999914 0.5838750005 0.5830000043 0.5806249976 0.5759999752 0.5682968497 0.5576249957 0.5446406007 0.5299999714 0.5128515363 0.4931874871 0.4729296863 0.4539999962 0.4368359447 0.420437485 0.4045703113 0.3889999986 0.3731718659 0.3573749959 0.3426406384 0.3300000131 0.3193906248 0.310375005 0.3034218848 0.298999995 0.2972500026 0.2969999909 0.2967499793 0.2949999869 0.2899531126 0.2821249962 0.2734843791 0.2660000026 0.2602812648 0.2552500069 0.2503437698 0.2450000048 0.2380000055 0.2300000042 0.2232500017 0.2199999988 0.2195625007 0.2194999903 0.2194374949 0.2189999968 0.2183593661 0.2176249921 0.2163281292 0.2140000015 0.2101874948 0.205249995 0.1999374926 0.1949999928 0.1904453039 0.185937494 0.1817109436 0.1780000031 0.1754062474 0.1736250073 0.1715312451 0.1679999977 0.1620937437 0.1546249986 0.147093758 0.1410000026 0.1372031271 0.1347499937 0.1324218661 0.1289999932 0.1237656176 0.1174999923 0.1112343743 0.1059999987 0.1021796837 0.09918750077 0.09660156071 0.09399999678 0.09089062363 0.0876249969 0.0850468725 0.08399999887 0.08524999768 0.0882499963 0.09187500179 0.09499999881 0.09706249833 0.09875000268 0.1008125022 0.1040000021 0.1084140688 0.1136875004 0.1198671907 0.1270000041 0.1355390698 0.145312503 0.1554296911 0.1650000066 0.1739453226 0.1826875061 0.1910859346 0.199000001 0.2061250061 0.2126249969 0.2190624923 0.2259999961 0.2338827997 0.2423124909 0.2505859137 0.2579999864 0.2642968595 0.26987499 0.2750156224 0.2800000012 0.2847812474 0.2892500162 0.2935937643 0.2980000079 0.3025000095 0.3070000112 0.3115000129 0.3160000145}
    alpha {}}
  name ColorLookup5
  label "Pointer's Gamut Boundary Yxy\ninterpolated: incr 50 - 0 to 8000"
  xpos -1360
  ypos -775
 }
 Multiply {
  channels rgb
  value {0.31 1 1 1}
  name Multiply2
  label "dim boundary"
  xpos -1360
  ypos -725
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace5
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1360
  ypos -688
 }
 Fill {
  output alpha
  name Fill4
  xpos -1360
  ypos -639
 }
 BlackOutside {
  name BlackOutside1
  xpos -1360
  ypos -562
 }
 Position {
  translate {6 {ReformatBox4.box_width-input.width}}
  name Position1
  xpos -1360
  ypos -538
 }
 Dot {
  name Dot24
  xpos -1326
  ypos -486
 }
push $N64ada800
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox2
  xpos -1140
  ypos -994
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression1
  xpos -1140
  ypos -898
 }
set N64a86400 [stack 0]
 Dot {
  name Dot8
  xpos -996
  ypos -894
 }
 ColorLookup {
  lut {master {curve L 0 s0 t0.9499999881 C k x0.308139503 1 s0}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos -1030
  ypos -849
 }
 Dot {
  name Dot14
  xpos -996
  ypos -750
 }
push $N64a86400
 Multiply {
  channels rgb
  value 269
  name Multiply5
  label "\[value value]"
  xpos -1140
  ypos -856
 }
 ColorLookup {
  lut {master {}
    red {curve C 1.8783474 1.85965741 1.8410753 1.82260251 1.80424976 1.78602886 1.76794314 1.75000143 1.73221421 1.71458244 1.69711792 1.67982578 1.66271067 1.6457777 1.62903571 1.6124835 1.59613538 1.57998943 1.56404996 1.54832447 1.5328095 1.51751649 1.50244594 1.48759735 1.47297573 1.45858264 1.44442391 1.43049574 1.41680288 1.40334678 1.39012623 1.37714779 1.36440396 1.35190022 1.33963728 1.32761216 1.31582856 1.30428183 1.29297352 1.28190565 1.27107596 1.2604804 1.25012183 1.23999798 1.23010659 1.22044563 1.21101499 1.20181489 1.19284034 1.18408906 1.17556167 1.16725397 1.15916491 1.15129638 1.14363372 1.13618886 1.12895167 1.12192106 1.11509454 1.10846853 1.10204577 1.09580922 1.08977199 1.08392429 1.07826447 1.07278681 1.06749392 1.06237841 1.05743873 1.05267084 1.04807138 1.04364109 1.03937256 1.03526449 1.03131545 1.02751946 1.02387333 1.02037668 1.01702523 1.01381445 1.01074362 1.00780725 1.00500631 1.00233305 0.99978602 0.99736285 0.9950608 0.99287677 0.99080539 0.98884678 0.98699367 0.9852494 0.98361033 0.98206747 0.98062134 0.97926998 0.97800934 0.97683728 0.97575116 0.97474778 0.97382426 0.97297859 0.97220623 0.97150886 0.97087657 0.97031689 0.96981871 0.96938527 0.96900952 0.96869147 0.96842706 0.96821606 0.96805781 0.96794283 0.96787858 0.96785843 0.96787864 0.96793604 0.96803701 0.96817231 0.96833968 0.96854311 0.96877253 0.96903455 0.96932232 0.96963543 0.96997368 0.97033387 0.97071254 0.9711163 0.97153723 0.97197378 0.97242606 0.97289121 0.97337079 0.97386622 0.97437072 0.97488332 0.97540969 0.97594237 0.97647977 0.97702706 0.97757769 0.97813445 0.97869468 0.97925854 0.97982538 0.98039114 0.98096472 0.98153675 0.98210776 0.98267955 0.98325121 0.98382008 0.98438704 0.9849571 0.98552132 0.98608243 0.98664182 0.98719966 0.98775077 0.98829895 0.98884273 0.98938417 0.98991877 0.9904511 0.99097681 0.99149919 0.99201453 0.99252397 0.99303031 0.99353105 0.99402624 0.99451613 0.99499857 0.99547589 0.99594522 0.99641174 0.99687338 0.99732745 0.99777603 0.9982177 0.99865389 0.999084 0.99950838 0.99992663 1.00033772 1.00074494 1.00114489 1.00153947 1.00192833 1.00231075 1.00268865 1.00305855 1.00342607 1.00378489 1.00413895 1.00448751 1.00483036 1.00517035 1.00550389 1.00583148 1.00615203 1.00646758 1.00678015 1.00708604 1.00738645 1.00768471 1.00797844 1.0082655 1.00854778 1.00882483 1.00909901 1.00936711 1.00963116 1.00989032 1.0101465 1.01039672 1.01064491 1.01088691 1.0111258 1.01135957 1.01158977 1.01181614 1.01203847 1.01225793 1.01247287 1.01268291 1.01289058 1.01309609 1.01329684 1.01349473 1.0136888 1.0138787 1.01406395 1.01424909 1.01442885 1.01460576 1.01478052 1.01495218 1.01512218 1.01528883 1.01545072 1.01561022 1.01576698 1.01592219 1.01607502 1.01622343 1.01636875 1.0165143 1.01665616 1.01679492 1.0169313 1.01706588 1.01719737 1.01732695 1.01745498 1.01757956 1.01770294 1.01782393 1.01794255 1.0180583 1.01817465 1.01828551 1.01839495 1.01850486 1.01861191 1.01871693 1.01882088 1.01891339}
    green {curve C 1}
    blue {curve C 0.00879261 0.00962762 0.010532 0.01151017 0.01256675 0.01370643 0.01493413 0.01625487 0.01767381 0.01919618 0.02082733 0.02257277 0.02443803 0.02642871 0.02855051 0.03080913 0.0332104 0.0357601 0.03846392 0.04132775 0.04435719 0.04755813 0.05093599 0.05449668 0.0582453 0.0621875 0.06632853 0.07067341 0.07522713 0.07999477 0.08498063 0.09018957 0.09562518 0.10129225 0.10719412 0.11333443 0.11971687 0.12634411 0.133219 0.14034435 0.14772213 0.15535444 0.16324303 0.17138906 0.179794 0.18845794 0.197382 0.20656651 0.21601067 0.22571453 0.23567709 0.24589771 0.25637382 0.26710594 0.2780903 0.28932518 0.30080822 0.3125369 0.32450783 0.33671761 0.34916404 0.36183971 0.37474373 0.38787127 0.40121818 0.41477671 0.42854655 0.44251823 0.45668846 0.47105014 0.48559928 0.50033116 0.5152359 0.5303098 0.5455451 0.56093836 0.5764783 0.59215891 0.60797763 0.62392306 0.63999057 0.65616876 0.6724565 0.68884456 0.70532417 0.72188419 0.73852479 0.7552371 0.77200818 0.78883314 0.80570388 0.82261622 0.83956301 0.8565321 0.87351894 0.89051074 0.90751225 0.92450547 0.94148719 0.95845115 0.97538745 0.99229181 1.00915313 1.02597356 1.04273522 1.05944169 1.07608175 1.09265125 1.10914159 1.12555146 1.14187002 1.15809321 1.1742171 1.190238 1.20614767 1.22194457 1.23762202 1.2531724 1.26859927 1.28389311 1.29905295 1.31407428 1.32895291 1.34368753 1.35827363 1.3727088 1.38699389 1.40111876 1.41508293 1.42889357 1.44254065 1.45602405 1.46934104 1.48249614 1.49548101 1.50830269 1.5209527 1.53343177 1.54574537 1.5578897 1.56985986 1.5816654 1.59329891 1.60476208 1.61605716 1.62718153 1.63813758 1.64892519 1.65955138 1.67000985 1.68030369 1.69043732 1.70040607 1.71021223 1.71985734 1.72934508 1.73867714 1.74785423 1.75688136 1.76575518 1.77447391 1.78304338 1.79146802 1.79975164 1.80788386 1.81587982 1.82373333 1.83144975 1.83902776 1.84647095 1.85378456 1.86096811 1.86802399 1.87495112 1.88175035 1.88842535 1.89497983 1.90141833 1.90774179 1.91394711 1.92004013 1.92602086 1.93188739 1.93765306 1.94330883 1.94886208 1.95430994 1.95965815 1.96490622 1.97005856 1.97511387 1.98007631 1.98494554 1.98972344 1.99441445 1.99901712 2.00353193 2.00796437 2.01231384 2.01658392 2.02076721 2.02487659 2.02890825 2.03286695 2.03675175 2.04056406 2.04430199 2.04797506 2.05157685 2.05511236 2.0585804 2.06198287 2.06532407 2.06860161 2.07181907 2.07497644 2.07807779 2.0811162 2.08409977 2.08702946 2.08990335 2.09272337 2.09549189 2.0982089 2.10087585 2.10349345 2.10606146 2.1085825 2.11105394 2.11348104 2.11586332 2.11820364 2.12050176 2.12275648 2.12496805 2.127141 2.12927723 2.13136625 2.13341999 2.13543844 2.13741732 2.13936305 2.1412704 2.1431427 2.14498401 2.14678812 2.14856291 2.1503005 2.15200949 2.15368938 2.15533352 2.15695238 2.15853977 2.16009951 2.16162968 2.16313291 2.16460824 2.16605687 2.16747928 2.16887903 2.17024994 2.1715951 2.17291784 2.17421341 2.17548871 2.17674041 2.17797112 2.17918396 2.18036819 2.18143296}
    alpha {}}
  name ColorLookup3
  label "Planckian Locus 0-269"
  xpos -1140
  ypos -808
 }
 Multiply {
  inputs 1+1
  channels rgb
  value 0
  maskChannelMask rgba.red
  invert_mask true
  name Multiply3
  label dim
  xpos -1140
  ypos -760
 }
 BlackOutside {
  name BlackOutside6
  xpos -1140
  ypos -706
 }
 Position {
  translate {6 {parent.Position2.translate.y-input.height}}
  name Position8
  xpos -1140
  ypos -682
 }
 Dot {
  name Dot28
  xpos -1106
  ypos -654
 }
push $N64adac00
 Dot {
  name Dot4
  xpos -886
  ypos -1086
 }
set N64a33800 [stack 0]
 Rectangle {
  replace true
  area {0 0 6 {height}}
  name Rectangle1
  xpos -810
  ypos -1089
 }
 BlackOutside {
  name BlackOutside5
  xpos -810
  ypos -1041
 }
push $N64a33800
 Radial {
  inputs 1+1
  replace true
  area {-5422 -3542 7470 5590}
  softness 0
  ramp linear
  color {0.0719 0.02604 0.0001 1}
  p1 {0 0}
  color0 {0.039378 0.001097 0.188331 1}
  p0 {0 2048}
  name Radial1
  xpos -920
  ypos -1041
 }
 Dot {
  name Dot9
  xpos -886
  ypos -894
 }
push $N64adb000
 Gamma {
  channels rgba
  value 0.5
  name Gamma2
  xpos -700
  ypos -1120
 }
 Expression {
  temp_name0 start
  temp_expr0 360
  temp_name1 end
  temp_expr1 830
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 r*(end-start)+start
  channel1 none
  channel2 none
  expr3 1
  name Expression2
  label "360nm to 830nm"
  xpos -700
  ypos -1096
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 6.97e-06 7.81e-06 8.77e-06 9.84e-06 1.104e-05 1.239e-05 1.389e-05 1.556e-05 1.744e-05 1.958e-05 2.202e-05 2.484e-05 2.804e-05 3.153e-05 3.522e-05 3.9e-05 4.283e-05 4.691e-05 5.159e-05 5.718e-05 6.4e-05 7.234e-05 8.221e-05 9.351e-05 0.00010614 0.00012 0.00013498 0.00015149 0.00017021 0.00019182 0.000217 0.00024691 0.00028124 0.00031852 0.00035727 0.000396 0.00043371 0.00047302 0.00051788 0.00057222 0.00064 0.00072456 0.0008255 0.00094116 0.00106988 0.00121 0.00136209 0.00153075 0.00172037 0.00193532 0.00218 0.0024548 0.002764 0.0031178 0.0035264 0.004 0.00454624 0.00515932 0.00582928 0.00654616 0.0073 0.00808651 0.00890872 0.00976768 0.01066443 0.0116 0.01257317 0.01358272 0.01462968 0.01571509 0.01684 0.01800736 0.01921448 0.02045392 0.02171824 0.023 0.02429461 0.02561024 0.02695857 0.02835125 0.0298 0.03131083 0.03288368 0.03452112 0.03622571 0.038 0.03984667 0.041768 0.043766 0.04584267 0.048 0.05024368 0.05257304 0.05498056 0.05745872 0.06 0.06260197 0.06527752 0.06804208 0.07091109 0.0739 0.077016 0.0802664 0.0836668 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name ColorLookup4
  label "CIE 1931 2 Degree Standard Observer\n360nm to 830nm"
  xpos -700
  ypos -1030
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeLineOfPurples
  xpos -700
  ypos -897
  disable {{!parent.draw_line_of_purples}}
 }
 Fill {
  color {0 0 0 1}
  name Disable_SpectralLocus
  xpos -700
  ypos -826
  disable {{parent.draw_spectral_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePlanckianLocus
  xpos -700
  ypos -658
  disable {{!parent.draw_planckian_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut
  xpos -700
  ypos -489
  disable {{!parent.draw_pointers_gamut}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut_Samples
  xpos -700
  ypos -417
  disable {{!draw_pointers_samples}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeMacbeth
  xpos -700
  ypos -273
  disable {{!parent.draw_macbeth_chart}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutGrid
  xpos -700
  ypos -81
  disable {{!parent.gamut_grid}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutA
  xpos -700
  ypos 255
  disable {{!parent.gamut_a}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutB
  xpos -700
  ypos 279
  disable {{!parent.gamut_b}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutC
  xpos -700
  ypos 303
  disable {{!parent.gamut_c}}
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 450
 }
set N649cec00 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 450
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace6
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -590
  ypos 488
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression5
  label "CIE Yxy to CIELuv"
  xpos -590
  ypos 536
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 618
 }
push $N649cec00
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  invert true
  name ColorMatrix1
  label "XYZ to working"
  xpos -700
  ypos 488
  disable {{!map_overlays_to_input_gamut}}
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_grid\" iterate pixelWise b2e7b5f8a89bdb0629aa8cc2eae387ef3436f24cb0af642eeba41235874506c4 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 6 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== \"draw_axes\" Bool 1 AA== \"grid_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 6 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 \"draw_axes\" 1 1 \"grid_color\" 4 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_grid : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n  bool draw_axes;\n  float4 grid_color;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  void draw_grid() \{\n    // grid width in pixels. expresses a 0 to 1 range in CIE xy\n    float grid_width = 1.0f * outsize + offset;\n    // draw grid lines\n    float i = offset;\n    while (i <= grid_width && i > 0.0f) \{\n      write_aa(offset, i, grid_color);\n      write_aa(i, offset, grid_color);\n      i += 1.0;\n    \}\n    // cross-hatching interval in pixels\n    float hatch_interval = (grid_width - offset) * 0.1f;\n    // cross-hatch length in pixels\n    float hatch_width = outsize * 0.01f;\n    i = offset;\n    while (i <= grid_width) \{\n      i += hatch_interval;\n      float j = 0.0;\n      while (j <= hatch_width/2) \{\n        write_aa(offset+j, i, grid_color);\n        write_aa(offset-j, i, grid_color);\n        write_aa(i, offset+j, grid_color);\n        write_aa(i, offset-j, grid_color);\n        j += 1.0;\n      \}\n    \}\n  \}\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n\n    // draw CIExy coordinate system axes\n    if (draw_axes && pos.x == 0 && pos.y == 0) \{\n      draw_grid();\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_grid_padding {{parent.PlotChromaticities.PlotChromaticity_padding}}
  PlotChromaticity_grid_left_margin {{parent.PlotChromaticities.PlotChromaticity_left_margin}}
  PlotChromaticity_grid_tolerance 0.8
  PlotChromaticity_grid_antialias true
  PlotChromaticity_grid_draw_axes {{parent.coordinate_system}}
  PlotChromaticity_grid_grid_color {0.15 0 0.005 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotInput2
  xpos -700
  ypos 608
 }
 FrameHold {
  firstFrame 1
  name FrameHold1
  xpos -700
  ypos 680
  cached true
 }
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 762
 }
 Input {
  inputs 0
  name Input
  xpos 620
  ypos -1426
 }
 AddChannels {
  name AddChannels1
  xpos 620
  ypos -1360
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat
  xpos 620
  ypos -1282
  disable {{!parent.resample_input}}
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name CropBBox
  xpos 620
  ypos -1257
 }
 Dot {
  name Dot7
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 162
 }
set N64963400 [stack 0]
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "256 256 0 0 256 256 1 square_256"
  name Constant2
  xpos 400
  ypos 38
  postage_stamp false
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat1
  xpos 400
  ypos 64
  disable {{!parent.resample_input}}
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input0]"}}
  name Switch1
  xpos 400
  ypos 158
 }
 Fill {
  output rgb
  color 0.18
  name SampleColor
  xpos 290
  ypos 158
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name Crop2
  xpos 290
  ypos 184
 }
 Fill {
  output alpha
  name Fill3
  xpos 290
  ypos 224
 }
 Dot {
  name Dot6
  xpos 324
  ypos 282
 }
set N64961800 [stack 0]
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  name ColorMatrix4
  label "working to XYZ"
  xpos 180
  ypos 272
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace1
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 180
  ypos 320
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression6
  label "CIE Yxy to CIELuv"
  xpos 180
  ypos 368
  disable {{!parent.diagram}}
 }
push $N64961800
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_sample\" iterate pixelWise 20e14b615a937bac78c1a771cbdfd10cc7c5fb6c487f65d0bb2d6633e404b958 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 3 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== 3 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_sample : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  void process(int2 pos) \{\n    // only process the first pixel\n    if (pos.x > 0 && pos.y > 0) return;\n\n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    int2 p = int2(round(out_coord.x), round(out_coord.y));\n    if (dst.bounds.inside(p.x, p.y)) \{\n      for (int k=0; k<3; k++) \{\n        dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n      \}\n      dst(p.x, p.y, 3) = 1.0f;\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_sample_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_sample_left_margin {{parent.left_margin}}
  PlotChromaticity_sample_tolerance 1
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities1
  xpos 290
  ypos 368
 }
 Dot {
  name Dot22
  xpos 324
  ypos 450
 }
set N64960400 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048}}
  name Dilate1
  label "\[value size]"
  xpos 290
  ypos 488
 }
set N6490fc00 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048*2}}
  name Dilate2
  label "\[value size]"
  xpos 180
  ypos 488
 }
push $N64960400
 Dot {
  name Dot21
  xpos -6
  ypos 450
 }
 FilterErode {
  channels rgba
  size {{-Output.width/2048/5}}
  filter triangle
  name FilterErode1
  label "\[value size]"
  xpos -40
  ypos 489
 }
set N6490f000 [stack 0]
 Dilate {
  channels rgba
  size {0 {parent.Dilate3.size.w}}
  name Dilate4
  label "\[value size]"
  xpos -40
  ypos 584
 }
push $N6490f000
 Dilate {
  channels rgba
  size {{Output.width*plus_size/100} 0}
  name Dilate3
  label "\[value size]"
  xpos 70
  ypos 488
  addUserKnob {20 User}
  addUserKnob {7 plus_size R 0 4}
  plus_size 0.8
 }
 Merge2 {
  inputs 2
  operation screen
  bbox B
  name Merge9
  xpos 70
  ypos 591
 }
 Merge2 {
  inputs 2
  operation stencil
  bbox B
  name Merge10
  xpos 180
  ypos 591
 }
 Group {
  name HueRotate
  xpos 180
  ypos 639
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -24
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos 15
  }
  Colorspace {
   colorspace_out HSV
   name Colorspace1
   xpos -40
   ypos 72
  }
  Add {
   channels {rgba.red -rgba.green -rgba.blue none}
   value 0.5
   name Add1
   xpos -40
   ypos 111
  }
  Fill {
   output {-rgba.red -rgba.green rgba.blue none}
   name Fill1
   xpos -40
   ypos 147
  }
  Colorspace {
   colorspace_in HSV
   name Colorspace2
   xpos -40
   ypos 183
  }
  Premult {
   name Premult1
   xpos -40
   ypos 231
  }
  Output {
   name Output1
   xpos -40
   ypos 302
  }
 end_group
push $N6490fc00
 Merge2 {
  inputs 2
  bbox B
  name Merge8
  xpos 290
  ypos 638
 }
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 690
 }
push $N64963400
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 162
 }
 Group {
  name GamutToXYZ
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos 730
  ypos 247
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 730
  ypos 296
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression4
  label "CIE Yxy to CIELuv"
  xpos 730
  ypos 344
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot13
  label " Pos"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 546
 }
push $N64963400
 Dot {
  name Dot16
  label " Col"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 450
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity\" iterate pixelWise 3e86399c7642fe5c35c23528a644f88a8bf13f967de084ae6842f8be55098c6b 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 4 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== 4 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_left_margin {{parent.left_margin}}
  PlotChromaticity_tolerance 2
  PlotChromaticity_antialias true
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities
  xpos 620
  ypos 536
  disable {{!parent.plot_input}}
 }
 Fill {
  color 0
  name BLACK
  tile_color 0x111111ff
  xpos 620
  ypos 591
  disable {{parent.plot_input}}
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge7
  xpos 620
  ypos 686
  disable {{!parent.enable_sample_color}}
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 620
  ypos 758
 }
 Output {
  name Output
  xpos 620
  ypos 1046
 }
end_group
set N6437eb00 [stack 0]
Write {
 file /Users/afry/GitHub/nukeZCAM/images/comparisons/ZCAMishDRTv03_macbethArcs_v001.jpg
 file_type jpeg
 checkHashOnRead false
 version 3
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write9
 xpos 2327
 ypos 2185
}
push $N5eb08f00
Crop {
 box {0 -74 {width} {height}}
 reformat true
 crop false
 name Crop5
 xpos 1639
 ypos 2323
 disable true
}
Rectangle {
 opacity 0.955
 area {782.4000244 6 1137.599976 67.80000305}
 color 0
 name Rectangle5
 xpos 1639
 ypos 2347
}
Text2 {
 font_size_toolbar 30
 font_width_toolbar 100
 font_height_toolbar 100
 message "ACES 1.2"
 old_message {{65 67 69 83 32 49 46 50}
   }
 box {0 16 1920 55}
 xjustify center
 yjustify center
 transforms {{0 2}
   }
 font_size_values {{0 30 1 30 2 30 3 30 4 30 5 30 6 30 7 30 0 99}
   }
 cursor_position 8
 font {{ Helvetica : Regular : Helvetica.ttc : 0 }}
 font_size 30
 center {960 540}
 cursor_initialised true
 autofit_bbox false
 initial_cursor_position {{717.6001587 112.7998962}
   }
 group_animations {{0} imported: 0 selected: items: "root transform/"}
 animation_layers {{1 11 960 540 0 0 1 1 0 0 0 0}
   }
 name Text3
 xpos 1634
 ypos 2375
}
push $N4e3d3000
Group {
 name OpenDRT
 xpos 1230
 ypos 11
 addUserKnob {20 OpenDRT}
 addUserKnob {26 about_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc>\n<b>OpenDRT</b> created by Jed Smith\n<br>v0.0.90b2 | <a href=https://github.com/jedypod/open-display-transform>documentation</a><br>"}
 addUserKnob {41 gamut l "in gamut" T InGamut_to_XYZ.gamut}
 addUserKnob {26 spacer l " " T ""}
 addUserKnob {35 presets l " " M {"presets/Rec.1886: 2.4 Power | Rec.709" "knobs this \{Lw 100 su 1 sat 1.2 wp 3 eotf 2 display_gamut 4\}" "presets/sRGB Display: 2.2 Power | Rec.709" "knobs this \{Lw 100 su 0 sat 1.2 wp 3 eotf 1 display_gamut 4\}" "presets/Apple Display P3: 2.2 Power | P3D65" "knobs this \{Lw 100 su 0 sat 1.2 wp 3 eotf 1 display_gamut 1\}" "presets/Rec.2020: 2.4 Power | Rec.2020" "knobs this \{Lw 100 su 1 sat 1.2 wp 3 eotf 2 display_gamut 0\}" "presets/Rec.2100: ST 2084 PQ | Rec.2020 | 100 nit" "knobs this \{Lw 100 su 1 sat 1.2 wp 3 eotf 4 display_gamut 0\}" "presets/Rec.2100: ST 2084 PQ | Rec.2020 | 600 nit" "knobs this \{Lw 600 su 2 sat 1 wp 3 eotf 4 display_gamut 0\}" "presets/Rec.2100: ST 2084 PQ | Rec.2020 | 1000 nit" "knobs this \{Lw 1000 su 2 sat 1 wp 3 eotf 4 display_gamut 0\}" "presets/Rec.2100: HLG | Rec.2020 | 1000 nit" "knobs this \{Lw 1000 su 2 sat 1 wp 3 eotf 5 display_gamut 0\}" "presets/Rec.2100: ST 2084 PQ | Rec.2020 | 2000 nit" "knobs this \{Lw 2000 su 2 sat 1 wp 3 eotf 4 display_gamut 0\}" "presets/Rec.2100: ST 2084 PQ | Rec.2020 | 4000 nit" "knobs this \{Lw 4000 su 2 sat 1 wp 3 eotf 4 display_gamut 0\}" "presets/Dolby: ST 2084 PQ | P3D65 | 100 nit" "knobs this \{Lw 100 su 1 sat 1.2 wp 3 eotf 4 display_gamut 1\}" "presets/Dolby: ST 2084 PQ | P3D65 | 600 nit" "knobs this \{Lw 600 su 2 sat 1 wp 3 eotf 4 display_gamut 1\}" "presets/Dolby: ST 2084 PQ | P3D65 | 1000 nit" "knobs this \{Lw 1000 su 2 sat 1 wp 3 eotf 4 display_gamut 1\}" "presets/Dolby: ST 2084 PQ | P3D65 | 2000 nit" "knobs this \{Lw 2000 su 2 sat 1 wp 3 eotf 4 display_gamut 1\}" "presets/Dolby: ST 2084 PQ | P3D65 | 4000 nit" "knobs this \{Lw 4000 su 2 sat 1 wp 3 eotf 4 display_gamut 1\}" "presets/DCI: 2.6 Power | P3 D60" "knobs this \{Lw 100 su 2 sat 1.2 wp 3 eotf 3 display_gamut 2\}" "presets/DCI: 2.6 Power | P3 D65" "knobs this \{Lw 100 su 2 sat 1.2 wp 3 eotf 3 display_gamut 1\}" "presets/DCI: 2.6 Power | P3 DCI" "knobs this \{Lw 100 su 2 sat 1.2 wp 3 eotf 3 display_gamut 3\}" "presets/DCI: 2.6 Power | DCDM XYZ" "knobs this \{Lw 100 su 2 sat 1.2 wp 3 eotf 3 display_gamut 5\}"}}
 addUserKnob {26 ""}
 addUserKnob {26 luminance_label l " " T <b>luminance</b>}
 addUserKnob {41 Lw T ToneScale.Lw}
 addUserKnob {41 su l surround T ToneScale.su}
 addUserKnob {26 chroma_label l " " T "<br/>\n<b>chroma</b>"}
 addUserKnob {41 dch l dechroma T ToneScale.dch}
 addUserKnob {41 sat l saturation T ToneScale.sat}
 addUserKnob {6 pdch l "perceptual dechroma" t "uses a perceptual colorspace to bias hue paths for chroma compression." +STARTLINE}
 pdch true
 addUserKnob {6 gcmp l "gamut compression" t "enable gamut compression" -STARTLINE}
 gcmp true
 addUserKnob {41 wp l whitepoint T Scale.wp}
 addUserKnob {26 ""}
 addUserKnob {26 display_encoding_label l " " T "<b>display encoding</b>"}
 addUserKnob {41 eotf T InverseEOTF.eotf}
 addUserKnob {41 display_gamut l gamut -STARTLINE T XYZ_to_DisplayGamut.gamut}
 addUserKnob {6 clamp t "clamp output to a 0-1 range" -STARTLINE}
 clamp true
 addUserKnob {26 ""}
 addUserKnob {4 direction M {forward inverse}}
}
 Input {
  inputs 0
  name Input
  xpos 180
  ypos -586
 }
set N6483a800 [stack 0]
 Group {
  name EOTF
  xpos 510
  ypos -490
  addUserKnob {20 EOTF_tab l EOTF}
  addUserKnob {4 eotf l EOTF t "Choose the inverse EOTF to apply for the target display device." M {None "sRGB Display" BT.1886 "Gamma 2.6" PQ HLG ""}}
  eotf {{parent.InverseEOTF.eotf}}
 }
  Input {
   inputs 0
   name Input
   xpos 400
   ypos -130
  }
set N6483a400 [stack 0]
  Expression {
   expr0 r<=0.5?r*r/3:(exp((r-_c)/_a)+_b)/12
   expr1 g<=0.5?g*g/3:(exp((g-_c)/_a)+_b)/12
   expr2 b<=0.5?b*b/3:(exp((b-_c)/_a)+_b)/12
   name HLG_InverseOETF
   xpos 620
   ypos -58
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 _a t alpha}
   _a 0.17883277
   addUserKnob {7 _b t beta}
   _b {{1-4*_a}}
   addUserKnob {7 _c}
   _c {{0.5-_a*log(4*_a)}}
  }
  Expression {
   temp_name0 Ys
   temp_expr0 0.2627*r+0.6780*g+0.0593*b
   expr0 pow(Ys,_g-1)*r
   expr1 pow(Ys,_g-1)*g
   expr2 pow(Ys,_g-1)*b
   name HLG_OOTF
   xpos 620
   ypos -34
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 _g t "Gamma: Extended model for gamma variation according to peak display luminance and surround luminance: BT.2390-8 p32" R 0 2}
   _g {{1.2*pow(1.111,log(Lw/1000)/log(2))*pow(0.98,log(max(1e-6,Lamb)/5)/log(2))}}
   addUserKnob {7 Lw R 600 4000}
   Lw 1000
   addUserKnob {7 Lb}
   addUserKnob {7 Lamb t "ambient luminance level in nits" R 0 200}
   Lamb 5
  }
push $N6483a400
  Expression {
   temp_name0 rp
   temp_expr0 pow(r,1/m_2)
   temp_name1 gp
   temp_expr1 pow(g,1/m_2)
   temp_name2 bp
   temp_expr2 pow(b,1/m_2)
   expr0 pow((rp-c_1)/(c_2-c_3*rp),1/m_1)
   expr1 pow((gp-c_1)/(c_2-c_3*gp),1/m_1)
   expr2 pow((bp-c_1)/(c_2-c_3*bp),1/m_1)
   name ST2084_EOTF
   xpos 510
   ypos -58
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{2523/4096*128}}
   addUserKnob {7 c_1}
   c_1 {{107/128}}
   addUserKnob {7 c_2}
   c_2 {{2413/128}}
   addUserKnob {7 c_3}
   c_3 {{2392/128}}
  }
push $N6483a400
  Expression {
   expr0 sign(r)*pow(fabs(r),p)
   expr1 sign(g)*pow(fabs(g),p)
   expr2 sign(b)*pow(fabs(b),p)
   name Power
   xpos 400
   ypos -58
   addUserKnob {20 Params_tab l Params}
   addUserKnob {7 p l power R 0.2 2}
   p {{eotf?2+eotf*0.2:1}}
  }
  Switch {
   inputs 3
   which {{eotf-3}}
   name SwitchInverseEOTF
   xpos 400
   ypos -10
  }
  Output {
   name Output
   xpos 400
   ypos 62
  }
 end_group
 Expression {
  temp_name0 mx
  temp_expr0 dcdm?1:s
  expr0 parent.clamp?max(0,min(mx,r/s)):r/s
  expr1 parent.clamp?max(0,min(mx,g/s)):g/s
  expr2 parent.clamp?max(0,min(mx,b/s)):b/s
  name InvDisplayScale
  xpos 510
  ypos -442
  addUserKnob {20 Params}
  addUserKnob {6 pq +STARTLINE}
  pq {{eotf==4}}
  addUserKnob {6 hlg -STARTLINE}
  hlg {{eotf==5}}
  addUserKnob {6 dcdm -STARTLINE}
  dcdm {{eotf==3&&display_gamut==5}}
  addUserKnob {7 s}
  s {{pq?Lw/10000:hlg?Lw/1000:dcdm?48/52.37:1}}
 }
 ColorMatrix {
  matrix {
      {{parent.XYZ_to_DisplayGamut.ColorMatrix.matrix} {parent.XYZ_to_DisplayGamut.ColorMatrix.matrix} {parent.XYZ_to_DisplayGamut.ColorMatrix.matrix}}
      {{parent.XYZ_to_DisplayGamut.ColorMatrix.matrix} {parent.XYZ_to_DisplayGamut.ColorMatrix.matrix} {parent.XYZ_to_DisplayGamut.ColorMatrix.matrix}}
      {{parent.XYZ_to_DisplayGamut.ColorMatrix.matrix} {parent.XYZ_to_DisplayGamut.ColorMatrix.matrix} {parent.XYZ_to_DisplayGamut.ColorMatrix.matrix}}
    }
  invert true
  name Inv_XYZ_to_DisplayGamut
  xpos 510
  ypos -370
 }
 ColorMatrix {
  matrix {
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
    }
  name Inv_tlms_to_XYZ6
  xpos 510
  ypos -346
 }
 Expression {
  expr0 n*r/w.0
  expr1 n*g/w.1
  expr2 n*b/w.2
  name InvScale
  xpos 510
  ypos -322
  addUserKnob {20 Params}
  addUserKnob {78 w n 3}
  w {{parent.Scale.w} {parent.Scale.w} {parent.Scale.w}}
  addUserKnob {7 n R 0 4}
  n {{parent.Scale.wn}}
 }
set N64bafc00 [stack 0]
 Expression {
  expr0 r*w.0
  expr1 g*w.1
  expr2 b*w.2
  name InvNormalize1
  xpos 620
  ypos -178
  addUserKnob {20 Params}
  addUserKnob {78 w n 3}
  w {{parent.Normalize.w} {parent.Normalize.w} {parent.Normalize.w}}
 }
 ColorMatrix {
  matrix {
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
    }
  invert true
  name Inv_XYZ_to_tlms1
  xpos 620
  ypos -154
 }
 Group {
  name Colorspace_JzAzBz_Forward4
  xpos 620
  ypos -106
  addUserKnob {20 JzAzBz_tab l JzAzBz}
  addUserKnob {41 L_p T eotf_inverse_ST2084_.L_p}
  addUserKnob {6 JCh t "Lightness, Chroma, hue angle" +STARTLINE}
  JCh true
  addUserKnob {35 const_d_presets l "" +STARTLINE M {"const d/JzAzBz" "knobs this \{d -0.56\}" "const d/CAM16-UCS" "knobs this \{d 0\}" "const d/IPT" "knobs this \{d -0.64\}" "const d/ICtCp" "knobs this \{d 1.1\}"}}
  addUserKnob {7 d l "" t "the d constant which can can be adjusted to tune the lightness predictors to different colorspaces:\ndefault: -0.56\nCAM16-UCS: 0\nIPT: -0.64\nICtCp: 1.1" -STARTLINE R -1 1}
  d -0.56
 }
  StickyNote {
   inputs 0
   name StickyNote1
   tile_color 0x40454aff
   label "<left><b>JzAzBz Colorspace</b>\nSafdar, M., Cui, G., Kim, Y. J., & Luo, M. R. (2017).\n    Perceptually uniform color space for image signals including high dynamic\n    range and wide gamut. Optics Express, 25(13), 15131.\n    doi:10.1364/OE.25.015131\nhttps://www.osapublishing.org/oe/fulltext.cfm?uri=oe-25-13-15131&id=368272\nhttps://observablehq.com/@jrus/jzazbz"
   note_font_size 14
   xpos 107
   ypos -332
  }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -394
  }
  Expression {
   expr0 1.15*r-(1.15-1)*b
   expr1 0.66*g-(0.66-1)*r
   expr2 b
   name Expression3
   label "X_p Y_p Z"
   xpos -40
   ypos -333
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name ColorMatrix6
   label XYZ_TO_LMS
   xpos -40
   ypos -295
  }
  Group {
   name eotf_inverse_ST2084_
   xpos -40
   ypos -250
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{1.7*2523/2**5}}
   addUserKnob {7 c_1}
   c_1 {{3424/4096}}
   addUserKnob {7 c_2}
   c_2 {{2413/4096*32}}
   addUserKnob {7 c_3}
   c_3 {{2392/4096*32}}
   addUserKnob {7 L_p R 100 10000}
   L_p 10000
  }
   Input {
    inputs 0
    name Input
    xpos -40
    ypos -290
   }
   Expression {
    expr0 "pow(r/L_p, m_1)"
    expr1 "pow(g/L_p, m_1)"
    expr2 "pow(b/L_p, m_1)"
    name Expression4
    label Y_p
    xpos -40
    ypos -255
   }
   Expression {
    expr0 "pow((c_1+c_2*r)/(c_3*r+1), m_2)"
    expr1 "pow((c_1+c_2*g)/(c_3*g+1), m_2)"
    expr2 "pow((c_1+c_2*b)/(c_3*b+1), m_2)"
    name Expression8
    label N
    xpos -40
    ypos -215
   }
   Output {
    name Output
    xpos -40
    ypos -170
   }
  end_group
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name ColorMatrix2
   label LMS_P_TO_IZAZBZ
   xpos -40
   ypos -224
  }
  Expression {
   temp_name0 d_0
   temp_expr0 1.6295499532821565e-11
   expr0 r*(1+d)/(1+d*r)-d_0
   expr1 g
   expr2 b
   name Expression1
   label Jz
   xpos -40
   ypos -184
  }
  Expression {
   expr0 r
   expr1 sqrt(g*g+b*b)
   expr2 atan2(b,g)
   channel3 none
   name Expression5
   label "JzAzBz to JCh"
   xpos -40
   ypos -136
   disable {{!parent.JCh}}
  }
  Output {
   name Output
   xpos -40
   ypos -58
  }
 end_group
push $N64bafc00
 Expression {
  temp_name0 n
  temp_expr0 sqrt(pow(w.0*r,2)+pow(w.1*g,2)+pow(w.2*b,2))/sum
  temp_name1 nt
  temp_expr1 (n+sqrt(n*(4*fl+n)))/2
  temp_name2 ns
  temp_expr2 (pow(nt/sy,1/p)/(1-pow(nt/sy,1/p)))*sx
  temp_name3 ccf
  temp_expr3 pow(ns==0?0:pow(nt,1/p)/(ns/sx),dch)*sat
  expr0 n==0?0:(n*(ccf-1)+r)/ccf*ns/n
  expr1 n==0?0:(n*(ccf-1)+g)/ccf*ns/n
  expr2 n==0?0:(n*(ccf-1)+b)/ccf*ns/n
  expr3 ccf
  name InvToneScale
  xpos 510
  ypos -250
  addUserKnob {20 Params}
  addUserKnob {7 Lw R 100 4000}
  Lw {{parent.ToneScale.Lw}}
  addUserKnob {7 p R 1 2}
  p {{parent.ToneScale.p}}
  addUserKnob {7 fl l flare R 0 0.01}
  fl {{1/Lw}}
  addUserKnob {7 sx R 0 10}
  sx {{0.016*pow(Lw,0.87)-0.17}}
  addUserKnob {7 sy R 0 4}
  sy {{1.036+5e-5*Lw}}
  addUserKnob {7 dch l dechroma}
  dch {{parent.ToneScale.dch}}
  addUserKnob {7 sat l saturation R 0.9 1.6}
  sat {{parent.ToneScale.sat}}
  addUserKnob {78 w n 3}
  w {0.24 0.1 0.09}
  addUserKnob {7 sum t "Normalize so achromatic in=out" R 0 2}
  sum {{sqrt(w.0*w.0+w.1*w.1+w.2*w.2)}}
 }
 Expression {
  expr0 r*w.0
  expr1 g*w.1
  expr2 b*w.2
  name InvNormalize
  xpos 510
  ypos -178
  addUserKnob {20 Params}
  addUserKnob {78 w n 3}
  w {{parent.Normalize.w} {parent.Normalize.w} {parent.Normalize.w}}
 }
 ColorMatrix {
  matrix {
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
    }
  invert true
  name Inv_XYZ_to_tlms
  xpos 510
  ypos -154
 }
 Group {
  name Colorspace_JzAzBz_Forward3
  xpos 510
  ypos -106
  addUserKnob {20 JzAzBz_tab l JzAzBz}
  addUserKnob {41 L_p T eotf_inverse_ST2084_.L_p}
  addUserKnob {6 JCh t "Lightness, Chroma, hue angle" +STARTLINE}
  JCh true
  addUserKnob {35 const_d_presets l "" +STARTLINE M {"const d/JzAzBz" "knobs this \{d -0.56\}" "const d/CAM16-UCS" "knobs this \{d 0\}" "const d/IPT" "knobs this \{d -0.64\}" "const d/ICtCp" "knobs this \{d 1.1\}"}}
  addUserKnob {7 d l "" t "the d constant which can can be adjusted to tune the lightness predictors to different colorspaces:\ndefault: -0.56\nCAM16-UCS: 0\nIPT: -0.64\nICtCp: 1.1" -STARTLINE R -1 1}
  d {{parent.Colorspace_JzAzBz_Forward4.d}}
 }
  StickyNote {
   inputs 0
   name StickyNote1
   tile_color 0x40454aff
   label "<left><b>JzAzBz Colorspace</b>\nSafdar, M., Cui, G., Kim, Y. J., & Luo, M. R. (2017).\n    Perceptually uniform color space for image signals including high dynamic\n    range and wide gamut. Optics Express, 25(13), 15131.\n    doi:10.1364/OE.25.015131\nhttps://www.osapublishing.org/oe/fulltext.cfm?uri=oe-25-13-15131&id=368272\nhttps://observablehq.com/@jrus/jzazbz"
   note_font_size 14
   xpos 107
   ypos -332
  }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -394
  }
  Expression {
   expr0 1.15*r-(1.15-1)*b
   expr1 0.66*g-(0.66-1)*r
   expr2 b
   name Expression3
   label "X_p Y_p Z"
   xpos -40
   ypos -333
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name ColorMatrix6
   label XYZ_TO_LMS
   xpos -40
   ypos -295
  }
  Group {
   name eotf_inverse_ST2084_
   xpos -40
   ypos -250
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{1.7*2523/2**5}}
   addUserKnob {7 c_1}
   c_1 {{3424/4096}}
   addUserKnob {7 c_2}
   c_2 {{2413/4096*32}}
   addUserKnob {7 c_3}
   c_3 {{2392/4096*32}}
   addUserKnob {7 L_p R 100 10000}
   L_p {{parent.parent.Colorspace_JzAzBz_Forward4.eotf_inverse_ST2084_.L_p}}
  }
   Input {
    inputs 0
    name Input
    xpos -40
    ypos -290
   }
   Expression {
    expr0 "pow(r/L_p, m_1)"
    expr1 "pow(g/L_p, m_1)"
    expr2 "pow(b/L_p, m_1)"
    name Expression4
    label Y_p
    xpos -40
    ypos -255
   }
   Expression {
    expr0 "pow((c_1+c_2*r)/(c_3*r+1), m_2)"
    expr1 "pow((c_1+c_2*g)/(c_3*g+1), m_2)"
    expr2 "pow((c_1+c_2*b)/(c_3*b+1), m_2)"
    name Expression8
    label N
    xpos -40
    ypos -215
   }
   Output {
    name Output
    xpos -40
    ypos -170
   }
  end_group
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name ColorMatrix2
   label LMS_P_TO_IZAZBZ
   xpos -40
   ypos -224
  }
  Expression {
   temp_name0 d_0
   temp_expr0 1.6295499532821565e-11
   expr0 r*(1+d)/(1+d*r)-d_0
   expr1 g
   expr2 b
   name Expression1
   label Jz
   xpos -40
   ypos -184
  }
  Expression {
   expr0 r
   expr1 sqrt(g*g+b*b)
   expr2 atan2(b,g)
   channel3 none
   name Expression5
   label "JzAzBz to JCh"
   xpos -40
   ypos -136
   disable {{!parent.JCh}}
  }
  Output {
   name Output
   xpos -40
   ypos -58
  }
 end_group
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy1
  xpos 510
  ypos -64
  disable {{!pdch}}
 }
 Group {
  name Colorspace_JzAzBz_Inverse2
  xpos 510
  ypos -10
  addUserKnob {20 JzAzBz_tab l JzAzBz}
  addUserKnob {41 L_p T eotf_ST2084_.L_p}
  addUserKnob {6 JCh t "Lightness, Chroma, hue angle" +STARTLINE}
  JCh true
  addUserKnob {35 const_d_presets l "" +STARTLINE M {"const d/JzAzBz" "knobs this \{d -0.56\}" "const d/CAM16-UCS" "knobs this \{d 0\}" "const d/IPT" "knobs this \{d -0.64\}" "const d/ICtCp" "knobs this \{d 1.1\}"}}
  addUserKnob {7 d l "" t "the d constant which can can be adjusted to tune the lightness predictors to different colorspaces:\ndefault: -0.56\nCAM16-UCS: 0\nIPT: -0.64\nICtCp: 1.1" -STARTLINE R -1 1}
  d {{parent.Colorspace_JzAzBz_Forward4.d}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -490
  }
  Expression {
   expr0 r
   expr1 g*cos(b)
   expr2 g*sin(b)
   channel3 none
   name Expression6
   label "JCh to JzAzBz"
   xpos -40
   ypos -376
   disable {{!parent.JCh}}
  }
  Expression {
   temp_name0 d_0
   temp_expr0 1.6295499532821565e-11
   expr0 (r+d_0)/(1+d-d*(r+d_0))
   expr1 g
   expr2 b
   name Expression4
   label Iz
   xpos -40
   ypos -328
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name ColorMatrix4
   label IZAZBZ_TO_LMS_P
   xpos -40
   ypos -280
  }
  Group {
   name eotf_ST2084_
   xpos -40
   ypos -226
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{1.7*2523/2**5}}
   addUserKnob {7 c_1}
   c_1 {{3424/4096}}
   addUserKnob {7 c_2}
   c_2 {{2413/4096*32}}
   addUserKnob {7 c_3}
   c_3 {{2392/4096*32}}
   addUserKnob {7 L_p R 0 10000}
   L_p {{parent.parent.Colorspace_JzAzBz_Forward4.eotf_inverse_ST2084_.L_p}}
  }
   Input {
    inputs 0
    name Input
    xpos -40
    ypos -290
   }
   Expression {
    expr0 "pow(r, 1/m_2)"
    expr1 "pow(g, 1/m_2)"
    expr2 "pow(b, 1/m_2)"
    name Expression1
    label V_p
    xpos -40
    ypos -256
   }
   Expression {
    expr0 pow(((r-c_1)/(c_2-c_3*r)),1/m_1)*L_p
    expr1 pow(((g-c_1)/(c_2-c_3*g)),1/m_1)*L_p
    expr2 pow(((b-c_1)/(c_2-c_3*b)),1/m_1)*L_p
    name Expression2
    label C
    xpos -40
    ypos -218
   }
   Output {
    name Output
    xpos -40
    ypos -169
   }
  end_group
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name ColorMatrix5
   label LMS_TO_XYZ
   xpos -40
   ypos -184
  }
  Expression {
   expr0 (r+(1.15-1)*b)/1.15
   expr1 (g+(0.66-1)*((r+(1.15-1)*b)/1.15))/0.66
   expr2 b
   name Expression2
   label "X_p Y_p Z"
   xpos -40
   ypos -136
  }
  Output {
   name Output
   xpos -40
   ypos 42
  }
 end_group
 ColorMatrix {
  matrix {
      {{parent.InGamut_to_XYZ.ColorMatrix.matrix} {parent.InGamut_to_XYZ.ColorMatrix.matrix} {parent.InGamut_to_XYZ.ColorMatrix.matrix}}
      {{parent.InGamut_to_XYZ.ColorMatrix.matrix} {parent.InGamut_to_XYZ.ColorMatrix.matrix} {parent.InGamut_to_XYZ.ColorMatrix.matrix}}
      {{parent.InGamut_to_XYZ.ColorMatrix.matrix} {parent.InGamut_to_XYZ.ColorMatrix.matrix} {parent.InGamut_to_XYZ.ColorMatrix.matrix}}
    }
  invert true
  name Inv_InGamut_to_XYZ1
  xpos 510
  ypos 38
 }
push $N6483a800
 Group {
  name InGamut_to_XYZ
  tile_color 0x429940ff
  xpos 180
  ypos -514
  addUserKnob {20 InputGamut_to_XYZ_tab l InputGamut_to_XYZ}
  addUserKnob {4 gamut l "in gamut" M {ACES ACEScg P3D65 Rec.2020 Rec.709 "Alexa WideGamut" "Red WideGamutRGB" "Sony SGamut3" "Filmlight E-Gamut" "DaVinci Wide Gamut" "" "" ""}}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {41 invert -STARTLINE T ColorMatrix.invert}
 }
  Input {
   inputs 0
   name Input
   xpos 290
   ypos -610
  }
  Dot {
   name Dot1
   xpos 324
   ypos -546
  }
set N64ec4400 [stack 0]
  ColorMatrix {
   matrix {
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
     }
   name ColorMatrix
   xpos 290
   ypos -370
  }
  Output {
   name Output
   xpos 290
   ypos -250
  }
push $N64ec4400
  Dot {
   name Dot391
   label " *RGB to XYZ D65 CAT: XYZ Scaling"
   xpos 434
   ypos -546
  }
set N64e4b400 [stack 0]
  ColorMatrix {
   matrix {
       {0.7006223202 0.1487748027 0.101058729}
       {0.2741184831 0.8736317754 -0.1477504224}
       {-0.09896290302 -0.1378953159 1.325916052}
     }
   name ColorMatrix30
   label "DaVinci WG to XYZ D65"
   xpos 1390
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.705396831 0.1640413404 0.08101775497}
       {0.2801307142 0.8202067018 -0.1003373787}
       {-0.1037815139 -0.07290726155 1.265746593}
     }
   name ColorMatrix29
   label "Filmlight E-Gamut to XYZ D65"
   xpos 1280
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.5990839005 0.2489254922 0.1024464965}
       {0.2150758207 0.8850684166 -0.1001443192}
       {-0.03206584975 -0.02765838802 1.148782015}
     }
   name ColorMatrix31
   label "SonySGamut3 to XYZ D65"
   xpos 1170
   ypos -465
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.735275209 0.06860940903 0.1465712786}
       {0.2866940796 0.8429790735 -0.1296732426}
       {-0.07968084514 -0.3473432064 1.516081929}
     }
   name ColorMatrix22
   label "REDWideGamutRGB to XYZ D65"
   xpos 1060
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.6380076408 0.2147038132 0.09774445742}
       {0.2919537723 0.8238408566 -0.1157948226}
       {0.002798279049 -0.06703422219 1.153293848}
     }
   name ColorMatrix21
   label "Arri AlexaWideGamut to XYZ D65"
   xpos 950
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.4123909175 0.3575843573 0.1804807931}
       {0.2126390785 0.7151687145 0.07219231129}
       {0.01933082566 0.1191947833 0.9505321383}
     }
   name ColorMatrix18
   label "Rec709 to XYZ D65"
   xpos 840
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.6369581223 0.1446169168 0.1688809693}
       {0.2627002299 0.6779981256 0.05930171534}
       {4.99410725e-17 0.02807269618 1.060985088}
     }
   name ColorMatrix17
   label "Rec2020 to XYZ D65"
   xpos 730
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.4865711331 0.2656677067 0.1982173175}
       {0.2289746404 0.6917386055 0.07928691804}
       {-3.972076965e-17 0.04511338845 1.043944478}
     }
   name ColorMatrix16
   label "P3D65 to XYZ D65"
   xpos 620
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.6609312296 0.1336961389 0.1558285803}
       {0.2722287476 0.6740817428 0.05368950963}
       {-0.006018006243 0.004383686464 1.090692043}
     }
   name ColorMatrix1
   label "ACEScg to XYZ D65"
   xpos 510
   ypos -466
  }
push $N64e4b400
  ColorMatrix {
   matrix {
       {0.9503623843 0 9.346324805e-05}
       {0.3439664543 0.728166163 -0.07213254273}
       {0 0 1.089057803}
     }
   name ColorMatrix2
   label "ACES to XYZ D65"
   xpos 400
   ypos -466
  }
  Switch {
   inputs 10
   which {{gamut}}
   name SwitchGamut
   xpos 400
   ypos -370
  }
 end_group
 ColorMatrix {
  matrix {
      {0.257085 0.859943 -0.031061}
      {-0.394427 1.1758 0.106423}
      {0.064856 -0.07625 0.559067}
    }
  name XYZ_to_tlms
  xpos 180
  ypos -490
 }
 Expression {
  expr0 r/w.0
  expr1 g/w.1
  expr2 b/w.2
  name Normalize
  xpos 180
  ypos -466
  addUserKnob {20 Params}
  addUserKnob {35 presets l "" +STARTLINE M {presets/D50 "knobs this \{w \{1.08221 0.883260 0.447579\}\}" presets/D55 "knobs this \{w \{1.07730 0.896467 0.500927\}\}" presets/D60 "knobs this \{w \{1.07344 0.907523 0.549381\}\}" presets/D65 "knobs this \{w \{1.07046 0.916817 0.594251\}\}" presets/D75 "knobs this \{w \{1.06600 0.931715 0.670839\}\}" presets/D93 "knobs this \{w \{1.06098 0.950462 0.776150\}\}"}}
  addUserKnob {78 w n 3}
  w {1.07046 0.916817 0.594251}
 }
set N64e48400 [stack 0]
 Expression {
  expr0 r*w.0/n
  expr1 g*w.1/n
  expr2 b*w.2/n
  name Scale1
  xpos 70
  ypos -226
  addUserKnob {20 Params}
  addUserKnob {78 w n 3}
  w {{parent.Scale.w} {parent.Scale.w} {parent.Scale.w}}
  addUserKnob {7 n R 0 2}
  n {{parent.Scale.wn}}
 }
 ColorMatrix {
  matrix {
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
    }
  invert true
  name tlms_to_XYZ1
  xpos 70
  ypos -202
 }
 Group {
  name Colorspace_JzAzBz_Forward1
  xpos 70
  ypos -154
  addUserKnob {20 JzAzBz_tab l JzAzBz}
  addUserKnob {41 L_p T eotf_inverse_ST2084_.L_p}
  addUserKnob {6 JCh t "Lightness, Chroma, hue angle" +STARTLINE}
  JCh true
  addUserKnob {35 const_d_presets l "" +STARTLINE M {"const d/JzAzBz" "knobs this \{d -0.56\}" "const d/CAM16-UCS" "knobs this \{d 0\}" "const d/IPT" "knobs this \{d -0.64\}" "const d/ICtCp" "knobs this \{d 1.1\}"}}
  addUserKnob {7 d l "" t "the d constant which can can be adjusted to tune the lightness predictors to different colorspaces:\ndefault: -0.56\nCAM16-UCS: 0\nIPT: -0.64\nICtCp: 1.1" -STARTLINE R -1 1}
  d {{parent.Colorspace_JzAzBz_Forward2.d}}
 }
  StickyNote {
   inputs 0
   name StickyNote1
   tile_color 0x40454aff
   label "<left><b>JzAzBz Colorspace</b>\nSafdar, M., Cui, G., Kim, Y. J., & Luo, M. R. (2017).\n    Perceptually uniform color space for image signals including high dynamic\n    range and wide gamut. Optics Express, 25(13), 15131.\n    doi:10.1364/OE.25.015131\nhttps://www.osapublishing.org/oe/fulltext.cfm?uri=oe-25-13-15131&id=368272\nhttps://observablehq.com/@jrus/jzazbz"
   note_font_size 14
   xpos 107
   ypos -332
  }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -394
  }
  Expression {
   expr0 1.15*r-(1.15-1)*b
   expr1 0.66*g-(0.66-1)*r
   expr2 b
   name Expression3
   label "X_p Y_p Z"
   xpos -40
   ypos -333
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name ColorMatrix6
   label XYZ_TO_LMS
   xpos -40
   ypos -295
  }
  Group {
   name eotf_inverse_ST2084_
   xpos -40
   ypos -250
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{1.7*2523/2**5}}
   addUserKnob {7 c_1}
   c_1 {{3424/4096}}
   addUserKnob {7 c_2}
   c_2 {{2413/4096*32}}
   addUserKnob {7 c_3}
   c_3 {{2392/4096*32}}
   addUserKnob {7 L_p R 100 10000}
   L_p {{parent.parent.Colorspace_JzAzBz_Forward2.eotf_inverse_ST2084_.L_p}}
  }
   Input {
    inputs 0
    name Input
    xpos -40
    ypos -290
   }
   Expression {
    expr0 "pow(r/L_p, m_1)"
    expr1 "pow(g/L_p, m_1)"
    expr2 "pow(b/L_p, m_1)"
    name Expression4
    label Y_p
    xpos -40
    ypos -255
   }
   Expression {
    expr0 "pow((c_1+c_2*r)/(c_3*r+1), m_2)"
    expr1 "pow((c_1+c_2*g)/(c_3*g+1), m_2)"
    expr2 "pow((c_1+c_2*b)/(c_3*b+1), m_2)"
    name Expression8
    label N
    xpos -40
    ypos -215
   }
   Output {
    name Output
    xpos -40
    ypos -170
   }
  end_group
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name ColorMatrix2
   label LMS_P_TO_IZAZBZ
   xpos -40
   ypos -224
  }
  Expression {
   temp_name0 d_0
   temp_expr0 1.6295499532821565e-11
   expr0 r*(1+d)/(1+d*r)-d_0
   expr1 g
   expr2 b
   name Expression1
   label Jz
   xpos -40
   ypos -184
  }
  Expression {
   expr0 r
   expr1 sqrt(g*g+b*b)
   expr2 atan2(b,g)
   channel3 none
   name Expression5
   label "JzAzBz to JCh"
   xpos -40
   ypos -136
   disable {{!parent.JCh}}
  }
  Output {
   name Output
   xpos -40
   ypos -58
  }
 end_group
push $N64e48400
 Expression {
  temp_name0 n
  temp_expr0 max(1e-12,sqrt(pow(w.0*r,2)+pow(w.1*g,2)+pow(w.2*b,2))/sum)
  temp_name1 ns
  temp_expr1 sy*pow(n/(n+sx),p)
  temp_name2 nt
  temp_expr2 ns*ns/(ns+fl)
  temp_name3 ccf
  temp_expr3 pow(sx/(n+sx),dch)*sat
  expr0 nt*(1-ccf)+r*(nt/n)*ccf
  expr1 nt*(1-ccf)+g*(nt/n)*ccf
  expr2 nt*(1-ccf)+b*(nt/n)*ccf
  expr3 ccf
  name ToneScale
  xpos 180
  ypos -394
  addUserKnob {20 Params}
  addUserKnob {7 Lw R 100 4000}
  Lw 100
  addUserKnob {7 c l contrast R 0.8 2}
  c {{12*pow(Lw,-0.86)+1.17}}
  addUserKnob {4 su l surround t "dark = 1.0\ndim = 0.95\naverage = 0.90" M {average dim dark}}
  su dim
  addUserKnob {7 p R 1 2}
  p {{c*(0.9+0.05*su)}}
  addUserKnob {7 fl l flare R 0 0.01}
  fl {{1/Lw}}
  addUserKnob {7 sx R 0 10}
  sx {{0.016*pow(Lw,0.87)-0.17}}
  addUserKnob {7 sy R 0 4}
  sy {{1.036+5e-5*Lw}}
  addUserKnob {7 dch l dechroma}
  dch 0.5
  addUserKnob {7 sat l saturation R 0.9 1.6}
  sat 1.2
  addUserKnob {78 w n 3}
  w {0.24 0.1 0.09}
  addUserKnob {7 sum t "Normalize so achromatic in=out" R 0 2}
  sum {{sqrt(w.0*w.0+w.1*w.1+w.2*w.2)}}
 }
set N64dd8400 [stack 0]
 Group {
  name LMS_to_Yrg
  xpos 290
  ypos -346
 }
  Input {
   inputs 0
   name Input
   xpos 400
   ypos -346
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin
   xpos 400
   ypos -320
  }
  Expression {
   temp_name0 _a
   temp_expr0 r+g+b
   temp_name1 l
   temp_expr1 _a==0?0:r/_a
   temp_name2 m
   temp_expr2 _a==0?0:g/_a
   expr0 0.68990272*r+0.34832189*g
   expr1 1.0671*l-0.6873*m+0.02062-0.14722
   expr2 -0.0362*l+1.7182*m-0.05155-0.50911666
   name LMS_to_Yrg
   xpos 400
   ypos -298
  }
  Expression {
   expr0 r
   expr1 hypot(g,b)
   expr2 atan2(b,g)
   name cartesian_to_polar1
   xpos 400
   ypos -274
  }
  Output {
   name Output
   xpos 400
   ypos -226
  }
 end_group
 Expression {
  expr1 g<t0?g:s*sqrt(g-ox)+oy
  maskChannelMask rgba.red
  name compress_parabolic
  xpos 290
  ypos -322
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 t0 t "threshold to start compression\n" R 0 2}
  t0 0.3
  addUserKnob {7 x0 t "x coordinate to compress to" R 0 2}
  x0 0.5
  addUserKnob {7 y0 t "y coordinate to compress to" R 0 2}
  y0 0.45
  addUserKnob {7 s}
  s {{(y0-t0)/sqrt(x0-y0)}}
  addUserKnob {7 ox R -2 2}
  ox {{t0-s*s/4}}
  addUserKnob {7 oy R -2 2}
  oy {{t0-s*sqrt(s*s/4)}}
 }
 Group {
  name Yrg_to_LMS
  xpos 290
  ypos -298
 }
  Input {
   inputs 0
   name Input
   xpos 510
   ypos -106
  }
  Expression {
   expr0 r
   expr1 g*cos(b)
   expr2 g*sin(b)
   name polar_to_cartesian
   xpos 510
   ypos -58
  }
  Expression {
   expr0 r
   expr1 g+0.14722
   expr2 b+0.50911666
   name offset_white1
   xpos 510
   ypos -34
  }
  Expression {
   temp_name0 l
   temp_expr0 0.95*g+0.38*b
   temp_name1 m
   temp_expr1 0.02*g+0.59*b+0.03
   temp_name2 _a
   temp_expr2 r/(0.68990272*l+0.34832189*m)
   expr0 l*_a
   expr1 m*_a
   expr2 (1-l-m)*_a
   name Yrg_to_LMS
   xpos 510
   ypos -10
  }
  Output {
   name Output
   xpos 510
   ypos 38
  }
 end_group
push $N64dd8400
 Switch {
  inputs 2
  which {{gcmp}}
  name Switch_gcmp
  xpos 180
  ypos -298
 }
 Expression {
  expr0 r*w.0/wn
  expr1 g*w.1/wn
  expr2 b*w.2/wn
  name Scale
  xpos 180
  ypos -226
  addUserKnob {20 Params}
  addUserKnob {4 wp M {D50 D55 D60 D65 D75 D93}}
  wp D65
  addUserKnob {78 w n 3}
  w {{curve(wp) 1.08221 1.0773 1.07344 1.07046 1.066 1.06098} {curve(wp) 0.88326 0.896467 0.907523 0.916817 0.931715 0.950462} {curve(wp) 0.447579 0.500927 0.549381 0.594251 0.670839 0.77615}}
  addUserKnob {7 wn R 0 2}
  wn {{curve(wp+6*display_gamut) 1.09063 1.05337 1.02355 1 1.12915 1.30631 1.1408 1.08334 1.037 1 1.13116 1.31116 1.09928 1.04391 1.00028 1.08307 1.22512 1.42007 1.2469 1.18409 1.13345 1.15054 1.30144 1.50853 1.17646 1.10416 1.0461 1 1.14486 1.34374 1 1 1 1 1 1}}
 }
 ColorMatrix {
  matrix {
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
      {{parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix} {parent.XYZ_to_tlms.matrix}}
    }
  invert true
  name tlms_to_XYZ
  xpos 180
  ypos -202
 }
 Group {
  name Colorspace_JzAzBz_Forward2
  xpos 180
  ypos -154
  addUserKnob {20 JzAzBz_tab l JzAzBz}
  addUserKnob {41 L_p T eotf_inverse_ST2084_.L_p}
  addUserKnob {6 JCh t "Lightness, Chroma, hue angle" +STARTLINE}
  JCh true
  addUserKnob {35 const_d_presets l "" +STARTLINE M {"const d/JzAzBz" "knobs this \{d -0.56\}" "const d/CAM16-UCS" "knobs this \{d 0\}" "const d/IPT" "knobs this \{d -0.64\}" "const d/ICtCp" "knobs this \{d 1.1\}"}}
  addUserKnob {7 d l "" t "the d constant which can can be adjusted to tune the lightness predictors to different colorspaces:\ndefault: -0.56\nCAM16-UCS: 0\nIPT: -0.64\nICtCp: 1.1" -STARTLINE R -1 1}
  d -0.56
 }
  StickyNote {
   inputs 0
   name StickyNote1
   tile_color 0x40454aff
   label "<left><b>JzAzBz Colorspace</b>\nSafdar, M., Cui, G., Kim, Y. J., & Luo, M. R. (2017).\n    Perceptually uniform color space for image signals including high dynamic\n    range and wide gamut. Optics Express, 25(13), 15131.\n    doi:10.1364/OE.25.015131\nhttps://www.osapublishing.org/oe/fulltext.cfm?uri=oe-25-13-15131&id=368272\nhttps://observablehq.com/@jrus/jzazbz"
   note_font_size 14
   xpos 107
   ypos -332
  }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -394
  }
  Expression {
   expr0 1.15*r-(1.15-1)*b
   expr1 0.66*g-(0.66-1)*r
   expr2 b
   name Expression3
   label "X_p Y_p Z"
   xpos -40
   ypos -333
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name ColorMatrix6
   label XYZ_TO_LMS
   xpos -40
   ypos -295
  }
  Group {
   name eotf_inverse_ST2084_
   xpos -40
   ypos -250
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{1.7*2523/2**5}}
   addUserKnob {7 c_1}
   c_1 {{3424/4096}}
   addUserKnob {7 c_2}
   c_2 {{2413/4096*32}}
   addUserKnob {7 c_3}
   c_3 {{2392/4096*32}}
   addUserKnob {7 L_p R 100 10000}
   L_p 10000
  }
   Input {
    inputs 0
    name Input
    xpos -40
    ypos -290
   }
   Expression {
    expr0 "pow(r/L_p, m_1)"
    expr1 "pow(g/L_p, m_1)"
    expr2 "pow(b/L_p, m_1)"
    name Expression4
    label Y_p
    xpos -40
    ypos -255
   }
   Expression {
    expr0 "pow((c_1+c_2*r)/(c_3*r+1), m_2)"
    expr1 "pow((c_1+c_2*g)/(c_3*g+1), m_2)"
    expr2 "pow((c_1+c_2*b)/(c_3*b+1), m_2)"
    name Expression8
    label N
    xpos -40
    ypos -215
   }
   Output {
    name Output
    xpos -40
    ypos -170
   }
  end_group
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name ColorMatrix2
   label LMS_P_TO_IZAZBZ
   xpos -40
   ypos -224
  }
  Expression {
   temp_name0 d_0
   temp_expr0 1.6295499532821565e-11
   expr0 r*(1+d)/(1+d*r)-d_0
   expr1 g
   expr2 b
   name Expression1
   label Jz
   xpos -40
   ypos -184
  }
  Expression {
   expr0 r
   expr1 sqrt(g*g+b*b)
   expr2 atan2(b,g)
   channel3 none
   name Expression5
   label "JzAzBz to JCh"
   xpos -40
   ypos -136
   disable {{!parent.JCh}}
  }
  Output {
   name Output
   xpos -40
   ypos -58
  }
 end_group
 Expression {
  expr1 g<t0?g:s*sqrt(g-ox)+oy
  maskChannelMask rgba.red
  name compress_parabolic2
  xpos 180
  ypos -106
  disable {{!gcmp}}
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 t0 t "threshold to start compression\n" R 0 0.1}
  t0 0.016
  addUserKnob {7 x0 t "x coordinate to compress to" R 0 0.2}
  x0 0.05
  addUserKnob {7 y0 t "y coordinate to compress to" R 0 0.1}
  y0 0.02
  addUserKnob {7 s}
  s {{(y0-t0)/sqrt(x0-y0)}}
  addUserKnob {7 ox R -2 2}
  ox {{t0-s*s/4}}
  addUserKnob {7 oy R -2 2}
  oy {{t0-s*sqrt(s*s/4)}}
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy2
  xpos 180
  ypos -64
  disable {{!pdch}}
 }
 Group {
  name Colorspace_JzAzBz_Inverse1
  xpos 180
  ypos -10
  addUserKnob {20 JzAzBz_tab l JzAzBz}
  addUserKnob {41 L_p T eotf_ST2084_.L_p}
  addUserKnob {6 JCh t "Lightness, Chroma, hue angle" +STARTLINE}
  JCh true
  addUserKnob {35 const_d_presets l "" +STARTLINE M {"const d/JzAzBz" "knobs this \{d -0.56\}" "const d/CAM16-UCS" "knobs this \{d 0\}" "const d/IPT" "knobs this \{d -0.64\}" "const d/ICtCp" "knobs this \{d 1.1\}"}}
  addUserKnob {7 d l "" t "the d constant which can can be adjusted to tune the lightness predictors to different colorspaces:\ndefault: -0.56\nCAM16-UCS: 0\nIPT: -0.64\nICtCp: 1.1" -STARTLINE R -1 1}
  d {{parent.Colorspace_JzAzBz_Forward2.d}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -490
  }
  Expression {
   expr0 r
   expr1 g*cos(b)
   expr2 g*sin(b)
   channel3 none
   name Expression6
   label "JCh to JzAzBz"
   xpos -40
   ypos -376
   disable {{!parent.JCh}}
  }
  Expression {
   temp_name0 d_0
   temp_expr0 1.6295499532821565e-11
   expr0 (r+d_0)/(1+d-d*(r+d_0))
   expr1 g
   expr2 b
   name Expression4
   label Iz
   xpos -40
   ypos -328
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name ColorMatrix4
   label IZAZBZ_TO_LMS_P
   xpos -40
   ypos -280
  }
  Group {
   name eotf_ST2084_
   xpos -40
   ypos -226
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{1.7*2523/2**5}}
   addUserKnob {7 c_1}
   c_1 {{3424/4096}}
   addUserKnob {7 c_2}
   c_2 {{2413/4096*32}}
   addUserKnob {7 c_3}
   c_3 {{2392/4096*32}}
   addUserKnob {7 L_p R 0 10000}
   L_p {{parent.parent.Colorspace_JzAzBz_Forward2.eotf_inverse_ST2084_.L_p}}
  }
   Input {
    inputs 0
    name Input
    xpos -40
    ypos -290
   }
   Expression {
    expr0 "pow(r, 1/m_2)"
    expr1 "pow(g, 1/m_2)"
    expr2 "pow(b, 1/m_2)"
    name Expression1
    label V_p
    xpos -40
    ypos -256
   }
   Expression {
    expr0 pow(((r-c_1)/(c_2-c_3*r)),1/m_1)*L_p
    expr1 pow(((g-c_1)/(c_2-c_3*g)),1/m_1)*L_p
    expr2 pow(((b-c_1)/(c_2-c_3*b)),1/m_1)*L_p
    name Expression2
    label C
    xpos -40
    ypos -218
   }
   Output {
    name Output
    xpos -40
    ypos -169
   }
  end_group
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name ColorMatrix5
   label LMS_TO_XYZ
   xpos -40
   ypos -184
  }
  Expression {
   expr0 (r+(1.15-1)*b)/1.15
   expr1 (g+(0.66-1)*((r+(1.15-1)*b)/1.15))/0.66
   expr2 b
   name Expression2
   label "X_p Y_p Z"
   xpos -40
   ypos -136
  }
  Output {
   name Output
   xpos -40
   ypos 42
  }
 end_group
 Group {
  name XYZ_to_DisplayGamut
  tile_color 0x425440ff
  xpos 180
  ypos 38
  addUserKnob {20 XYZ_to_DisplayGamut_tab l XYZ_to_DisplayGamut}
  addUserKnob {4 gamut l "display gamut" t "Choose the target display device chromaticities." M {Rec.2020 "P3 D65" "P3 D60" "P3 DCI" Rec.709 "DCDM X'Y'Z'"}}
  gamut Rec.709
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {41 invert -STARTLINE T ColorMatrix.invert}
 }
  Input {
   inputs 0
   name Input
   xpos 290
   ypos -580
  }
  Dot {
   name Dot391
   label " "
   xpos 324
   ypos -516
  }
set N64c7d800 [stack 0]
  ColorMatrix {
   matrix {
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
       {{"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"} {"SwitchGamut.input\[value SwitchGamut.which].matrix"}}
     }
   name ColorMatrix
   xpos 290
   ypos -399
  }
  Output {
   name Output
   xpos 290
   ypos -310
  }
push $N64c7d800
  Dot {
   name Dot1
   label " XYZ D65 to *RGB CAT: XYZ Scaling"
   xpos 434
   ypos -516
  }
set N64c7cc00 [stack 0]
  ColorMatrix {
   matrix {
       {1 0 0}
       {0 1 0}
       {0 0 1}
     }
   name ColorMatrix4
   label "XYZ D65 to XYZ E"
   xpos 950
   ypos -465
  }
push $N64c7cc00
  ColorMatrix {
   matrix {
       {3.240968943 -1.537382722 -0.4986106157}
       {-0.9692435861 1.875967264 0.04155508429}
       {0.05563007668 -0.2039769441 1.056971431}
     }
   name ColorMatrix2
   label "XYZ D65 to Rec709"
   xpos 840
   ypos -465
  }
push $N64c7cc00
  ColorMatrix {
   matrix {
       {2.72539258 -1.01800251 -0.4401629865}
       {-0.795167923 1.689731836 0.02264717408}
       {0.04124189168 -0.08763902634 1.100929379}
     }
   name ColorMatrix12
   label "XYZ D65 to P3DCI"
   xpos 730
   ypos -465
  }
push $N64c7cc00
  ColorMatrix {
   matrix {
       {2.40274024 -0.8974836469 -0.3880532086}
       {-0.8325793743 1.769231319 0.02371269651}
       {0.03882337734 -0.0824996829 1.036368608}
     }
   name ColorMatrix11
   label "XYZ D65 to P3D60"
   xpos 620
   ypos -465
  }
push $N64c7cc00
  ColorMatrix {
   matrix {
       {2.493495464 -0.9313831329 -0.4027105868}
       {-0.8294886947 1.762663484 0.02362468652}
       {0.03584581986 -0.07617236674 0.9568843246}
     }
   name ColorMatrix10
   label "XYZ D65 to P3D65"
   xpos 510
   ypos -465
  }
push $N64c7cc00
  ColorMatrix {
   matrix {
       {1.716650844 -0.3556707203 -0.2533662021}
       {-0.6666842103 1.616480947 0.01576854289}
       {0.01763985492 -0.04277061298 0.9421030283}
     }
   name ColorMatrix5
   label "XYZ D65 to Rec2020"
   xpos 400
   ypos -465
  }
  Switch {
   inputs 6
   which {{gamut}}
   name SwitchGamut
   xpos 400
   ypos -399
  }
 end_group
 Expression {
  temp_name0 mx
  temp_expr0 dcdm?1:s
  expr0 parent.clamp?max(0,min(mx,r*s)):r*s
  expr1 parent.clamp?max(0,min(mx,g*s)):g*s
  expr2 parent.clamp?max(0,min(mx,b*s)):b*s
  name DisplayScale1
  xpos 180
  ypos 86
  addUserKnob {20 Params}
  addUserKnob {6 pq +STARTLINE}
  pq {{eotf==4}}
  addUserKnob {6 hlg -STARTLINE}
  hlg {{eotf==5}}
  addUserKnob {6 dcdm -STARTLINE}
  dcdm {{eotf==3&&display_gamut==5}}
  addUserKnob {7 s}
  s {{pq?Lw/10000:hlg?Lw/1000:dcdm?48/52.37:1}}
 }
 Group {
  name InverseEOTF
  xpos 180
  ypos 110
  addUserKnob {20 EOTF_tab l EOTF}
  addUserKnob {4 eotf t "Choose the inverse EOTF to apply for the target display device." M {None "sRGB Display" BT.1886 "Gamma 2.6" PQ HLG "" "" ""}}
 }
  Input {
   inputs 0
   name Input
   xpos 400
   ypos -130
  }
set N64c26800 [stack 0]
  Expression {
   temp_name0 Yd
   temp_expr0 0.2627*r+0.6780*g+0.0593*b
   expr0 r*pow(Yd,(1-_g)/_g)
   expr1 g*pow(Yd,(1-_g)/_g)
   expr2 b*pow(Yd,(1-_g)/_g)
   name HLG_InverseOOTF
   xpos 620
   ypos -58
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 _g t "Gamma: Extended model for gamma variation according to peak display luminance and surround luminance: BT.2390-8 p32" R 0 2}
   _g {{1.2*pow(1.111,log(Lw/1000)/log(2))*pow(0.98,log(max(1e-6,Lamb)/5)/log(2))}}
   addUserKnob {7 Lw R 600 4000}
   Lw {{parent.parent.Lw}}
   addUserKnob {7 Lamb t "ambient luminance level in nits" R 0 200}
   Lamb 5
  }
  Expression {
   expr0 r<=1/12?sqrt(3*r):_a*log(12*r-_b)+_c
   expr1 g<=1/12?sqrt(3*g):_a*log(12*g-_b)+_c
   expr2 b<=1/12?sqrt(3*b):_a*log(12*b-_b)+_c
   name HLG_OETF
   xpos 620
   ypos -34
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 _a t alpha}
   _a 0.17883277
   addUserKnob {7 _b t beta}
   _b {{1-4*_a}}
   addUserKnob {7 _c}
   _c {{0.5-_a*log(4*_a)}}
  }
push $N64c26800
  Expression {
   temp_name0 rp
   temp_expr0 pow(r,m_1)
   temp_name1 gp
   temp_expr1 pow(g,m_1)
   temp_name2 bp
   temp_expr2 pow(b,m_1)
   expr0 pow((c_1+c_2*rp)/(1+c_3*rp),m_2)
   expr1 pow((c_1+c_2*gp)/(1+c_3*gp),m_2)
   expr2 pow((c_1+c_2*bp)/(1+c_3*bp),m_2)
   name ST2084_InverseEOTF
   xpos 510
   ypos -58
   addUserKnob {20 CONSTANTS_tab l CONSTANTS}
   addUserKnob {7 m_1}
   m_1 {{2610/4096*(1/4)}}
   addUserKnob {7 m_2}
   m_2 {{2523/4096*128}}
   addUserKnob {7 c_1}
   c_1 {{107/128}}
   addUserKnob {7 c_2}
   c_2 {{2413/128}}
   addUserKnob {7 c_3}
   c_3 {{2392/128}}
  }
push $N64c26800
  Expression {
   expr0 sign(r)*pow(fabs(r),1/p)
   expr1 sign(g)*pow(fabs(g),1/p)
   expr2 sign(b)*pow(fabs(b),1/p)
   name power
   xpos 400
   ypos -58
   addUserKnob {20 Params_tab l Params}
   addUserKnob {7 p l power R 0.2 2}
   p {{eotf?2+eotf*0.2:1}}
  }
  Switch {
   inputs 3
   which {{eotf-3}}
   name SwitchInverseEOTF
   xpos 400
   ypos 14
  }
  Output {
   name Output
   xpos 400
   ypos 86
  }
 end_group
 Switch {
  inputs 2
  which {{parent.direction}}
  name SwitchDirection
  xpos 180
  ypos 206
 }
 Output {
  name Output
  xpos 180
  ypos 278
 }
end_group
Crop {
 box {0 -74 {width} {height}}
 reformat true
 crop false
 name Crop4
 xpos 1523
 ypos 2323
 disable true
}
Rectangle {
 opacity 0.955
 area {782.4000244 6 1137.599976 67.80000305}
 color 0
 name Rectangle4
 xpos 1523
 ypos 2347
}
Text2 {
 font_size_toolbar 30
 font_width_toolbar 100
 font_height_toolbar 100
 message "OpenDRT v0.0.90b2"
 old_message {{79 112 101 110 68 82 84 32 118 48 46 48 46 57 48 98 50}
   }
 box {0 16 1920 55}
 xjustify center
 yjustify center
 transforms {{0 2}
   }
 font_size_values {{0 30 1 30 2 30 3 30 4 30 5 30 6 30 7 30 8 30 9 30 10 30 11 30 12 30 13 30 14 30 15 30 16 30 8 99}
   }
 cursor_position 8
 font {{ Helvetica : Regular : Helvetica.ttc : 0 }}
 font_size 30
 center {960 540}
 cursor_initialised true
 autofit_bbox false
 initial_cursor_position {{717.6001587 112.7998962}
   }
 group_animations {{0} imported: 0 selected: items: "root transform/"}
 animation_layers {{1 11 960 540 0 0 1 1 0 0 0 0}
   }
 name Text2
 xpos 1537
 ypos 2374
}
push $N61d7b400
ContactSheet {
 inputs 3
 width {{input.width*columns}}
 height {{input.height}}
 rows 1
 columns 3
 name ContactSheet1
 xpos 1537
 ypos 2457
}
Reformat {
 format "3840 2160 0 0 3840 2160 1 UHD_4K"
 scale 0.5
 name Reformat5
 xpos 1537
 ypos 2481
}
Colorspace {
 colorspace_out sRGB
 name Colorspace9
 xpos 1537
 ypos 2513
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/comparisons/ZCAMishDRTv03_vs_v001/ZCAMishDRTv03_vs_v001.####.jpg
 colorspace texture_paint
 raw true
 file_type jpeg
 checkHashOnRead false
 version 10
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write1
 xpos 1537
 ypos 2568
}
Constant {
 inputs 0
 channels rgb
 color {100 {frame/20*100} 0 0}
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Constant7
 xpos -1422
 ypos 958
}
Expression {
 expr0 (y/(height-1))*r
 expr2 cx*180
 name Expression15
 xpos -1422
 ypos 1069
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.red 0 0 zcam_J.blue 0 2 rgba.red 0 0 zcam_J.alpha 0 3"
 name Shuffle31
 xpos -1422
 ypos 1093
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_Q
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.red 0 0 zcam_Q.blue 0 2 rgba.red 0 0 zcam_Q.alpha 0 3"
 name Shuffle32
 xpos -1422
 ypos 1117
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_M
 fromInput2 {{0} B}
 mappings "4 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
 name Shuffle47
 xpos -1422
 ypos 1139
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_h
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.red 0 0 rgba.blue 0 2 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.alpha 0 3"
 name Shuffle53
 xpos -1422
 ypos 1163
}
Group {
 name ZCAM18
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -1422
 ypos 1215
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N64f84800 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N64f13000 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N64f13000
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N652d3900 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N652d3900
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N64f11400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N64f11000 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N64f11400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N64f10400 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N6529fc00 [stack 0]
push $N64f11400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N6529f800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N6529f400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N6529f000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N6529ec00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N64f11000
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N64f11400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N64f11400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N64f11400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N64f84800
push $N64f11000
push $N64f10400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N6529d000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N6529d000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N64f11000
push $N6529fc00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N65237800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N65237800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N64f11000
push $N6529f800
push $N64f10400
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N65236000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N65235c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N65235c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N6529f000
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N65236000
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N6529f000
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N6529ec00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N65236000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N6529fc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N6529f400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N64f10400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N6529f800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N64f11000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N64f84800
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N65164800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N650df800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N650df800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N650de000 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N650dd400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N650dd400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N650dd400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N650dc400 [stack 0]
push $N650dc400
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N650de000
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N65091400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N65091400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N65091400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N6504b900 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N65090400 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N6504b900
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N65047800 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N6504b900
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N65046c00 [stack 0]
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N65046000 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N6504b200 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N65090400
push $N65047800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N65044400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N65044400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N6504b200
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N653de000 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N653de000
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N6504a400 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N6504a400
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N65164800
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N65164800
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N65164800
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N6504b200
push $N65164800
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N650de000
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N65046c00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N65046000
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N6504b900
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
Multiply {
 value 0.01
 name Multiply23
 label "Div by 100 to go from nits"
 xpos -1422
 ypos 1297
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle54
 xpos -1422
 ypos 1339
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace21
 label "XYZ to sRGB Prims"
 xpos -1422
 ypos 1363
}
Dot {
 name Dot16
 xpos -1388
 ypos 1412
}
set N65303000 [stack 0]
Dot {
 name Dot17
 xpos -1261
 ypos 1438
}
set N65302c00 [stack 0]
Expression {
 channel0 rgba
 expr0 min((r<0?0:1),(g<0?0:1),(b<0?0:1))
 name Expression16
 xpos -1338
 ypos 1463
}
push $N65302c00
Expression {
 channel0 rgba
 expr0 min((r>1?0:1),(g>1?0:1),(b>1?0:1))
 name Expression17
 xpos -1233
 ypos 1461
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply24
 xpos -1296
 ypos 1493
}
push $N65303000
Copy {
 inputs 2
 from0 rgba.alpha
 to0 rgba.alpha
 name Copy5
 xpos -1422
 ypos 1549
}
Premult {
 name Premult2
 xpos -1422
 ypos 1581
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/sRGBgamutBoundGif/sRGBgamutBoundGif_v001.%04d.png
 file_type png
 checkHashOnRead false
 version 1
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write5
 xpos -1422
 ypos 1617
}
Read {
 inputs 0
 file_type exr
 file "\[value Write11.file]"
 origset true
 version 3095
 name Read64
 xpos -8
 ypos 1675
}
set N65301000 [stack 0]
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/sRGBgamutBound_tempImg.png
 file_type png
 checkHashOnRead false
 version 1047
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write12
 xpos 111
 ypos 1832
}
push $N5cd33800
Group {
 name ZCAM11
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 412
 ypos -565
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N6567bc00 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N6567a800 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N6567a800
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N65643900 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N65643900
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N65678c00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N65678800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N65678c00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N65613800 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N65613400 [stack 0]
push $N65678c00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N65613000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N65612c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N65612800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N65612400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N65678800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N65678c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N65678c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N65678c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N6567bc00
push $N65678800
push $N65613800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N65610800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N65610800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N65678800
push $N65613400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N655a7000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N655a7000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N65678800
push $N65613000
push $N65613800
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N655a5800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N655a5400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N655a5400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N65612800
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N655a5800
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N65612800
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N65612400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N655a5800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N65613400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N65612c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N65613800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N65613000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N65678800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N6567bc00
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N65457c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N65457000 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N65457000
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N65455800 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N65454c00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N65454c00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N65454c00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N65417800 [stack 0]
push $N65417800
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N65455800
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N65414c00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N65414c00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N65414c00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N657af900 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N657b7800 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N657af900
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N657b7000 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N657af900
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N657b6400 [stack 0]
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N657b5800 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N657af200 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N657b7800
push $N657b7000
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N65743800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N65743800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N657af200
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N65741800 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N65741800
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N657ae400 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N657ae400
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N65457c00
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N65457c00
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N65457c00
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N657af200
push $N65457c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N65455800
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N657b6400
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N657b5800
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N657af900
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
set N65306b00 [stack 0]
Remove {
 channels zcam_M
 name Remove2
 xpos 416
 ypos -508
}
Multiply {
 channels zcam_C
 value 0.45
 name Multiply19
 xpos 408
 ypos -474
}
Expression {
 channel0 zcam_C
 expr0 20
 name Expression21
 xpos 408
 ypos -442
}
Group {
 name ZCAM15
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 408
 ypos -397
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 C,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N65a7e000 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N65a7cc00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N65a7cc00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N65a58100 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N65a58100
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N659fec00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N659fe800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N659fec00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N659fdc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N659fd800 [stack 0]
push $N659fec00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N659fd400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N659fd000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N659fcc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N659fc800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N659fe800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N659fec00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N659fec00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N659fec00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N65a7e000
push $N659fe800
push $N659fdc00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N6597a800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N6597a800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N659fe800
push $N659fd800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N65979400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N65979400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N659fe800
push $N659fd400
push $N659fdc00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N6591f800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N6591f400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N6591f400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N659fcc00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N6591f800
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N659fcc00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N659fc800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N6591f800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N659fd800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N659fd000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N659fdc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N659fd400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N659fe800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N65a7e000
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N6583a000 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N65839400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N65839400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N65bdf800 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N65bdec00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N65bdec00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N65bdec00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N65bddc00 [stack 0]
push $N65bddc00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N65bdf800
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N65b8ec00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N65b8ec00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N65b8ec00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N659d0100 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N65b8dc00 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N659d0100
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N65b8d400 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N659d0100
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N65b8c800 [stack 0]
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N65b3f800 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N65b23900 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N65b8dc00
push $N65b8d400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N65b3dc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N65b3dc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N65b23900
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N65eb3800 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N65eb3800
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N65b22b00 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N65b22b00
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N6583a000
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N6583a000
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N6583a000
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N65b23900
push $N6583a000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N65bdf800
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N65b8c800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N65b3f800
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N659d0100
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
push $N65306b00
Remove {
 channels zcam_C
 name Remove1
 xpos 308
 ypos -505
}
Multiply {
 channels zcam_M
 value {{parent.Multiply19.value}}
 name Multiply20
 xpos 308
 ypos -473
}
Expression {
 channel0 zcam_M
 expr0 20
 name Expression20
 xpos 308
 ypos -441
}
Group {
 name ZCAM16
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos 304
 ypos -398
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N65e5c400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N65ddec00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N65ddec00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N65e00800 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N65e00800
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N65ddd000 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N65ddcc00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N65ddd000
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N65d6fc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N65d6f800 [stack 0]
push $N65ddd000
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N65d6f400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N65d6f000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N65d6ec00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N65d6e800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N65ddcc00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N65ddd000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N65ddd000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N65ddd000
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N65e5c400
push $N65ddcc00
push $N65d6fc00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N65d6cc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N65d6cc00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N65ddcc00
push $N65d6f800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N65d07400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N65d07400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N65ddcc00
push $N65d6f400
push $N65d6fc00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N65d05c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N65d05800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N65d05800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N65d6ec00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N65d05c00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N65d6ec00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N65d6e800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N65d05c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N65d6f800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N65d6f000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N65d6fc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N65d6f400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N65ddcc00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N65e5c400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N65c28400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N65fa3400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N65fa3400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N65fa1c00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N65fa1000 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N65fa1000
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N65fa1000
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N65f63c00 [stack 0]
push $N65f63c00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  selected true
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N65fa1c00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N65f61000 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N65f61000
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N65f61000
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N65d18800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2714
 }
set N65f17c00 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N65d18800
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2036
  ypos 2713
 }
set N65f17400 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N65d18800
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N65f16800 [stack 0]
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N65f15c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N65d18100 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1818
  ypos 2708
 }
push $N65f17c00
push $N65f17400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  xpos -1543
  ypos 2822
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2986
 }
set N662a3c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N662a3c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N65d18100
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N662a1c00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N662a1c00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N662c7200 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N662c7200
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N65c28400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N65c28400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N65c28400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N65d18100
push $N65c28400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N65fa1c00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N65f16800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N65f15c00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N65d18800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
end_group
push $N6076ec00
push $N61de9c00
Merge2 {
 inputs 2
 name Merge5
 xpos 492
 ypos 1788
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
 file_type exr
 first_part rgba
 version 2074
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write4
 xpos 492
 ypos 1830
 addUserKnob {20 User}
 addUserKnob {22 recursiveWrite T "writeNode = nuke.thisNode()\nmergeNode = writeNode.input(0)\nreadNode = writeNode.input(0).input(0)\n\nwriteNode.setInput(0,writeNode.input(0).input(1))\nnuke.execute(writeNode, 0, 0)\nreadNode.knob('reload').execute()\nwriteNode.setInput(0,mergeNode)\n\n\nfor i in range(0,1024):\n    nuke.execute(writeNode, i, i)\n    readNode.knob('reload').execute()" +STARTLINE}
}
Colorspace {
 inputs 0
 primary_out DCI-P3
 name VIEWER_INPUT
 xpos -496
 ypos -580
}
push $N62c10f00
Group {
 name AF_WindsorExpBlur2
 tile_color 0x10e9efff
 xpos 2997
 ypos 2106
 addUserKnob {20 User}
 addUserKnob {41 channels T Dissolve2.channels}
 addUserKnob {4 iterations M {1 2 3 4 5 6 7 8 9 10}}
 iterations 10
 addUserKnob {7 size l Size R 0 5}
 size 1.82
 addUserKnob {41 which T Dissolve2.which}
 addUserKnob {26 version l "" +STARTLINE T v001}
}
 Input {
  inputs 0
  name Input1
  xpos 784
  ypos 334
 }
 NoOp {
  name NoOp2
  xpos 784
  ypos 374
  addUserKnob {20 User}
  addUserKnob {7 size R 0 10}
  size {{parent.size}}
 }
set N661ce800 [stack 0]
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur22
  xpos 1843
  ypos 480
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 10
 }
 Multiply {
  value 0
  name Multiply9
  xpos 1843
  ypos 518
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur21
  xpos 1708
  ypos 483
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 9
 }
 Multiply {
  value 0
  name Multiply8
  xpos 1708
  ypos 521
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur20
  xpos 1593
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 8
 }
 Multiply {
  value 0
  name Multiply7
  xpos 1593
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur19
  xpos 1491
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 7
 }
 Multiply {
  value 0
  name Multiply6
  xpos 1491
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur4
  xpos 1378
  ypos 483
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 6
 }
 Multiply {
  value 0
  name Multiply5
  xpos 1378
  ypos 521
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur5
  xpos 1268
  ypos 481
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 5
 }
 Multiply {
  value 0
  name Multiply4
  xpos 1268
  ypos 519
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur15
  xpos 1161
  ypos 487
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 4
 }
 Multiply {
  value 0
  name Multiply3
  xpos 1161
  ypos 525
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur16
  xpos 1062
  ypos 485
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 3
 }
 Multiply {
  value 0
  name Multiply2
  xpos 1062
  ypos 523
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
push 0
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur17
  xpos 877
  ypos 487
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 1
 }
push $N661ce800
 Blur {
  size {{pow(input.size,stepval)}}
  name Blur18
  xpos 970
  ypos 488
  addUserKnob {20 User}
  addUserKnob {3 stepval l step}
  stepval 2
 }
 Multiply {
  value 0
  name Multiply1
  xpos 970
  ypos 526
  disable {{parent.iterations<(input.stepval-1)?0:1}}
 }
 Merge2 {
  inputs 10+1
  operation plus
  name Plus10
  xpos 877
  ypos 608
 }
 Multiply {
  value {{1/(parent.iterations+1)}}
  name Multiply14
  xpos 877
  ypos 634
 }
 Crop {
  box {0 0 {input.width} {input.height}}
  name Crop1
  xpos 877
  ypos 672
 }
push $N661ce800
 Dissolve {
  inputs 2
  channels rgb
  which 0.16
  name Dissolve2
  xpos 792
  ypos 775
 }
 Output {
  name Output1
  xpos 792
  ypos 875
 }
end_group
push $N62c10f00
Group {
 name ZCAMishDRT3
 xpos 2849
 ypos 2162
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 illuminant_in l "" -STARTLINE T Colorspace30.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T Colorspace30.primary_in}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
}
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read1
  xpos 829
  ypos 237
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 829
  ypos 317
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 829
  ypos 341
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 829
  ypos 383
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N660de800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N660dd400 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N660dd400
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N66073200 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N66073200
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6605b400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6605b000 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6605b400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6605a400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6605a000 [stack 0]
push $N6605b400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N66059c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N66059800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N66059400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N66059000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6605b000
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6605b400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6605b400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6605b400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N660de800
push $N6605b000
push $N6605a400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N66407000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N66407000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6605b000
push $N6605a000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N66405c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N66405c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6605b000
push $N66059c00
push $N6605a400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N66404400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6639bc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6639bc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N66059400
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N66404400
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N66059400
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N66059000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N66404400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6605a000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N66059800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6605a400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N66059c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6605b000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N660de800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N666ca800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N666c9c00 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N666c9c00
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N666c8400 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6665f400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6665f400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6665f400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6665e400 [stack 0]
push $N6665e400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N666c8400
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N66607400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N66607400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N66607400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N66653200 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N66606400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N66653200
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N66605c00 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N66653200
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N66605000 [stack 0]
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N66604400 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N66652b00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N66606400
push $N66605c00
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N665ca400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N665ca400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N66652b00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N665c8400 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N665c8400
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N66651d00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N66651d00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N666ca800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N666ca800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N666ca800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N66652b00
push $N666ca800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N666c8400
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N66605000
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N66604400
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N66653200
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 829
  ypos 442
 }
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -41
 }
 Colorspace {
  primary_in ACES
  colorspace_out CIE-XYZ
  name Colorspace30
  label "ACES to XYZ"
  xpos 1344
  ypos -1
 }
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos 31
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos 107
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N664dc800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N66467000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N66467000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6642f900 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6642f900
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N66465400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N66465000 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N66465400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N66464400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N667efc00 [stack 0]
push $N66465400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N667ef800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N667ef400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N667ef000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N667eec00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N66465000
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N66465400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N66465400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N66465400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N664dc800
push $N66465000
push $N66464400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N667ed000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N667ed000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N66465000
push $N667efc00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6678b800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6678b800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N66465000
push $N667ef800
push $N66464400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6678a000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N66789c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N66789c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N667ef000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6678a000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N667ef000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N667eec00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6678a000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N667efc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N667ef400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N66464400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N667ef800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N66465000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N664dc800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N66ab4800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N66a37800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N66a37800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N66a36000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N66a35400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N66a35400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N66a35400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N66a34400 [stack 0]
push $N66a34400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N66a36000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N669ed400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N669ed400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N669ed400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N669a7900 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N669ec400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N669a7900
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N66997800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N669a7900
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N66996c00 [stack 0]
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N66996000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N669a7200 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N669ec400
push $N66997800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N66994400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N66994400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N669a7200
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6692e000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6692e000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N669a6400 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N669a6400
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N66ab4800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N66ab4800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N66ab4800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N669a7200
push $N66ab4800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N66a36000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N66996c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N66996000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N669a7900
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N664b2b00 [stack 0]
 Ramp {
  replace true
  p0 {0 0}
  p1 {{width} 0}
  color 1.5
  name Ramp1
  xpos 1208
  ypos 175
 }
set N66863c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle1
  xpos 1208
  ypos 206
 }
set N66863800 [stack 0]
push $N66863c00
push $N664b2b00
 Multiply {
  inputs 1+1
  channels zcam_M
  value 0
  name Multiply1
  xpos 1349
  ypos 171
  disable true
 }
 Merge2 {
  inputs 2
  operation multiply
  Achannels none
  Bchannels none
  output none
  also_merge zcam_C
  name Multiply
  xpos 1349
  ypos 220
 }
 Clamp {
  channels zcam_C
  maximum 100
  name Clamp1
  selected true
  xpos 1349
  ypos 256
 }
set N66862c00 [stack 0]
 Dot {
  name Dot13
  xpos 1376
  ypos 487
 }
set N66862800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 409
 }
set N66861800 [stack 0]
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit2
  xpos 1064
  ypos 470
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.765
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 1064
  ypos 499
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 1193
  ypos 550
 }
push $N66862800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1354
  ypos 595
  disable true
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1354
  ypos 663
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 C,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N66bd7800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N66bd6400 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N66bd6400
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N66bf1d00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N66bf1d00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N66bd4800 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N66bd4400 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N66bd4800
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N66b77400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N66b77000 [stack 0]
push $N66bd4800
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N66b76c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N66b76800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N66b76400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N66b76000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N66bd4400
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N66bd4800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N66bd4800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N66bd4800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N66bd7800
push $N66bd4400
push $N66b77400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N66b74400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N66b74400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N66bd4400
push $N66b77000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N66f02c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N66f02c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N66bd4400
push $N66b76c00
push $N66b77400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N66f01400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N66f01000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N66f01000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N66b76400
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N66f01400
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N66b76400
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N66b76000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N66f01400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N66b77000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N66b76800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N66b77400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N66b76c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N66bd4400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N66bd7800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N66db3800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N66db2c00 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N66db2c00
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N66db1400 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N66db0800 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N66db0800
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N66db0800
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N66d6b400 [stack 0]
push $N66d6b400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N66db1400
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N66d68800 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N66d68800
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N66d68800
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N66f09d00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N66d17400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N66f09d00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N66d16c00 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N66f09d00
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N66d16000 [stack 0]
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N66d15400 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N66f09600 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N66d17400
push $N66d16c00
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N66cb3400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N66cb3400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N66f09600
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N66cb1400 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N66cb1400
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N66f08800 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N66f08800
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N66db3800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N66db3800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N66db3800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N66f09600
push $N66db3800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N66db1400
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N66d16000
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N66d15400
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N66f09d00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1354
  ypos 715
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1354
  ypos 757
 }
 Colorspace {
  colorspace_in CIE-XYZ
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1354
  ypos 781
 }
 Output {
  name Output1
  xpos 1354
  ypos 888
 }
push $N66861800
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*width),(r/100*height))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit3
  xpos 981
  ypos 546
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
push $N66863800
push $N66862c00
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy1
  xpos 1349
  ypos 334
 }
set N66fcdc00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle51
  xpos 1588
  ypos 227
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply20
  label "Div by 100 to go from nits"
  xpos 1588
  ypos 251
 }
 ColorLookup {
  channels all
  lut {master {curve x0.02407439426 0 x0.04948588461 5.620706361e-06 x0.0808724314 5.995634638e-05 x0.1089436561 0.0002520732232 x0.1538826674 0.0009655252215 x0.1705526412 0.001552375033 x0.1965807676 0.003411091166 x0.2212548852 0.005432802252 x0.2435974032 0.008078291081 x0.2744711637 0.01258628722 x0.335355252 0.02872310206 x0.3656598926 0.0391706787 x0.4067366123 0.05722413212 x0.451582104 0.08477441967 x0.5436673164 0.1626682729 x0.6915633678 0.3178558648 x0.7352961302 0.3736175299 x0.8164004087 0.4692641795 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos 1588
  ypos 293
 }
 Gamma {
  value 2.2
  name Gamma2
  xpos 1588
  ypos 325
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply21
  label "Mult by 100 to put in absolute nits"
  xpos 1588
  ypos 357
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle52
  xpos 1588
  ypos 399
 }
push $N66fcdc00
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1345
  ypos 390
 }
end_group
Group {
 name PlotChromaticity2
 xpos 2849
 ypos 2195
 addUserKnob {20 PlotChromaticity_tab l PlotChromaticity}
 addUserKnob {6 use_gpu l "Use GPU if available" +STARTLINE}
 use_gpu true
 addUserKnob {26 ""}
 addUserKnob {6 plot_input l "plot input" t "Enable plotting of the input pixels" +STARTLINE}
 plot_input true
 addUserKnob {41 input_gamut l gamut t "Set the gamut that the input colors are encoded in" -STARTLINE T GamutToXYZ.gamut}
 addUserKnob {4 diagram l in t "Choose the type of chromaticity diagram: \nCIE 1931 xy Chromaticity Diagram\nCIE 1976 u' v' Uniform Chromaticity Scale Diagram" -STARTLINE M {"CIE 1931 xy" "CIE 1976 u' v'" "" ""}}
 diagram "CIE 1976 u' v'"
 addUserKnob {6 enable_sample_color l "sample color" t "Enable plotting of the sampled color" +STARTLINE}
 enable_sample_color true
 addUserKnob {41 sample_color l color t "sample and plot selected color" T SampleColor.color}
 addUserKnob {22 follow_viewer l "follow viewer" t "Follow the selected viewer node. This causes this node to automatically connect to whatever the followed viewer is connected to.\n\nThis is useful if you want to have a 2nd viewer showing a chromaticity plot for whever you're looking at in your main viewer." T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to follow.')\nelse:\n    v\['knobChanged'].setValue('v = nuke.activeViewer().node()\\nif v and v.name() == nuke.thisNode().name():\\n    con = v.input(nuke.activeViewer().activeInput())\\n    plt = nuke.toNode(\"\{0\}\")\\n    plt.setInput(0, con)'.format(n.name()))" +STARTLINE}
 addUserKnob {22 unfollow_viewer l "unfollow viewer" -STARTLINE T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to unfollow.')\nelse:\n    v\['knobChanged'].setValue('')"}
 addUserKnob {26 plot_dimensions_label l " " T "<b>Chromaticity Diagram"}
 addUserKnob {3 resolution l " resolution" t "resolution to output"}
 resolution 2048
 addUserKnob {7 right_margin l "right margin" R 1 1.5}
 right_margin 1.1
 addUserKnob {7 left_margin l "left margin" R 0 0.2}
 left_margin 0.1
 addUserKnob {6 draw_spectral_locus l "spectrum locus" t "draw the spectrum locus: the boundary of color the human eye can see." +STARTLINE}
 draw_spectral_locus true
 addUserKnob {6 draw_line_of_purples l "line of purples" t "draw the \"line of purples\"" -STARTLINE}
 draw_line_of_purples true
 addUserKnob {6 draw_planckian_locus l "planckian locus" t "Display the planckian locus or the blackbody locus." +STARTLINE}
 addUserKnob {6 gamut_grid l "gamut grid" t "Display a gamut boundary with a grid or dot pattern" +STARTLINE}
 addUserKnob {41 gamut_gamutgrid l "" t "gamut for gamutgrid" -STARTLINE T RGBToXYZ_GamutGrid.gamut}
 addUserKnob {4 gamut_grid_style l style t "Choose the style to display the gamut plot" -STARTLINE M {grid dots "" "" "" ""}}
 addUserKnob {4 distribution l dist t "Which chromaticity space should the overlays be constructed in? \n\nYxy is familiar, but not very perceptually uniform.\n\nu'v' is designed to be more perceptually uniform." -STARTLINE M {"1931 Yxy" "1976 u'v'" "" ""}}
 addUserKnob {7 density t "Density of the grid or points" R 10 100}
 density 50
 addUserKnob {6 gamut_a l "gamut a" t "Display a gamut outline" +STARTLINE}
 gamut_a true
 addUserKnob {41 gamut_a_1 l "" -STARTLINE T RGBToXYZ_GamutA.gamut}
 addUserKnob {6 gamut_b l "gamut b" t "Display a gamut outline" +STARTLINE}
 addUserKnob {41 gamut_b_1 l "" -STARTLINE T RGBToXYZ_GamutB.gamut}
 addUserKnob {6 gamut_c l "gamut c" t "Display a gamut outline" +STARTLINE}
 gamut_c true
 addUserKnob {41 gamut_c_1 l "" -STARTLINE T RGBToXYZ_GamutC.gamut}
 addUserKnob {6 draw_pointers_gamut l "pointer's gamut" t "DrawPointer's gamut boundary" +STARTLINE}
 addUserKnob {6 draw_pointers_samples l "pointers sample colors" t "show the individual pointer gamut samples" -STARTLINE}
 addUserKnob {6 draw_macbeth_chart l "macbeth chart" t "draw a ColorChecker24 aka Macbeth Chart" +STARTLINE}
 addUserKnob {6 coordinate_system l "coordinate system" t "Draw CIE xy coordinate grid x and y axes" +STARTLINE}
 coordinate_system true
 addUserKnob {6 map_overlays_to_input_gamut l "map overlays to input gamut" t "This maps the overlays like the spectral locus, pointer's gamut, and the gamut overlay to the working gamut instead of keeping them as XYZ.\n\nFor example if the input gamut is ACEScg, these overlays will be mapped to that. Note that this can cause most of the overlays to be negative or highly saturated which might harm the visual appearance." +STARTLINE}
 map_overlays_to_input_gamut true
}
 Group {
  inputs 0
  name GamutGrid1
  xpos -920
  ypos -201
  postage_stamp true
  addUserKnob {20 GamutGrid}
  addUserKnob {3 style}
  style {{!parent.gamut_grid_style}}
  addUserKnob {3 distribution -STARTLINE}
  distribution {{parent.distribution}}
  addUserKnob {7 density R 10 150}
  density {{parent.density}}
  addUserKnob {26 ""}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {12 wxy}
  wxy {{parent.RGBToXYZ_GamutGrid.wxy} {parent.RGBToXYZ_GamutGrid.wxy}}
 }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   centerSaturation 1
   fillFormat false
   area {-170 -158 682 670}
   name ColorWheel4
   xpos -260
   ypos -15
   postage_stamp false
  }
  Crop {
   box {0 0 {width} {height}}
   crop false
   name Crop2
   xpos -260
   ypos 27
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat3
   xpos -260
   ypos 110
  }
set N66f6b000 [stack 0]
push $N66f6b000
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   roworder TopBottom
   name ContactSheet2
   xpos -260
   ypos 169
  }
  Dot {
   name Dot1
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -226
   ypos 246
  }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   fillFormat false
   area {40 40 472 472}
   name ColorWheel1
   xpos -40
   ypos -664
   postage_stamp false
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat1
   xpos -40
   ypos -628
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   name Crop1
   xpos -40
   ypos -602
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos -526
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos -415
  }
  Colorspace {
   colorspace_in CIE-XYZ
   colorspace_out CIE-Yxy
   name Colorspace1
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -341
  }
set N66f68800 [stack 0]
  Dot {
   name Dot2
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos -331
  }
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression5
   label "CIE Yxy to CIELuv"
   xpos -590
   ypos -304
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 "(-(degrees(atan2(g-white.x, b-white.y))-180)+270)%360/360"
   expr2 "hypot(g-white.x, b-white.y)"
   expr3 a
   name Expression3
   xpos -590
   ypos -261
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{"parent.distribution ? 4*parent.wxy.x / ( -2 * parent.wxy.x + 12 * parent.wxy.y + 3) : parent.wxy"} {"parent.distribution ? 9*parent.wxy.y / ( -2*parent.wxy.x + 12*parent.wxy.y + 3) : parent.wxy"}}
  }
set N6730b800 [stack 0]
  Posterize {
   channels rgb
   Colors {{rint(parent.density/3*2)}}
   name Posterize1
   xpos -590
   ypos -191
  }
set N6730b400 [stack 0]
push $N6730b800
  Dot {
   name Dot15
   xpos -446
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy1
   xpos -480
   ypos -154
  }
push $N6730b400
push $N6730b800
  Dot {
   name Dot16
   xpos -666
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy2
   xpos -700
   ypos -153
  }
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   center true
   roworder TopBottom
   name ContactSheet3
   xpos -590
   ypos -106
  }
  Expression {
   expr0 r
   expr1 cos(radians(g*360))*b+white.x
   expr2 sin(radians(g*360))*b+white.y
   expr3 a
   name Expression19
   xpos -590
   ypos -58
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{parent.Expression3.white} {parent.Expression3.white}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression2
   label "CIELuv to CIE Yxy"
   xpos -590
   ypos -16
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace2
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -590
   ypos 32
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix1
   label "XYZ to RGB"
   xpos -590
   ypos 81
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin2
   xpos -590
   ypos 119
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp1
   xpos -590
   ypos 152
  }
  Premult {
   name Premult1
   xpos -590
   ypos 194
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge2
   xpos -590
   ypos 242
  }
  Fill {
   output alpha
   name Fill1
   xpos -590
   ypos 297
  }
  Dot {
   name Dot3
   label " GRID"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos 378
  }
push $N66f6b000
push $N66f68800
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression4
   label "CIE Yxy to CIELuv"
   xpos -40
   ypos -280
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 rint(g*Colors)/Colors
   expr2 rint(b*Colors)/Colors
   expr3 a
   name Expression1
   label rint
   xpos -40
   ypos -232
   addUserKnob {20 User}
   addUserKnob {7 Colors R 1 256}
   Colors {{parent.density}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression6
   label "CIELuv to CIE Yxy"
   xpos -40
   ypos -184
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace3
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -112
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix3
   label "XYZ to RGB"
   xpos -40
   ypos -57
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp4
   xpos -40
  }
  Premult {
   name Premult2
   xpos -40
   ypos 55
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge1
   xpos -40
   ypos 110
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin1
   xpos -40
   ypos 273
  }
  Dot {
   name Dot4
   label " DOTS"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 378
  }
  Switch {
   inputs 2
   which {{parent.style}}
   name Switch1
   xpos -257
   ypos 483
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix2
   label "RGB to XYZ"
   xpos -257
   ypos 560
  }
  Output {
   name Output
   xpos -257
   ypos 740
  }
  ColorWheel {
   inputs 0
   format "256 256 0 0 256 256 1 square_256"
   area {40 40 472 472}
   name ColorWheel2
   xpos -37
   ypos -705
   postage_stamp false
  }
 end_group
set N66f76b00 [stack 0]
 Group {
  name RGBToXYZ_GamutGrid
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos -184
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorWheel {
  inputs 0
  format "512 512 0 0 512 512 1 square_512"
  centerSaturation 1
  fillFormat false
  area {-196 -184 708 696}
  name ColorWheel1
  xpos -920
  ypos 5
 }
 Crop {
  box {0 0 {width} {height}}
  name Crop1
  xpos -920
  ypos 87
 }
 BlackOutside {
  name BlackOutside3
  xpos -920
  ypos 134
 }
set N67222400 [stack 0]
 Group {
  name RGBToXYZ_GamutC
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1140
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r+input.width} {parent.ReformatBox4.box_width-input.height}}
  name Position6
  xpos -1140
  ypos 254
 }
push $N67222400
 Group {
  name RGBToXYZ_GamutB
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height*2}}
  name Position5
  xpos -1030
  ypos 254
 }
push $N67222400
 Group {
  name RGBToXYZ_GamutA
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -920
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position4
  xpos -920
  ypos 254
 }
push $N66f76b00
 Reformat {
  type scale
  scale 0.8
  turn true
  filter impulse
  black_outside true
  name Reformat2
  xpos -920
  ypos -129
 }
 BlackOutside {
  name BlackOutside2
  xpos -920
  ypos -106
 }
 Position {
  translate {{Rectangle1.area.r} {parent.Position3.translate.y-input.height}}
  name Position2
  xpos -920
  ypos -81
 }
 Group {
  inputs 0
  name ColorChecker24_After_November_2014
  label "CIE XYZ D50"
  xpos -920
  ypos -352
  addUserKnob {20 colorchecker_tab l "ColorChecker24 - After November 2014"}
  addUserKnob {3 patch_resolution}
  patch_resolution 48
 }
  Group {
   inputs 0
   name bluish_green
   selected true
   xpos 622
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.30451114 0.4143554688 0.344352688 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "bluish green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 6
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_flower
   xpos 512
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2419823988 0.2287175998 0.3282104382 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue flower"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 5
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name foliage
   xpos 402
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1114392339 0.1346792679 0.05239320311 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob foliage
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 4
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_sky
   xpos 292
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1652470004 0.1785519348 0.2546024121 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue sky"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 3
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name light_skin
   xpos 180
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3811104477 0.336202304 0.1852590702 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "light skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 2
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 135
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name dark_skin
   xpos 70
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1136398927 0.09832436105 0.047793811 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "dark skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 1
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 290
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 290
    ypos 158
   }
   Output {
    name Output
    xpos 290
    ypos 230
   }
  end_group
  Group {
   inputs 0
   name orange_yellow
   xpos 622
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4769723742 0.4293377578 0.06005041429 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "orange yellow"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 12
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow_green
   xpos 512
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3427379502 0.4331759409 0.08330791241 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "yellow green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 11
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purple
   xpos 401
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08353888545 0.06276662955 0.1042075686 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob purple
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 10
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name moderate_red
   xpos 290
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2915036416 0.188999956 0.09736350318 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "moderate red"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 9
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purplish_blue
   xpos 180
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1200518326 0.1091090233 0.2874447494 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "purplish blue"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 8
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name orange
   xpos 74
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4073691399 0.3126416159 0.05130591012 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob orange
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 7
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name cyan
   xpos 622
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1247966941 0.180609913 0.2913392383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob cyan
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 18
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name magenta
   xpos 512
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.299122798 0.1895114577 0.2213469194 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob magenta
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 17
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow
   xpos 399
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5888922356 0.5992976803 0.07077420003 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob yellow
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 16
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 182
   }
  end_group
  Group {
   inputs 0
   name red
   xpos 292
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2143728424 0.127800835 0.03868150726 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob red
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 15
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name green
   xpos 182
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1413517689 0.2233437582 0.07287461742 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob green
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 14
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue
   xpos 72
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.06809095613 0.05596214063 0.2077405936 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob blue
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 13
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name black_2
   xpos 623
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.03042544265 0.03151319431 0.02656724434 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "black 2 (1.5 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 24
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_3
   xpos 512
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08448968042 0.08817234828 0.07391630753 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 3.5 (1.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 23
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_5
   xpos 403
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1835495863 0.1906228754 0.1566717383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 5 (.70 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 22
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_6
   xpos 292
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3495921991 0.3648652066 0.3013565492 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 6.5 (.44 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 21
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_8
   xpos 179
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5665335579 0.5899709702 0.4828473821 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 8 (.23 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 20
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name white_9
   xpos 70
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.8436985288 0.8806903203 0.6936778752 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "white 9.5 (.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 19
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 134
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  ContactSheet {
   inputs 24
   width {{"rint(parent.patch_resolution * 6 + gap * 7)"}}
   height {{"rint(parent.patch_resolution * 4 + gap * 5)"}}
   rows 4
   columns 6
   startframe 1
   endframe 1
   name ContactSheet
   xpos 620
   ypos 206
  }
  Unpremult {
   name Unpremult1
   xpos 620
   ypos 278
  }
  Output {
   name Output
   xpos 620
   ypos 446
  }
 end_group
 BlackOutside {
  name BlackOutside4
  xpos -920
  ypos -298
 }
 Position {
  translate {{parent.Reformat1.box_width*3+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position7
  xpos -920
  ypos -273
 }
 Constant {
  inputs 0
  format "256 256 0 0 256 256 1 square_256"
  name Constant5
  xpos -700
  ypos -1354
  postage_stamp false
 }
 Dot {
  name Dot25
  xpos -666
  ypos -1302
 }
set N6733e800 [stack 0]
 Dot {
  name Dot27
  xpos -1546
  ypos -1302
 }
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox1
  xpos -1580
  ypos -994
 }
 Ramp {
  p0 {0 0}
  p1 {{input.width} 0}
  color {{p1}}
  name Ramp3
  xpos -1580
  ypos -898
 }
 ColorLookup {
  lut {master {}
    red {curve 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914}
    green {curve 0.433 0.464 0.513 0.611 0.576 0.46 0.426 0.412 0.404 0.397 0.384 0.374 0.346 0.333 0.311 0.287 0.257 0.23 0.21 0.219 0.208 0.211 0.208 0.187 0.191 0.187 0.18 0.164 0.17 0.177 0.175 0.188 0.252 0.325 0.385 0.416 0.433 0.487 0.532 0.588 0.637 0.634 0.549 0.506 0.49 0.458 0.426 0.412 0.397 0.365 0.337 0.301 0.262 0.221 0.192 0.164 0.167 0.162 0.176 0.179 0.148 0.156 0.142 0.148 0.138 0.145 0.145 0.161 0.197 0.256 0.324 0.393 0.451 0.487 0.508 0.538 0.587 0.634 0.659 0.611 0.552 0.526 0.484 0.452 0.428 0.406 0.371 0.334 0.293 0.243 0.204 0.177 0.151 0.151 0.162 0.158 0.161 0.142 0.141 0.129 0.134 0.14 0.156 0.166 0.192 0.221 0.265 0.325 0.392 0.451 0.508 0.48 0.513 0.554 0.597 0.63 0.634 0.58 0.546 0.499 0.466 0.434 0.408 0.372 0.332 0.288 0.242 0.202 0.179 0.16 0.157 0.162 0.157 0.159 0.149 0.153 0.147 0.154 0.164 0.18 0.199 0.226 0.25 0.279 0.325 0.38 0.439 0.48 0.436 0.468 0.502 0.541 0.57 0.605 0.594 0.555 0.511 0.473 0.439 0.409 0.371 0.332 0.288 0.252 0.217 0.196 0.181 0.178 0.185 0.176 0.173 0.168 0.176 0.178 0.19 0.202 0.214 0.235 0.254 0.27 0.291 0.323 0.366 0.41 0.436 0.396 0.414 0.438 0.465 0.485 0.527 0.566 0.557 0.523 0.478 0.442 0.409 0.371 0.334 0.294 0.265 0.244 0.223 0.225 0.212 0.218 0.211 0.211 0.207 0.214 0.217 0.229 0.237 0.244 0.264 0.275 0.285 0.3 0.321 0.348 0.376 0.396 0.357 0.368 0.377 0.391 0.402 0.431 0.481 0.503 0.521 0.482 0.444 0.409 0.372 0.337 0.307 0.286 0.27 0.257 0.247 0.251 0.257 0.255 0.254 0.25 0.258 0.259 0.265 0.269 0.278 0.284 0.292 0.297 0.305 0.317 0.33 0.344 0.357 0.321 0.322 0.328 0.332 0.333 0.346 0.365 0.389 0.411 0.459 0.443 0.399 0.352 0.327 0.313 0.304 0.3 0.294 0.295 0.294 0.293 0.292 0.291 0.295 0.3 0.301 0.302 0.304 0.304 0.304 0.305 0.307 0.309 0.312 0.313 0.316 0.321}
    blue {curve 0.26 0.281 0.298 0.306 0.342 0.365 0.39 0.381 0.392 0.416 0.413 0.43 0.448 0.446 0.433 0.425 0.419 0.394 0.362 0.328 0.305 0.298 0.286 0.247 0.26 0.219 0.199 0.168 0.178 0.14 0.11 0.084 0.104 0.158 0.18 0.225 0.26 0.235 0.26 0.28 0.298 0.327 0.372 0.395 0.417 0.43 0.435 0.455 0.488 0.479 0.521 0.522 0.515 0.49 0.436 0.383 0.331 0.295 0.282 0.258 0.219 0.208 0.179 0.168 0.141 0.129 0.106 0.094 0.095 0.112 0.127 0.165 0.199 0.235 0.226 0.258 0.28 0.298 0.316 0.361 0.399 0.427 0.446 0.461 0.482 0.52 0.521 0.553 0.563 0.573 0.524 0.454 0.389 0.33 0.295 0.266 0.247 0.214 0.195 0.168 0.178 0.142 0.14 0.128 0.129 0.126 0.131 0.144 0.167 0.199 0.226 0.238 0.266 0.289 0.31 0.329 0.351 0.395 0.428 0.453 0.475 0.494 0.533 0.542 0.568 0.584 0.576 0.53 0.451 0.385 0.331 0.299 0.266 0.245 0.22 0.206 0.184 0.174 0.167 0.166 0.166 0.173 0.172 0.165 0.172 0.187 0.208 0.238 0.258 0.28 0.3 0.321 0.343 0.362 0.391 0.427 0.458 0.482 0.503 0.546 0.554 0.573 0.582 0.546 0.499 0.431 0.375 0.33 0.304 0.275 0.254 0.234 0.225 0.212 0.209 0.206 0.203 0.21 0.215 0.212 0.204 0.208 0.214 0.231 0.258 0.277 0.294 0.31 0.328 0.348 0.372 0.397 0.427 0.462 0.487 0.51 0.544 0.558 0.559 0.556 0.503 0.444 0.402 0.355 0.329 0.309 0.289 0.275 0.26 0.254 0.245 0.245 0.241 0.238 0.249 0.249 0.245 0.241 0.242 0.246 0.258 0.277 0.295 0.305 0.315 0.327 0.339 0.359 0.39 0.421 0.461 0.491 0.515 0.54 0.546 0.522 0.478 0.429 0.393 0.368 0.345 0.325 0.313 0.303 0.295 0.286 0.284 0.279 0.277 0.274 0.277 0.277 0.28 0.276 0.273 0.274 0.279 0.285 0.295 0.311 0.314 0.316 0.32 0.323 0.331 0.346 0.367 0.397 0.468 0.513 0.494 0.425 0.388 0.372 0.348 0.336 0.331 0.326 0.32 0.316 0.314 0.312 0.309 0.321 0.32 0.319 0.305 0.317 0.316 0.316 0.315 0.316 0.317 0.319 0.321 0.311}
    alpha {}}
  name ColorLookup7
  label "Pointers Samples Yxy\nSource: https://www.rit.edu/cos/colorscience/rc_useful_data.php"
  xpos -1580
  ypos -790
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace12
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1580
  ypos -688
 }
 Fill {
  output alpha
  name Fill5
  xpos -1580
  ypos -639
 }
 BlackOutside {
  name BlackOutside7
  xpos -1580
  ypos -562
 }
 Position {
  translate {6 {parent.Position1.translate.y-input.height}}
  name Position3
  xpos -1580
  ypos -538
 }
 Dot {
  name Dot15
  xpos -1546
  ypos -414
 }
push $N6733e800
 Reformat {
  type "to box"
  box_width 2048
  box_height 2048
  box_fixed true
  name ReformatBox4
  xpos -700
  ypos -1258
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression7
  xpos -700
  ypos -1209
 }
 Dot {
  name Dot10
  xpos -666
  ypos -1158
 }
set N676e6c00 [stack 0]
 Dot {
  name Dot26
  xpos -886
  ypos -1158
 }
set N676e6800 [stack 0]
 Dot {
  name Dot23
  xpos -1106
  ypos -1158
 }
set N676e6400 [stack 0]
 Dot {
  name Dot12
  xpos -1326
  ypos -1158
 }
 Mirror2 {
  flip true
  flop true
  name Mirror2_1
  xpos -1360
  ypos -1042
 }
 Reformat {
  type "to box"
  box_width 512
  box_height {{box_width}}
  box_fixed true
  name Reformat1
  xpos -1360
  ypos -994
 }
 Gamma {
  channels rgb
  value 2
  name Gamma1
  xpos -1360
  ypos -898
 }
 Multiply {
  channels rgb
  value 8000
  name Multiply1
  label "\[value value]"
  xpos -1360
  ypos -811
 }
 ColorLookup {
  lut {master {}
    red {curve R 0.4830000103 x50 0.5045000315 0.5260000229 0.5475000143 0.5690000057 0.5904999971 0.6119999886 0.63349998 0.6549999714 0.6805312037 0.7087500095 0.7315937281 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.75459373 0.7845000029 0.8144062757 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8009687662 0.74150002 0.6820312142 0.6549999714 0.6684374809 0.6980000138 0.7275624871 0.7409999967 0.7315937281 0.7087500095 0.6805312037 0.6549999714 0.629468739 0.6012499928 0.5784062743 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5555624962 0.5260000229 0.4964375198 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4964375198 0.5260000229 0.5555624962 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5653046966 0.5555624962 0.5417890549 0.5260000229 0.5102109313 0.4964375198 0.4866953194 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4695625007 0.4400000274 0.4104375243 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.4104375243 0.4400000274 0.4695625007 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103}
    green {curve R 0.6589999795 x50 0.6542205811 0.6484853029 0.6414804459 0.6340000033 0.6249843836 0.6147499681 0.6041406393 0.5939999819 0.5844687223 0.575124979 0.5659687519 0.5569999814 0.5484530926 0.5402500033 0.5319218636 0.5230000019 0.5131718516 0.5027499795 0.4922031164 0.4819999933 0.4722187519 0.4626249969 0.4532187581 0.4440000057 0.4351093769 0.4265000224 0.4178906381 0.4090000093 0.3997343779 0.3902499974 0.380640626 0.3709999919 0.3614374995 0.3518749774 0.3421249986 0.3319999874 0.321398437 0.3104375005 0.2992577851 0.2879999876 0.2764999866 0.2647500038 0.2531249821 0.2419999987 0.2312265635 0.2206875086 0.2108047009 0.202000007 0.1947187632 0.1886250079 0.1829687506 0.1770000011 0.1693515629 0.1608124971 0.1538671851 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1527187377 0.1564999968 0.1602812558 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1612187475 0.1595000029 0.1577812582 0.1570000052 0.1573124975 0.1579999924 0.1586875021 0.1589999944 0.1575781256 0.1543750018 0.1509843767 0.1490000039 0.1485625058 0.1484999955 0.1484375 0.1480000019 0.1467812508 0.1449999958 0.1432187557 0.1420000046 0.1415625066 0.1414999962 0.1414375007 0.1410000026 0.1397656202 0.1378750056 0.1357968748 0.1340000033 0.1323750019 0.1307500005 0.1295000017 0.1289999932 0.130031243 0.1324999928 0.1354687512 0.1379999965 0.1402187496 0.1424999982 0.1442812532 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1464921832 0.1503124982 0.1554765552 0.1609999985 0.1673984379 0.1749375015 0.1822578013 0.1879999936 0.1906718612 0.1913749874 0.1926406175 0.1969999969 0.2064140588 0.2199375033 0.2357421964 0.2520000041 0.2688750029 0.2871249914 0.3058125079 0.324000001 0.3417187631 0.359375 0.3765937686 0.3930000067 0.4082968831 0.4227499962 0.4368281364 0.451000005 0.4659531415 0.4812500179 0.4956718981 0.5080000162 0.5169296861 0.5234375 0.5297265649 0.5379999876 0.5491171479 0.5618124604 0.5751015544 0.5879999995 0.6009531021 0.6142500043 0.6266719103 0.6370000243 0.6457066536 0.6532088518 0.6575522423 0.6589999795}
    blue {curve R 0.3160000145 x50 0.324739933 0.3330312669 0.3418398499 0.351000011 0.3607422113 0.3709374964 0.3811640739 0.3910000026 0.4003046751 0.4093124866 0.4181640446 0.4269999862 0.4359609187 0.4449374974 0.453695327 0.4620000124 0.4697890878 0.4771875143 0.4842422009 0.4909999967 0.4971874952 0.5028749704 0.5086249709 0.5149999857 0.5227031112 0.53125 0.5394218564 0.5460000038 0.5502656102 0.5530000329 0.5552343726 0.5580000281 0.561632812 0.5655625463 0.5694609284 0.5730000138 0.5765469074 0.5801249743 0.5828906298 0.5839999914 0.5838750005 0.5830000043 0.5806249976 0.5759999752 0.5682968497 0.5576249957 0.5446406007 0.5299999714 0.5128515363 0.4931874871 0.4729296863 0.4539999962 0.4368359447 0.420437485 0.4045703113 0.3889999986 0.3731718659 0.3573749959 0.3426406384 0.3300000131 0.3193906248 0.310375005 0.3034218848 0.298999995 0.2972500026 0.2969999909 0.2967499793 0.2949999869 0.2899531126 0.2821249962 0.2734843791 0.2660000026 0.2602812648 0.2552500069 0.2503437698 0.2450000048 0.2380000055 0.2300000042 0.2232500017 0.2199999988 0.2195625007 0.2194999903 0.2194374949 0.2189999968 0.2183593661 0.2176249921 0.2163281292 0.2140000015 0.2101874948 0.205249995 0.1999374926 0.1949999928 0.1904453039 0.185937494 0.1817109436 0.1780000031 0.1754062474 0.1736250073 0.1715312451 0.1679999977 0.1620937437 0.1546249986 0.147093758 0.1410000026 0.1372031271 0.1347499937 0.1324218661 0.1289999932 0.1237656176 0.1174999923 0.1112343743 0.1059999987 0.1021796837 0.09918750077 0.09660156071 0.09399999678 0.09089062363 0.0876249969 0.0850468725 0.08399999887 0.08524999768 0.0882499963 0.09187500179 0.09499999881 0.09706249833 0.09875000268 0.1008125022 0.1040000021 0.1084140688 0.1136875004 0.1198671907 0.1270000041 0.1355390698 0.145312503 0.1554296911 0.1650000066 0.1739453226 0.1826875061 0.1910859346 0.199000001 0.2061250061 0.2126249969 0.2190624923 0.2259999961 0.2338827997 0.2423124909 0.2505859137 0.2579999864 0.2642968595 0.26987499 0.2750156224 0.2800000012 0.2847812474 0.2892500162 0.2935937643 0.2980000079 0.3025000095 0.3070000112 0.3115000129 0.3160000145}
    alpha {}}
  name ColorLookup5
  label "Pointer's Gamut Boundary Yxy\ninterpolated: incr 50 - 0 to 8000"
  xpos -1360
  ypos -775
 }
 Multiply {
  channels rgb
  value {0.31 1 1 1}
  name Multiply2
  label "dim boundary"
  xpos -1360
  ypos -725
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace5
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1360
  ypos -688
 }
 Fill {
  output alpha
  name Fill4
  xpos -1360
  ypos -639
 }
 BlackOutside {
  name BlackOutside1
  xpos -1360
  ypos -562
 }
 Position {
  translate {6 {ReformatBox4.box_width-input.width}}
  name Position1
  xpos -1360
  ypos -538
 }
 Dot {
  name Dot24
  xpos -1326
  ypos -486
 }
push $N676e6400
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox2
  xpos -1140
  ypos -994
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression1
  xpos -1140
  ypos -898
 }
set N6769e000 [stack 0]
 Dot {
  name Dot8
  xpos -996
  ypos -894
 }
 ColorLookup {
  lut {master {curve L 0 s0 t0.9499999881 C k x0.308139503 1 s0}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos -1030
  ypos -849
 }
 Dot {
  name Dot14
  xpos -996
  ypos -750
 }
push $N6769e000
 Multiply {
  channels rgb
  value 269
  name Multiply5
  label "\[value value]"
  xpos -1140
  ypos -856
 }
 ColorLookup {
  lut {master {}
    red {curve C 1.8783474 1.85965741 1.8410753 1.82260251 1.80424976 1.78602886 1.76794314 1.75000143 1.73221421 1.71458244 1.69711792 1.67982578 1.66271067 1.6457777 1.62903571 1.6124835 1.59613538 1.57998943 1.56404996 1.54832447 1.5328095 1.51751649 1.50244594 1.48759735 1.47297573 1.45858264 1.44442391 1.43049574 1.41680288 1.40334678 1.39012623 1.37714779 1.36440396 1.35190022 1.33963728 1.32761216 1.31582856 1.30428183 1.29297352 1.28190565 1.27107596 1.2604804 1.25012183 1.23999798 1.23010659 1.22044563 1.21101499 1.20181489 1.19284034 1.18408906 1.17556167 1.16725397 1.15916491 1.15129638 1.14363372 1.13618886 1.12895167 1.12192106 1.11509454 1.10846853 1.10204577 1.09580922 1.08977199 1.08392429 1.07826447 1.07278681 1.06749392 1.06237841 1.05743873 1.05267084 1.04807138 1.04364109 1.03937256 1.03526449 1.03131545 1.02751946 1.02387333 1.02037668 1.01702523 1.01381445 1.01074362 1.00780725 1.00500631 1.00233305 0.99978602 0.99736285 0.9950608 0.99287677 0.99080539 0.98884678 0.98699367 0.9852494 0.98361033 0.98206747 0.98062134 0.97926998 0.97800934 0.97683728 0.97575116 0.97474778 0.97382426 0.97297859 0.97220623 0.97150886 0.97087657 0.97031689 0.96981871 0.96938527 0.96900952 0.96869147 0.96842706 0.96821606 0.96805781 0.96794283 0.96787858 0.96785843 0.96787864 0.96793604 0.96803701 0.96817231 0.96833968 0.96854311 0.96877253 0.96903455 0.96932232 0.96963543 0.96997368 0.97033387 0.97071254 0.9711163 0.97153723 0.97197378 0.97242606 0.97289121 0.97337079 0.97386622 0.97437072 0.97488332 0.97540969 0.97594237 0.97647977 0.97702706 0.97757769 0.97813445 0.97869468 0.97925854 0.97982538 0.98039114 0.98096472 0.98153675 0.98210776 0.98267955 0.98325121 0.98382008 0.98438704 0.9849571 0.98552132 0.98608243 0.98664182 0.98719966 0.98775077 0.98829895 0.98884273 0.98938417 0.98991877 0.9904511 0.99097681 0.99149919 0.99201453 0.99252397 0.99303031 0.99353105 0.99402624 0.99451613 0.99499857 0.99547589 0.99594522 0.99641174 0.99687338 0.99732745 0.99777603 0.9982177 0.99865389 0.999084 0.99950838 0.99992663 1.00033772 1.00074494 1.00114489 1.00153947 1.00192833 1.00231075 1.00268865 1.00305855 1.00342607 1.00378489 1.00413895 1.00448751 1.00483036 1.00517035 1.00550389 1.00583148 1.00615203 1.00646758 1.00678015 1.00708604 1.00738645 1.00768471 1.00797844 1.0082655 1.00854778 1.00882483 1.00909901 1.00936711 1.00963116 1.00989032 1.0101465 1.01039672 1.01064491 1.01088691 1.0111258 1.01135957 1.01158977 1.01181614 1.01203847 1.01225793 1.01247287 1.01268291 1.01289058 1.01309609 1.01329684 1.01349473 1.0136888 1.0138787 1.01406395 1.01424909 1.01442885 1.01460576 1.01478052 1.01495218 1.01512218 1.01528883 1.01545072 1.01561022 1.01576698 1.01592219 1.01607502 1.01622343 1.01636875 1.0165143 1.01665616 1.01679492 1.0169313 1.01706588 1.01719737 1.01732695 1.01745498 1.01757956 1.01770294 1.01782393 1.01794255 1.0180583 1.01817465 1.01828551 1.01839495 1.01850486 1.01861191 1.01871693 1.01882088 1.01891339}
    green {curve C 1}
    blue {curve C 0.00879261 0.00962762 0.010532 0.01151017 0.01256675 0.01370643 0.01493413 0.01625487 0.01767381 0.01919618 0.02082733 0.02257277 0.02443803 0.02642871 0.02855051 0.03080913 0.0332104 0.0357601 0.03846392 0.04132775 0.04435719 0.04755813 0.05093599 0.05449668 0.0582453 0.0621875 0.06632853 0.07067341 0.07522713 0.07999477 0.08498063 0.09018957 0.09562518 0.10129225 0.10719412 0.11333443 0.11971687 0.12634411 0.133219 0.14034435 0.14772213 0.15535444 0.16324303 0.17138906 0.179794 0.18845794 0.197382 0.20656651 0.21601067 0.22571453 0.23567709 0.24589771 0.25637382 0.26710594 0.2780903 0.28932518 0.30080822 0.3125369 0.32450783 0.33671761 0.34916404 0.36183971 0.37474373 0.38787127 0.40121818 0.41477671 0.42854655 0.44251823 0.45668846 0.47105014 0.48559928 0.50033116 0.5152359 0.5303098 0.5455451 0.56093836 0.5764783 0.59215891 0.60797763 0.62392306 0.63999057 0.65616876 0.6724565 0.68884456 0.70532417 0.72188419 0.73852479 0.7552371 0.77200818 0.78883314 0.80570388 0.82261622 0.83956301 0.8565321 0.87351894 0.89051074 0.90751225 0.92450547 0.94148719 0.95845115 0.97538745 0.99229181 1.00915313 1.02597356 1.04273522 1.05944169 1.07608175 1.09265125 1.10914159 1.12555146 1.14187002 1.15809321 1.1742171 1.190238 1.20614767 1.22194457 1.23762202 1.2531724 1.26859927 1.28389311 1.29905295 1.31407428 1.32895291 1.34368753 1.35827363 1.3727088 1.38699389 1.40111876 1.41508293 1.42889357 1.44254065 1.45602405 1.46934104 1.48249614 1.49548101 1.50830269 1.5209527 1.53343177 1.54574537 1.5578897 1.56985986 1.5816654 1.59329891 1.60476208 1.61605716 1.62718153 1.63813758 1.64892519 1.65955138 1.67000985 1.68030369 1.69043732 1.70040607 1.71021223 1.71985734 1.72934508 1.73867714 1.74785423 1.75688136 1.76575518 1.77447391 1.78304338 1.79146802 1.79975164 1.80788386 1.81587982 1.82373333 1.83144975 1.83902776 1.84647095 1.85378456 1.86096811 1.86802399 1.87495112 1.88175035 1.88842535 1.89497983 1.90141833 1.90774179 1.91394711 1.92004013 1.92602086 1.93188739 1.93765306 1.94330883 1.94886208 1.95430994 1.95965815 1.96490622 1.97005856 1.97511387 1.98007631 1.98494554 1.98972344 1.99441445 1.99901712 2.00353193 2.00796437 2.01231384 2.01658392 2.02076721 2.02487659 2.02890825 2.03286695 2.03675175 2.04056406 2.04430199 2.04797506 2.05157685 2.05511236 2.0585804 2.06198287 2.06532407 2.06860161 2.07181907 2.07497644 2.07807779 2.0811162 2.08409977 2.08702946 2.08990335 2.09272337 2.09549189 2.0982089 2.10087585 2.10349345 2.10606146 2.1085825 2.11105394 2.11348104 2.11586332 2.11820364 2.12050176 2.12275648 2.12496805 2.127141 2.12927723 2.13136625 2.13341999 2.13543844 2.13741732 2.13936305 2.1412704 2.1431427 2.14498401 2.14678812 2.14856291 2.1503005 2.15200949 2.15368938 2.15533352 2.15695238 2.15853977 2.16009951 2.16162968 2.16313291 2.16460824 2.16605687 2.16747928 2.16887903 2.17024994 2.1715951 2.17291784 2.17421341 2.17548871 2.17674041 2.17797112 2.17918396 2.18036819 2.18143296}
    alpha {}}
  name ColorLookup3
  label "Planckian Locus 0-269"
  xpos -1140
  ypos -808
 }
 Multiply {
  inputs 1+1
  channels rgb
  value 0
  maskChannelMask rgba.red
  invert_mask true
  name Multiply3
  label dim
  xpos -1140
  ypos -760
 }
 BlackOutside {
  name BlackOutside6
  xpos -1140
  ypos -706
 }
 Position {
  translate {6 {parent.Position2.translate.y-input.height}}
  name Position8
  xpos -1140
  ypos -682
 }
 Dot {
  name Dot28
  xpos -1106
  ypos -654
 }
push $N676e6800
 Dot {
  name Dot4
  xpos -886
  ypos -1086
 }
set N6764f400 [stack 0]
 Rectangle {
  replace true
  area {0 0 6 {height}}
  name Rectangle1
  xpos -810
  ypos -1089
 }
 BlackOutside {
  name BlackOutside5
  xpos -810
  ypos -1041
 }
push $N6764f400
 Radial {
  inputs 1+1
  replace true
  area {-5422 -3542 7470 5590}
  softness 0
  ramp linear
  color {0.0719 0.02604 0.0001 1}
  p1 {0 0}
  color0 {0.039378 0.001097 0.188331 1}
  p0 {0 2048}
  name Radial1
  xpos -920
  ypos -1041
 }
 Dot {
  name Dot9
  xpos -886
  ypos -894
 }
push $N676e6c00
 Gamma {
  channels rgba
  value 0.5
  name Gamma2
  xpos -700
  ypos -1120
 }
 Expression {
  temp_name0 start
  temp_expr0 360
  temp_name1 end
  temp_expr1 830
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 r*(end-start)+start
  channel1 none
  channel2 none
  expr3 1
  name Expression2
  label "360nm to 830nm"
  xpos -700
  ypos -1096
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 6.97e-06 7.81e-06 8.77e-06 9.84e-06 1.104e-05 1.239e-05 1.389e-05 1.556e-05 1.744e-05 1.958e-05 2.202e-05 2.484e-05 2.804e-05 3.153e-05 3.522e-05 3.9e-05 4.283e-05 4.691e-05 5.159e-05 5.718e-05 6.4e-05 7.234e-05 8.221e-05 9.351e-05 0.00010614 0.00012 0.00013498 0.00015149 0.00017021 0.00019182 0.000217 0.00024691 0.00028124 0.00031852 0.00035727 0.000396 0.00043371 0.00047302 0.00051788 0.00057222 0.00064 0.00072456 0.0008255 0.00094116 0.00106988 0.00121 0.00136209 0.00153075 0.00172037 0.00193532 0.00218 0.0024548 0.002764 0.0031178 0.0035264 0.004 0.00454624 0.00515932 0.00582928 0.00654616 0.0073 0.00808651 0.00890872 0.00976768 0.01066443 0.0116 0.01257317 0.01358272 0.01462968 0.01571509 0.01684 0.01800736 0.01921448 0.02045392 0.02171824 0.023 0.02429461 0.02561024 0.02695857 0.02835125 0.0298 0.03131083 0.03288368 0.03452112 0.03622571 0.038 0.03984667 0.041768 0.043766 0.04584267 0.048 0.05024368 0.05257304 0.05498056 0.05745872 0.06 0.06260197 0.06527752 0.06804208 0.07091109 0.0739 0.077016 0.0802664 0.0836668 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name ColorLookup4
  label "CIE 1931 2 Degree Standard Observer\n360nm to 830nm"
  xpos -700
  ypos -1030
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeLineOfPurples
  xpos -700
  ypos -897
  disable {{!parent.draw_line_of_purples}}
 }
 Fill {
  color {0 0 0 1}
  name Disable_SpectralLocus
  xpos -700
  ypos -826
  disable {{parent.draw_spectral_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePlanckianLocus
  xpos -700
  ypos -658
  disable {{!parent.draw_planckian_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut
  xpos -700
  ypos -489
  disable {{!parent.draw_pointers_gamut}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut_Samples
  xpos -700
  ypos -417
  disable {{!draw_pointers_samples}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeMacbeth
  xpos -700
  ypos -273
  disable {{!parent.draw_macbeth_chart}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutGrid
  xpos -700
  ypos -81
  disable {{!parent.gamut_grid}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutA
  xpos -700
  ypos 255
  disable {{!parent.gamut_a}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutB
  xpos -700
  ypos 279
  disable {{!parent.gamut_b}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutC
  xpos -700
  ypos 303
  disable {{!parent.gamut_c}}
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 450
 }
set N675de800 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 450
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace6
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -590
  ypos 488
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression5
  label "CIE Yxy to CIELuv"
  xpos -590
  ypos 536
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 618
 }
push $N675de800
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  invert true
  name ColorMatrix1
  label "XYZ to working"
  xpos -700
  ypos 488
  disable {{!map_overlays_to_input_gamut}}
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_grid\" iterate pixelWise b2e7b5f8a89bdb0629aa8cc2eae387ef3436f24cb0af642eeba41235874506c4 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 6 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== \"draw_axes\" Bool 1 AA== \"grid_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 6 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 \"draw_axes\" 1 1 \"grid_color\" 4 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_grid : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n  bool draw_axes;\n  float4 grid_color;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  void draw_grid() \{\n    // grid width in pixels. expresses a 0 to 1 range in CIE xy\n    float grid_width = 1.0f * outsize + offset;\n    // draw grid lines\n    float i = offset;\n    while (i <= grid_width && i > 0.0f) \{\n      write_aa(offset, i, grid_color);\n      write_aa(i, offset, grid_color);\n      i += 1.0;\n    \}\n    // cross-hatching interval in pixels\n    float hatch_interval = (grid_width - offset) * 0.1f;\n    // cross-hatch length in pixels\n    float hatch_width = outsize * 0.01f;\n    i = offset;\n    while (i <= grid_width) \{\n      i += hatch_interval;\n      float j = 0.0;\n      while (j <= hatch_width/2) \{\n        write_aa(offset+j, i, grid_color);\n        write_aa(offset-j, i, grid_color);\n        write_aa(i, offset+j, grid_color);\n        write_aa(i, offset-j, grid_color);\n        j += 1.0;\n      \}\n    \}\n  \}\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n\n    // draw CIExy coordinate system axes\n    if (draw_axes && pos.x == 0 && pos.y == 0) \{\n      draw_grid();\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_grid_padding {{parent.PlotChromaticities.PlotChromaticity_padding}}
  PlotChromaticity_grid_left_margin {{parent.PlotChromaticities.PlotChromaticity_left_margin}}
  PlotChromaticity_grid_tolerance 0.8
  PlotChromaticity_grid_antialias true
  PlotChromaticity_grid_draw_axes {{parent.coordinate_system}}
  PlotChromaticity_grid_grid_color {0.15 0 0.005 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotInput2
  xpos -700
  ypos 608
 }
 FrameHold {
  firstFrame 1
  name FrameHold1
  xpos -700
  ypos 680
  cached true
 }
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 762
 }
 Input {
  inputs 0
  name Input
  xpos 620
  ypos -1426
 }
 AddChannels {
  name AddChannels1
  xpos 620
  ypos -1360
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat
  xpos 620
  ypos -1282
  disable {{!parent.resample_input}}
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name CropBBox
  xpos 620
  ypos -1257
 }
 Dot {
  name Dot7
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 162
 }
set N67577000 [stack 0]
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "256 256 0 0 256 256 1 square_256"
  name Constant2
  xpos 400
  ypos 38
  postage_stamp false
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat1
  xpos 400
  ypos 64
  disable {{!parent.resample_input}}
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input0]"}}
  name Switch1
  xpos 400
  ypos 158
 }
 Fill {
  output rgb
  color 0.18
  name SampleColor
  xpos 290
  ypos 158
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name Crop2
  xpos 290
  ypos 184
 }
 Fill {
  output alpha
  name Fill3
  xpos 290
  ypos 224
 }
 Dot {
  name Dot6
  xpos 324
  ypos 282
 }
set N67575400 [stack 0]
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  name ColorMatrix4
  label "working to XYZ"
  xpos 180
  ypos 272
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace1
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 180
  ypos 320
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression6
  label "CIE Yxy to CIELuv"
  xpos 180
  ypos 368
  disable {{!parent.diagram}}
 }
push $N67575400
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_sample\" iterate pixelWise 20e14b615a937bac78c1a771cbdfd10cc7c5fb6c487f65d0bb2d6633e404b958 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 3 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== 3 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_sample : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  void process(int2 pos) \{\n    // only process the first pixel\n    if (pos.x > 0 && pos.y > 0) return;\n\n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    int2 p = int2(round(out_coord.x), round(out_coord.y));\n    if (dst.bounds.inside(p.x, p.y)) \{\n      for (int k=0; k<3; k++) \{\n        dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n      \}\n      dst(p.x, p.y, 3) = 1.0f;\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_sample_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_sample_left_margin {{parent.left_margin}}
  PlotChromaticity_sample_tolerance 1
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities1
  xpos 290
  ypos 368
 }
 Dot {
  name Dot22
  xpos 324
  ypos 450
 }
set N6751fc00 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048}}
  name Dilate1
  label "\[value size]"
  xpos 290
  ypos 488
 }
set N6751f800 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048*2}}
  name Dilate2
  label "\[value size]"
  xpos 180
  ypos 488
 }
push $N6751fc00
 Dot {
  name Dot21
  xpos -6
  ypos 450
 }
 FilterErode {
  channels rgba
  size {{-Output.width/2048/5}}
  filter triangle
  name FilterErode1
  label "\[value size]"
  xpos -40
  ypos 489
 }
set N6751ec00 [stack 0]
 Dilate {
  channels rgba
  size {0 {parent.Dilate3.size.w}}
  name Dilate4
  label "\[value size]"
  xpos -40
  ypos 584
 }
push $N6751ec00
 Dilate {
  channels rgba
  size {{Output.width*plus_size/100} 0}
  name Dilate3
  label "\[value size]"
  xpos 70
  ypos 488
  addUserKnob {20 User}
  addUserKnob {7 plus_size R 0 4}
  plus_size 0.8
 }
 Merge2 {
  inputs 2
  operation screen
  bbox B
  name Merge9
  xpos 70
  ypos 591
 }
 Merge2 {
  inputs 2
  operation stencil
  bbox B
  name Merge10
  xpos 180
  ypos 591
 }
 Group {
  name HueRotate
  xpos 180
  ypos 639
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -24
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos 15
  }
  Colorspace {
   colorspace_out HSV
   name Colorspace1
   xpos -40
   ypos 72
  }
  Add {
   channels {rgba.red -rgba.green -rgba.blue none}
   value 0.5
   name Add1
   xpos -40
   ypos 111
  }
  Fill {
   output {-rgba.red -rgba.green rgba.blue none}
   name Fill1
   xpos -40
   ypos 147
  }
  Colorspace {
   colorspace_in HSV
   name Colorspace2
   xpos -40
   ypos 183
  }
  Premult {
   name Premult1
   xpos -40
   ypos 231
  }
  Output {
   name Output1
   xpos -40
   ypos 302
  }
 end_group
push $N6751f800
 Merge2 {
  inputs 2
  bbox B
  name Merge8
  xpos 290
  ypos 638
 }
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 690
 }
push $N67577000
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 162
 }
 Group {
  name GamutToXYZ
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos 730
  ypos 247
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 730
  ypos 296
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression4
  label "CIE Yxy to CIELuv"
  xpos 730
  ypos 344
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot13
  label " Pos"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 546
 }
push $N67577000
 Dot {
  name Dot16
  label " Col"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 450
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity\" iterate pixelWise 3e86399c7642fe5c35c23528a644f88a8bf13f967de084ae6842f8be55098c6b 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 4 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== 4 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_left_margin {{parent.left_margin}}
  PlotChromaticity_tolerance 2
  PlotChromaticity_antialias true
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities
  xpos 620
  ypos 536
  disable {{!parent.plot_input}}
 }
 Fill {
  color 0
  name BLACK
  tile_color 0x111111ff
  xpos 620
  ypos 591
  disable {{parent.plot_input}}
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge7
  xpos 620
  ypos 686
  disable {{!parent.enable_sample_color}}
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 620
  ypos 758
 }
 Output {
  name Output
  xpos 620
  ypos 1046
 }
end_group
set N66f77200 [stack 0]
Write {
 file /Users/afry/GitHub/nukeZCAM/images/comparisons/ZCAMishDRTv03_709andAP1Arcs_v001.jpg
 file_type jpeg
 checkHashOnRead false
 version 3
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write13
 xpos 2849
 ypos 2249
}
push $N5eb08f00
Gamma {
 value 3.4
 name Gamma4
 xpos 1881
 ypos 2077
 disable true
}
Expression {
 expr0 "y==floor(r(x, pos.y)*height*mult)?1:0"
 expr1 "y==floor(g(x, pos.y)*height*mult)?1:0"
 expr2 "y==floor(b(x, pos.y)*height*mult)?1:0"
 channel3 alpha
 name PlotScanline4
 xpos 1894
 ypos 2175
 addUserKnob {20 User}
 addUserKnob {12 pos}
 addUserKnob {7 mult R 0 5}
 mult 1
}
push $N60c87200
Gamma {
 value 3.4
 name Gamma3
 xpos 1754
 ypos 2154
 disable true
}
Expression {
 expr0 "y==floor(r(x, pos.y)*height*mult)?1:0"
 expr1 "y==floor(g(x, pos.y)*height*mult)?1:0"
 expr2 "y==floor(b(x, pos.y)*height*mult)?1:0"
 channel3 alpha
 name PlotScanline5
 xpos 1747
 ypos 2186
 addUserKnob {20 User}
 addUserKnob {12 pos}
 pos {0 970}
 addUserKnob {7 mult R 0 5}
 mult 1
}
Copy {
 inputs 2
 from0 rgba.red
 to0 rgba.red
 name Copy4
 xpos 1830
 ypos 2219
}
Rectangle {
 area {{width/2-1} 0 {width/2+1} {height}}
 color 0.05
 name Rectangle2
 xpos 1830
 ypos 2251
}
Read {
 inputs 0
 file_type exr
 file /Users/afry/Downloads/HdM-HDR-2014_Original-HDR-Camera-Footage/beerfest_lightshow_04_reconstruction_update_2015/beerfest_lightshow_04_######.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 first 3467
 last 3984
 origfirst 3467
 origlast 3984
 origset true
 name Read91
 xpos 4577
 ypos 1138
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Linear - ALEXA Wide Gamut"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace27
 xpos 4577
 ypos 1218
}
Group {
 name ZCAMishDRT4
 xpos 4577
 ypos 1242
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 illuminant_in l "" -STARTLINE T Colorspace30.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T Colorspace30.primary_in}
 addUserKnob {26 ""}
 addUserKnob {41 inverseData1 l "Inverse Data 1" T ZCAM11.inverseData1}
 addUserKnob {41 thr T clipToLimit1.thr}
 addUserKnob {26 ""}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
}
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JCh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2070
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read64
  xpos 553
  ypos 229
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace1
  xpos 553
  ypos 309
 }
 Multiply {
  value 100
  name Multiply3
  label "Mult by 100 to put in absolute nits"
  xpos 553
  ypos 333
 }
 Group {
  name ZCAM1
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 553
  ypos 375
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N677b7800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N677b6400 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N677b6400
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N67793200 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N67793200
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N677b4800 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N677b4400 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N677b4800
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N67753400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N67753000 [stack 0]
push $N677b4800
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N67752c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N67752800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N67752400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N67752000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N677b4400
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N677b4800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N677b4800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N677b4800
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N677b7800
push $N677b4400
push $N67753400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N67750400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N67750400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N677b4400
push $N67753000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N67ae2c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N67ae2c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N677b4400
push $N67752c00
push $N67753400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N67ae1400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N67ae1000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N67ae1000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N67752400
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N67ae1400
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N67752400
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N67752000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N67ae1400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N67753000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N67752800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N67753400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N67752c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N677b4400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N677b7800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6799b800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6799ac00 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6799ac00
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N67999400 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N67998800 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N67998800
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N67998800
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N67947400 [stack 0]
push $N67947400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N67999400
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N67944800 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N67944800
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N67944800
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N67943200 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N678f3400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N67943200
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N678f2c00 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N67943200
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N678f2000 [stack 0]
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N678f1400 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N67942b00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N678f3400
push $N678f2c00
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N67893400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N67893400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N67942b00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N67891400 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N67891400
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N67941d00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N67941d00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6799b800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6799b800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6799b800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N67942b00
push $N6799b800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N67999400
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N678f2000
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N678f1400
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N67943200
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode1
  xpos 553
  ypos 428
 }
set N67bbb000 [stack 0]
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -455
 }
 Colorspace {
  primary_in ACES
  colorspace_out CIE-XYZ
  name Colorspace30
  label "ACES to XYZ"
  xpos 1344
  ypos -402
 }
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos -370
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos -306
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N67bb9800 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N67bb8400 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N67bb8400
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N67b23900 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N67b23900
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N67b42400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N67b42000 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N67b42400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N67b41400 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N67b41000 [stack 0]
push $N67b42400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N67b40c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N67b40800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N67b40400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N67ec3c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N67b42000
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N67b42400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N67b42400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N67b42400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N67bb9800
push $N67b42000
push $N67b41400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N67ec2000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N67ec2000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N67b42000
push $N67b41000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N67ec0c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N67ec0c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N67b42000
push $N67b40c00
push $N67b41400
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N67e63000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N67e62c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N67e62c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N67b40400
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N67e63000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N67b40400
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N67ec3c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N67e63000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N67b41000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N67b40800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N67b41400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N67b40c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N67b42000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N67bb9800
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N67d7d800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N67d7cc00 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N67d7cc00
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N67d23000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N67d22400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N67d22400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N67d22400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N67d21400 [stack 0]
push $N67d21400
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N67d23000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N67cc6400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N67cc6400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N67cc6400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N67c9b900 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N67cc5400 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N67c9b900
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N67cc4c00 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N67c9b900
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N67c6fc00 [stack 0]
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N67c6f000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N67c9b200 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N67cc5400
push $N67cc4c00
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N67c6d400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N67c6d400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N67c9b200
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N67ffb000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N67ffb000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N67c9a400 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N67c9a400
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N67d7d800
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N67d7d800
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N67d7d800
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N67c9b200
push $N67d7d800
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N67d23000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N67c6fc00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N67c6f000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N67c9b900
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N67b9eb00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle1
  xpos 1501
  ypos -229
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply1
  label "Div by 100 to go from nits"
  xpos 1501
  ypos -205
 }
 ColorLookup {
  channels all
  lut {master {curve x0.02407439426 0 x0.04948588461 5.620706361e-06 x0.0808724314 5.995634638e-05 x0.1089436561 0.0002520732232 x0.1538826674 0.0009655252215 x0.1705526412 0.001552375033 x0.1965807676 0.003411091166 x0.2212548852 0.005432802252 x0.2435974032 0.008078291081 x0.2744711637 0.01258628722 x0.335355252 0.02872310206 x0.3656598926 0.0391706787 x0.4067366123 0.05722413212 x0.451582104 0.08477441967 x0.5436673164 0.1626682729 x0.6915633678 0.3178558648 x0.7352961302 0.3736175299 x0.8164004087 0.4692641795 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup2
  xpos 1501
  ypos -163
 }
 Gamma {
  value 2.2
  name Gamma1
  xpos 1501
  ypos -131
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply2
  label "Mult by 100 to put in absolute nits"
  xpos 1501
  ypos -99
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle2
  xpos 1501
  ypos -57
 }
push $N67b9eb00
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1350
  ypos -21
 }
 Dot {
  name Dot13
  xpos 1384
  ypos 90
 }
set N67f33000 [stack 0]
 Dot {
  name Dot2
  xpos 739
  ypos 119
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle3
  xpos 705
  ypos 186
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_C
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_C.green 1 1 rgba.green 0 1"
  name Shuffle4
  xpos 705
  ypos 210
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle5
  xpos 705
  ypos 234
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy1
  xpos 705
  ypos 424
 }
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit1
  xpos 705
  ypos 456
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle6
  xpos 705
  ypos 480
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.green 0 1 zcam_C.alpha 0 3"
  name Shuffle7
  xpos 705
  ypos 504
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read68
  xpos 829
  ypos 237
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 829
  ypos 317
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 829
  ypos 341
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 829
  ypos 383
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N682a7400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N682a6000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N682a6000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N682b9600 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N682b9600
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N682a4400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N68253c00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N682a4400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N68253000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N68252c00 [stack 0]
push $N682a4400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N68252800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N68252400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N68252000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N68251c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N68253c00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N682a4400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N682a4400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N682a4400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N682a7400
push $N68253c00
push $N68253000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N681dbc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N681dbc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N68253c00
push $N68252c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N681da800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N681da800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N68253c00
push $N68252800
push $N68253000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N681d9000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N681d8c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N681d8c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N68252000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N681d9000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N68252000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N68251c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N681d9000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N68252c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N68252400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N68253000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N68252800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N68253c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N682a7400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N68087400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N68086800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N68086800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N68085000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N68084400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N68084400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N68084400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6803b000 [stack 0]
push $N6803b000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N68085000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N68038400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N68038400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N68038400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N681d5600 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N683df000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N681d5600
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N683de800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N681d5600
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N683ddc00 [stack 0]
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N683dd000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N681d4f00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N683df000
push $N683de800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N68387000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N68387000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N681d4f00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N68385000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N68385000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N681d4100 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N681d4100
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N68087400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N68087400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N68087400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N681d4f00
push $N68087400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N68085000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N683ddc00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N683dd000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N681d5600
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 829
  ypos 436
 }
push $N67f33000
 Dot {
  name Dot1
  xpos 1015
  ypos 127
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 432
 }
set N686ad800 [stack 0]
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit
  xpos 981
  ypos 464
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.765
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 981
  ypos 488
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 981
  ypos 512
 }
push $N67f33000
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1354
  ypos 569
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy2
  xpos 1354
  ypos 611
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1354
  ypos 663
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 C,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N68627400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N68626000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N68626000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6862e400 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6862e400
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N68624400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N685cbc00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N68624400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N685cb000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N685cac00 [stack 0]
push $N68624400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N685ca800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N685ca400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N685ca000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N685c9c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N685cbc00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N68624400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N68624400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N68624400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N68627400
push $N685cbc00
push $N685cb000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6855bc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6855bc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N685cbc00
push $N685cac00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6855a800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6855a800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N685cbc00
push $N685ca800
push $N685cb000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N68559000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N68558c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N68558c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N685ca000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N68559000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N685ca000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N685c9c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N68559000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N685cac00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N685ca400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N685cb000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N685ca800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N685cbc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N68627400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N68807400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N68806800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N68806800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N68805000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N68804400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N68804400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N68804400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N687bb000 [stack 0]
push $N687bb000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N68805000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N687b8400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N687b8400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N687b8400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N687ee400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6876b000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N687ee400
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6876a800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N687ee400
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N68769c00 [stack 0]
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N68769000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N687edd00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6876b000
push $N6876a800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N68aff000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N68aff000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N687edd00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N68afd000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N68afd000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N687ecf00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N687ecf00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N68807400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N68807400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N68807400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N687edd00
push $N68807400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N68805000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N68769c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N68769000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N687ee400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1354
  ypos 715
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1354
  ypos 757
 }
 Colorspace {
  colorspace_in CIE-XYZ
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1354
  ypos 781
 }
 Output {
  name Output1
  xpos 1354
  ypos 888
 }
push $N67bbb000
push $N686ad800
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {-0.20703125 -0.3359375 -0.205078125 -0.333984375}
  name Viewer1
  xpos 409
  ypos 450
 }
end_group
Constant {
 inputs 0
 channels rgb
 color {100 {frame/1023*100} 0 0}
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Constant9
 xpos -666
 ypos 987
}
Expression {
 expr0 (y/(height-1))*r
 expr2 cx*180
 name Expression25
 xpos -666
 ypos 1098
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.red 0 0 zcam_J.blue 0 2 rgba.red 0 0 zcam_J.alpha 0 3"
 name Shuffle49
 xpos -666
 ypos 1122
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_M
 fromInput2 {{0} B}
 mappings "4 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
 name Shuffle50
 xpos -666
 ypos 1168
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_h
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.red 0 0 rgba.blue 0 2 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.alpha 0 3"
 name Shuffle51
 xpos -666
 ypos 1192
}
Group {
 name ZCAM17
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -666
 ypos 1244
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N689a3c00 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N689a2800 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N689a2800
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N689add00 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N689add00
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N689a0c00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N689a0800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N689a0c00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N68943800 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N68943400 [stack 0]
push $N689a0c00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N68943000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N68942c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N68942800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N68942400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N689a0800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N689a0c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N689a0c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N689a0c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N689a3c00
push $N689a0800
push $N68943800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N68940800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N68940800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N689a0800
push $N68943400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N688bf000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N688bf000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N689a0800
push $N68943000
push $N68943800
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N688bd800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N688bd400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N688bd400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N68942800
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N688bd800
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N68942800
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N68942400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N688bd800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N68943400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N68942c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N68943800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N68943000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N689a0800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N689a3c00
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N68b73c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N68b73000 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N68b73000
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N68b71800 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N68b70c00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N68b70c00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N68b70c00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N68b2f800 [stack 0]
push $N68b2f800
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N68b71800
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N68b2cc00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N68b2cc00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N68b2cc00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N688d9d00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2710
 }
set N68ee3800 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N688d9d00
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2032
  ypos 2710
 }
set N68ee3000 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N688d9d00
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N68ee2400 [stack 0]
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N68ee1800 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N688d9600 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1814
  ypos 2705
 }
push $N68ee3800
push $N68ee3000
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  selected true
  xpos -1543
  ypos 2822
 }
set N68ee0800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2985
 }
set N68e73800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N68e73800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N688d9600
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N68e71800 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N68e71800
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N688d8800 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N688d8800
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N68b73c00
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N68b73c00
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N68b73c00
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N688d9600
push $N68b73c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N68b71800
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N68ee2400
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N68ee1800
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N688d9d00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
push $N68ee3000
push $N68ee0800
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {0.00390625 -0.1640625 0.005859375 -0.162109375}
  name Viewer1
  xpos -2115
  ypos 2819
 }
end_group
Multiply {
 value 0.01
 name Multiply29
 label "Div by 100 to go from nits"
 xpos -666
 ypos 1326
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle52
 xpos -666
 ypos 1368
}
Colorspace {
 colorspace_in CIE-XYZ
 primary_out DCI-P3
 name Colorspace42
 label "XYZ to sRGB Prims"
 xpos -666
 ypos 1392
}
Dot {
 name Dot22
 xpos -632
 ypos 1441
}
set N68d9a800 [stack 0]
Dot {
 name Dot23
 xpos -505
 ypos 1467
}
set N68d9a400 [stack 0]
Expression {
 channel0 rgba
 expr0 min((r<0?0:1),(g<0?0:1),(b<0?0:1))
 name Expression26
 xpos -582
 ypos 1492
}
push $N68d9a400
Expression {
 channel0 rgba
 expr0 min((r>1?0:1),(g>1?0:1),(b>1?0:1))
 name Expression27
 xpos -477
 ypos 1490
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply30
 xpos -540
 ypos 1522
}
push $N68d9a800
Copy {
 inputs 2
 from0 rgba.alpha
 to0 rgba.alpha
 name Copy7
 xpos -666
 ypos 1578
}
Premult {
 name Premult4
 xpos -666
 ypos 1610
}
Dot {
 name Dot24
 xpos -632
 ypos 1717
}
Read {
 inputs 0
 file_type exr
 file "\[value Write15.file]"
 origset true
 version 4120
 name Read92
 xpos -518
 ypos 1671
}
Merge2 {
 inputs 2
 name Merge3
 xpos -518
 ypos 1790
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_P3gamutBound_tempImg.exr
 file_type exr
 first_part rgba
 version 4124
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write15
 xpos -518
 ypos 1828
 addUserKnob {20 User}
 addUserKnob {22 recursiveWrite T "writeNode = nuke.thisNode()\nmergeNode = writeNode.input(0)\nreadNode = writeNode.input(0).input(0)\n\nwriteNode.setInput(0,writeNode.input(0).input(1))\nnuke.execute(writeNode, 0, 0)\nreadNode.knob('reload').execute()\nwriteNode.setInput(0,mergeNode)\n\n\nfor i in range(0,1024):\n    nuke.execute(writeNode, i, i)\n    readNode.knob('reload').execute()" +STARTLINE}
}
push $N60c87200
Reformat {
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Reformat15
 xpos 989
 ypos 2182
}
Group {
 name PlotChromaticity4
 xpos 982
 ypos 2235
 addUserKnob {20 PlotChromaticity_tab l PlotChromaticity}
 addUserKnob {6 use_gpu l "Use GPU if available" +STARTLINE}
 use_gpu true
 addUserKnob {26 ""}
 addUserKnob {6 plot_input l "plot input" t "Enable plotting of the input pixels" +STARTLINE}
 plot_input true
 addUserKnob {41 input_gamut l gamut t "Set the gamut that the input colors are encoded in" -STARTLINE T GamutToXYZ.gamut}
 addUserKnob {4 diagram l in t "Choose the type of chromaticity diagram: \nCIE 1931 xy Chromaticity Diagram\nCIE 1976 u' v' Uniform Chromaticity Scale Diagram" -STARTLINE M {"CIE 1931 xy" "CIE 1976 u' v'" "" ""}}
 addUserKnob {6 enable_sample_color l "sample color" t "Enable plotting of the sampled color" +STARTLINE}
 enable_sample_color true
 addUserKnob {41 sample_color l color t "sample and plot selected color" T SampleColor.color}
 addUserKnob {22 follow_viewer l "follow viewer" t "Follow the selected viewer node. This causes this node to automatically connect to whatever the followed viewer is connected to.\n\nThis is useful if you want to have a 2nd viewer showing a chromaticity plot for whever you're looking at in your main viewer." T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to follow.')\nelse:\n    v\['knobChanged'].setValue('v = nuke.activeViewer().node()\\nif v and v.name() == nuke.thisNode().name():\\n    con = v.input(nuke.activeViewer().activeInput())\\n    plt = nuke.toNode(\"\{0\}\")\\n    plt.setInput(0, con)'.format(n.name()))" +STARTLINE}
 addUserKnob {22 unfollow_viewer l "unfollow viewer" -STARTLINE T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to unfollow.')\nelse:\n    v\['knobChanged'].setValue('')"}
 addUserKnob {26 plot_dimensions_label l " " T "<b>Chromaticity Diagram"}
 addUserKnob {3 resolution l " resolution" t "resolution to output"}
 resolution 2048
 addUserKnob {7 right_margin l "right margin" R 1 1.5}
 right_margin 1.1
 addUserKnob {7 left_margin l "left margin" R 0 0.2}
 left_margin 0.1
 addUserKnob {6 draw_spectral_locus l "spectrum locus" t "draw the spectrum locus: the boundary of color the human eye can see." +STARTLINE}
 draw_spectral_locus true
 addUserKnob {6 draw_line_of_purples l "line of purples" t "draw the \"line of purples\"" -STARTLINE}
 draw_line_of_purples true
 addUserKnob {6 draw_planckian_locus l "planckian locus" t "Display the planckian locus or the blackbody locus." +STARTLINE}
 addUserKnob {6 gamut_grid l "gamut grid" t "Display a gamut boundary with a grid or dot pattern" +STARTLINE}
 addUserKnob {41 gamut_gamutgrid l "" t "gamut for gamutgrid" -STARTLINE T RGBToXYZ_GamutGrid.gamut}
 addUserKnob {4 gamut_grid_style l style t "Choose the style to display the gamut plot" -STARTLINE M {grid dots "" "" "" ""}}
 addUserKnob {4 distribution l dist t "Which chromaticity space should the overlays be constructed in? \n\nYxy is familiar, but not very perceptually uniform.\n\nu'v' is designed to be more perceptually uniform." -STARTLINE M {"1931 Yxy" "1976 u'v'" "" ""}}
 addUserKnob {7 density t "Density of the grid or points" R 10 100}
 density 50
 addUserKnob {6 gamut_a l "gamut a" t "Display a gamut outline" +STARTLINE}
 gamut_a true
 addUserKnob {41 gamut_a_1 l "" -STARTLINE T RGBToXYZ_GamutA.gamut}
 addUserKnob {6 gamut_b l "gamut b" t "Display a gamut outline" +STARTLINE}
 gamut_b true
 addUserKnob {41 gamut_b_1 l "" -STARTLINE T RGBToXYZ_GamutB.gamut}
 addUserKnob {6 gamut_c l "gamut c" t "Display a gamut outline" +STARTLINE}
 gamut_c true
 addUserKnob {41 gamut_c_1 l "" -STARTLINE T RGBToXYZ_GamutC.gamut}
 addUserKnob {6 draw_pointers_gamut l "pointer's gamut" t "DrawPointer's gamut boundary" +STARTLINE}
 addUserKnob {6 draw_pointers_samples l "pointers sample colors" t "show the individual pointer gamut samples" -STARTLINE}
 addUserKnob {6 draw_macbeth_chart l "macbeth chart" t "draw a ColorChecker24 aka Macbeth Chart" +STARTLINE}
 addUserKnob {6 coordinate_system l "coordinate system" t "Draw CIE xy coordinate grid x and y axes" +STARTLINE}
 coordinate_system true
 addUserKnob {6 map_overlays_to_input_gamut l "map overlays to input gamut" t "This maps the overlays like the spectral locus, pointer's gamut, and the gamut overlay to the working gamut instead of keeping them as XYZ.\n\nFor example if the input gamut is ACEScg, these overlays will be mapped to that. Note that this can cause most of the overlays to be negative or highly saturated which might harm the visual appearance." +STARTLINE}
 map_overlays_to_input_gamut true
}
 Group {
  inputs 0
  name GamutGrid1
  xpos -920
  ypos -201
  postage_stamp true
  addUserKnob {20 GamutGrid}
  addUserKnob {3 style}
  style {{!parent.gamut_grid_style}}
  addUserKnob {3 distribution -STARTLINE}
  distribution {{parent.distribution}}
  addUserKnob {7 density R 10 150}
  density {{parent.density}}
  addUserKnob {26 ""}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {12 wxy}
  wxy {{parent.RGBToXYZ_GamutGrid.wxy} {parent.RGBToXYZ_GamutGrid.wxy}}
 }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   centerSaturation 1
   fillFormat false
   area {-170 -158 682 670}
   name ColorWheel4
   xpos -260
   ypos -15
   postage_stamp false
  }
  Crop {
   box {0 0 {width} {height}}
   crop false
   name Crop2
   xpos -260
   ypos 27
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat3
   xpos -260
   ypos 110
  }
set N68d22800 [stack 0]
push $N68d22800
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   roworder TopBottom
   name ContactSheet2
   xpos -260
   ypos 169
  }
  Dot {
   name Dot1
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -226
   ypos 246
  }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   fillFormat false
   area {40 40 472 472}
   name ColorWheel1
   xpos -40
   ypos -664
   postage_stamp false
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat1
   xpos -40
   ypos -628
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   name Crop1
   xpos -40
   ypos -602
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos -526
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos -415
  }
  Colorspace {
   colorspace_in CIE-XYZ
   colorspace_out CIE-Yxy
   name Colorspace1
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -341
  }
set N68cbbc00 [stack 0]
  Dot {
   name Dot2
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos -331
  }
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression5
   label "CIE Yxy to CIELuv"
   xpos -590
   ypos -304
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 "(-(degrees(atan2(g-white.x, b-white.y))-180)+270)%360/360"
   expr2 "hypot(g-white.x, b-white.y)"
   expr3 a
   name Expression3
   xpos -590
   ypos -261
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{"parent.distribution ? 4*parent.wxy.x / ( -2 * parent.wxy.x + 12 * parent.wxy.y + 3) : parent.wxy"} {"parent.distribution ? 9*parent.wxy.y / ( -2*parent.wxy.x + 12*parent.wxy.y + 3) : parent.wxy"}}
  }
set N68cbb000 [stack 0]
  Posterize {
   channels rgb
   Colors {{rint(parent.density/3*2)}}
   name Posterize1
   xpos -590
   ypos -191
  }
set N68cbac00 [stack 0]
push $N68cbb000
  Dot {
   name Dot15
   xpos -446
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy1
   xpos -480
   ypos -154
  }
push $N68cbac00
push $N68cbb000
  Dot {
   name Dot16
   xpos -666
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy2
   xpos -700
   ypos -153
  }
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   center true
   roworder TopBottom
   name ContactSheet3
   xpos -590
   ypos -106
  }
  Expression {
   expr0 r
   expr1 cos(radians(g*360))*b+white.x
   expr2 sin(radians(g*360))*b+white.y
   expr3 a
   name Expression19
   xpos -590
   ypos -58
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{parent.Expression3.white} {parent.Expression3.white}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression2
   label "CIELuv to CIE Yxy"
   xpos -590
   ypos -16
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace2
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -590
   ypos 32
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix1
   label "XYZ to RGB"
   xpos -590
   ypos 81
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin2
   xpos -590
   ypos 119
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp1
   xpos -590
   ypos 152
  }
  Premult {
   name Premult1
   xpos -590
   ypos 194
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge2
   xpos -590
   ypos 242
  }
  Fill {
   output alpha
   name Fill1
   xpos -590
   ypos 297
  }
  Dot {
   name Dot3
   label " GRID"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos 378
  }
push $N68d22800
push $N68cbbc00
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression4
   label "CIE Yxy to CIELuv"
   xpos -40
   ypos -280
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 rint(g*Colors)/Colors
   expr2 rint(b*Colors)/Colors
   expr3 a
   name Expression1
   label rint
   xpos -40
   ypos -232
   addUserKnob {20 User}
   addUserKnob {7 Colors R 1 256}
   Colors {{parent.density}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression6
   label "CIELuv to CIE Yxy"
   xpos -40
   ypos -184
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace3
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -112
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix3
   label "XYZ to RGB"
   xpos -40
   ypos -57
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp4
   xpos -40
  }
  Premult {
   name Premult2
   xpos -40
   ypos 55
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge1
   xpos -40
   ypos 110
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin1
   xpos -40
   ypos 273
  }
  Dot {
   name Dot4
   label " DOTS"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 378
  }
  Switch {
   inputs 2
   which {{parent.style}}
   name Switch1
   xpos -257
   ypos 483
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix2
   label "RGB to XYZ"
   xpos -257
   ypos 560
  }
  Output {
   name Output
   xpos -257
   ypos 740
  }
  ColorWheel {
   inputs 0
   format "256 256 0 0 256 256 1 square_256"
   area {40 40 472 472}
   name ColorWheel2
   xpos -37
   ypos -705
   postage_stamp false
  }
 end_group
set N68df4100 [stack 0]
 Group {
  name RGBToXYZ_GamutGrid
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos -184
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorWheel {
  inputs 0
  format "512 512 0 0 512 512 1 square_512"
  centerSaturation 1
  fillFormat false
  area {-196 -184 708 696}
  name ColorWheel1
  xpos -920
  ypos 5
 }
 Crop {
  box {0 0 {width} {height}}
  name Crop1
  xpos -920
  ypos 87
 }
 BlackOutside {
  name BlackOutside3
  xpos -920
  ypos 134
 }
set N68fc5c00 [stack 0]
 Group {
  name RGBToXYZ_GamutC
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1140
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r+input.width} {parent.ReformatBox4.box_width-input.height}}
  name Position6
  xpos -1140
  ypos 254
 }
push $N68fc5c00
 Group {
  name RGBToXYZ_GamutB
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height*2}}
  name Position5
  xpos -1030
  ypos 254
 }
push $N68fc5c00
 Group {
  name RGBToXYZ_GamutA
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -920
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position4
  xpos -920
  ypos 254
 }
push $N68df4100
 Reformat {
  type scale
  scale 0.8
  turn true
  filter impulse
  black_outside true
  name Reformat2
  xpos -920
  ypos -129
 }
 BlackOutside {
  name BlackOutside2
  xpos -920
  ypos -106
 }
 Position {
  translate {{Rectangle1.area.r} {parent.Position3.translate.y-input.height}}
  name Position2
  xpos -920
  ypos -81
 }
 Group {
  inputs 0
  name ColorChecker24_After_November_2014
  label "CIE XYZ D50"
  xpos -920
  ypos -352
  addUserKnob {20 colorchecker_tab l "ColorChecker24 - After November 2014"}
  addUserKnob {3 patch_resolution}
  patch_resolution 48
 }
  Group {
   inputs 0
   name bluish_green
   selected true
   xpos 622
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.30451114 0.4143554688 0.344352688 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "bluish green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 6
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_flower
   xpos 512
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2419823988 0.2287175998 0.3282104382 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue flower"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 5
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name foliage
   xpos 402
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1114392339 0.1346792679 0.05239320311 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob foliage
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 4
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_sky
   xpos 292
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1652470004 0.1785519348 0.2546024121 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue sky"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 3
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name light_skin
   xpos 180
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3811104477 0.336202304 0.1852590702 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "light skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 2
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 135
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name dark_skin
   xpos 70
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1136398927 0.09832436105 0.047793811 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "dark skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 1
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 290
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 290
    ypos 158
   }
   Output {
    name Output
    xpos 290
    ypos 230
   }
  end_group
  Group {
   inputs 0
   name orange_yellow
   xpos 622
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4769723742 0.4293377578 0.06005041429 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "orange yellow"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 12
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow_green
   xpos 512
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3427379502 0.4331759409 0.08330791241 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "yellow green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 11
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purple
   xpos 401
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08353888545 0.06276662955 0.1042075686 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob purple
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 10
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name moderate_red
   xpos 290
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2915036416 0.188999956 0.09736350318 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "moderate red"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 9
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purplish_blue
   xpos 180
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1200518326 0.1091090233 0.2874447494 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "purplish blue"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 8
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name orange
   xpos 74
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4073691399 0.3126416159 0.05130591012 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob orange
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 7
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name cyan
   xpos 622
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1247966941 0.180609913 0.2913392383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob cyan
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 18
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name magenta
   xpos 512
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.299122798 0.1895114577 0.2213469194 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob magenta
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 17
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow
   xpos 399
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5888922356 0.5992976803 0.07077420003 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob yellow
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 16
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 182
   }
  end_group
  Group {
   inputs 0
   name red
   xpos 292
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2143728424 0.127800835 0.03868150726 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob red
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 15
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name green
   xpos 182
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1413517689 0.2233437582 0.07287461742 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob green
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 14
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue
   xpos 72
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.06809095613 0.05596214063 0.2077405936 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob blue
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 13
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name black_2
   xpos 623
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.03042544265 0.03151319431 0.02656724434 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "black 2 (1.5 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 24
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_3
   xpos 512
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08448968042 0.08817234828 0.07391630753 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 3.5 (1.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 23
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_5
   xpos 403
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1835495863 0.1906228754 0.1566717383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 5 (.70 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 22
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_6
   xpos 292
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3495921991 0.3648652066 0.3013565492 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 6.5 (.44 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 21
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_8
   xpos 179
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5665335579 0.5899709702 0.4828473821 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 8 (.23 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 20
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name white_9
   xpos 70
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.8436985288 0.8806903203 0.6936778752 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "white 9.5 (.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 19
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 134
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  ContactSheet {
   inputs 24
   width {{"rint(parent.patch_resolution * 6 + gap * 7)"}}
   height {{"rint(parent.patch_resolution * 4 + gap * 5)"}}
   rows 4
   columns 6
   startframe 1
   endframe 1
   name ContactSheet
   xpos 620
   ypos 206
  }
  Unpremult {
   name Unpremult1
   xpos 620
   ypos 278
  }
  Output {
   name Output
   xpos 620
   ypos 446
  }
 end_group
 BlackOutside {
  name BlackOutside4
  xpos -920
  ypos -298
 }
 Position {
  translate {{parent.Reformat1.box_width*3+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position7
  xpos -920
  ypos -273
 }
 Constant {
  inputs 0
  format "256 256 0 0 256 256 1 square_256"
  name Constant5
  xpos -700
  ypos -1354
  postage_stamp false
 }
 Dot {
  name Dot25
  xpos -666
  ypos -1302
 }
set N690e6000 [stack 0]
 Dot {
  name Dot27
  xpos -1546
  ypos -1302
 }
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox1
  xpos -1580
  ypos -994
 }
 Ramp {
  p0 {0 0}
  p1 {{input.width} 0}
  color {{p1}}
  name Ramp3
  xpos -1580
  ypos -898
 }
 ColorLookup {
  lut {master {}
    red {curve 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914}
    green {curve 0.433 0.464 0.513 0.611 0.576 0.46 0.426 0.412 0.404 0.397 0.384 0.374 0.346 0.333 0.311 0.287 0.257 0.23 0.21 0.219 0.208 0.211 0.208 0.187 0.191 0.187 0.18 0.164 0.17 0.177 0.175 0.188 0.252 0.325 0.385 0.416 0.433 0.487 0.532 0.588 0.637 0.634 0.549 0.506 0.49 0.458 0.426 0.412 0.397 0.365 0.337 0.301 0.262 0.221 0.192 0.164 0.167 0.162 0.176 0.179 0.148 0.156 0.142 0.148 0.138 0.145 0.145 0.161 0.197 0.256 0.324 0.393 0.451 0.487 0.508 0.538 0.587 0.634 0.659 0.611 0.552 0.526 0.484 0.452 0.428 0.406 0.371 0.334 0.293 0.243 0.204 0.177 0.151 0.151 0.162 0.158 0.161 0.142 0.141 0.129 0.134 0.14 0.156 0.166 0.192 0.221 0.265 0.325 0.392 0.451 0.508 0.48 0.513 0.554 0.597 0.63 0.634 0.58 0.546 0.499 0.466 0.434 0.408 0.372 0.332 0.288 0.242 0.202 0.179 0.16 0.157 0.162 0.157 0.159 0.149 0.153 0.147 0.154 0.164 0.18 0.199 0.226 0.25 0.279 0.325 0.38 0.439 0.48 0.436 0.468 0.502 0.541 0.57 0.605 0.594 0.555 0.511 0.473 0.439 0.409 0.371 0.332 0.288 0.252 0.217 0.196 0.181 0.178 0.185 0.176 0.173 0.168 0.176 0.178 0.19 0.202 0.214 0.235 0.254 0.27 0.291 0.323 0.366 0.41 0.436 0.396 0.414 0.438 0.465 0.485 0.527 0.566 0.557 0.523 0.478 0.442 0.409 0.371 0.334 0.294 0.265 0.244 0.223 0.225 0.212 0.218 0.211 0.211 0.207 0.214 0.217 0.229 0.237 0.244 0.264 0.275 0.285 0.3 0.321 0.348 0.376 0.396 0.357 0.368 0.377 0.391 0.402 0.431 0.481 0.503 0.521 0.482 0.444 0.409 0.372 0.337 0.307 0.286 0.27 0.257 0.247 0.251 0.257 0.255 0.254 0.25 0.258 0.259 0.265 0.269 0.278 0.284 0.292 0.297 0.305 0.317 0.33 0.344 0.357 0.321 0.322 0.328 0.332 0.333 0.346 0.365 0.389 0.411 0.459 0.443 0.399 0.352 0.327 0.313 0.304 0.3 0.294 0.295 0.294 0.293 0.292 0.291 0.295 0.3 0.301 0.302 0.304 0.304 0.304 0.305 0.307 0.309 0.312 0.313 0.316 0.321}
    blue {curve 0.26 0.281 0.298 0.306 0.342 0.365 0.39 0.381 0.392 0.416 0.413 0.43 0.448 0.446 0.433 0.425 0.419 0.394 0.362 0.328 0.305 0.298 0.286 0.247 0.26 0.219 0.199 0.168 0.178 0.14 0.11 0.084 0.104 0.158 0.18 0.225 0.26 0.235 0.26 0.28 0.298 0.327 0.372 0.395 0.417 0.43 0.435 0.455 0.488 0.479 0.521 0.522 0.515 0.49 0.436 0.383 0.331 0.295 0.282 0.258 0.219 0.208 0.179 0.168 0.141 0.129 0.106 0.094 0.095 0.112 0.127 0.165 0.199 0.235 0.226 0.258 0.28 0.298 0.316 0.361 0.399 0.427 0.446 0.461 0.482 0.52 0.521 0.553 0.563 0.573 0.524 0.454 0.389 0.33 0.295 0.266 0.247 0.214 0.195 0.168 0.178 0.142 0.14 0.128 0.129 0.126 0.131 0.144 0.167 0.199 0.226 0.238 0.266 0.289 0.31 0.329 0.351 0.395 0.428 0.453 0.475 0.494 0.533 0.542 0.568 0.584 0.576 0.53 0.451 0.385 0.331 0.299 0.266 0.245 0.22 0.206 0.184 0.174 0.167 0.166 0.166 0.173 0.172 0.165 0.172 0.187 0.208 0.238 0.258 0.28 0.3 0.321 0.343 0.362 0.391 0.427 0.458 0.482 0.503 0.546 0.554 0.573 0.582 0.546 0.499 0.431 0.375 0.33 0.304 0.275 0.254 0.234 0.225 0.212 0.209 0.206 0.203 0.21 0.215 0.212 0.204 0.208 0.214 0.231 0.258 0.277 0.294 0.31 0.328 0.348 0.372 0.397 0.427 0.462 0.487 0.51 0.544 0.558 0.559 0.556 0.503 0.444 0.402 0.355 0.329 0.309 0.289 0.275 0.26 0.254 0.245 0.245 0.241 0.238 0.249 0.249 0.245 0.241 0.242 0.246 0.258 0.277 0.295 0.305 0.315 0.327 0.339 0.359 0.39 0.421 0.461 0.491 0.515 0.54 0.546 0.522 0.478 0.429 0.393 0.368 0.345 0.325 0.313 0.303 0.295 0.286 0.284 0.279 0.277 0.274 0.277 0.277 0.28 0.276 0.273 0.274 0.279 0.285 0.295 0.311 0.314 0.316 0.32 0.323 0.331 0.346 0.367 0.397 0.468 0.513 0.494 0.425 0.388 0.372 0.348 0.336 0.331 0.326 0.32 0.316 0.314 0.312 0.309 0.321 0.32 0.319 0.305 0.317 0.316 0.316 0.315 0.316 0.317 0.319 0.321 0.311}
    alpha {}}
  name ColorLookup7
  label "Pointers Samples Yxy\nSource: https://www.rit.edu/cos/colorscience/rc_useful_data.php"
  xpos -1580
  ypos -790
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace12
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1580
  ypos -688
 }
 Fill {
  output alpha
  name Fill5
  xpos -1580
  ypos -639
 }
 BlackOutside {
  name BlackOutside7
  xpos -1580
  ypos -562
 }
 Position {
  translate {6 {parent.Position1.translate.y-input.height}}
  name Position3
  xpos -1580
  ypos -538
 }
 Dot {
  name Dot15
  xpos -1546
  ypos -414
 }
push $N690e6000
 Reformat {
  type "to box"
  box_width 2048
  box_height 2048
  box_fixed true
  name ReformatBox4
  xpos -700
  ypos -1258
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression7
  xpos -700
  ypos -1209
 }
 Dot {
  name Dot10
  xpos -666
  ypos -1158
 }
set N69096400 [stack 0]
 Dot {
  name Dot26
  xpos -886
  ypos -1158
 }
set N69096000 [stack 0]
 Dot {
  name Dot23
  xpos -1106
  ypos -1158
 }
set N69095c00 [stack 0]
 Dot {
  name Dot12
  xpos -1326
  ypos -1158
 }
 Mirror2 {
  flip true
  flop true
  name Mirror2_1
  xpos -1360
  ypos -1042
 }
 Reformat {
  type "to box"
  box_width 512
  box_height {{box_width}}
  box_fixed true
  name Reformat1
  xpos -1360
  ypos -994
 }
 Gamma {
  channels rgb
  value 2
  name Gamma1
  xpos -1360
  ypos -898
 }
 Multiply {
  channels rgb
  value 8000
  name Multiply1
  label "\[value value]"
  xpos -1360
  ypos -811
 }
 ColorLookup {
  lut {master {}
    red {curve R 0.4830000103 x50 0.5045000315 0.5260000229 0.5475000143 0.5690000057 0.5904999971 0.6119999886 0.63349998 0.6549999714 0.6805312037 0.7087500095 0.7315937281 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.75459373 0.7845000029 0.8144062757 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8009687662 0.74150002 0.6820312142 0.6549999714 0.6684374809 0.6980000138 0.7275624871 0.7409999967 0.7315937281 0.7087500095 0.6805312037 0.6549999714 0.629468739 0.6012499928 0.5784062743 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5555624962 0.5260000229 0.4964375198 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4964375198 0.5260000229 0.5555624962 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5653046966 0.5555624962 0.5417890549 0.5260000229 0.5102109313 0.4964375198 0.4866953194 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4695625007 0.4400000274 0.4104375243 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.4104375243 0.4400000274 0.4695625007 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103}
    green {curve R 0.6589999795 x50 0.6542205811 0.6484853029 0.6414804459 0.6340000033 0.6249843836 0.6147499681 0.6041406393 0.5939999819 0.5844687223 0.575124979 0.5659687519 0.5569999814 0.5484530926 0.5402500033 0.5319218636 0.5230000019 0.5131718516 0.5027499795 0.4922031164 0.4819999933 0.4722187519 0.4626249969 0.4532187581 0.4440000057 0.4351093769 0.4265000224 0.4178906381 0.4090000093 0.3997343779 0.3902499974 0.380640626 0.3709999919 0.3614374995 0.3518749774 0.3421249986 0.3319999874 0.321398437 0.3104375005 0.2992577851 0.2879999876 0.2764999866 0.2647500038 0.2531249821 0.2419999987 0.2312265635 0.2206875086 0.2108047009 0.202000007 0.1947187632 0.1886250079 0.1829687506 0.1770000011 0.1693515629 0.1608124971 0.1538671851 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1527187377 0.1564999968 0.1602812558 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1612187475 0.1595000029 0.1577812582 0.1570000052 0.1573124975 0.1579999924 0.1586875021 0.1589999944 0.1575781256 0.1543750018 0.1509843767 0.1490000039 0.1485625058 0.1484999955 0.1484375 0.1480000019 0.1467812508 0.1449999958 0.1432187557 0.1420000046 0.1415625066 0.1414999962 0.1414375007 0.1410000026 0.1397656202 0.1378750056 0.1357968748 0.1340000033 0.1323750019 0.1307500005 0.1295000017 0.1289999932 0.130031243 0.1324999928 0.1354687512 0.1379999965 0.1402187496 0.1424999982 0.1442812532 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1464921832 0.1503124982 0.1554765552 0.1609999985 0.1673984379 0.1749375015 0.1822578013 0.1879999936 0.1906718612 0.1913749874 0.1926406175 0.1969999969 0.2064140588 0.2199375033 0.2357421964 0.2520000041 0.2688750029 0.2871249914 0.3058125079 0.324000001 0.3417187631 0.359375 0.3765937686 0.3930000067 0.4082968831 0.4227499962 0.4368281364 0.451000005 0.4659531415 0.4812500179 0.4956718981 0.5080000162 0.5169296861 0.5234375 0.5297265649 0.5379999876 0.5491171479 0.5618124604 0.5751015544 0.5879999995 0.6009531021 0.6142500043 0.6266719103 0.6370000243 0.6457066536 0.6532088518 0.6575522423 0.6589999795}
    blue {curve R 0.3160000145 x50 0.324739933 0.3330312669 0.3418398499 0.351000011 0.3607422113 0.3709374964 0.3811640739 0.3910000026 0.4003046751 0.4093124866 0.4181640446 0.4269999862 0.4359609187 0.4449374974 0.453695327 0.4620000124 0.4697890878 0.4771875143 0.4842422009 0.4909999967 0.4971874952 0.5028749704 0.5086249709 0.5149999857 0.5227031112 0.53125 0.5394218564 0.5460000038 0.5502656102 0.5530000329 0.5552343726 0.5580000281 0.561632812 0.5655625463 0.5694609284 0.5730000138 0.5765469074 0.5801249743 0.5828906298 0.5839999914 0.5838750005 0.5830000043 0.5806249976 0.5759999752 0.5682968497 0.5576249957 0.5446406007 0.5299999714 0.5128515363 0.4931874871 0.4729296863 0.4539999962 0.4368359447 0.420437485 0.4045703113 0.3889999986 0.3731718659 0.3573749959 0.3426406384 0.3300000131 0.3193906248 0.310375005 0.3034218848 0.298999995 0.2972500026 0.2969999909 0.2967499793 0.2949999869 0.2899531126 0.2821249962 0.2734843791 0.2660000026 0.2602812648 0.2552500069 0.2503437698 0.2450000048 0.2380000055 0.2300000042 0.2232500017 0.2199999988 0.2195625007 0.2194999903 0.2194374949 0.2189999968 0.2183593661 0.2176249921 0.2163281292 0.2140000015 0.2101874948 0.205249995 0.1999374926 0.1949999928 0.1904453039 0.185937494 0.1817109436 0.1780000031 0.1754062474 0.1736250073 0.1715312451 0.1679999977 0.1620937437 0.1546249986 0.147093758 0.1410000026 0.1372031271 0.1347499937 0.1324218661 0.1289999932 0.1237656176 0.1174999923 0.1112343743 0.1059999987 0.1021796837 0.09918750077 0.09660156071 0.09399999678 0.09089062363 0.0876249969 0.0850468725 0.08399999887 0.08524999768 0.0882499963 0.09187500179 0.09499999881 0.09706249833 0.09875000268 0.1008125022 0.1040000021 0.1084140688 0.1136875004 0.1198671907 0.1270000041 0.1355390698 0.145312503 0.1554296911 0.1650000066 0.1739453226 0.1826875061 0.1910859346 0.199000001 0.2061250061 0.2126249969 0.2190624923 0.2259999961 0.2338827997 0.2423124909 0.2505859137 0.2579999864 0.2642968595 0.26987499 0.2750156224 0.2800000012 0.2847812474 0.2892500162 0.2935937643 0.2980000079 0.3025000095 0.3070000112 0.3115000129 0.3160000145}
    alpha {}}
  name ColorLookup5
  label "Pointer's Gamut Boundary Yxy\ninterpolated: incr 50 - 0 to 8000"
  xpos -1360
  ypos -775
 }
 Multiply {
  channels rgb
  value {0.31 1 1 1}
  name Multiply2
  label "dim boundary"
  xpos -1360
  ypos -725
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace5
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1360
  ypos -688
 }
 Fill {
  output alpha
  name Fill4
  xpos -1360
  ypos -639
 }
 BlackOutside {
  name BlackOutside1
  xpos -1360
  ypos -562
 }
 Position {
  translate {6 {ReformatBox4.box_width-input.width}}
  name Position1
  xpos -1360
  ypos -538
 }
 Dot {
  name Dot24
  xpos -1326
  ypos -486
 }
push $N69095c00
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox2
  xpos -1140
  ypos -994
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression1
  xpos -1140
  ypos -898
 }
set N69059800 [stack 0]
 Dot {
  name Dot8
  xpos -996
  ypos -894
 }
 ColorLookup {
  lut {master {curve L 0 s0 t0.9499999881 C k x0.308139503 1 s0}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos -1030
  ypos -849
 }
 Dot {
  name Dot14
  xpos -996
  ypos -750
 }
push $N69059800
 Multiply {
  channels rgb
  value 269
  name Multiply5
  label "\[value value]"
  xpos -1140
  ypos -856
 }
 ColorLookup {
  lut {master {}
    red {curve C 1.8783474 1.85965741 1.8410753 1.82260251 1.80424976 1.78602886 1.76794314 1.75000143 1.73221421 1.71458244 1.69711792 1.67982578 1.66271067 1.6457777 1.62903571 1.6124835 1.59613538 1.57998943 1.56404996 1.54832447 1.5328095 1.51751649 1.50244594 1.48759735 1.47297573 1.45858264 1.44442391 1.43049574 1.41680288 1.40334678 1.39012623 1.37714779 1.36440396 1.35190022 1.33963728 1.32761216 1.31582856 1.30428183 1.29297352 1.28190565 1.27107596 1.2604804 1.25012183 1.23999798 1.23010659 1.22044563 1.21101499 1.20181489 1.19284034 1.18408906 1.17556167 1.16725397 1.15916491 1.15129638 1.14363372 1.13618886 1.12895167 1.12192106 1.11509454 1.10846853 1.10204577 1.09580922 1.08977199 1.08392429 1.07826447 1.07278681 1.06749392 1.06237841 1.05743873 1.05267084 1.04807138 1.04364109 1.03937256 1.03526449 1.03131545 1.02751946 1.02387333 1.02037668 1.01702523 1.01381445 1.01074362 1.00780725 1.00500631 1.00233305 0.99978602 0.99736285 0.9950608 0.99287677 0.99080539 0.98884678 0.98699367 0.9852494 0.98361033 0.98206747 0.98062134 0.97926998 0.97800934 0.97683728 0.97575116 0.97474778 0.97382426 0.97297859 0.97220623 0.97150886 0.97087657 0.97031689 0.96981871 0.96938527 0.96900952 0.96869147 0.96842706 0.96821606 0.96805781 0.96794283 0.96787858 0.96785843 0.96787864 0.96793604 0.96803701 0.96817231 0.96833968 0.96854311 0.96877253 0.96903455 0.96932232 0.96963543 0.96997368 0.97033387 0.97071254 0.9711163 0.97153723 0.97197378 0.97242606 0.97289121 0.97337079 0.97386622 0.97437072 0.97488332 0.97540969 0.97594237 0.97647977 0.97702706 0.97757769 0.97813445 0.97869468 0.97925854 0.97982538 0.98039114 0.98096472 0.98153675 0.98210776 0.98267955 0.98325121 0.98382008 0.98438704 0.9849571 0.98552132 0.98608243 0.98664182 0.98719966 0.98775077 0.98829895 0.98884273 0.98938417 0.98991877 0.9904511 0.99097681 0.99149919 0.99201453 0.99252397 0.99303031 0.99353105 0.99402624 0.99451613 0.99499857 0.99547589 0.99594522 0.99641174 0.99687338 0.99732745 0.99777603 0.9982177 0.99865389 0.999084 0.99950838 0.99992663 1.00033772 1.00074494 1.00114489 1.00153947 1.00192833 1.00231075 1.00268865 1.00305855 1.00342607 1.00378489 1.00413895 1.00448751 1.00483036 1.00517035 1.00550389 1.00583148 1.00615203 1.00646758 1.00678015 1.00708604 1.00738645 1.00768471 1.00797844 1.0082655 1.00854778 1.00882483 1.00909901 1.00936711 1.00963116 1.00989032 1.0101465 1.01039672 1.01064491 1.01088691 1.0111258 1.01135957 1.01158977 1.01181614 1.01203847 1.01225793 1.01247287 1.01268291 1.01289058 1.01309609 1.01329684 1.01349473 1.0136888 1.0138787 1.01406395 1.01424909 1.01442885 1.01460576 1.01478052 1.01495218 1.01512218 1.01528883 1.01545072 1.01561022 1.01576698 1.01592219 1.01607502 1.01622343 1.01636875 1.0165143 1.01665616 1.01679492 1.0169313 1.01706588 1.01719737 1.01732695 1.01745498 1.01757956 1.01770294 1.01782393 1.01794255 1.0180583 1.01817465 1.01828551 1.01839495 1.01850486 1.01861191 1.01871693 1.01882088 1.01891339}
    green {curve C 1}
    blue {curve C 0.00879261 0.00962762 0.010532 0.01151017 0.01256675 0.01370643 0.01493413 0.01625487 0.01767381 0.01919618 0.02082733 0.02257277 0.02443803 0.02642871 0.02855051 0.03080913 0.0332104 0.0357601 0.03846392 0.04132775 0.04435719 0.04755813 0.05093599 0.05449668 0.0582453 0.0621875 0.06632853 0.07067341 0.07522713 0.07999477 0.08498063 0.09018957 0.09562518 0.10129225 0.10719412 0.11333443 0.11971687 0.12634411 0.133219 0.14034435 0.14772213 0.15535444 0.16324303 0.17138906 0.179794 0.18845794 0.197382 0.20656651 0.21601067 0.22571453 0.23567709 0.24589771 0.25637382 0.26710594 0.2780903 0.28932518 0.30080822 0.3125369 0.32450783 0.33671761 0.34916404 0.36183971 0.37474373 0.38787127 0.40121818 0.41477671 0.42854655 0.44251823 0.45668846 0.47105014 0.48559928 0.50033116 0.5152359 0.5303098 0.5455451 0.56093836 0.5764783 0.59215891 0.60797763 0.62392306 0.63999057 0.65616876 0.6724565 0.68884456 0.70532417 0.72188419 0.73852479 0.7552371 0.77200818 0.78883314 0.80570388 0.82261622 0.83956301 0.8565321 0.87351894 0.89051074 0.90751225 0.92450547 0.94148719 0.95845115 0.97538745 0.99229181 1.00915313 1.02597356 1.04273522 1.05944169 1.07608175 1.09265125 1.10914159 1.12555146 1.14187002 1.15809321 1.1742171 1.190238 1.20614767 1.22194457 1.23762202 1.2531724 1.26859927 1.28389311 1.29905295 1.31407428 1.32895291 1.34368753 1.35827363 1.3727088 1.38699389 1.40111876 1.41508293 1.42889357 1.44254065 1.45602405 1.46934104 1.48249614 1.49548101 1.50830269 1.5209527 1.53343177 1.54574537 1.5578897 1.56985986 1.5816654 1.59329891 1.60476208 1.61605716 1.62718153 1.63813758 1.64892519 1.65955138 1.67000985 1.68030369 1.69043732 1.70040607 1.71021223 1.71985734 1.72934508 1.73867714 1.74785423 1.75688136 1.76575518 1.77447391 1.78304338 1.79146802 1.79975164 1.80788386 1.81587982 1.82373333 1.83144975 1.83902776 1.84647095 1.85378456 1.86096811 1.86802399 1.87495112 1.88175035 1.88842535 1.89497983 1.90141833 1.90774179 1.91394711 1.92004013 1.92602086 1.93188739 1.93765306 1.94330883 1.94886208 1.95430994 1.95965815 1.96490622 1.97005856 1.97511387 1.98007631 1.98494554 1.98972344 1.99441445 1.99901712 2.00353193 2.00796437 2.01231384 2.01658392 2.02076721 2.02487659 2.02890825 2.03286695 2.03675175 2.04056406 2.04430199 2.04797506 2.05157685 2.05511236 2.0585804 2.06198287 2.06532407 2.06860161 2.07181907 2.07497644 2.07807779 2.0811162 2.08409977 2.08702946 2.08990335 2.09272337 2.09549189 2.0982089 2.10087585 2.10349345 2.10606146 2.1085825 2.11105394 2.11348104 2.11586332 2.11820364 2.12050176 2.12275648 2.12496805 2.127141 2.12927723 2.13136625 2.13341999 2.13543844 2.13741732 2.13936305 2.1412704 2.1431427 2.14498401 2.14678812 2.14856291 2.1503005 2.15200949 2.15368938 2.15533352 2.15695238 2.15853977 2.16009951 2.16162968 2.16313291 2.16460824 2.16605687 2.16747928 2.16887903 2.17024994 2.1715951 2.17291784 2.17421341 2.17548871 2.17674041 2.17797112 2.17918396 2.18036819 2.18143296}
    alpha {}}
  name ColorLookup3
  label "Planckian Locus 0-269"
  xpos -1140
  ypos -808
 }
 Multiply {
  inputs 1+1
  channels rgb
  value 0
  maskChannelMask rgba.red
  invert_mask true
  name Multiply3
  label dim
  xpos -1140
  ypos -760
 }
 BlackOutside {
  name BlackOutside6
  xpos -1140
  ypos -706
 }
 Position {
  translate {6 {parent.Position2.translate.y-input.height}}
  name Position8
  xpos -1140
  ypos -682
 }
 Dot {
  name Dot28
  xpos -1106
  ypos -654
 }
push $N69096000
 Dot {
  name Dot4
  xpos -886
  ypos -1086
 }
set N693eec00 [stack 0]
 Rectangle {
  replace true
  area {0 0 6 {height}}
  name Rectangle1
  xpos -810
  ypos -1089
 }
 BlackOutside {
  name BlackOutside5
  xpos -810
  ypos -1041
 }
push $N693eec00
 Radial {
  inputs 1+1
  replace true
  area {-5422 -3542 7470 5590}
  softness 0
  ramp linear
  color {0.0719 0.02604 0.0001 1}
  p1 {0 0}
  color0 {0.039378 0.001097 0.188331 1}
  p0 {0 2048}
  name Radial1
  xpos -920
  ypos -1041
 }
 Dot {
  name Dot9
  xpos -886
  ypos -894
 }
push $N69096400
 Gamma {
  channels rgba
  value 0.5
  name Gamma2
  xpos -700
  ypos -1120
 }
 Expression {
  temp_name0 start
  temp_expr0 360
  temp_name1 end
  temp_expr1 830
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 r*(end-start)+start
  channel1 none
  channel2 none
  expr3 1
  name Expression2
  label "360nm to 830nm"
  xpos -700
  ypos -1096
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 6.97e-06 7.81e-06 8.77e-06 9.84e-06 1.104e-05 1.239e-05 1.389e-05 1.556e-05 1.744e-05 1.958e-05 2.202e-05 2.484e-05 2.804e-05 3.153e-05 3.522e-05 3.9e-05 4.283e-05 4.691e-05 5.159e-05 5.718e-05 6.4e-05 7.234e-05 8.221e-05 9.351e-05 0.00010614 0.00012 0.00013498 0.00015149 0.00017021 0.00019182 0.000217 0.00024691 0.00028124 0.00031852 0.00035727 0.000396 0.00043371 0.00047302 0.00051788 0.00057222 0.00064 0.00072456 0.0008255 0.00094116 0.00106988 0.00121 0.00136209 0.00153075 0.00172037 0.00193532 0.00218 0.0024548 0.002764 0.0031178 0.0035264 0.004 0.00454624 0.00515932 0.00582928 0.00654616 0.0073 0.00808651 0.00890872 0.00976768 0.01066443 0.0116 0.01257317 0.01358272 0.01462968 0.01571509 0.01684 0.01800736 0.01921448 0.02045392 0.02171824 0.023 0.02429461 0.02561024 0.02695857 0.02835125 0.0298 0.03131083 0.03288368 0.03452112 0.03622571 0.038 0.03984667 0.041768 0.043766 0.04584267 0.048 0.05024368 0.05257304 0.05498056 0.05745872 0.06 0.06260197 0.06527752 0.06804208 0.07091109 0.0739 0.077016 0.0802664 0.0836668 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name ColorLookup4
  label "CIE 1931 2 Degree Standard Observer\n360nm to 830nm"
  xpos -700
  ypos -1030
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeLineOfPurples
  xpos -700
  ypos -897
  disable {{!parent.draw_line_of_purples}}
 }
 Fill {
  color {0 0 0 1}
  name Disable_SpectralLocus
  xpos -700
  ypos -826
  disable {{parent.draw_spectral_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePlanckianLocus
  xpos -700
  ypos -658
  disable {{!parent.draw_planckian_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut
  xpos -700
  ypos -489
  disable {{!parent.draw_pointers_gamut}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut_Samples
  xpos -700
  ypos -417
  disable {{!draw_pointers_samples}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeMacbeth
  xpos -700
  ypos -273
  disable {{!parent.draw_macbeth_chart}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutGrid
  xpos -700
  ypos -81
  disable {{!parent.gamut_grid}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutA
  xpos -700
  ypos 255
  disable {{!parent.gamut_a}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutB
  xpos -700
  ypos 279
  disable {{!parent.gamut_b}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutC
  xpos -700
  ypos 303
  disable {{!parent.gamut_c}}
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 450
 }
set N69392000 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 450
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace6
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -590
  ypos 488
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression5
  label "CIE Yxy to CIELuv"
  xpos -590
  ypos 536
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 618
 }
push $N69392000
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  invert true
  name ColorMatrix1
  label "XYZ to working"
  xpos -700
  ypos 488
  disable {{!map_overlays_to_input_gamut}}
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_grid\" iterate pixelWise b2e7b5f8a89bdb0629aa8cc2eae387ef3436f24cb0af642eeba41235874506c4 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 6 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== \"draw_axes\" Bool 1 AA== \"grid_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 6 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 \"draw_axes\" 1 1 \"grid_color\" 4 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_grid : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n  bool draw_axes;\n  float4 grid_color;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  void draw_grid() \{\n    // grid width in pixels. expresses a 0 to 1 range in CIE xy\n    float grid_width = 1.0f * outsize + offset;\n    // draw grid lines\n    float i = offset;\n    while (i <= grid_width && i > 0.0f) \{\n      write_aa(offset, i, grid_color);\n      write_aa(i, offset, grid_color);\n      i += 1.0;\n    \}\n    // cross-hatching interval in pixels\n    float hatch_interval = (grid_width - offset) * 0.1f;\n    // cross-hatch length in pixels\n    float hatch_width = outsize * 0.01f;\n    i = offset;\n    while (i <= grid_width) \{\n      i += hatch_interval;\n      float j = 0.0;\n      while (j <= hatch_width/2) \{\n        write_aa(offset+j, i, grid_color);\n        write_aa(offset-j, i, grid_color);\n        write_aa(i, offset+j, grid_color);\n        write_aa(i, offset-j, grid_color);\n        j += 1.0;\n      \}\n    \}\n  \}\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n\n    // draw CIExy coordinate system axes\n    if (draw_axes && pos.x == 0 && pos.y == 0) \{\n      draw_grid();\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_grid_padding {{parent.PlotChromaticities.PlotChromaticity_padding}}
  PlotChromaticity_grid_left_margin {{parent.PlotChromaticities.PlotChromaticity_left_margin}}
  PlotChromaticity_grid_tolerance 0.8
  PlotChromaticity_grid_antialias true
  PlotChromaticity_grid_draw_axes {{parent.coordinate_system}}
  PlotChromaticity_grid_grid_color {0.15 0 0.005 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotInput2
  xpos -700
  ypos 608
 }
 FrameHold {
  firstFrame 1
  name FrameHold1
  xpos -700
  ypos 680
  cached true
 }
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 762
 }
 Input {
  inputs 0
  name Input
  xpos 620
  ypos -1426
 }
 AddChannels {
  name AddChannels1
  xpos 620
  ypos -1360
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat
  xpos 620
  ypos -1282
  disable {{!parent.resample_input}}
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name CropBBox
  xpos 620
  ypos -1257
 }
 Dot {
  name Dot7
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 162
 }
set N69322800 [stack 0]
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "256 256 0 0 256 256 1 square_256"
  name Constant2
  xpos 400
  ypos 38
  postage_stamp false
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat1
  xpos 400
  ypos 64
  disable {{!parent.resample_input}}
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input0]"}}
  name Switch1
  xpos 400
  ypos 158
 }
 Fill {
  output rgb
  color 0.18
  name SampleColor
  xpos 290
  ypos 158
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name Crop2
  xpos 290
  ypos 184
 }
 Fill {
  output alpha
  name Fill3
  xpos 290
  ypos 224
 }
 Dot {
  name Dot6
  xpos 324
  ypos 282
 }
set N69320c00 [stack 0]
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  name ColorMatrix4
  label "working to XYZ"
  xpos 180
  ypos 272
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace1
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 180
  ypos 320
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression6
  label "CIE Yxy to CIELuv"
  xpos 180
  ypos 368
  disable {{!parent.diagram}}
 }
push $N69320c00
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_sample\" iterate pixelWise 20e14b615a937bac78c1a771cbdfd10cc7c5fb6c487f65d0bb2d6633e404b958 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 3 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== 3 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_sample : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  void process(int2 pos) \{\n    // only process the first pixel\n    if (pos.x > 0 && pos.y > 0) return;\n\n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    int2 p = int2(round(out_coord.x), round(out_coord.y));\n    if (dst.bounds.inside(p.x, p.y)) \{\n      for (int k=0; k<3; k++) \{\n        dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n      \}\n      dst(p.x, p.y, 3) = 1.0f;\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_sample_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_sample_left_margin {{parent.left_margin}}
  PlotChromaticity_sample_tolerance 1
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities1
  xpos 290
  ypos 368
 }
 Dot {
  name Dot22
  xpos 324
  ypos 450
 }
set N696bf400 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048}}
  name Dilate1
  label "\[value size]"
  xpos 290
  ypos 488
 }
set N696bf000 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048*2}}
  name Dilate2
  label "\[value size]"
  xpos 180
  ypos 488
 }
push $N696bf400
 Dot {
  name Dot21
  xpos -6
  ypos 450
 }
 FilterErode {
  channels rgba
  size {{-Output.width/2048/5}}
  filter triangle
  name FilterErode1
  label "\[value size]"
  xpos -40
  ypos 489
 }
set N696be400 [stack 0]
 Dilate {
  channels rgba
  size {0 {parent.Dilate3.size.w}}
  name Dilate4
  label "\[value size]"
  xpos -40
  ypos 584
 }
push $N696be400
 Dilate {
  channels rgba
  size {{Output.width*plus_size/100} 0}
  name Dilate3
  label "\[value size]"
  xpos 70
  ypos 488
  addUserKnob {20 User}
  addUserKnob {7 plus_size R 0 4}
  plus_size 0.8
 }
 Merge2 {
  inputs 2
  operation screen
  bbox B
  name Merge9
  xpos 70
  ypos 591
 }
 Merge2 {
  inputs 2
  operation stencil
  bbox B
  name Merge10
  xpos 180
  ypos 591
 }
 Group {
  name HueRotate
  xpos 180
  ypos 639
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -24
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos 15
  }
  Colorspace {
   colorspace_out HSV
   name Colorspace1
   xpos -40
   ypos 72
  }
  Add {
   channels {rgba.red -rgba.green -rgba.blue none}
   value 0.5
   name Add1
   xpos -40
   ypos 111
  }
  Fill {
   output {-rgba.red -rgba.green rgba.blue none}
   name Fill1
   xpos -40
   ypos 147
  }
  Colorspace {
   colorspace_in HSV
   name Colorspace2
   xpos -40
   ypos 183
  }
  Premult {
   name Premult1
   xpos -40
   ypos 231
  }
  Output {
   name Output1
   xpos -40
   ypos 302
  }
 end_group
push $N696bf000
 Merge2 {
  inputs 2
  bbox B
  name Merge8
  xpos 290
  ypos 638
 }
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 690
 }
push $N69322800
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 162
 }
 Group {
  name GamutToXYZ
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos 730
  ypos 247
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 730
  ypos 296
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression4
  label "CIE Yxy to CIELuv"
  xpos 730
  ypos 344
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot13
  label " Pos"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 546
 }
push $N69322800
 Dot {
  name Dot16
  label " Col"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 450
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity\" iterate pixelWise 3e86399c7642fe5c35c23528a644f88a8bf13f967de084ae6842f8be55098c6b 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 4 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== 4 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_left_margin {{parent.left_margin}}
  PlotChromaticity_tolerance 2
  PlotChromaticity_antialias true
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities
  xpos 620
  ypos 536
  disable {{!parent.plot_input}}
 }
 Fill {
  color 0
  name BLACK
  tile_color 0x111111ff
  xpos 620
  ypos 591
  disable {{parent.plot_input}}
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge7
  xpos 620
  ypos 686
  disable {{!parent.enable_sample_color}}
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 620
  ypos 758
 }
 Output {
  name Output
  xpos 620
  ypos 1046
 }
end_group
Read {
 inputs 0
 file_type tiff
 file /Users/afry/Downloads/martin-smekal/A009C002_190210_R0EI_LogC_AlexaWideGamut.tif
 format "3414 2198 0 0 3414 2198 1 "
 origset true
 raw true
 name Read93
 xpos 3494
 ypos 1980
}
OCIOColorSpace {
 in_colorspace "Input - ARRI - Curve - V3 LogC (EI800)"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace28
 xpos 3494
 ypos 2070
}
set N695fe800 [stack 0]
OCIOColorSpace {
 in_colorspace "ACES - ACES2065-1"
 out_colorspace scene_linear
 name OCIOColorSpace29
 xpos 3494
 ypos 2094
}
Group {
 name GamutCompress2
 label "\[value direction]"
 xpos 3494
 ypos 2118
 addUserKnob {20 GamutCompress}
 addUserKnob {41 threshold t "Percentage of the gamut to protect. A value of 0.8 means 20% of the outer gamut will be utilized for gamut compression." T compress.threshold}
 addUserKnob {41 power T compress.power}
 addUserKnob {26 distance_limit_label l " " t "Specifies the distance beyond the gamut boundary to map to the gamut boundary for each color component." T "<b>distance limit"}
 addUserKnob {41 cyan t "Maximum distance beyond the green-blue gamut boundary to compress to the gamut boundary." T compress.cyan}
 addUserKnob {41 magenta t "Maximum distance beyond the blue-red gamut boundary to compress to the gamut boundary." T compress.magenta}
 addUserKnob {41 yellow t "Maximum distance beyond the red-green gamut boundary to compress to the gamut boundary." T compress.yellow}
 addUserKnob {6 overlay l "graph overlay" +STARTLINE}
 addUserKnob {22 reset t "Reset knobs to default values. Distance limits are calculated based on an the average of a selection of digital cinema cameras." T "n = nuke.thisNode()\nnuke.root().begin()\ndefaults = \{\n    'threshold': (0.815, 0.803, 0.88),\n    'power': 1.2,\n    'cyan': 0.147,\n    'magenta':0.264,\n    'yellow': 0.312,\n\}\nfor k, v in defaults.items():\n    n\[k].setValue(v)" +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {20 info_tab l Info}
 addUserKnob {26 info_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc>\n<b>GamutCompress</b><br>\nmaps out of gamut colors back into gamut.\n<br><br><a href=https://github.com/colour-science/aces-vwg-gamut-mapping-2020/tree/master/model>Documentation</a>"}
 addUserKnob {26 about_label l " " T "<style> a:link \{ color: #ccc \}</style>\n<font color=#ccc><br>\n<b>About</b><br>\nWritten by <a href=https://github.com/jedypod color=red>Jed Smith</a> <br> with <a href=https://community.acescentral.com/t/rgb-saturation-gamut-mapping-approach-and-a-comp-vfx-perspective>help</a> from the <a href=https://community.acescentral.com/c/aces-development-acesnext/vwg-aces-gamut-mapping-working-group>ACES Gamut Mapping VWG</a>"}
}
 Input {
  inputs 0
  name Input
  xpos -40
  ypos -274
 }
 Dot {
  name Dot4
  xpos -6
  ypos -174
 }
set N695fdc00 [stack 0]
 Dot {
  name Dot2
  xpos -226
  ypos -174
 }
 Expression {
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 max(r,g,b)
  name achromatic
  xpos -260
  ypos -130
 }
set N695fd400 [stack 0]
push $N695fdc00
 Merge2 {
  inputs 2
  operation minus
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge1
  xpos -40
  ypos -130
 }
push $N695fd400
 Dot {
  name Dot1
  xpos -226
  ypos -78
 }
set N695fcc00 [stack 0]
 Expression {
  expr0 abs(r)
  expr1 abs(g)
  expr2 abs(b)
  name abs
  xpos -167
  ypos -81
 }
set N695fc800 [stack 0]
 Merge2 {
  inputs 2
  operation divide
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge2
  xpos -40
  ypos -82
 }
set N695fc400 [stack 0]
 Expression {
  expr0 "2 * x / (width - 1)"
  expr1 "2 * x / (width - 1)"
  expr2 "2 * x / (width - 1)"
  name Grad
  xpos 180
  ypos -82
 }
 Group {
  name compress1
  xpos 180
  ypos 63
  addUserKnob {20 compress}
  addUserKnob {18 threshold R 0.4 1}
  threshold {{parent.compress.threshold}}
  addUserKnob {6 threshold_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 power R 1 3}
  power {{parent.compress.power}}
  addUserKnob {7 cyan}
  cyan {{parent.compress.cyan}}
  addUserKnob {7 magenta}
  magenta {{parent.compress.magenta}}
  addUserKnob {7 yellow}
  yellow {{parent.compress.yellow}}
  addUserKnob {26 ""}
  addUserKnob {26 ""}
  addUserKnob {6 invert +STARTLINE}
  invert {{parent.direction}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -130
  }
  Dot {
   name Dot2
   xpos -6
   ypos -30
  }
set N6959b400 [stack 0]
  Dot {
   name Dot1
   xpos 434
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001||r>thr.r+s.r)?r:thr.r+s.r*pow(-(pow((r-thr.r)/s.r,p)/(pow((r-thr.r)/s.r,p)-1)),1/p)
   expr1 (g<thr.g||lim.g<1.0001||g>thr.g+s.g)?g:thr.g+s.g*pow(-(pow((g-thr.g)/s.g,p)/(pow((g-thr.g)/s.g,p)-1)),1/p)
   expr2 (b<thr.b||lim.b<1.0001||b>thr.b+s.b)?b:thr.b+s.b*pow(-(pow((b-thr.b)/s.b,p)/(pow((b-thr.b)/s.b,p)-1)),1/p)
   name uncompress_power
   xpos 400
   ypos 50
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
push $N6959b400
  Dot {
   name Dot6
   xpos -446
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001)?r:thr.r+s.r*((r-thr.r)/s.r)/(pow(1+pow((r-thr.r)/s.r,p),1/p))
   expr1 (g<thr.g||lim.g<1.0001)?g:thr.g+s.g*((g-thr.g)/s.g)/(pow(1+pow((g-thr.g)/s.g,p),1/p))
   expr2 (b<thr.b||lim.b<1.0001)?b:thr.b+s.b*((b-thr.b)/s.b)/(pow(1+pow((b-thr.b)/s.b,p),1/p))
   name compress_power1
   xpos -480
   ypos 38
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name switch_reverse
   xpos -40
   ypos 230
  }
  Output {
   name Output
   xpos -40
   ypos 326
  }
 end_group
 Expression {
  expr0 "abs(g - 2 * y / height) < 0.004 || abs(b - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  expr1 "abs(b - 2 * y / height) < 0.004 || abs(r - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  expr2 "abs(r - 2 * y / height) < 0.004 || abs(g - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  expr3 "abs(r - 2 * y / height) < 0.004 || abs(g - 2 * y / height) < 0.004 || abs(b - 2 * y / height) < 0.004 || abs(y - height / 2) < 0.002 ? 1 : 0"
  name Plot
  xpos 180
  ypos 185
 }
push $N695fcc00
 Dot {
  name Dot3
  xpos -226
  ypos 234
 }
push $N695fc800
 Dot {
  name Dot7
  xpos -133
  ypos 185
 }
push $N695fc400
 Group {
  name compress
  selected true
  xpos -40
  ypos 62
  addUserKnob {20 compress}
  addUserKnob {18 threshold R 0.4 1}
  threshold {0.815 0.803 0.88}
  addUserKnob {6 threshold_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 power R 1 3}
  power 1.2
  addUserKnob {7 cyan}
  cyan 0.147
  addUserKnob {7 magenta}
  magenta 0.264
  addUserKnob {7 yellow}
  yellow 0.312
  addUserKnob {26 ""}
  addUserKnob {26 ""}
  addUserKnob {6 invert +STARTLINE}
  invert {{parent.direction}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -130
  }
  Dot {
   name Dot2
   xpos -6
   ypos -30
  }
set N69598c00 [stack 0]
  Dot {
   name Dot1
   xpos 434
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001||r>thr.r+s.r)?r:thr.r+s.r*pow(-(pow((r-thr.r)/s.r,p)/(pow((r-thr.r)/s.r,p)-1)),1/p)
   expr1 (g<thr.g||lim.g<1.0001||g>thr.g+s.g)?g:thr.g+s.g*pow(-(pow((g-thr.g)/s.g,p)/(pow((g-thr.g)/s.g,p)-1)),1/p)
   expr2 (b<thr.b||lim.b<1.0001||b>thr.b+s.b)?b:thr.b+s.b*pow(-(pow((b-thr.b)/s.b,p)/(pow((b-thr.b)/s.b,p)-1)),1/p)
   name uncompress_power
   xpos 400
   ypos 50
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)} {min(0.9999,parent.threshold)}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
push $N69598c00
  Dot {
   name Dot6
   xpos -446
   ypos -30
  }
  Expression {
   expr0 (r<thr.r||lim.r<1.0001)?r:thr.r+s.r*((r-thr.r)/s.r)/(pow(1+pow((r-thr.r)/s.r,p),1/p))
   expr1 (g<thr.g||lim.g<1.0001)?g:thr.g+s.g*((g-thr.g)/s.g)/(pow(1+pow((g-thr.g)/s.g,p),1/p))
   expr2 (b<thr.b||lim.b<1.0001)?b:thr.b+s.b*((b-thr.b)/s.b)/(pow(1+pow((b-thr.b)/s.b,p),1/p))
   name compress_power1
   xpos -480
   ypos 38
   addUserKnob {20 Params_tab l Params}
   addUserKnob {18 thr}
   thr {{"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"} {"min(0.9999, parent.threshold)"}}
   addUserKnob {6 thr_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 lim}
   lim {{parent.cyan+1} {parent.magenta+1} {parent.yellow+1}}
   addUserKnob {6 lim_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 s}
   s {{(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)} {(lim-thr)/pow(pow((1-thr)/(lim-thr),-p)-1,1/p)}}
   addUserKnob {6 s_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 p R 1 5}
   p {{parent.power}}
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name switch_reverse
   xpos -40
   ypos 230
  }
  Output {
   name Output
   xpos -40
   ypos 326
  }
 end_group
 Merge2 {
  inputs 2
  operation multiply
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge3
  xpos -40
  ypos 182
 }
 Merge2 {
  inputs 2
  operation minus
  bbox B
  Achannels rgb
  Bchannels rgb
  output rgb
  name Merge5
  xpos -40
  ypos 230
 }
set N6952ec00 [stack 0]
 Merge2 {
  inputs 2
  name Merge7
  xpos 180
  ypos 231
 }
 Dot {
  name Dot9
  xpos 214
  ypos 268
 }
push $N6952ec00
 Switch {
  inputs 2
  which {{parent.overlay}}
  name Switch1
  xpos -40
  ypos 265
 }
 Output {
  name Output
  xpos -40
  ypos 302
 }
end_group
OCIOColorSpace {
 in_colorspace "ACES - ACEScg"
 out_colorspace "ACES - ACES2065-1"
 name OCIOColorSpace30
 xpos 3494
 ypos 2150
}
set N6952dc00 [stack 0]
Group {
 name ZCAMishDRT6
 xpos 3655
 ypos 2208
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 illuminant_in l "" -STARTLINE T Colorspace30.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T Colorspace30.primary_in}
 addUserKnob {26 ""}
 addUserKnob {41 inverseData1 l "Inverse Data 1" T ZCAM11.inverseData1}
 addUserKnob {4 gamutBounds l "Gamut Bounds" M {Rec709/sRGB P3}}
 addUserKnob {41 thr T clipToLimit1.thr}
 addUserKnob {26 ""}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
}
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JCh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2070
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read64
  xpos 553
  ypos 229
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace1
  xpos 553
  ypos 309
 }
 Multiply {
  value 100
  name Multiply3
  label "Mult by 100 to put in absolute nits"
  xpos 553
  ypos 333
 }
 Group {
  name ZCAM1
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 553
  ypos 375
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6952c400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6949ec00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6949ec00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N694c1600 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N694c1600
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6949d000 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6949cc00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6949d000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N69437c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N69437800 [stack 0]
push $N6949d000
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N69437400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N69437000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N69436c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N69436800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6949cc00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6949d000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6949d000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6949d000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6952c400
push $N6949cc00
push $N69437c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N69434c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N69434c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6949cc00
push $N69437800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N697cb400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N697cb400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6949cc00
push $N69437400
push $N69437c00
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N697c9c00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N697c9800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N697c9800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N69436c00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N697c9c00
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N69436c00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N69436800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N697c9c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N69437800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N69437000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N69437c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N69437400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6949cc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6952c400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N69aec400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N69a73400 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N69a73400
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N69a71c00 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N69a71000 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N69a71000
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N69a71000
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N69a33c00 [stack 0]
push $N69a33c00
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N69a71c00
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N69a31000 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N69a31000
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N69a31000
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N697e1600 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N699e3c00 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N697e1600
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N699e3400 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N697e1600
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N699e2800 [stack 0]
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N699e1c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N697e0f00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N699e3c00
push $N699e3400
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N69973c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N69973c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N697e0f00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N69971c00 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N69971c00
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N697e0100 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N697e0100
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N69aec400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N69aec400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N69aec400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N697e0f00
push $N69aec400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N69a71c00
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N699e2800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N699e1c00
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N697e1600
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode1
  xpos 553
  ypos 428
 }
set N6989b800 [stack 0]
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -455
 }
 Colorspace {
  primary_in ACES
  colorspace_out CIE-XYZ
  name Colorspace30
  label "ACES to XYZ"
  xpos 1344
  ypos -402
 }
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos -370
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos -306
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6989a000 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N69898c00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N69898c00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N69871d00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N69871d00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6981ec00 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6981e800 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6981ec00
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6981dc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6981d800 [stack 0]
push $N6981ec00
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6981d400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6981d000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6981cc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6981c800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6981e800
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6981ec00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6981ec00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6981ec00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6989a000
push $N6981e800
push $N6981dc00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N69ba6800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N69ba6800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6981e800
push $N6981d800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N69ba5400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N69ba5400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6981e800
push $N6981d400
push $N6981dc00
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N69b43800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N69b43400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N69b43400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6981cc00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N69b43800
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6981cc00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6981c800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N69b43800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6981d800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6981d000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6981dc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6981d400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6981e800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6989a000
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N69e6a000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N69e69400 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N69e69400
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N69dff800 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N69dfec00 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N69dfec00
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N69dfec00
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N69dfdc00 [stack 0]
push $N69dfdc00
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N69dff800
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N69daec00 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N69daec00
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N69daec00
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N69b8dd00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N69dadc00 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N69b8dd00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N69dad400 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N69b8dd00
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N69dac800 [stack 0]
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N69d5f800 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N69b8d600 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N69dadc00
push $N69dad400
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N69d5dc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N69d5dc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N69b8d600
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N69cdf800 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N69cdf800
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N69b8c800 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N69b8c800
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N69e6a000
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N69e6a000
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N69e6a000
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N69b8d600
push $N69e6a000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N69dff800
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N69dac800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N69d5f800
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N69b8dd00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N6991cf00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle1
  xpos 1501
  ypos -229
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply1
  label "Div by 100 to go from nits"
  xpos 1501
  ypos -205
 }
 ColorLookup {
  channels all
  lut {master {curve x0.02407439426 0 x0.04948588461 5.620706361e-06 x0.0808724314 5.995634638e-05 x0.1089436561 0.0002520732232 x0.1538826674 0.0009655252215 x0.1705526412 0.001552375033 x0.1965807676 0.003411091166 x0.2212548852 0.005432802252 x0.2435974032 0.008078291081 x0.2744711637 0.01258628722 x0.335355252 0.02872310206 x0.3656598926 0.0391706787 x0.4067366123 0.05722413212 x0.451582104 0.08477441967 x0.5436673164 0.1626682729 x0.6915633678 0.3178558648 x0.7352961302 0.3736175299 x0.8164004087 0.4692641795 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup2
  xpos 1501
  ypos -163
 }
 Gamma {
  value 2.2
  name Gamma1
  xpos 1501
  ypos -131
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply2
  label "Mult by 100 to put in absolute nits"
  xpos 1501
  ypos -99
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle2
  xpos 1501
  ypos -57
 }
push $N6991cf00
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1350
  ypos -21
 }
 Dot {
  name Dot13
  xpos 1384
  ypos 90
 }
set N69c17800 [stack 0]
 Dot {
  name Dot2
  xpos 739
  ypos 119
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle3
  xpos 705
  ypos 186
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_C
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_C.green 1 1 rgba.green 0 1"
  name Shuffle4
  xpos 705
  ypos 210
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle5
  xpos 705
  ypos 234
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy1
  xpos 705
  ypos 424
 }
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit1
  xpos 705
  ypos 456
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle6
  xpos 705
  ypos 480
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.green 0 1 zcam_C.alpha 0 3"
  name Shuffle7
  xpos 705
  ypos 504
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_P3gamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 4120
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read93
  xpos 898
  ypos 192
 }
 Colorspace {
  primary_in DCI-P3
  colorspace_out CIE-XYZ
  name Colorspace2
  xpos 898
  ypos 272
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read68
  xpos 811
  ypos 189
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 811
  ypos 269
 }
 Switch {
  inputs 2
  which {{parent.gamutBounds}}
  name bounSwitch
  selected true
  xpos 819
  ypos 308
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 829
  ypos 341
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 829
  ypos 383
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N69f97400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N69f96000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N69f96000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N69f9eb00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N69f9eb00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N69f94400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N69f3fc00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N69f94400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N69f3f000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N69f3ec00 [stack 0]
push $N69f94400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N69f3e800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N69f3e400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N69f3e000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N69f3dc00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N69f3fc00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N69f94400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N69f94400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N69f94400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N69f97400
push $N69f3fc00
push $N69f3f000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6a2cbc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6a2cbc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N69f3fc00
push $N69f3ec00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6a2ca800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6a2ca800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N69f3fc00
push $N69f3e800
push $N69f3f000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6a2c9000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6a2c8c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6a2c8c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N69f3e000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6a2c9000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N69f3e000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N69f3dc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6a2c9000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N69f3ec00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N69f3e400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N69f3f000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N69f3e800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N69f3fc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N69f97400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6a177400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6a176800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6a176800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6a175000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6a174400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6a174400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6a174400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6a117000 [stack 0]
push $N6a117000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6a175000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N6a114400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N6a114400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N6a114400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6a13eb00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6a0c7000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6a13eb00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6a0c6800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6a13eb00
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6a0c5c00 [stack 0]
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6a0c5000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6a13e400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6a0c7000
push $N6a0c6800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6a06f000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6a06f000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6a13e400
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6a06d000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6a06d000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6a13d600 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6a13d600
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6a177400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6a177400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6a177400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6a13e400
push $N6a177400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6a175000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6a0c5c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6a0c5000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6a13eb00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 829
  ypos 436
 }
set N6a3aac00 [stack 0]
push $N69c17800
 Dot {
  name Dot1
  xpos 1015
  ypos 127
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 432
 }
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit
  xpos 981
  ypos 464
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr {{parent.clipToLimit1.thr}}
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 981
  ypos 488
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 981
  ypos 512
 }
push $N69c17800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1354
  ypos 569
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy2
  xpos 1354
  ypos 611
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1354
  ypos 663
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6a71b400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6a71a000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6a71a000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6a6cf900 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6a6cf900
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6a718400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6a6bbc00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6a718400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6a6bb000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6a6bac00 [stack 0]
push $N6a718400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6a6ba800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6a6ba400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6a6ba000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6a6b9c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6a6bbc00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6a718400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6a718400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6a718400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6a71b400
push $N6a6bbc00
push $N6a6bb000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6a64bc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6a64bc00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6a6bbc00
push $N6a6bac00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6a64a800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6a64a800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6a6bbc00
push $N6a6ba800
push $N6a6bb000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6a649000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6a648c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6a648c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6a6ba000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6a649000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6a6ba000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6a6b9c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6a649000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6a6bac00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6a6ba400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6a6bb000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6a6ba800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6a6bbc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6a71b400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6a4ef400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6a4ee800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6a4ee800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6a4ed000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6a4ec400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6a4ec400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6a4ec400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6a49f000 [stack 0]
push $N6a49f000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6a4ed000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N6a49c400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N6a49c400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N6a49c400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6a447900 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6a44f000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6a447900
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6a44e800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6a447900
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6a44dc00 [stack 0]
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6a44d000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6a447200 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6a44f000
push $N6a44e800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6a7e7000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6a7e7000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6a447200
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6a7e5000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6a7e5000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6a446400 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6a446400
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6a4ef400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6a4ef400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6a4ef400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6a447200
push $N6a4ef400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6a4ed000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6a44dc00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6a44d000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6a447900
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1354
  ypos 715
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1354
  ypos 757
 }
 Colorspace {
  colorspace_in CIE-XYZ
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1354
  ypos 781
 }
 Output {
  name Output1
  xpos 1354
  ypos 888
 }
push $N6989b800
push $N6a3aac00
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {-0.20703125 -0.3359375 -0.205078125 -0.333984375}
  name Viewer1
  xpos 409
  ypos 450
 }
end_group
Write {
 file /Users/afry/GitHub/nukeZCAM/images/examples/BlueBar_ZCAMishDRTv04_sRGB_Limit.jpg
 file_type jpeg
 checkHashOnRead false
 version 1
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write16
 xpos 3655
 ypos 2232
}
push $N695fe800
Group {
 name ZCAMishDRT5
 xpos 3652
 ypos 2119
 addUserKnob {20 User}
 addUserKnob {26 In}
 addUserKnob {41 illuminant_in l "" -STARTLINE T Colorspace30.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T Colorspace30.primary_in}
 addUserKnob {26 ""}
 addUserKnob {41 inverseData1 l "Inverse Data 1" T ZCAM11.inverseData1}
 addUserKnob {4 gamutBounds l "Gamut Bounds" M {Rec709/sRGB P3}}
 addUserKnob {41 thr T clipToLimit1.thr}
 addUserKnob {26 ""}
 addUserKnob {26 Out}
 addUserKnob {41 colorspace_out l out T Colorspace25.colorspace_out}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Colorspace25.illuminant_out}
 addUserKnob {41 primary_out l "" -STARTLINE T Colorspace25.primary_out}
}
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JCh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2070
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read64
  xpos 553
  ypos 229
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace1
  xpos 553
  ypos 309
 }
 Multiply {
  value 100
  name Multiply3
  label "Mult by 100 to put in absolute nits"
  xpos 553
  ypos 333
 }
 Group {
  name ZCAM1
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 553
  ypos 375
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6ab14400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6aa82c00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6aa82c00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6aa8e400 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6aa8e400
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6aa81000 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6aa80c00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6aa81000
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6aa07c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6aa07800 [stack 0]
push $N6aa81000
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6aa07400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6aa07000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6aa06c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6aa06800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6aa80c00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6aa81000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6aa81000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6aa81000
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6ab14400
push $N6aa80c00
push $N6aa07c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6aa04c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6aa04c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6aa80c00
push $N6aa07800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6a9ab400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6a9ab400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6aa80c00
push $N6aa07400
push $N6aa07c00
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6a9a9c00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6a9a9800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6a9a9800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6aa06c00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6a9a9c00
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6aa06c00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6aa06800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6a9a9c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6aa07800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6aa07000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6aa07c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6aa07400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6aa80c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6ab14400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6a8d0400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6a847400 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6a847400
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6a845c00 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6a845000 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6a845000
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6a845000
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6ac03c00 [stack 0]
push $N6ac03c00
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6a845c00
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N6ac01000 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N6ac01000
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N6ac01000
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6a85a400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6abafc00 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6a85a400
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6abaf400 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6a85a400
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6abae800 [stack 0]
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6abadc00 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6a859d00 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6abafc00
push $N6abaf400
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6ab53c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6ab53c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6a859d00
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6ab51c00 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6ab51c00
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6a858f00 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6a858f00
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6a8d0400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6a8d0400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6a8d0400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6a859d00
push $N6a8d0400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6a845c00
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6abae800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6abadc00
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6a85a400
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode1
  xpos 553
  ypos 428
 }
set N6ae73800 [stack 0]
 Input {
  inputs 0
  name Input1
  xpos 1344
  ypos -455
 }
 Colorspace {
  primary_in ACES
  colorspace_out CIE-XYZ
  name Colorspace30
  label "ACES to XYZ"
  xpos 1344
  ypos -402
 }
 Multiply {
  value 100
  name Multiply19
  label "Mult by 100 to put in absolute nits"
  xpos 1344
  ypos -370
 }
 Group {
  name ZCAM10
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1344
  ypos -306
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6ae72000 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6ae70c00 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6ae70c00
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6ae3ab00 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6ae3ab00
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6adfac00 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6adfa800 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6adfac00
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6adf9c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6adf9800 [stack 0]
push $N6adfac00
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6adf9400 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6adf9000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6adf8c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6adf8800 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6adfa800
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6adfac00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6adfac00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6adfac00
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6ae72000
push $N6adfa800
push $N6adf9c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6ad8a800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6ad8a800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6adfa800
push $N6adf9800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6ad89400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6ad89400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6adfa800
push $N6adf9400
push $N6adf9c00
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6ad1b800 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6ad1b400 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6ad1b400
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6adf8c00
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6ad1b800
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6adf8c00
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6adf8800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6ad1b800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6adf9800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6adf9000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6adf9c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6adf9400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6adfa800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6ae72000
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6ac3e000 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6ac3d400 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6ac3d400
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6afd7800 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6afd6c00 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6afd6c00
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6afd6c00
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6afd5c00 [stack 0]
push $N6afd5c00
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6afd7800
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N6af86c00 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N6af86c00
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N6af86c00
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6afceb00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6af85c00 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6afceb00
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6af85400 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6afceb00
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6af84800 [stack 0]
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6af43800 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6afce400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6af85c00
push $N6af85400
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6af41c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6af41c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6afce400
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6b2bb800 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6b2bb800
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6afcd600 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6afcd600
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6ac3e000
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6ac3e000
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6ac3e000
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6afce400
push $N6ac3e000
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6afd7800
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6af84800
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6af43800
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6afceb00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
set N6aeb5d00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle1
  xpos 1501
  ypos -229
 }
 Multiply {
  value {{1/parent.Multiply19.value}}
  name Multiply1
  label "Div by 100 to go from nits"
  xpos 1501
  ypos -205
 }
 ColorLookup {
  channels all
  lut {master {curve x0.02407439426 0 x0.04948588461 5.620706361e-06 x0.0808724314 5.995634638e-05 x0.1089436561 0.0002520732232 x0.1538826674 0.0009655252215 x0.1705526412 0.001552375033 x0.1965807676 0.003411091166 x0.2212548852 0.005432802252 x0.2435974032 0.008078291081 x0.2744711637 0.01258628722 x0.335355252 0.02872310206 x0.3656598926 0.0391706787 x0.4067366123 0.05722413212 x0.451582104 0.08477441967 x0.5436673164 0.1626682729 x0.6915633678 0.3178558648 x0.7352961302 0.3736175299 x0.8164004087 0.4692641795 x0.8752408028 0.5275940299 x0.9309006333 0.5828329325 x0.9754681587 0.6187173724 x1.033632636 0.6637632847 x1.16960156 0.745464921 x1.235319972 0.7762671709 x1.356181145 0.8217196465 x1.508617401 0.8695153594 x1.637787938 0.8979744911 x1.822932601 0.9321763515 x1.905457973 0.9441890717 x2.068963289 0.9626951218 x2.316649675 0.9837986231 x2.455148697 0.9925647378 x2.621634722 1}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup2
  xpos 1501
  ypos -163
 }
 Gamma {
  value 2.2
  name Gamma1
  xpos 1501
  ypos -131
 }
 Multiply {
  value {{parent.Multiply19.value}}
  name Multiply2
  label "Mult by 100 to put in absolute nits"
  xpos 1501
  ypos -99
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle2
  xpos 1501
  ypos -57
 }
push $N6aeb5d00
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy10
  xpos 1350
  ypos -21
 }
 Dot {
  name Dot13
  xpos 1384
  ypos 90
 }
set N6b1e7800 [stack 0]
 Dot {
  name Dot2
  xpos 739
  ypos 119
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle3
  xpos 705
  ypos 186
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_C
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_C.green 1 1 rgba.green 0 1"
  name Shuffle4
  xpos 705
  ypos 210
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle5
  xpos 705
  ypos 234
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy1
  xpos 705
  ypos 424
 }
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit1
  xpos 705
  ypos 456
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr 0.9
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle6
  xpos 705
  ypos 480
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.green 0 1 zcam_C.alpha 0 3"
  name Shuffle7
  xpos 705
  ypos 504
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_P3gamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 4120
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read93
  xpos 898
  ypos 192
 }
 Colorspace {
  primary_in DCI-P3
  colorspace_out CIE-XYZ
  name Colorspace2
  xpos 898
  ypos 272
 }
 Read {
  inputs 0
  file_type exr
  file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
  format "1024 1024 0 0 1024 1024 1 square_1K"
  origset true
  version 2072
  in_colorspace scene_linear
  out_colorspace scene_linear
  name Read68
  xpos 811
  ypos 189
 }
 Colorspace {
  colorspace_out CIE-XYZ
  name Colorspace29
  xpos 811
  ypos 269
 }
 Switch {
  inputs 2
  which {{parent.gamutBounds}}
  name bounSwitch
  selected true
  xpos 819
  ypos 308
 }
 Multiply {
  value 100
  name Multiply18
  label "Mult by 100 to put in absolute nits"
  xpos 829
  ypos 341
 }
 Group {
  name ZCAM15
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 829
  ypos 383
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6b15f400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6b15e000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6b15e000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6b11b900 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6b11b900
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6b15c400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6b103c00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6b15c400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6b103000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6b102c00 [stack 0]
push $N6b15c400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6b102800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6b102400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6b102000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6b101c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6b103c00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6b15c400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6b15c400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6b15c400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6b15f400
push $N6b103c00
push $N6b103000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6b093c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6b093c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6b103c00
push $N6b102c00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6b092800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6b092800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6b103c00
push $N6b102800
push $N6b103000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6b091000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6b090c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6b090c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6b102000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6b091000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6b102000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6b101c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6b091000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6b102c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6b102400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6b103000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6b102800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6b103c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6b15f400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6b33f400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6b33e800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6b33e800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6b33d000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6b33c400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6b33c400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6b33c400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6b6e7000 [stack 0]
push $N6b6e7000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6b33d000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N6b6e4400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N6b6e4400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N6b6e4400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6b69b900 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6b6a3000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6b69b900
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6b6a2800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6b69b900
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6b6a1c00 [stack 0]
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6b6a1000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6b69b200 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6b6a3000
push $N6b6a2800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6b643000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6b643000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6b69b200
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6b641000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6b641000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6b69a400 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6b69a400
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6b33f400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6b33f400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6b33f400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6b69b200
push $N6b33f400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6b33d000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6b6a1c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6b6a1000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6b69b900
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name limitSampleNode
  xpos 829
  ypos 436
 }
set N6b572c00 [stack 0]
push $N6b1e7800
 Dot {
  name Dot1
  xpos 1015
  ypos 127
 }
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle37
  xpos 981
  ypos 194
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_M
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 zcam_M.green 1 1 rgba.green 0 1"
  name Shuffle48
  xpos 981
  ypos 218
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  in2 zcam_h
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.alpha 0 3 rgba.alpha 0 3 zcam_h.blue 1 2 rgba.blue 0 2"
  name Shuffle49
  xpos 981
  ypos 242
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.alpha
  name Copy9
  xpos 981
  ypos 432
 }
 Expression {
  temp_name0 limit
  temp_expr0 a(((b/360+.5)*1023),(r/100*1023))
  temp_name1 scaledVal
  temp_expr1 g/limit
  temp_name2 scale
  temp_expr2 1-thr
  expr2 "(scaledVal>thr? ( ((scaledVal-thr)/scale) / (((scaledVal-thr)/scale)+1) * scale + thr  )   : scaledVal ) * limit"
  channel3 alpha
  expr3 limit
  name clipToLimit
  xpos 981
  ypos 464
  addUserKnob {20 User}
  addUserKnob {7 limitScale R 0 100}
  limitScale 100
  addUserKnob {7 thr}
  thr {{parent.clipToLimit1.thr}}
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.alpha 0 3"
  name Shuffle50
  xpos 981
  ypos 488
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
  name Shuffle39
  xpos 981
  ypos 512
 }
push $N6b1e7800
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy7
  xpos 1354
  ypos 569
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy2
  xpos 1354
  ypos 611
 }
 Group {
  name ZCAM11
  label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
  xpos 1354
  ypos 663
  addUserKnob {20 ZCAM}
  addUserKnob {4 direction M {forward inverse}}
  direction inverse
  addUserKnob {26 ""}
  addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
  addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
  addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
  inverseData1 M,h
  addUserKnob {26 ""}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {41 surrounds T Constants.surrounds}
  addUserKnob {41 c T Constants.c}
  addUserKnob {41 Nc T Constants.Nc}
  addUserKnob {41 F T Constants.F}
  addUserKnob {41 FLL T Constants.FLL}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {41 La T Constants.La}
  addUserKnob {41 Yb T Constants.Yb}
  addUserKnob {41 surround T Constants.surround}
  addUserKnob {41 D T Constants.D}
  addUserKnob {41 Dtype T Constants.Dtype}
  addUserKnob {26 ""}
  addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
  addUserKnob {41 xyzw T Constants.xyzw}
  addUserKnob {26 ""}
  addUserKnob {41 Yw T Constants.Yw}
  addUserKnob {41 FL T Constants.FL}
  addUserKnob {41 n T Constants.n}
  addUserKnob {41 Fb T Constants.Fb}
  addUserKnob {41 Fs T Constants.Fs}
  addUserKnob {26 ""}
  addUserKnob {41 xyzwc T Constants.xyzwc}
  addUserKnob {41 iabzw T Constants.iabzw}
  addUserKnob {41 Qw T Constants.Qw}
 }
  BackdropNode {
   inputs 0
   name BackdropNode1
   tile_color 0x71c67100
   label xyz_to_jabz
   note_font_size 42
   xpos -1063
   ypos -50
   bdwidth 255
   bdheight 678
  }
  BackdropNode {
   inputs 0
   name BackdropNode2
   tile_color 0x388e8e00
   label Forward
   note_font_size 42
   xpos -1278
   ypos 673
   bdwidth 1634
   bdheight 582
  }
  BackdropNode {
   inputs 0
   name BackdropNode3
   tile_color 0x388e8e00
   label Inverse
   note_font_size 42
   xpos -2310
   ypos 2374
   bdwidth 1715
   bdheight 953
  }
  BackdropNode {
   inputs 0
   name BackdropNode4
   tile_color 0x388e8e00
   label "jabz to xyz"
   note_font_size 42
   xpos -2260
   ypos 3390
   bdwidth 300
   bdheight 667
  }
  BackdropNode {
   inputs 0
   name BackdropNode5
   label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
   xpos -1922
   ypos 791
   bdwidth 411
   bdheight 201
  }
  Input {
   inputs 0
   name Input1
   xpos -984
   ypos -137
  }
  Dot {
   name Dot4
   label xyzc
   xpos -950
   ypos -97
  }
  Dot {
   name Dot5
   xpos -950
   ypos -21
  }
set N6b4e3400 [stack 0]
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   name M_to_xyzp
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -984
   ypos 30
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   name _M_XYZP_TO_LMS
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -984
   ypos 102
  }
  Dot {
   name Dot1
   label LMS
   xpos -950
   ypos 154
  }
  Expression {
   expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
   expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
   expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
   name Expression1
   label "# response compression: lms to lms'"
   xpos -984
   ypos 199
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  Dot {
   name Dot2
   label lmsp
   xpos -950
   ypos 260
  }
set N6b4e2000 [stack 0]
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_ZCAM
   xpos -912
   ypos 329
  }
  Add {
   value -3.703522621e-11
   name Add1
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -912
   ypos 353
  }
  Dot {
   name Dot6
   label Iabz
   xpos -878
   ypos 411
  }
push $N6b4e2000
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   name _M_LMSP_TO_IAB_JABZ
   xpos -1053
   ypos 328
  }
  Dot {
   name Dot7
   label Iabz
   xpos -1019
   ypos 410
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters
   xpos -978
   ypos 441
  }
set N6b500800 [stack 0]
  Expression {
   expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
   name Expression2
   label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
   xpos -886
   ypos 492
  }
push $N6b500800
  Switch {
   inputs 2
   name use_zcam_parameters1
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -978
   ypos 564
  }
  Dot {
   name Dot3
   label iabz
   xpos -944
   ypos 753
  }
set N6b4e0400 [stack 0]
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(b,g)*r2d
   channel0 rgba
   expr0 h
   name h
   xpos -1074
   ypos 904
  }
set N6b48bc00 [stack 0]
  Expression {
   temp_name0 h
   temp_expr0 r
   channel0 rgba
   expr0 "1.015 + cos((h + 89.038)*pi/180)"
   name ez
   xpos -1074
   ypos 928
  }
push $N6b4e0400
  Copy {
   inputs 2
   from0 rgba.red
   to0 rgba.red
   name Copy1
   xpos -894
   ypos 989
  }
  Expression {
   channel0 rgba
   expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
   name M_colorfulness
   label "# calculate colorfulness, M:"
   xpos -894
   ypos 1021
  }
set N6b48b000 [stack 0]
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C
   label "# calculate chroma, C:"
   xpos -894
   ypos 1118
  }
set N6b48ac00 [stack 0]
push $N6b4e0400
  Expression {
   channel0 rgba
   expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
   name Q
   label "# calculate brightness, Q:"
   xpos -1030
   ypos 1019
  }
set N6b48a800 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100.0 * (r/Constants.Qw)"
   name J
   label "# calculate lightness, J:"
   xpos -1030
   ypos 1117
  }
set N6b48a400 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy3
   xpos -1030
   ypos 1155
  }
set N6b48a000 [stack 0]
  Expression {
   channel0 rgba
   expr0 "100 - ((100-r)**2 + g**2)**0.5"
   name Wz
   label "# calculate whiteness, W:"
   xpos -1030
   ypos 1195
  }
set N6b489c00 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam
   fromInput2 {{0} B}
   mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
   name Shuffle2
   xpos -1202
   ypos 1199
  }
push $N6b48bc00
  Dot {
   name Dot9
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1975
   ypos 2339
  }
push $N6b4e0400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
   name Iz
   xpos -1127
   ypos 835
  }
push $N6b4e0400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
   name az
   xpos -978
   ypos 837
  }
push $N6b4e0400
  Shuffle2 {
   fromInput1 {{0} B}
   fromInput2 {{0} B}
   mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
   name bz
   xpos -825
   ypos 835
  }
  NoOp {
   inputs 0
   name Constants
   xpos -527
   ypos 180
   addUserKnob {20 User}
   addUserKnob {26 _1 l _SURROUND_PARAMETERS}
   addUserKnob {4 surrounds M {average dim dark}}
   addUserKnob {7 c}
   c {{curve(surrounds) 0.69 0.59 0.525}}
   addUserKnob {7 Nc}
   Nc {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 F}
   F {{curve(surrounds) 1 0.9 0.8}}
   addUserKnob {7 FLL}
   FLL {{curve(surrounds) 1 1 1}}
   addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
   addUserKnob {7 La}
   La 100
   addUserKnob {7 Yb}
   Yb 20
   addUserKnob {4 surround M {avg dim dark}}
   addUserKnob {7 D}
   D 1
   addUserKnob {7 Dtype}
   addUserKnob {26 ""}
   addUserKnob {18 xyzw_d65}
   xyzw_d65 {95.043 100 108.89}
   addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 xyzw}
   xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
   addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {26 ""}
   addUserKnob {7 Yw}
   Yw 100
   addUserKnob {7 FL}
   FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
   addUserKnob {7 n}
   n {{Yb/Yw}}
   addUserKnob {7 Fb}
   Fb {{n**0.5}}
   addUserKnob {7 Fs}
   Fs {{c}}
   addUserKnob {26 ""}
   addUserKnob {18 xyzwc}
   xyzwc {95.043 100 108.89}
   addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {18 iabzw}
   iabzw {0.31331 -0.00014318 -8.9369e-05}
   addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {7 Qw}
   Qw 185.85
  }
push $N6b4e3400
push $N6b48bc00
push $N6b48b000
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy5
   xpos 67
   ypos 1136
  }
set N6b807c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bM
   xpos 163
   ypos 1202
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
   name Shuffle11
   xpos -752
   ypos 1400
  }
push $N6b807c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aM
   xpos 67
   ypos 1203
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aM
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
   name Shuffle10
   xpos -848
   ypos 1400
  }
push $N6b48bc00
push $N6b48ac00
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy25
   xpos -164
   ypos 1149
  }
set N6b806800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bC
   xpos -76
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
   name Shuffle25
   xpos -949
   ypos 1399
  }
push $N6b806800
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aC
   xpos -164
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aC
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
   name Shuffle24
   xpos -1048
   ypos 1397
  }
push $N6b48bc00
push $N6b48a800
push $N6b48b000
  Copy {
   inputs 2
   from1 rgba.green
   to1 rgba.green
   name Copy2
   xpos -734
   ypos 1076
  }
  Expression {
   channel0 rgba
   expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
   name s
   label "# calculate saturation, s:"
   xpos -734
   ypos 1118
  }
set N6b805000 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy24
   xpos -381
   ypos 1143
  }
set N6b804c00 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180.0)
   name bS
   xpos -287
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_bS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
   name Shuffle23
   xpos -1150
   ypos 1398
  }
push $N6b804c00
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180.0)
   name aS
   xpos -381
   ypos 1207
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_aS
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
   name Shuffle22
   xpos -1254
   ypos 1395
  }
push $N6b48a000
  Expression {
   channel0 rgba
   expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
   name Vz
   label "# calculate vividness, V:"
   xpos -583
   ypos 1200
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Vz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
   name Shuffle9
   xpos -1345
   ypos 1396
  }
push $N6b805000
  Expression {
   channel0 rgba
   name Sz
   label "# calculate saturation, S:"
   xpos -734
   ypos 1196
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
   name Shuffle8
   xpos -1436
   ypos 1395
  }
push $N6b48a000
  Expression {
   channel0 rgba
   expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
   name Kz
   label "# calculate blackness, K:"
   xpos -895
   ypos 1195
  }
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Kz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
   name Shuffle7
   xpos -1524
   ypos 1393
  }
push $N6b489c00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Wz
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
   name Shuffle6
   xpos -1613
   ypos 1393
  }
push $N6b805000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_s
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
   name Shuffle5
   xpos -1708
   ypos 1392
  }
push $N6b48ac00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_C
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
   name Shuffle4
   xpos -1798
   ypos 1391
  }
push $N6b48a400
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_J
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
   name Shuffle1
   xpos -1900
   ypos 1390
  }
push $N6b48b000
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_M
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
   name Shuffle12
   xpos -1999
   ypos 1389
  }
push $N6b48a800
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
   name Shuffle3
   xpos -2089
   ypos 1391
  }
push $N6b48bc00
  Shuffle2 {
   fromInput1 {{0} B}
   out1 zcam_h
   fromInput2 {{0} B}
   mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
   name Shuffle13
   xpos -2182
   ypos 1392
  }
push $N6b4e3400
  Dot {
   name Dot16
   xpos -2265
   ypos 1253
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_h
   name Copy21
   xpos -2299
   ypos 1416
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Q
   name Copy22
   xpos -2299
   ypos 1458
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_M
   name Copy20
   xpos -2298
   ypos 1505
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_J
   name Copy11
   xpos -2298
   ypos 1547
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_C
   name Copy12
   xpos -2298
   ypos 1589
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_s
   name Copy13
   xpos -2302
   ypos 1631
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Wz
   name Copy14
   xpos -2302
   ypos 1673
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Kz
   name Copy15
   xpos -2302
   ypos 1715
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Sz
   name Copy16
   xpos -2302
   ypos 1757
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_Vz
   name Copy17
   xpos -2302
   ypos 1799
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aS
   name Copy26
   xpos -2302
   ypos 1841
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bS
   name Copy27
   xpos -2302
   ypos 1883
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aC
   name Copy28
   xpos -2302
   ypos 1925
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bC
   name Copy29
   xpos -2302
   ypos 1963
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_aM
   name Copy18
   xpos -2302
   ypos 2005
  }
  Copy {
   inputs 2
   from0 -rgba.alpha
   to0 -rgba.alpha
   channels zcam_bM
   name Copy19
   xpos -2302
   ypos 2047
  }
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction1
   xpos -2302
   ypos 2112
  }
  Dot {
   name Dot17
   xpos -2268
   ypos 2157
  }
set N6bac3400 [stack 0]
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_h
   fromInput2 {{0} B}
   mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
   name Shuffle20
   xpos -1041
   ypos 2260
  }
  Dot {
   name Dot41
   label h
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1007
   ypos 2349
  }
  Dot {
   name Dot33
   label "h in outIn"
   xpos -1007
   ypos 2613
  }
set N6bac2800 [stack 0]
  Dot {
   name Dot34
   xpos -1007
   ypos 2652
  }
push $N6bac2800
  Dot {
   name Dot35
   xpos -1034
   ypos 2640
  }
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bS
   fromInput2 {{0} B}
   in2 zcam_aS
   mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
   name Shuffle16
   label "aS & bS"
   note_font_size 15
   xpos -1489
   ypos 2304
  }
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bC
   fromInput2 {{0} B}
   in2 zcam_aC
   mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
   name Shuffle17
   label "aC & bC"
   note_font_size 15
   xpos -1585
   ypos 2304
  }
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_bM
   fromInput2 {{0} B}
   in2 zcam_aM
   mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
   name Shuffle26
   label "aM & bM"
   note_font_size 15
   xpos -1682
   ypos 2303
  }
  Switch {
   inputs 3
   which {{parent.inverseData1}}
   name inputdata_abX_mode
   xpos -1543
   ypos 2400
  }
  Dot {
   name Dot30
   xpos -1509
   ypos 2449
  }
set N6bac1000 [stack 0]
  Dot {
   name Dot29
   xpos -1210
   ypos 2483
  }
  Expression {
   temp_name0 r2d
   temp_expr0 180.0/pi
   temp_name1 h360
   temp_expr1 "360.0\n"
   temp_name2 h
   temp_expr2 atan2(g,r)*r2d
   channel0 rgba
   expr0 h
   name inv_h
   label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
   xpos -1244
   ypos 2546
  }
  Dot {
   name Dot36
   label "a in outIn"
   xpos -1210
   ypos 2619
  }
set N6bac0400 [stack 0]
  Dot {
   name Dot37
   xpos -1163
   ypos 2636
  }
push $N6bac0400
  Dot {
   name Dot38
   xpos -1185
   ypos 2648
  }
push $N6bac0400
  Dot {
   name Dot39
   xpos -1210
   ypos 2663
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode1
   label MCs
   xpos -1116
   ypos 2672
  }
  Dot {
   name Dot40
   xpos -1210
   ypos 2719
  }
set N6ba73000 [stack 0]
push $N6ba73000
  Expression {
   channel0 rgba
   expr0 "1.015 + cos((r + 89.038)*pi/180)"
   name inv_ez
   xpos -1244
   ypos 2756
  }
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_C
   fromInput2 {{0} B}
   mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
   name Shuffle21
   xpos -1357
   ypos 2252
  }
  Dot {
   name Dot42
   label C
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1323
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs2
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1357
   ypos 2501
  }
  Dot {
   name Dot43
   label "h in outIn"
   xpos -1323
   ypos 2578
  }
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_M
   fromInput2 {{0} B}
   mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
   name Shuffle19
   xpos -1442
   ypos 2252
  }
  Dot {
   name Dot31
   label M
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1408
   ypos 2341
  }
  Expression {
   channel0 rgba
   expr0 r
   name MCs1
   label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
   xpos -1442
   ypos 2501
  }
  Dot {
   name Dot25
   label "h in outIn"
   xpos -1408
   ypos 2575
  }
push $N6bac1000
  Expression {
   channel0 rgba
   expr0 "(r**2.0 + g**2.0)**0.5"
   name MCs
   label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
   xpos -1645
   ypos 2460
  }
  Dot {
   name Dot24
   label "a in outIn"
   xpos -1611
   ypos 2581
  }
set N6ba70400 [stack 0]
  Dot {
   name Dot28
   xpos -1564
   ypos 2598
  }
push $N6ba70400
  Dot {
   name Dot27
   xpos -1586
   ypos 2610
  }
push $N6ba70400
  Dot {
   name Dot26
   xpos -1611
   ypos 2625
  }
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inverseData1_Mode
   label MCs
   xpos -1517
   ypos 2634
  }
set N6b810800 [stack 0]
  Expression {
   channel0 rgba
   expr0 r
   name C_from_aC
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -1926
   ypos 2714
  }
set N6ba1b000 [stack 0]
  Dot {
   name Dot44
   label C,h
   xpos -1673
   ypos 2768
  }
push $N6b810800
  Expression {
   channel0 rgba
   expr0 100*r/Constants.Qw
   name C_from_aM
   label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
   xpos -2036
   ypos 2713
  }
set N6ba1a800 [stack 0]
  Dot {
   name Dot20
   label M,h
   xpos -1737
   ypos 2767
  }
push $N6b810800
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Q
   fromInput2 {{0} B}
   mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
   name Shuffle18
   xpos -2182
   ypos 2257
  }
  Dot {
   name Dot21
   label Q
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1996
   ypos 2435
  }
set N6ba19c00 [stack 0]
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_J
   fromInput2 {{0} B}
   mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
   name Shuffle14
   xpos -2302
   ypos 2259
  }
  Dot {
   name Dot8
   label J
   note_font_size 20
   note_font_color 0x677754ff
   xpos -2229
   ypos 2434
  }
  Dot {
   name Dot22
   xpos -2229
   ypos 2456
  }
set N6ba19000 [stack 0]
  Expression {
   channel0 rgba
   expr0 Constants.Qw*(r/100)
   name Q_from_J
   label "# Get Lightness J and brightness Q from data:"
   xpos -2263
   ypos 2519
  }
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode
   label Q
   xpos -2263
   ypos 2564
  }
set N6b810100 [stack 0]
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy30
   xpos -1818
   ypos 2676
  }
  Expression {
   temp_name0 M
   temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
   channel0 rgba
   expr0 100*M/Constants.Qw
   name C_from_aS
   label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
   xpos -1818
   ypos 2708
  }
push $N6ba1b000
push $N6ba1a800
  Switch {
   inputs 5
   which {{parent.inverseData1}}
   name inputdata_abX_mode1
   xpos -1926
   ypos 2799
  }
  Expression {
   channel0 rgba
   expr0 "Constants.Qw * r / 100"
   name inv_M
   label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
   xpos -1543
   ypos 2822
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy7
   xpos -1543
   ypos 2874
  }
  Expression {
   channel0 rgba
   expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
   name inv_t
   label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
   xpos -1543
   ypos 2906
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy8
   xpos -1543
   ypos 2986
  }
set N6b9bb000 [stack 0]
  Expression {
   channel0 rgba
   expr0 r*sin(g*pi/180)
   name inv_bz
   label t*np.sin(h*np.pi/180)
   xpos -1402
   ypos 3067
  }
push $N6b9bb000
  Expression {
   channel0 rgba
   expr0 r*cos(g*pi/180)
   name inv_az
   label "az = t*np.cos(h*np.pi/180)"
   xpos -1543
   ypos 3064
  }
push $N6b810100
  Expression {
   channel0 rgba
   expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
   name inv_Iz
   label "# calculate achromatic signal, Iz:"
   xpos -2263
   ypos 2619
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy9
   xpos -2181
   ypos 3184
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy10
   xpos -2181
   ypos 3216
  }
  Dot {
   name Dot15
   label iabz
   note_font_size 20
   xpos -2147
   ypos 3275
  }
  Dot {
   name Dot13
   xpos -2145
   ypos 3414
  }
  Dot {
   name Dot14
   xpos -2145
   ypos 3470
  }
set N6b9b9000 [stack 0]
  Expression {
   expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
   name Expression3
   label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
   xpos -2050
   ypos 3532
  }
push $N6b9b9000
  Switch {
   inputs 2
   name use_zcam_parameters2
   label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
   xpos -2179
   ypos 3608
  }
set N6b9c3200 [stack 0]
  Dot {
   name Dot19
   label Iabz
   xpos -2092
   ypos 3678
  }
  Add {
   value 3.703522621e-11
   name Add2
   label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
   xpos -2126
   ypos 3712
  }
  ColorMatrix {
   matrix {
       {0 1 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_ZCAM1
   xpos -2126
   ypos 3750
  }
push $N6b9c3200
  Dot {
   name Dot18
   label Iabz
   xpos -2216
   ypos 3683
  }
  ColorMatrix {
   matrix {
       {0.5 0.5 0}
       {3.524 -4.066708 0.542708}
       {0.199076 1.096799 -1.295875}
     }
   invert true
   name _M_LMSP_TO_IAB_JABZ1
   xpos -2250
   ypos 3748
  }
  Switch {
   inputs 2
   which 1
   name use_zcam_parameters3
   xpos -2182
   ypos 3844
  }
  Expression {
   expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
   expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
   expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
   name Expression4
   label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
   xpos -2182
   ypos 3874
   addUserKnob {20 _PQ_PARAMETERS}
   addUserKnob {7 c1}
   c1 {{3424/2**12}}
   addUserKnob {7 c2}
   c2 {{2413/2**7}}
   addUserKnob {7 c3}
   c3 {{2392/2**7}}
   addUserKnob {7 n}
   n {{2610/2**14}}
   addUserKnob {7 p}
   p {{1.7*2523/2**5}}
  }
  ColorMatrix {
   matrix {
       {0.41478972 0.579999 0.014648}
       {-0.20151 1.120649 0.0531008}
       {-0.0166008 0.2648 0.6684799}
     }
   invert true
   name _M_XYZP_TO_LMS1
   label "# Define X',Y',Z' to L,M,S conversion matrix:"
   xpos -2182
   ypos 3949
  }
  ColorMatrix {
   matrix {
       {{b} 0 {1-b}}
       {{1-g} {g} 0}
       {0 0 1}
     }
   invert true
   name M_to_xyzp1
   label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
   xpos -2182
   ypos 3981
   addUserKnob {20 User}
   addUserKnob {7 b}
   b 1.15
   addUserKnob {7 g}
   g 0.66
  }
push $N6bac3400
  Switch {
   inputs 2
   which {{parent.direction}}
   name direction
   xpos -1519
   ypos 4172
  }
  Output {
   name Output1
   xpos -1519
   ypos 4272
  }
push $N6bac3400
  Dot {
   name Dot11
   label aM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1535
   ypos 2170
  }
push $N6bac3400
  Dot {
   name Dot12
   label bM
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1439
   ypos 2173
  }
push $N6b810100
push $N6bac3400
  Shuffle2 {
   fromInput1 {{0} B}
   in1 zcam_Sz
   fromInput2 {{0} B}
   mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
   name Shuffle15
   xpos -1870
   ypos 2254
  }
  Dot {
   name Dot10
   label Sz
   note_font_size 20
   note_font_color 0x677754ff
   xpos -1836
   ypos 2342
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy4
   xpos -1770
   ypos 2555
  }
  Expression {
   expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
   name inv_C
   label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
   xpos -1770
   ypos 2587
  }
push $N6bac1000
  Dot {
   name Dot23
   label "H in outIn"
   xpos -1509
   ypos 2582
  }
  Dot {
   inputs 0
   name Dot32
   label "H in outIn"
   xpos -1108
   ypos 2620
  }
push $N6ba19c00
  Expression {
   channel0 rgba
   expr0 "100.0* (r/Constants.Qw)"
   name J_from_Q
   xpos -2030
   ypos 2479
  }
push $N6ba19000
  Switch {
   inputs 2
   which {{parent.inverseData0}}
   name InverseData0_Mode1
   label J
   xpos -2030
   ypos 2527
  }
push $N6b810800
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy23
   xpos -1596
   ypos 2681
  }
  Expression {
   channel0 rgba
   expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
   name inv3_C
   label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
   xpos -1596
   ypos 2713
  }
  Constant {
   inputs 0
   channels rgb
   color 0.034705
   name Constant1
   xpos -440
   ypos 2450
  }
 end_group
 Multiply {
  value 0.01
  name Multiply13
  label "Div by 100 to go from nits"
  xpos 1354
  ypos 715
 }
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
  name Shuffle36
  xpos 1354
  ypos 757
 }
 Colorspace {
  colorspace_in CIE-XYZ
  name Colorspace25
  label "XYZ to sRGB Prims"
  xpos 1354
  ypos 781
 }
 Output {
  name Output1
  xpos 1354
  ypos 888
 }
push $N6ae73800
push $N6b572c00
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {-0.20703125 -0.3359375 -0.205078125 -0.333984375}
  name Viewer1
  xpos 409
  ypos 450
 }
end_group
Write {
 file /Users/afry/GitHub/nukeZCAM/images/examples/BlueBar_ZCAMishDRTv04_sRGB_noLimit.jpg
 file_type jpeg
 checkHashOnRead false
 version 1
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write14
 xpos 3652
 ypos 2143
}
push $N6437eb00
push 0
push $N66f77200
push $N6952dc00
Crop {
 box {0 920 582 2198}
 name Crop7
 xpos 3175
 ypos 2175
}
Group {
 name PlotChromaticity5
 xpos 3175
 ypos 2199
 addUserKnob {20 PlotChromaticity_tab l PlotChromaticity}
 addUserKnob {6 use_gpu l "Use GPU if available" +STARTLINE}
 use_gpu true
 addUserKnob {26 ""}
 addUserKnob {6 plot_input l "plot input" t "Enable plotting of the input pixels" +STARTLINE}
 plot_input true
 addUserKnob {41 input_gamut l gamut t "Set the gamut that the input colors are encoded in" -STARTLINE T GamutToXYZ.gamut}
 addUserKnob {4 diagram l in t "Choose the type of chromaticity diagram: \nCIE 1931 xy Chromaticity Diagram\nCIE 1976 u' v' Uniform Chromaticity Scale Diagram" -STARTLINE M {"CIE 1931 xy" "CIE 1976 u' v'" "" ""}}
 diagram "CIE 1976 u' v'"
 addUserKnob {6 enable_sample_color l "sample color" t "Enable plotting of the sampled color" +STARTLINE}
 enable_sample_color true
 addUserKnob {41 sample_color l color t "sample and plot selected color" T SampleColor.color}
 addUserKnob {22 follow_viewer l "follow viewer" t "Follow the selected viewer node. This causes this node to automatically connect to whatever the followed viewer is connected to.\n\nThis is useful if you want to have a 2nd viewer showing a chromaticity plot for whever you're looking at in your main viewer." T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to follow.')\nelse:\n    v\['knobChanged'].setValue('v = nuke.activeViewer().node()\\nif v and v.name() == nuke.thisNode().name():\\n    con = v.input(nuke.activeViewer().activeInput())\\n    plt = nuke.toNode(\"\{0\}\")\\n    plt.setInput(0, con)'.format(n.name()))" +STARTLINE}
 addUserKnob {22 unfollow_viewer l "unfollow viewer" -STARTLINE T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to unfollow.')\nelse:\n    v\['knobChanged'].setValue('')"}
 addUserKnob {26 plot_dimensions_label l " " T "<b>Chromaticity Diagram"}
 addUserKnob {3 resolution l " resolution" t "resolution to output"}
 resolution 2048
 addUserKnob {7 right_margin l "right margin" R 1 1.5}
 right_margin 1.1
 addUserKnob {7 left_margin l "left margin" R 0 0.2}
 left_margin 0.1
 addUserKnob {6 draw_spectral_locus l "spectrum locus" t "draw the spectrum locus: the boundary of color the human eye can see." +STARTLINE}
 draw_spectral_locus true
 addUserKnob {6 draw_line_of_purples l "line of purples" t "draw the \"line of purples\"" -STARTLINE}
 draw_line_of_purples true
 addUserKnob {6 draw_planckian_locus l "planckian locus" t "Display the planckian locus or the blackbody locus." +STARTLINE}
 addUserKnob {6 gamut_grid l "gamut grid" t "Display a gamut boundary with a grid or dot pattern" +STARTLINE}
 addUserKnob {41 gamut_gamutgrid l "" t "gamut for gamutgrid" -STARTLINE T RGBToXYZ_GamutGrid.gamut}
 addUserKnob {4 gamut_grid_style l style t "Choose the style to display the gamut plot" -STARTLINE M {grid dots "" "" "" ""}}
 addUserKnob {4 distribution l dist t "Which chromaticity space should the overlays be constructed in? \n\nYxy is familiar, but not very perceptually uniform.\n\nu'v' is designed to be more perceptually uniform." -STARTLINE M {"1931 Yxy" "1976 u'v'" "" ""}}
 addUserKnob {7 density t "Density of the grid or points" R 10 100}
 density 50
 addUserKnob {6 gamut_a l "gamut a" t "Display a gamut outline" +STARTLINE}
 gamut_a true
 addUserKnob {41 gamut_a_1 l "" -STARTLINE T RGBToXYZ_GamutA.gamut}
 addUserKnob {6 gamut_b l "gamut b" t "Display a gamut outline" +STARTLINE}
 addUserKnob {41 gamut_b_1 l "" -STARTLINE T RGBToXYZ_GamutB.gamut}
 addUserKnob {6 gamut_c l "gamut c" t "Display a gamut outline" +STARTLINE}
 gamut_c true
 addUserKnob {41 gamut_c_1 l "" -STARTLINE T RGBToXYZ_GamutC.gamut}
 addUserKnob {6 draw_pointers_gamut l "pointer's gamut" t "DrawPointer's gamut boundary" +STARTLINE}
 addUserKnob {6 draw_pointers_samples l "pointers sample colors" t "show the individual pointer gamut samples" -STARTLINE}
 addUserKnob {6 draw_macbeth_chart l "macbeth chart" t "draw a ColorChecker24 aka Macbeth Chart" +STARTLINE}
 addUserKnob {6 coordinate_system l "coordinate system" t "Draw CIE xy coordinate grid x and y axes" +STARTLINE}
 coordinate_system true
 addUserKnob {6 map_overlays_to_input_gamut l "map overlays to input gamut" t "This maps the overlays like the spectral locus, pointer's gamut, and the gamut overlay to the working gamut instead of keeping them as XYZ.\n\nFor example if the input gamut is ACEScg, these overlays will be mapped to that. Note that this can cause most of the overlays to be negative or highly saturated which might harm the visual appearance." +STARTLINE}
 map_overlays_to_input_gamut true
}
 Group {
  inputs 0
  name GamutGrid1
  xpos -920
  ypos -201
  postage_stamp true
  addUserKnob {20 GamutGrid}
  addUserKnob {3 style}
  style {{!parent.gamut_grid_style}}
  addUserKnob {3 distribution -STARTLINE}
  distribution {{parent.distribution}}
  addUserKnob {7 density R 10 150}
  density {{parent.density}}
  addUserKnob {26 ""}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {12 wxy}
  wxy {{parent.RGBToXYZ_GamutGrid.wxy} {parent.RGBToXYZ_GamutGrid.wxy}}
 }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   centerSaturation 1
   fillFormat false
   area {-170 -158 682 670}
   name ColorWheel4
   xpos -260
   ypos -15
   postage_stamp false
  }
  Crop {
   box {0 0 {width} {height}}
   crop false
   name Crop2
   xpos -260
   ypos 27
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat3
   xpos -260
   ypos 110
  }
set N6b8dcc00 [stack 0]
push $N6b8dcc00
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   roworder TopBottom
   name ContactSheet2
   xpos -260
   ypos 169
  }
  Dot {
   name Dot1
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -226
   ypos 246
  }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   fillFormat false
   area {40 40 472 472}
   name ColorWheel1
   xpos -40
   ypos -664
   postage_stamp false
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat1
   xpos -40
   ypos -628
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   name Crop1
   xpos -40
   ypos -602
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos -526
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos -415
  }
  Colorspace {
   colorspace_in CIE-XYZ
   colorspace_out CIE-Yxy
   name Colorspace1
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -341
  }
set N6b85a000 [stack 0]
  Dot {
   name Dot2
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos -331
  }
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression5
   label "CIE Yxy to CIELuv"
   xpos -590
   ypos -304
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 "(-(degrees(atan2(g-white.x, b-white.y))-180)+270)%360/360"
   expr2 "hypot(g-white.x, b-white.y)"
   expr3 a
   name Expression3
   xpos -590
   ypos -261
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{"parent.distribution ? 4*parent.wxy.x / ( -2 * parent.wxy.x + 12 * parent.wxy.y + 3) : parent.wxy"} {"parent.distribution ? 9*parent.wxy.y / ( -2*parent.wxy.x + 12*parent.wxy.y + 3) : parent.wxy"}}
  }
set N6b859400 [stack 0]
  Posterize {
   channels rgb
   Colors {{rint(parent.density/3*2)}}
   name Posterize1
   xpos -590
   ypos -191
  }
set N6b859000 [stack 0]
push $N6b859400
  Dot {
   name Dot15
   xpos -446
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy1
   xpos -480
   ypos -154
  }
push $N6b859000
push $N6b859400
  Dot {
   name Dot16
   xpos -666
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy2
   xpos -700
   ypos -153
  }
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   center true
   roworder TopBottom
   name ContactSheet3
   xpos -590
   ypos -106
  }
  Expression {
   expr0 r
   expr1 cos(radians(g*360))*b+white.x
   expr2 sin(radians(g*360))*b+white.y
   expr3 a
   name Expression19
   xpos -590
   ypos -58
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{parent.Expression3.white} {parent.Expression3.white}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression2
   label "CIELuv to CIE Yxy"
   xpos -590
   ypos -16
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace2
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -590
   ypos 32
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix1
   label "XYZ to RGB"
   xpos -590
   ypos 81
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin2
   xpos -590
   ypos 119
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp1
   xpos -590
   ypos 152
  }
  Premult {
   name Premult1
   xpos -590
   ypos 194
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge2
   xpos -590
   ypos 242
  }
  Fill {
   output alpha
   name Fill1
   xpos -590
   ypos 297
  }
  Dot {
   name Dot3
   label " GRID"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos 378
  }
push $N6b8dcc00
push $N6b85a000
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression4
   label "CIE Yxy to CIELuv"
   xpos -40
   ypos -280
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 rint(g*Colors)/Colors
   expr2 rint(b*Colors)/Colors
   expr3 a
   name Expression1
   label rint
   xpos -40
   ypos -232
   addUserKnob {20 User}
   addUserKnob {7 Colors R 1 256}
   Colors {{parent.density}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression6
   label "CIELuv to CIE Yxy"
   xpos -40
   ypos -184
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace3
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -112
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix3
   label "XYZ to RGB"
   xpos -40
   ypos -57
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp4
   xpos -40
  }
  Premult {
   name Premult2
   xpos -40
   ypos 55
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge1
   xpos -40
   ypos 110
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin1
   xpos -40
   ypos 273
  }
  Dot {
   name Dot4
   label " DOTS"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 378
  }
  Switch {
   inputs 2
   which {{parent.style}}
   name Switch1
   xpos -257
   ypos 483
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix2
   label "RGB to XYZ"
   xpos -257
   ypos 560
  }
  Output {
   name Output
   xpos -257
   ypos 740
  }
  ColorWheel {
   inputs 0
   format "256 256 0 0 256 256 1 square_256"
   area {40 40 472 472}
   name ColorWheel2
   xpos -37
   ypos -705
   postage_stamp false
  }
 end_group
set N6b88b200 [stack 0]
 Group {
  name RGBToXYZ_GamutGrid
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos -184
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorWheel {
  inputs 0
  format "512 512 0 0 512 512 1 square_512"
  centerSaturation 1
  fillFormat false
  area {-196 -184 708 696}
  name ColorWheel1
  xpos -920
  ypos 5
 }
 Crop {
  box {0 0 {width} {height}}
  name Crop1
  xpos -920
  ypos 87
 }
 BlackOutside {
  name BlackOutside3
  xpos -920
  ypos 134
 }
set N6bf1bc00 [stack 0]
 Group {
  name RGBToXYZ_GamutC
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1140
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r+input.width} {parent.ReformatBox4.box_width-input.height}}
  name Position6
  xpos -1140
  ypos 254
 }
push $N6bf1bc00
 Group {
  name RGBToXYZ_GamutB
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height*2}}
  name Position5
  xpos -1030
  ypos 254
 }
push $N6bf1bc00
 Group {
  name RGBToXYZ_GamutA
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -920
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position4
  xpos -920
  ypos 254
 }
push $N6b88b200
 Reformat {
  type scale
  scale 0.8
  turn true
  filter impulse
  black_outside true
  name Reformat2
  xpos -920
  ypos -129
 }
 BlackOutside {
  name BlackOutside2
  xpos -920
  ypos -106
 }
 Position {
  translate {{Rectangle1.area.r} {parent.Position3.translate.y-input.height}}
  name Position2
  xpos -920
  ypos -81
 }
 Group {
  inputs 0
  name ColorChecker24_After_November_2014
  label "CIE XYZ D50"
  xpos -920
  ypos -352
  addUserKnob {20 colorchecker_tab l "ColorChecker24 - After November 2014"}
  addUserKnob {3 patch_resolution}
  patch_resolution 48
 }
  Group {
   inputs 0
   name bluish_green
   selected true
   xpos 622
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.30451114 0.4143554688 0.344352688 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "bluish green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 6
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_flower
   xpos 512
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2419823988 0.2287175998 0.3282104382 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue flower"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 5
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name foliage
   xpos 402
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1114392339 0.1346792679 0.05239320311 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob foliage
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 4
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_sky
   xpos 292
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1652470004 0.1785519348 0.2546024121 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue sky"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 3
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name light_skin
   xpos 180
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3811104477 0.336202304 0.1852590702 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "light skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 2
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 135
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name dark_skin
   xpos 70
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1136398927 0.09832436105 0.047793811 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "dark skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 1
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 290
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 290
    ypos 158
   }
   Output {
    name Output
    xpos 290
    ypos 230
   }
  end_group
  Group {
   inputs 0
   name orange_yellow
   xpos 622
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4769723742 0.4293377578 0.06005041429 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "orange yellow"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 12
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow_green
   xpos 512
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3427379502 0.4331759409 0.08330791241 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "yellow green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 11
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purple
   xpos 401
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08353888545 0.06276662955 0.1042075686 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob purple
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 10
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name moderate_red
   xpos 290
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2915036416 0.188999956 0.09736350318 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "moderate red"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 9
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purplish_blue
   xpos 180
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1200518326 0.1091090233 0.2874447494 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "purplish blue"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 8
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name orange
   xpos 74
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4073691399 0.3126416159 0.05130591012 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob orange
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 7
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name cyan
   xpos 622
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1247966941 0.180609913 0.2913392383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob cyan
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 18
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name magenta
   xpos 512
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.299122798 0.1895114577 0.2213469194 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob magenta
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 17
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow
   xpos 399
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5888922356 0.5992976803 0.07077420003 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob yellow
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 16
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 182
   }
  end_group
  Group {
   inputs 0
   name red
   xpos 292
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2143728424 0.127800835 0.03868150726 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob red
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 15
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name green
   xpos 182
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1413517689 0.2233437582 0.07287461742 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob green
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 14
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue
   xpos 72
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.06809095613 0.05596214063 0.2077405936 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob blue
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 13
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name black_2
   xpos 623
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.03042544265 0.03151319431 0.02656724434 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "black 2 (1.5 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 24
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_3
   xpos 512
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08448968042 0.08817234828 0.07391630753 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 3.5 (1.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 23
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_5
   xpos 403
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1835495863 0.1906228754 0.1566717383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 5 (.70 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 22
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_6
   xpos 292
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3495921991 0.3648652066 0.3013565492 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 6.5 (.44 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 21
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_8
   xpos 179
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5665335579 0.5899709702 0.4828473821 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 8 (.23 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 20
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name white_9
   xpos 70
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.8436985288 0.8806903203 0.6936778752 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "white 9.5 (.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 19
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 134
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  ContactSheet {
   inputs 24
   width {{"rint(parent.patch_resolution * 6 + gap * 7)"}}
   height {{"rint(parent.patch_resolution * 4 + gap * 5)"}}
   rows 4
   columns 6
   startframe 1
   endframe 1
   name ContactSheet
   xpos 620
   ypos 206
  }
  Unpremult {
   name Unpremult1
   xpos 620
   ypos 278
  }
  Output {
   name Output
   xpos 620
   ypos 446
  }
 end_group
 BlackOutside {
  name BlackOutside4
  xpos -920
  ypos -298
 }
 Position {
  translate {{parent.Reformat1.box_width*3+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position7
  xpos -920
  ypos -273
 }
 Constant {
  inputs 0
  format "256 256 0 0 256 256 1 square_256"
  name Constant5
  xpos -700
  ypos -1354
  postage_stamp false
 }
 Dot {
  name Dot25
  xpos -666
  ypos -1302
 }
set N6bc90400 [stack 0]
 Dot {
  name Dot27
  xpos -1546
  ypos -1302
 }
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox1
  xpos -1580
  ypos -994
 }
 Ramp {
  p0 {0 0}
  p1 {{input.width} 0}
  color {{p1}}
  name Ramp3
  xpos -1580
  ypos -898
 }
 ColorLookup {
  lut {master {}
    red {curve 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914}
    green {curve 0.433 0.464 0.513 0.611 0.576 0.46 0.426 0.412 0.404 0.397 0.384 0.374 0.346 0.333 0.311 0.287 0.257 0.23 0.21 0.219 0.208 0.211 0.208 0.187 0.191 0.187 0.18 0.164 0.17 0.177 0.175 0.188 0.252 0.325 0.385 0.416 0.433 0.487 0.532 0.588 0.637 0.634 0.549 0.506 0.49 0.458 0.426 0.412 0.397 0.365 0.337 0.301 0.262 0.221 0.192 0.164 0.167 0.162 0.176 0.179 0.148 0.156 0.142 0.148 0.138 0.145 0.145 0.161 0.197 0.256 0.324 0.393 0.451 0.487 0.508 0.538 0.587 0.634 0.659 0.611 0.552 0.526 0.484 0.452 0.428 0.406 0.371 0.334 0.293 0.243 0.204 0.177 0.151 0.151 0.162 0.158 0.161 0.142 0.141 0.129 0.134 0.14 0.156 0.166 0.192 0.221 0.265 0.325 0.392 0.451 0.508 0.48 0.513 0.554 0.597 0.63 0.634 0.58 0.546 0.499 0.466 0.434 0.408 0.372 0.332 0.288 0.242 0.202 0.179 0.16 0.157 0.162 0.157 0.159 0.149 0.153 0.147 0.154 0.164 0.18 0.199 0.226 0.25 0.279 0.325 0.38 0.439 0.48 0.436 0.468 0.502 0.541 0.57 0.605 0.594 0.555 0.511 0.473 0.439 0.409 0.371 0.332 0.288 0.252 0.217 0.196 0.181 0.178 0.185 0.176 0.173 0.168 0.176 0.178 0.19 0.202 0.214 0.235 0.254 0.27 0.291 0.323 0.366 0.41 0.436 0.396 0.414 0.438 0.465 0.485 0.527 0.566 0.557 0.523 0.478 0.442 0.409 0.371 0.334 0.294 0.265 0.244 0.223 0.225 0.212 0.218 0.211 0.211 0.207 0.214 0.217 0.229 0.237 0.244 0.264 0.275 0.285 0.3 0.321 0.348 0.376 0.396 0.357 0.368 0.377 0.391 0.402 0.431 0.481 0.503 0.521 0.482 0.444 0.409 0.372 0.337 0.307 0.286 0.27 0.257 0.247 0.251 0.257 0.255 0.254 0.25 0.258 0.259 0.265 0.269 0.278 0.284 0.292 0.297 0.305 0.317 0.33 0.344 0.357 0.321 0.322 0.328 0.332 0.333 0.346 0.365 0.389 0.411 0.459 0.443 0.399 0.352 0.327 0.313 0.304 0.3 0.294 0.295 0.294 0.293 0.292 0.291 0.295 0.3 0.301 0.302 0.304 0.304 0.304 0.305 0.307 0.309 0.312 0.313 0.316 0.321}
    blue {curve 0.26 0.281 0.298 0.306 0.342 0.365 0.39 0.381 0.392 0.416 0.413 0.43 0.448 0.446 0.433 0.425 0.419 0.394 0.362 0.328 0.305 0.298 0.286 0.247 0.26 0.219 0.199 0.168 0.178 0.14 0.11 0.084 0.104 0.158 0.18 0.225 0.26 0.235 0.26 0.28 0.298 0.327 0.372 0.395 0.417 0.43 0.435 0.455 0.488 0.479 0.521 0.522 0.515 0.49 0.436 0.383 0.331 0.295 0.282 0.258 0.219 0.208 0.179 0.168 0.141 0.129 0.106 0.094 0.095 0.112 0.127 0.165 0.199 0.235 0.226 0.258 0.28 0.298 0.316 0.361 0.399 0.427 0.446 0.461 0.482 0.52 0.521 0.553 0.563 0.573 0.524 0.454 0.389 0.33 0.295 0.266 0.247 0.214 0.195 0.168 0.178 0.142 0.14 0.128 0.129 0.126 0.131 0.144 0.167 0.199 0.226 0.238 0.266 0.289 0.31 0.329 0.351 0.395 0.428 0.453 0.475 0.494 0.533 0.542 0.568 0.584 0.576 0.53 0.451 0.385 0.331 0.299 0.266 0.245 0.22 0.206 0.184 0.174 0.167 0.166 0.166 0.173 0.172 0.165 0.172 0.187 0.208 0.238 0.258 0.28 0.3 0.321 0.343 0.362 0.391 0.427 0.458 0.482 0.503 0.546 0.554 0.573 0.582 0.546 0.499 0.431 0.375 0.33 0.304 0.275 0.254 0.234 0.225 0.212 0.209 0.206 0.203 0.21 0.215 0.212 0.204 0.208 0.214 0.231 0.258 0.277 0.294 0.31 0.328 0.348 0.372 0.397 0.427 0.462 0.487 0.51 0.544 0.558 0.559 0.556 0.503 0.444 0.402 0.355 0.329 0.309 0.289 0.275 0.26 0.254 0.245 0.245 0.241 0.238 0.249 0.249 0.245 0.241 0.242 0.246 0.258 0.277 0.295 0.305 0.315 0.327 0.339 0.359 0.39 0.421 0.461 0.491 0.515 0.54 0.546 0.522 0.478 0.429 0.393 0.368 0.345 0.325 0.313 0.303 0.295 0.286 0.284 0.279 0.277 0.274 0.277 0.277 0.28 0.276 0.273 0.274 0.279 0.285 0.295 0.311 0.314 0.316 0.32 0.323 0.331 0.346 0.367 0.397 0.468 0.513 0.494 0.425 0.388 0.372 0.348 0.336 0.331 0.326 0.32 0.316 0.314 0.312 0.309 0.321 0.32 0.319 0.305 0.317 0.316 0.316 0.315 0.316 0.317 0.319 0.321 0.311}
    alpha {}}
  name ColorLookup7
  label "Pointers Samples Yxy\nSource: https://www.rit.edu/cos/colorscience/rc_useful_data.php"
  xpos -1580
  ypos -790
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace12
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1580
  ypos -688
 }
 Fill {
  output alpha
  name Fill5
  xpos -1580
  ypos -639
 }
 BlackOutside {
  name BlackOutside7
  xpos -1580
  ypos -562
 }
 Position {
  translate {6 {parent.Position1.translate.y-input.height}}
  name Position3
  xpos -1580
  ypos -538
 }
 Dot {
  name Dot15
  xpos -1546
  ypos -414
 }
push $N6bc90400
 Reformat {
  type "to box"
  box_width 2048
  box_height 2048
  box_fixed true
  name ReformatBox4
  xpos -700
  ypos -1258
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression7
  xpos -700
  ypos -1209
 }
 Dot {
  name Dot10
  xpos -666
  ypos -1158
 }
set N6bc50800 [stack 0]
 Dot {
  name Dot26
  xpos -886
  ypos -1158
 }
set N6bc50400 [stack 0]
 Dot {
  name Dot23
  xpos -1106
  ypos -1158
 }
set N6bfefc00 [stack 0]
 Dot {
  name Dot12
  xpos -1326
  ypos -1158
 }
 Mirror2 {
  flip true
  flop true
  name Mirror2_1
  xpos -1360
  ypos -1042
 }
 Reformat {
  type "to box"
  box_width 512
  box_height {{box_width}}
  box_fixed true
  name Reformat1
  xpos -1360
  ypos -994
 }
 Gamma {
  channels rgb
  value 2
  name Gamma1
  xpos -1360
  ypos -898
 }
 Multiply {
  channels rgb
  value 8000
  name Multiply1
  label "\[value value]"
  xpos -1360
  ypos -811
 }
 ColorLookup {
  lut {master {}
    red {curve R 0.4830000103 x50 0.5045000315 0.5260000229 0.5475000143 0.5690000057 0.5904999971 0.6119999886 0.63349998 0.6549999714 0.6805312037 0.7087500095 0.7315937281 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.75459373 0.7845000029 0.8144062757 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8009687662 0.74150002 0.6820312142 0.6549999714 0.6684374809 0.6980000138 0.7275624871 0.7409999967 0.7315937281 0.7087500095 0.6805312037 0.6549999714 0.629468739 0.6012499928 0.5784062743 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5555624962 0.5260000229 0.4964375198 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4964375198 0.5260000229 0.5555624962 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5653046966 0.5555624962 0.5417890549 0.5260000229 0.5102109313 0.4964375198 0.4866953194 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4695625007 0.4400000274 0.4104375243 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.4104375243 0.4400000274 0.4695625007 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103}
    green {curve R 0.6589999795 x50 0.6542205811 0.6484853029 0.6414804459 0.6340000033 0.6249843836 0.6147499681 0.6041406393 0.5939999819 0.5844687223 0.575124979 0.5659687519 0.5569999814 0.5484530926 0.5402500033 0.5319218636 0.5230000019 0.5131718516 0.5027499795 0.4922031164 0.4819999933 0.4722187519 0.4626249969 0.4532187581 0.4440000057 0.4351093769 0.4265000224 0.4178906381 0.4090000093 0.3997343779 0.3902499974 0.380640626 0.3709999919 0.3614374995 0.3518749774 0.3421249986 0.3319999874 0.321398437 0.3104375005 0.2992577851 0.2879999876 0.2764999866 0.2647500038 0.2531249821 0.2419999987 0.2312265635 0.2206875086 0.2108047009 0.202000007 0.1947187632 0.1886250079 0.1829687506 0.1770000011 0.1693515629 0.1608124971 0.1538671851 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1527187377 0.1564999968 0.1602812558 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1612187475 0.1595000029 0.1577812582 0.1570000052 0.1573124975 0.1579999924 0.1586875021 0.1589999944 0.1575781256 0.1543750018 0.1509843767 0.1490000039 0.1485625058 0.1484999955 0.1484375 0.1480000019 0.1467812508 0.1449999958 0.1432187557 0.1420000046 0.1415625066 0.1414999962 0.1414375007 0.1410000026 0.1397656202 0.1378750056 0.1357968748 0.1340000033 0.1323750019 0.1307500005 0.1295000017 0.1289999932 0.130031243 0.1324999928 0.1354687512 0.1379999965 0.1402187496 0.1424999982 0.1442812532 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1464921832 0.1503124982 0.1554765552 0.1609999985 0.1673984379 0.1749375015 0.1822578013 0.1879999936 0.1906718612 0.1913749874 0.1926406175 0.1969999969 0.2064140588 0.2199375033 0.2357421964 0.2520000041 0.2688750029 0.2871249914 0.3058125079 0.324000001 0.3417187631 0.359375 0.3765937686 0.3930000067 0.4082968831 0.4227499962 0.4368281364 0.451000005 0.4659531415 0.4812500179 0.4956718981 0.5080000162 0.5169296861 0.5234375 0.5297265649 0.5379999876 0.5491171479 0.5618124604 0.5751015544 0.5879999995 0.6009531021 0.6142500043 0.6266719103 0.6370000243 0.6457066536 0.6532088518 0.6575522423 0.6589999795}
    blue {curve R 0.3160000145 x50 0.324739933 0.3330312669 0.3418398499 0.351000011 0.3607422113 0.3709374964 0.3811640739 0.3910000026 0.4003046751 0.4093124866 0.4181640446 0.4269999862 0.4359609187 0.4449374974 0.453695327 0.4620000124 0.4697890878 0.4771875143 0.4842422009 0.4909999967 0.4971874952 0.5028749704 0.5086249709 0.5149999857 0.5227031112 0.53125 0.5394218564 0.5460000038 0.5502656102 0.5530000329 0.5552343726 0.5580000281 0.561632812 0.5655625463 0.5694609284 0.5730000138 0.5765469074 0.5801249743 0.5828906298 0.5839999914 0.5838750005 0.5830000043 0.5806249976 0.5759999752 0.5682968497 0.5576249957 0.5446406007 0.5299999714 0.5128515363 0.4931874871 0.4729296863 0.4539999962 0.4368359447 0.420437485 0.4045703113 0.3889999986 0.3731718659 0.3573749959 0.3426406384 0.3300000131 0.3193906248 0.310375005 0.3034218848 0.298999995 0.2972500026 0.2969999909 0.2967499793 0.2949999869 0.2899531126 0.2821249962 0.2734843791 0.2660000026 0.2602812648 0.2552500069 0.2503437698 0.2450000048 0.2380000055 0.2300000042 0.2232500017 0.2199999988 0.2195625007 0.2194999903 0.2194374949 0.2189999968 0.2183593661 0.2176249921 0.2163281292 0.2140000015 0.2101874948 0.205249995 0.1999374926 0.1949999928 0.1904453039 0.185937494 0.1817109436 0.1780000031 0.1754062474 0.1736250073 0.1715312451 0.1679999977 0.1620937437 0.1546249986 0.147093758 0.1410000026 0.1372031271 0.1347499937 0.1324218661 0.1289999932 0.1237656176 0.1174999923 0.1112343743 0.1059999987 0.1021796837 0.09918750077 0.09660156071 0.09399999678 0.09089062363 0.0876249969 0.0850468725 0.08399999887 0.08524999768 0.0882499963 0.09187500179 0.09499999881 0.09706249833 0.09875000268 0.1008125022 0.1040000021 0.1084140688 0.1136875004 0.1198671907 0.1270000041 0.1355390698 0.145312503 0.1554296911 0.1650000066 0.1739453226 0.1826875061 0.1910859346 0.199000001 0.2061250061 0.2126249969 0.2190624923 0.2259999961 0.2338827997 0.2423124909 0.2505859137 0.2579999864 0.2642968595 0.26987499 0.2750156224 0.2800000012 0.2847812474 0.2892500162 0.2935937643 0.2980000079 0.3025000095 0.3070000112 0.3115000129 0.3160000145}
    alpha {}}
  name ColorLookup5
  label "Pointer's Gamut Boundary Yxy\ninterpolated: incr 50 - 0 to 8000"
  xpos -1360
  ypos -775
 }
 Multiply {
  channels rgb
  value {0.31 1 1 1}
  name Multiply2
  label "dim boundary"
  xpos -1360
  ypos -725
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace5
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1360
  ypos -688
 }
 Fill {
  output alpha
  name Fill4
  xpos -1360
  ypos -639
 }
 BlackOutside {
  name BlackOutside1
  xpos -1360
  ypos -562
 }
 Position {
  translate {6 {ReformatBox4.box_width-input.width}}
  name Position1
  xpos -1360
  ypos -538
 }
 Dot {
  name Dot24
  xpos -1326
  ypos -486
 }
push $N6bfefc00
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox2
  xpos -1140
  ypos -994
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression1
  xpos -1140
  ypos -898
 }
set N6bfab800 [stack 0]
 Dot {
  name Dot8
  xpos -996
  ypos -894
 }
 ColorLookup {
  lut {master {curve L 0 s0 t0.9499999881 C k x0.308139503 1 s0}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos -1030
  ypos -849
 }
 Dot {
  name Dot14
  xpos -996
  ypos -750
 }
push $N6bfab800
 Multiply {
  channels rgb
  value 269
  name Multiply5
  label "\[value value]"
  xpos -1140
  ypos -856
 }
 ColorLookup {
  lut {master {}
    red {curve C 1.8783474 1.85965741 1.8410753 1.82260251 1.80424976 1.78602886 1.76794314 1.75000143 1.73221421 1.71458244 1.69711792 1.67982578 1.66271067 1.6457777 1.62903571 1.6124835 1.59613538 1.57998943 1.56404996 1.54832447 1.5328095 1.51751649 1.50244594 1.48759735 1.47297573 1.45858264 1.44442391 1.43049574 1.41680288 1.40334678 1.39012623 1.37714779 1.36440396 1.35190022 1.33963728 1.32761216 1.31582856 1.30428183 1.29297352 1.28190565 1.27107596 1.2604804 1.25012183 1.23999798 1.23010659 1.22044563 1.21101499 1.20181489 1.19284034 1.18408906 1.17556167 1.16725397 1.15916491 1.15129638 1.14363372 1.13618886 1.12895167 1.12192106 1.11509454 1.10846853 1.10204577 1.09580922 1.08977199 1.08392429 1.07826447 1.07278681 1.06749392 1.06237841 1.05743873 1.05267084 1.04807138 1.04364109 1.03937256 1.03526449 1.03131545 1.02751946 1.02387333 1.02037668 1.01702523 1.01381445 1.01074362 1.00780725 1.00500631 1.00233305 0.99978602 0.99736285 0.9950608 0.99287677 0.99080539 0.98884678 0.98699367 0.9852494 0.98361033 0.98206747 0.98062134 0.97926998 0.97800934 0.97683728 0.97575116 0.97474778 0.97382426 0.97297859 0.97220623 0.97150886 0.97087657 0.97031689 0.96981871 0.96938527 0.96900952 0.96869147 0.96842706 0.96821606 0.96805781 0.96794283 0.96787858 0.96785843 0.96787864 0.96793604 0.96803701 0.96817231 0.96833968 0.96854311 0.96877253 0.96903455 0.96932232 0.96963543 0.96997368 0.97033387 0.97071254 0.9711163 0.97153723 0.97197378 0.97242606 0.97289121 0.97337079 0.97386622 0.97437072 0.97488332 0.97540969 0.97594237 0.97647977 0.97702706 0.97757769 0.97813445 0.97869468 0.97925854 0.97982538 0.98039114 0.98096472 0.98153675 0.98210776 0.98267955 0.98325121 0.98382008 0.98438704 0.9849571 0.98552132 0.98608243 0.98664182 0.98719966 0.98775077 0.98829895 0.98884273 0.98938417 0.98991877 0.9904511 0.99097681 0.99149919 0.99201453 0.99252397 0.99303031 0.99353105 0.99402624 0.99451613 0.99499857 0.99547589 0.99594522 0.99641174 0.99687338 0.99732745 0.99777603 0.9982177 0.99865389 0.999084 0.99950838 0.99992663 1.00033772 1.00074494 1.00114489 1.00153947 1.00192833 1.00231075 1.00268865 1.00305855 1.00342607 1.00378489 1.00413895 1.00448751 1.00483036 1.00517035 1.00550389 1.00583148 1.00615203 1.00646758 1.00678015 1.00708604 1.00738645 1.00768471 1.00797844 1.0082655 1.00854778 1.00882483 1.00909901 1.00936711 1.00963116 1.00989032 1.0101465 1.01039672 1.01064491 1.01088691 1.0111258 1.01135957 1.01158977 1.01181614 1.01203847 1.01225793 1.01247287 1.01268291 1.01289058 1.01309609 1.01329684 1.01349473 1.0136888 1.0138787 1.01406395 1.01424909 1.01442885 1.01460576 1.01478052 1.01495218 1.01512218 1.01528883 1.01545072 1.01561022 1.01576698 1.01592219 1.01607502 1.01622343 1.01636875 1.0165143 1.01665616 1.01679492 1.0169313 1.01706588 1.01719737 1.01732695 1.01745498 1.01757956 1.01770294 1.01782393 1.01794255 1.0180583 1.01817465 1.01828551 1.01839495 1.01850486 1.01861191 1.01871693 1.01882088 1.01891339}
    green {curve C 1}
    blue {curve C 0.00879261 0.00962762 0.010532 0.01151017 0.01256675 0.01370643 0.01493413 0.01625487 0.01767381 0.01919618 0.02082733 0.02257277 0.02443803 0.02642871 0.02855051 0.03080913 0.0332104 0.0357601 0.03846392 0.04132775 0.04435719 0.04755813 0.05093599 0.05449668 0.0582453 0.0621875 0.06632853 0.07067341 0.07522713 0.07999477 0.08498063 0.09018957 0.09562518 0.10129225 0.10719412 0.11333443 0.11971687 0.12634411 0.133219 0.14034435 0.14772213 0.15535444 0.16324303 0.17138906 0.179794 0.18845794 0.197382 0.20656651 0.21601067 0.22571453 0.23567709 0.24589771 0.25637382 0.26710594 0.2780903 0.28932518 0.30080822 0.3125369 0.32450783 0.33671761 0.34916404 0.36183971 0.37474373 0.38787127 0.40121818 0.41477671 0.42854655 0.44251823 0.45668846 0.47105014 0.48559928 0.50033116 0.5152359 0.5303098 0.5455451 0.56093836 0.5764783 0.59215891 0.60797763 0.62392306 0.63999057 0.65616876 0.6724565 0.68884456 0.70532417 0.72188419 0.73852479 0.7552371 0.77200818 0.78883314 0.80570388 0.82261622 0.83956301 0.8565321 0.87351894 0.89051074 0.90751225 0.92450547 0.94148719 0.95845115 0.97538745 0.99229181 1.00915313 1.02597356 1.04273522 1.05944169 1.07608175 1.09265125 1.10914159 1.12555146 1.14187002 1.15809321 1.1742171 1.190238 1.20614767 1.22194457 1.23762202 1.2531724 1.26859927 1.28389311 1.29905295 1.31407428 1.32895291 1.34368753 1.35827363 1.3727088 1.38699389 1.40111876 1.41508293 1.42889357 1.44254065 1.45602405 1.46934104 1.48249614 1.49548101 1.50830269 1.5209527 1.53343177 1.54574537 1.5578897 1.56985986 1.5816654 1.59329891 1.60476208 1.61605716 1.62718153 1.63813758 1.64892519 1.65955138 1.67000985 1.68030369 1.69043732 1.70040607 1.71021223 1.71985734 1.72934508 1.73867714 1.74785423 1.75688136 1.76575518 1.77447391 1.78304338 1.79146802 1.79975164 1.80788386 1.81587982 1.82373333 1.83144975 1.83902776 1.84647095 1.85378456 1.86096811 1.86802399 1.87495112 1.88175035 1.88842535 1.89497983 1.90141833 1.90774179 1.91394711 1.92004013 1.92602086 1.93188739 1.93765306 1.94330883 1.94886208 1.95430994 1.95965815 1.96490622 1.97005856 1.97511387 1.98007631 1.98494554 1.98972344 1.99441445 1.99901712 2.00353193 2.00796437 2.01231384 2.01658392 2.02076721 2.02487659 2.02890825 2.03286695 2.03675175 2.04056406 2.04430199 2.04797506 2.05157685 2.05511236 2.0585804 2.06198287 2.06532407 2.06860161 2.07181907 2.07497644 2.07807779 2.0811162 2.08409977 2.08702946 2.08990335 2.09272337 2.09549189 2.0982089 2.10087585 2.10349345 2.10606146 2.1085825 2.11105394 2.11348104 2.11586332 2.11820364 2.12050176 2.12275648 2.12496805 2.127141 2.12927723 2.13136625 2.13341999 2.13543844 2.13741732 2.13936305 2.1412704 2.1431427 2.14498401 2.14678812 2.14856291 2.1503005 2.15200949 2.15368938 2.15533352 2.15695238 2.15853977 2.16009951 2.16162968 2.16313291 2.16460824 2.16605687 2.16747928 2.16887903 2.17024994 2.1715951 2.17291784 2.17421341 2.17548871 2.17674041 2.17797112 2.17918396 2.18036819 2.18143296}
    alpha {}}
  name ColorLookup3
  label "Planckian Locus 0-269"
  xpos -1140
  ypos -808
 }
 Multiply {
  inputs 1+1
  channels rgb
  value 0
  maskChannelMask rgba.red
  invert_mask true
  name Multiply3
  label dim
  xpos -1140
  ypos -760
 }
 BlackOutside {
  name BlackOutside6
  xpos -1140
  ypos -706
 }
 Position {
  translate {6 {parent.Position2.translate.y-input.height}}
  name Position8
  xpos -1140
  ypos -682
 }
 Dot {
  name Dot28
  xpos -1106
  ypos -654
 }
push $N6bc50400
 Dot {
  name Dot4
  xpos -886
  ypos -1086
 }
set N6bfa9000 [stack 0]
 Rectangle {
  replace true
  area {0 0 6 {height}}
  name Rectangle1
  xpos -810
  ypos -1089
 }
 BlackOutside {
  name BlackOutside5
  xpos -810
  ypos -1041
 }
push $N6bfa9000
 Radial {
  inputs 1+1
  replace true
  area {-5422 -3542 7470 5590}
  softness 0
  ramp linear
  color {0.0719 0.02604 0.0001 1}
  p1 {0 0}
  color0 {0.039378 0.001097 0.188331 1}
  p0 {0 2048}
  name Radial1
  xpos -920
  ypos -1041
 }
 Dot {
  name Dot9
  xpos -886
  ypos -894
 }
push $N6bc50800
 Gamma {
  channels rgba
  value 0.5
  name Gamma2
  xpos -700
  ypos -1120
 }
 Expression {
  temp_name0 start
  temp_expr0 360
  temp_name1 end
  temp_expr1 830
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 r*(end-start)+start
  channel1 none
  channel2 none
  expr3 1
  name Expression2
  label "360nm to 830nm"
  xpos -700
  ypos -1096
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 6.97e-06 7.81e-06 8.77e-06 9.84e-06 1.104e-05 1.239e-05 1.389e-05 1.556e-05 1.744e-05 1.958e-05 2.202e-05 2.484e-05 2.804e-05 3.153e-05 3.522e-05 3.9e-05 4.283e-05 4.691e-05 5.159e-05 5.718e-05 6.4e-05 7.234e-05 8.221e-05 9.351e-05 0.00010614 0.00012 0.00013498 0.00015149 0.00017021 0.00019182 0.000217 0.00024691 0.00028124 0.00031852 0.00035727 0.000396 0.00043371 0.00047302 0.00051788 0.00057222 0.00064 0.00072456 0.0008255 0.00094116 0.00106988 0.00121 0.00136209 0.00153075 0.00172037 0.00193532 0.00218 0.0024548 0.002764 0.0031178 0.0035264 0.004 0.00454624 0.00515932 0.00582928 0.00654616 0.0073 0.00808651 0.00890872 0.00976768 0.01066443 0.0116 0.01257317 0.01358272 0.01462968 0.01571509 0.01684 0.01800736 0.01921448 0.02045392 0.02171824 0.023 0.02429461 0.02561024 0.02695857 0.02835125 0.0298 0.03131083 0.03288368 0.03452112 0.03622571 0.038 0.03984667 0.041768 0.043766 0.04584267 0.048 0.05024368 0.05257304 0.05498056 0.05745872 0.06 0.06260197 0.06527752 0.06804208 0.07091109 0.0739 0.077016 0.0802664 0.0836668 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name ColorLookup4
  label "CIE 1931 2 Degree Standard Observer\n360nm to 830nm"
  xpos -700
  ypos -1030
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeLineOfPurples
  xpos -700
  ypos -897
  disable {{!parent.draw_line_of_purples}}
 }
 Fill {
  color {0 0 0 1}
  name Disable_SpectralLocus
  xpos -700
  ypos -826
  disable {{parent.draw_spectral_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePlanckianLocus
  xpos -700
  ypos -658
  disable {{!parent.draw_planckian_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut
  xpos -700
  ypos -489
  disable {{!parent.draw_pointers_gamut}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut_Samples
  xpos -700
  ypos -417
  disable {{!draw_pointers_samples}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeMacbeth
  xpos -700
  ypos -273
  disable {{!parent.draw_macbeth_chart}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutGrid
  xpos -700
  ypos -81
  disable {{!parent.gamut_grid}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutA
  xpos -700
  ypos 255
  disable {{!parent.gamut_a}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutB
  xpos -700
  ypos 279
  disable {{!parent.gamut_b}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutC
  xpos -700
  ypos 303
  disable {{!parent.gamut_c}}
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 450
 }
set N6bf44400 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 450
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace6
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -590
  ypos 488
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression5
  label "CIE Yxy to CIELuv"
  xpos -590
  ypos 536
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 618
 }
push $N6bf44400
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  invert true
  name ColorMatrix1
  label "XYZ to working"
  xpos -700
  ypos 488
  disable {{!map_overlays_to_input_gamut}}
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_grid\" iterate pixelWise b2e7b5f8a89bdb0629aa8cc2eae387ef3436f24cb0af642eeba41235874506c4 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 6 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== \"draw_axes\" Bool 1 AA== \"grid_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 6 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 \"draw_axes\" 1 1 \"grid_color\" 4 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_grid : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n  bool draw_axes;\n  float4 grid_color;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  void draw_grid() \{\n    // grid width in pixels. expresses a 0 to 1 range in CIE xy\n    float grid_width = 1.0f * outsize + offset;\n    // draw grid lines\n    float i = offset;\n    while (i <= grid_width && i > 0.0f) \{\n      write_aa(offset, i, grid_color);\n      write_aa(i, offset, grid_color);\n      i += 1.0;\n    \}\n    // cross-hatching interval in pixels\n    float hatch_interval = (grid_width - offset) * 0.1f;\n    // cross-hatch length in pixels\n    float hatch_width = outsize * 0.01f;\n    i = offset;\n    while (i <= grid_width) \{\n      i += hatch_interval;\n      float j = 0.0;\n      while (j <= hatch_width/2) \{\n        write_aa(offset+j, i, grid_color);\n        write_aa(offset-j, i, grid_color);\n        write_aa(i, offset+j, grid_color);\n        write_aa(i, offset-j, grid_color);\n        j += 1.0;\n      \}\n    \}\n  \}\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n\n    // draw CIExy coordinate system axes\n    if (draw_axes && pos.x == 0 && pos.y == 0) \{\n      draw_grid();\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_grid_padding {{parent.PlotChromaticities.PlotChromaticity_padding}}
  PlotChromaticity_grid_left_margin {{parent.PlotChromaticities.PlotChromaticity_left_margin}}
  PlotChromaticity_grid_tolerance 0.8
  PlotChromaticity_grid_antialias true
  PlotChromaticity_grid_draw_axes {{parent.coordinate_system}}
  PlotChromaticity_grid_grid_color {0.15 0 0.005 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotInput2
  xpos -700
  ypos 608
 }
 FrameHold {
  firstFrame 1
  name FrameHold1
  xpos -700
  ypos 680
  cached true
 }
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 762
 }
 Input {
  inputs 0
  name Input
  xpos 620
  ypos -1426
 }
 AddChannels {
  name AddChannels1
  xpos 620
  ypos -1360
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat
  xpos 620
  ypos -1282
  disable {{!parent.resample_input}}
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name CropBBox
  xpos 620
  ypos -1257
 }
 Dot {
  name Dot7
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 162
 }
set N6c2ccc00 [stack 0]
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "256 256 0 0 256 256 1 square_256"
  name Constant2
  xpos 400
  ypos 38
  postage_stamp false
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat1
  xpos 400
  ypos 64
  disable {{!parent.resample_input}}
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input0]"}}
  name Switch1
  xpos 400
  ypos 158
 }
 Fill {
  output rgb
  color 0.18
  name SampleColor
  xpos 290
  ypos 158
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name Crop2
  xpos 290
  ypos 184
 }
 Fill {
  output alpha
  name Fill3
  xpos 290
  ypos 224
 }
 Dot {
  name Dot6
  xpos 324
  ypos 282
 }
set N6c282c00 [stack 0]
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  name ColorMatrix4
  label "working to XYZ"
  xpos 180
  ypos 272
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace1
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 180
  ypos 320
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression6
  label "CIE Yxy to CIELuv"
  xpos 180
  ypos 368
  disable {{!parent.diagram}}
 }
push $N6c282c00
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_sample\" iterate pixelWise 20e14b615a937bac78c1a771cbdfd10cc7c5fb6c487f65d0bb2d6633e404b958 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 3 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== 3 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_sample : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  void process(int2 pos) \{\n    // only process the first pixel\n    if (pos.x > 0 && pos.y > 0) return;\n\n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    int2 p = int2(round(out_coord.x), round(out_coord.y));\n    if (dst.bounds.inside(p.x, p.y)) \{\n      for (int k=0; k<3; k++) \{\n        dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n      \}\n      dst(p.x, p.y, 3) = 1.0f;\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_sample_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_sample_left_margin {{parent.left_margin}}
  PlotChromaticity_sample_tolerance 1
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities1
  xpos 290
  ypos 368
 }
 Dot {
  name Dot22
  xpos 324
  ypos 450
 }
set N6c281800 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048}}
  name Dilate1
  label "\[value size]"
  xpos 290
  ypos 488
 }
set N6c281400 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048*2}}
  name Dilate2
  label "\[value size]"
  xpos 180
  ypos 488
 }
push $N6c281800
 Dot {
  name Dot21
  xpos -6
  ypos 450
 }
 FilterErode {
  channels rgba
  size {{-Output.width/2048/5}}
  filter triangle
  name FilterErode1
  label "\[value size]"
  xpos -40
  ypos 489
 }
set N6c280800 [stack 0]
 Dilate {
  channels rgba
  size {0 {parent.Dilate3.size.w}}
  name Dilate4
  label "\[value size]"
  xpos -40
  ypos 584
 }
push $N6c280800
 Dilate {
  channels rgba
  size {{Output.width*plus_size/100} 0}
  name Dilate3
  label "\[value size]"
  xpos 70
  ypos 488
  addUserKnob {20 User}
  addUserKnob {7 plus_size R 0 4}
  plus_size 0.8
 }
 Merge2 {
  inputs 2
  operation screen
  bbox B
  name Merge9
  xpos 70
  ypos 591
 }
 Merge2 {
  inputs 2
  operation stencil
  bbox B
  name Merge10
  xpos 180
  ypos 591
 }
 Group {
  name HueRotate
  xpos 180
  ypos 639
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -24
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos 15
  }
  Colorspace {
   colorspace_out HSV
   name Colorspace1
   xpos -40
   ypos 72
  }
  Add {
   channels {rgba.red -rgba.green -rgba.blue none}
   value 0.5
   name Add1
   xpos -40
   ypos 111
  }
  Fill {
   output {-rgba.red -rgba.green rgba.blue none}
   name Fill1
   xpos -40
   ypos 147
  }
  Colorspace {
   colorspace_in HSV
   name Colorspace2
   xpos -40
   ypos 183
  }
  Premult {
   name Premult1
   xpos -40
   ypos 231
  }
  Output {
   name Output1
   xpos -40
   ypos 302
  }
 end_group
push $N6c281400
 Merge2 {
  inputs 2
  bbox B
  name Merge8
  xpos 290
  ypos 638
 }
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 690
 }
push $N6c2ccc00
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 162
 }
 Group {
  name GamutToXYZ
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos 730
  ypos 247
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACES
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 730
  ypos 296
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression4
  label "CIE Yxy to CIELuv"
  xpos 730
  ypos 344
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot13
  label " Pos"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 546
 }
push $N6c2ccc00
 Dot {
  name Dot16
  label " Col"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 450
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity\" iterate pixelWise 3e86399c7642fe5c35c23528a644f88a8bf13f967de084ae6842f8be55098c6b 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 4 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== 4 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_left_margin {{parent.left_margin}}
  PlotChromaticity_tolerance 2
  PlotChromaticity_antialias true
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities
  xpos 620
  ypos 536
  disable {{!parent.plot_input}}
 }
 Fill {
  color 0
  name BLACK
  tile_color 0x111111ff
  xpos 620
  ypos 591
  disable {{parent.plot_input}}
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge7
  xpos 620
  ypos 686
  disable {{!parent.enable_sample_color}}
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 620
  ypos 758
 }
 Output {
  name Output
  xpos 620
  ypos 1046
 }
end_group
Merge2 {
 inputs 3+1
 operation plus
 name Plus1
 xpos 3175
 ypos 2262
}
Crop {
 box {0 0 1712 1634}
 reformat true
 crop false
 name Crop9
 xpos 3175
 ypos 2286
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/examples/BlueBar_ZCAMishDRTv04_sRGB_Limit_CIE76.jpg
 file_type jpeg
 checkHashOnRead false
 version 1
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write18
 xpos 3175
 ypos 2321
}
push $N6437eb00
push 0
push $N66f77200
push $N695fe800
Crop {
 box {0 920 582 2198}
 name Crop6
 xpos 3032
 ypos 2178
}
Group {
 name PlotChromaticity3
 xpos 3032
 ypos 2202
 addUserKnob {20 PlotChromaticity_tab l PlotChromaticity}
 addUserKnob {6 use_gpu l "Use GPU if available" +STARTLINE}
 use_gpu true
 addUserKnob {26 ""}
 addUserKnob {6 plot_input l "plot input" t "Enable plotting of the input pixels" +STARTLINE}
 plot_input true
 addUserKnob {41 input_gamut l gamut t "Set the gamut that the input colors are encoded in" -STARTLINE T GamutToXYZ.gamut}
 addUserKnob {4 diagram l in t "Choose the type of chromaticity diagram: \nCIE 1931 xy Chromaticity Diagram\nCIE 1976 u' v' Uniform Chromaticity Scale Diagram" -STARTLINE M {"CIE 1931 xy" "CIE 1976 u' v'" "" ""}}
 diagram "CIE 1976 u' v'"
 addUserKnob {6 enable_sample_color l "sample color" t "Enable plotting of the sampled color" +STARTLINE}
 enable_sample_color true
 addUserKnob {41 sample_color l color t "sample and plot selected color" T SampleColor.color}
 addUserKnob {22 follow_viewer l "follow viewer" t "Follow the selected viewer node. This causes this node to automatically connect to whatever the followed viewer is connected to.\n\nThis is useful if you want to have a 2nd viewer showing a chromaticity plot for whever you're looking at in your main viewer." T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to follow.')\nelse:\n    v\['knobChanged'].setValue('v = nuke.activeViewer().node()\\nif v and v.name() == nuke.thisNode().name():\\n    con = v.input(nuke.activeViewer().activeInput())\\n    plt = nuke.toNode(\"\{0\}\")\\n    plt.setInput(0, con)'.format(n.name()))" +STARTLINE}
 addUserKnob {22 unfollow_viewer l "unfollow viewer" -STARTLINE T "n = nuke.thisNode()\nnuke.root().begin()\nv = nuke.selectedNode()\nif not v or v.Class() != 'Viewer':\n    nuke.message('Please select a viewer node to unfollow.')\nelse:\n    v\['knobChanged'].setValue('')"}
 addUserKnob {26 plot_dimensions_label l " " T "<b>Chromaticity Diagram"}
 addUserKnob {3 resolution l " resolution" t "resolution to output"}
 resolution 2048
 addUserKnob {7 right_margin l "right margin" R 1 1.5}
 right_margin 1.1
 addUserKnob {7 left_margin l "left margin" R 0 0.2}
 left_margin 0.1
 addUserKnob {6 draw_spectral_locus l "spectrum locus" t "draw the spectrum locus: the boundary of color the human eye can see." +STARTLINE}
 draw_spectral_locus true
 addUserKnob {6 draw_line_of_purples l "line of purples" t "draw the \"line of purples\"" -STARTLINE}
 draw_line_of_purples true
 addUserKnob {6 draw_planckian_locus l "planckian locus" t "Display the planckian locus or the blackbody locus." +STARTLINE}
 addUserKnob {6 gamut_grid l "gamut grid" t "Display a gamut boundary with a grid or dot pattern" +STARTLINE}
 addUserKnob {41 gamut_gamutgrid l "" t "gamut for gamutgrid" -STARTLINE T RGBToXYZ_GamutGrid.gamut}
 addUserKnob {4 gamut_grid_style l style t "Choose the style to display the gamut plot" -STARTLINE M {grid dots "" "" "" ""}}
 addUserKnob {4 distribution l dist t "Which chromaticity space should the overlays be constructed in? \n\nYxy is familiar, but not very perceptually uniform.\n\nu'v' is designed to be more perceptually uniform." -STARTLINE M {"1931 Yxy" "1976 u'v'" "" ""}}
 addUserKnob {7 density t "Density of the grid or points" R 10 100}
 density 50
 addUserKnob {6 gamut_a l "gamut a" t "Display a gamut outline" +STARTLINE}
 gamut_a true
 addUserKnob {41 gamut_a_1 l "" -STARTLINE T RGBToXYZ_GamutA.gamut}
 addUserKnob {6 gamut_b l "gamut b" t "Display a gamut outline" +STARTLINE}
 addUserKnob {41 gamut_b_1 l "" -STARTLINE T RGBToXYZ_GamutB.gamut}
 addUserKnob {6 gamut_c l "gamut c" t "Display a gamut outline" +STARTLINE}
 gamut_c true
 addUserKnob {41 gamut_c_1 l "" -STARTLINE T RGBToXYZ_GamutC.gamut}
 addUserKnob {6 draw_pointers_gamut l "pointer's gamut" t "DrawPointer's gamut boundary" +STARTLINE}
 addUserKnob {6 draw_pointers_samples l "pointers sample colors" t "show the individual pointer gamut samples" -STARTLINE}
 addUserKnob {6 draw_macbeth_chart l "macbeth chart" t "draw a ColorChecker24 aka Macbeth Chart" +STARTLINE}
 addUserKnob {6 coordinate_system l "coordinate system" t "Draw CIE xy coordinate grid x and y axes" +STARTLINE}
 coordinate_system true
 addUserKnob {6 map_overlays_to_input_gamut l "map overlays to input gamut" t "This maps the overlays like the spectral locus, pointer's gamut, and the gamut overlay to the working gamut instead of keeping them as XYZ.\n\nFor example if the input gamut is ACEScg, these overlays will be mapped to that. Note that this can cause most of the overlays to be negative or highly saturated which might harm the visual appearance." +STARTLINE}
 map_overlays_to_input_gamut true
}
 Group {
  inputs 0
  name GamutGrid1
  xpos -920
  ypos -201
  postage_stamp true
  addUserKnob {20 GamutGrid}
  addUserKnob {3 style}
  style {{!parent.gamut_grid_style}}
  addUserKnob {3 distribution -STARTLINE}
  distribution {{parent.distribution}}
  addUserKnob {7 density R 10 150}
  density {{parent.density}}
  addUserKnob {26 ""}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {12 wxy}
  wxy {{parent.RGBToXYZ_GamutGrid.wxy} {parent.RGBToXYZ_GamutGrid.wxy}}
 }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   centerSaturation 1
   fillFormat false
   area {-170 -158 682 670}
   name ColorWheel4
   xpos -260
   ypos -15
   postage_stamp false
  }
  Crop {
   box {0 0 {width} {height}}
   crop false
   name Crop2
   xpos -260
   ypos 27
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat3
   xpos -260
   ypos 110
  }
set N6c143400 [stack 0]
push $N6c143400
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   roworder TopBottom
   name ContactSheet2
   xpos -260
   ypos 169
  }
  Dot {
   name Dot1
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -226
   ypos 246
  }
  ColorWheel {
   inputs 0
   format "512 512 0 0 512 512 1 square_512"
   fillFormat false
   area {40 40 472 472}
   name ColorWheel1
   xpos -40
   ypos -664
   postage_stamp false
  }
  Reformat {
   type scale
   scale {{max(parent.density/50,0.25)}}
   resize distort
   filter impulse
   pbb true
   name Reformat1
   xpos -40
   ypos -628
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   name Crop1
   xpos -40
   ypos -602
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos -526
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos -415
  }
  Colorspace {
   colorspace_in CIE-XYZ
   colorspace_out CIE-Yxy
   name Colorspace1
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -341
  }
set N6c140c00 [stack 0]
  Dot {
   name Dot2
   label " "
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos -331
  }
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression5
   label "CIE Yxy to CIELuv"
   xpos -590
   ypos -304
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 "(-(degrees(atan2(g-white.x, b-white.y))-180)+270)%360/360"
   expr2 "hypot(g-white.x, b-white.y)"
   expr3 a
   name Expression3
   xpos -590
   ypos -261
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{"parent.distribution ? 4*parent.wxy.x / ( -2 * parent.wxy.x + 12 * parent.wxy.y + 3) : parent.wxy"} {"parent.distribution ? 9*parent.wxy.y / ( -2*parent.wxy.x + 12*parent.wxy.y + 3) : parent.wxy"}}
  }
set N6c0dfc00 [stack 0]
  Posterize {
   channels rgb
   Colors {{rint(parent.density/3*2)}}
   name Posterize1
   xpos -590
   ypos -191
  }
set N6c0df800 [stack 0]
push $N6c0dfc00
  Dot {
   name Dot15
   xpos -446
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy1
   xpos -480
   ypos -154
  }
push $N6c0df800
push $N6c0dfc00
  Dot {
   name Dot16
   xpos -666
   ypos -257
  }
  Copy {
   inputs 2
   from0 rgba.green
   to0 rgba.green
   name Copy2
   xpos -700
   ypos -153
  }
  ContactSheet {
   inputs 2
   width {{width*columns}}
   height {{height/pixel_aspect*rows}}
   rows 1
   columns 2
   center true
   roworder TopBottom
   name ContactSheet3
   xpos -590
   ypos -106
  }
  Expression {
   expr0 r
   expr1 cos(radians(g*360))*b+white.x
   expr2 sin(radians(g*360))*b+white.y
   expr3 a
   name Expression19
   xpos -590
   ypos -58
   cached true
   addUserKnob {20 User}
   addUserKnob {12 white}
   white {{parent.Expression3.white} {parent.Expression3.white}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression2
   label "CIELuv to CIE Yxy"
   xpos -590
   ypos -16
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace2
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -590
   ypos 32
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix1
   label "XYZ to RGB"
   xpos -590
   ypos 81
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin2
   xpos -590
   ypos 119
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp1
   xpos -590
   ypos 152
  }
  Premult {
   name Premult1
   xpos -590
   ypos 194
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge2
   xpos -590
   ypos 242
  }
  Fill {
   output alpha
   name Fill1
   xpos -590
   ypos 297
  }
  Dot {
   name Dot3
   label " GRID"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -556
   ypos 378
  }
push $N6c143400
push $N6c140c00
  Expression {
   expr0 r
   expr1 "4*g / ( -2*g + 12*b + 3)"
   expr2 "9*b / ( -2*g + 12*b + 3)"
   name Expression4
   label "CIE Yxy to CIELuv"
   xpos -40
   ypos -280
   disable {{!parent.distribution}}
  }
  Expression {
   expr0 r
   expr1 rint(g*Colors)/Colors
   expr2 rint(b*Colors)/Colors
   expr3 a
   name Expression1
   label rint
   xpos -40
   ypos -232
   addUserKnob {20 User}
   addUserKnob {7 Colors R 1 256}
   Colors {{parent.density}}
  }
  Expression {
   expr0 r
   expr1 "9*g / ( 6*g - 16*b + 12)"
   expr2 "4*b/ ( 6*g - 16*b + 12)"
   name Expression6
   label "CIELuv to CIE Yxy"
   xpos -40
   ypos -184
   disable {{!parent.distribution}}
  }
  Colorspace {
   colorspace_in CIE-Yxy
   colorspace_out CIE-XYZ
   name Colorspace3
   label "\[value colorspace_in] -> \[value colorspace_out]"
   xpos -40
   ypos -112
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   invert true
   name ColorMatrix3
   label "XYZ to RGB"
   xpos -40
   ypos -57
  }
  Clamp {
   channels alpha
   minimum 1
   MinClampTo_enable true
   MaxClampTo_enable true
   name Clamp4
   xpos -40
  }
  Premult {
   name Premult2
   xpos -40
   ypos 55
  }
  Merge2 {
   inputs 2
   operation under
   bbox B
   name Merge1
   xpos -40
   ypos 110
  }
  Clamp {
   channels rgba
   maximum_enable false
   name ClampMin1
   xpos -40
   ypos 273
  }
  Dot {
   name Dot4
   label " DOTS"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 378
  }
  Switch {
   inputs 2
   which {{parent.style}}
   name Switch1
   xpos -257
   ypos 483
  }
  ColorMatrix {
   matrix {
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
       {{parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix} {parent.parent.RGBToXYZ_GamutGrid.ColorMatrix.matrix}}
     }
   name ColorMatrix2
   label "RGB to XYZ"
   xpos -257
   ypos 560
  }
  Output {
   name Output
   xpos -257
   ypos 740
  }
  ColorWheel {
   inputs 0
   format "256 256 0 0 256 256 1 square_256"
   area {40 40 472 472}
   name ColorWheel2
   xpos -37
   ypos -705
   postage_stamp false
  }
 end_group
set N6c1c1d00 [stack 0]
 Group {
  name RGBToXYZ_GamutGrid
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos -184
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorWheel {
  inputs 0
  format "512 512 0 0 512 512 1 square_512"
  centerSaturation 1
  fillFormat false
  area {-196 -184 708 696}
  name ColorWheel1
  xpos -920
  ypos 5
 }
 Crop {
  box {0 0 {width} {height}}
  name Crop1
  xpos -920
  ypos 87
 }
 BlackOutside {
  name BlackOutside3
  xpos -920
  ypos 134
 }
set N6c3f6800 [stack 0]
 Group {
  name RGBToXYZ_GamutC
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1140
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut Rec709
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r+input.width} {parent.ReformatBox4.box_width-input.height}}
  name Position6
  xpos -1140
  ypos 254
 }
push $N6c3f6800
 Group {
  name RGBToXYZ_GamutB
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -1030
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut P3D65
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height*2}}
  name Position5
  xpos -1030
  ypos 254
 }
push $N6c3f6800
 Group {
  name RGBToXYZ_GamutA
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos -920
  ypos 176
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.7006223798 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.1487748176 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.101058729 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2741185129 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.8736318946 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 -0.1477504075 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 -0.09896291792 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 -0.1378953159 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 1.325916052 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Position {
  translate {{parent.Reformat1.box_width+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position4
  xpos -920
  ypos 254
 }
push $N6c1c1d00
 Reformat {
  type scale
  scale 0.8
  turn true
  filter impulse
  black_outside true
  name Reformat2
  xpos -920
  ypos -129
 }
 BlackOutside {
  name BlackOutside2
  xpos -920
  ypos -106
 }
 Position {
  translate {{Rectangle1.area.r} {parent.Position3.translate.y-input.height}}
  name Position2
  xpos -920
  ypos -81
 }
 Group {
  inputs 0
  name ColorChecker24_After_November_2014
  label "CIE XYZ D50"
  xpos -920
  ypos -352
  addUserKnob {20 colorchecker_tab l "ColorChecker24 - After November 2014"}
  addUserKnob {3 patch_resolution}
  patch_resolution 48
 }
  Group {
   inputs 0
   name bluish_green
   selected true
   xpos 622
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.30451114 0.4143554688 0.344352688 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "bluish green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 6
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_flower
   xpos 512
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2419823988 0.2287175998 0.3282104382 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue flower"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 5
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name foliage
   xpos 402
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1114392339 0.1346792679 0.05239320311 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob foliage
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 4
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue_sky
   xpos 292
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1652470004 0.1785519348 0.2546024121 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "blue sky"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 3
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name light_skin
   xpos 180
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3811104477 0.336202304 0.1852590702 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "light skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 2
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 135
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name dark_skin
   xpos 70
   ypos -321
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1136398927 0.09832436105 0.047793811 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "dark skin"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 1
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 290
    ypos 63
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 290
    ypos 158
   }
   Output {
    name Output
    xpos 290
    ypos 230
   }
  end_group
  Group {
   inputs 0
   name orange_yellow
   xpos 622
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4769723742 0.4293377578 0.06005041429 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "orange yellow"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 12
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow_green
   xpos 512
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3427379502 0.4331759409 0.08330791241 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "yellow green"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 11
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purple
   xpos 401
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08353888545 0.06276662955 0.1042075686 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob purple
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 10
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name moderate_red
   xpos 290
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2915036416 0.188999956 0.09736350318 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "moderate red"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 9
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name purplish_blue
   xpos 180
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1200518326 0.1091090233 0.2874447494 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "purplish blue"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 8
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name orange
   xpos 74
   ypos -201
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.4073691399 0.3126416159 0.05130591012 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob orange
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 7
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name cyan
   xpos 622
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1247966941 0.180609913 0.2913392383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob cyan
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 18
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name magenta
   xpos 512
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.299122798 0.1895114577 0.2213469194 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob magenta
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 17
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name yellow
   xpos 399
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5888922356 0.5992976803 0.07077420003 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob yellow
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 16
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 182
   }
  end_group
  Group {
   inputs 0
   name red
   xpos 292
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.2143728424 0.127800835 0.03868150726 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob red
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 15
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name green
   xpos 182
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1413517689 0.2233437582 0.07287461742 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob green
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 14
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name blue
   xpos 72
   ypos -81
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.06809095613 0.05596214063 0.2077405936 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob blue
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 13
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name black_2
   xpos 623
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.03042544265 0.03151319431 0.02656724434 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "black 2 (1.5 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 24
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 125
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_3
   xpos 512
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.08448968042 0.08817234828 0.07391630753 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 3.5 (1.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 23
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_5
   xpos 403
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.1835495863 0.1906228754 0.1566717383 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 5 (.70 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 22
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_6
   xpos 292
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.3495921991 0.3648652066 0.3013565492 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 6.5 (.44 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 21
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name neutral_8
   xpos 179
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.5665335579 0.5899709702 0.4828473821 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "neutral 8 (.23 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 20
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  Group {
   inputs 0
   name white_9
   xpos 70
   ypos 39
   postage_stamp true
   addUserKnob {20 sample_Tab l Sample}
   addUserKnob {19 colour_RGBA_Color_Knob l Colour}
   colour_RGBA_Color_Knob {0.8436985288 0.8806903203 0.6936778752 1}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 colour_RGBA_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {1 name_Text_Knob l Name}
   name_Text_Knob "white 9.5 (.05 D)"
   addUserKnob {1 index_Text_Knob l Index}
   index_Text_Knob 19
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {6 label_colour_RGB_Color_Knob_panelDropped_1_1 l "panel dropped state" -STARTLINE +HIDDEN}
   addUserKnob {3 resolution}
   resolution {{parent.patch_resolution}}
  }
   Constant {
    inputs 0
    color {{parent.colour_RGBA_Color_Knob.r} {parent.colour_RGBA_Color_Knob.g} {parent.colour_RGBA_Color_Knob.b} {parent.colour_RGBA_Color_Knob.a}}
    format "512 512 0 0 512 512 1 square_512"
    name Constant
    xpos 262
    ypos 53
   }
   Reformat {
    type "to box"
    box_width {{parent.resolution}}
    box_height {{parent.resolution}}
    box_fixed true
    filter impulse
    black_outside true
    name Reformat1
    xpos 262
    ypos 134
   }
   Output {
    name Output
    xpos 262
    ypos 173
   }
  end_group
  ContactSheet {
   inputs 24
   width {{"rint(parent.patch_resolution * 6 + gap * 7)"}}
   height {{"rint(parent.patch_resolution * 4 + gap * 5)"}}
   rows 4
   columns 6
   startframe 1
   endframe 1
   name ContactSheet
   xpos 620
   ypos 206
  }
  Unpremult {
   name Unpremult1
   xpos 620
   ypos 278
  }
  Output {
   name Output
   xpos 620
   ypos 446
  }
 end_group
 BlackOutside {
  name BlackOutside4
  xpos -920
  ypos -298
 }
 Position {
  translate {{parent.Reformat1.box_width*3+Rectangle1.area.r} {parent.ReformatBox4.box_width-input.height}}
  name Position7
  xpos -920
  ypos -273
 }
 Constant {
  inputs 0
  format "256 256 0 0 256 256 1 square_256"
  name Constant5
  xpos -700
  ypos -1354
  postage_stamp false
 }
 Dot {
  name Dot25
  xpos -666
  ypos -1302
 }
set N6c52ac00 [stack 0]
 Dot {
  name Dot27
  xpos -1546
  ypos -1302
 }
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox1
  xpos -1580
  ypos -994
 }
 Ramp {
  p0 {0 0}
  p1 {{input.width} 0}
  color {{p1}}
  name Ramp3
  xpos -1580
  ypos -898
 }
 ColorLookup {
  lut {master {}
    red {curve 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.397 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.483 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.569 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.655 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.741 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.828 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914 0.914}
    green {curve 0.433 0.464 0.513 0.611 0.576 0.46 0.426 0.412 0.404 0.397 0.384 0.374 0.346 0.333 0.311 0.287 0.257 0.23 0.21 0.219 0.208 0.211 0.208 0.187 0.191 0.187 0.18 0.164 0.17 0.177 0.175 0.188 0.252 0.325 0.385 0.416 0.433 0.487 0.532 0.588 0.637 0.634 0.549 0.506 0.49 0.458 0.426 0.412 0.397 0.365 0.337 0.301 0.262 0.221 0.192 0.164 0.167 0.162 0.176 0.179 0.148 0.156 0.142 0.148 0.138 0.145 0.145 0.161 0.197 0.256 0.324 0.393 0.451 0.487 0.508 0.538 0.587 0.634 0.659 0.611 0.552 0.526 0.484 0.452 0.428 0.406 0.371 0.334 0.293 0.243 0.204 0.177 0.151 0.151 0.162 0.158 0.161 0.142 0.141 0.129 0.134 0.14 0.156 0.166 0.192 0.221 0.265 0.325 0.392 0.451 0.508 0.48 0.513 0.554 0.597 0.63 0.634 0.58 0.546 0.499 0.466 0.434 0.408 0.372 0.332 0.288 0.242 0.202 0.179 0.16 0.157 0.162 0.157 0.159 0.149 0.153 0.147 0.154 0.164 0.18 0.199 0.226 0.25 0.279 0.325 0.38 0.439 0.48 0.436 0.468 0.502 0.541 0.57 0.605 0.594 0.555 0.511 0.473 0.439 0.409 0.371 0.332 0.288 0.252 0.217 0.196 0.181 0.178 0.185 0.176 0.173 0.168 0.176 0.178 0.19 0.202 0.214 0.235 0.254 0.27 0.291 0.323 0.366 0.41 0.436 0.396 0.414 0.438 0.465 0.485 0.527 0.566 0.557 0.523 0.478 0.442 0.409 0.371 0.334 0.294 0.265 0.244 0.223 0.225 0.212 0.218 0.211 0.211 0.207 0.214 0.217 0.229 0.237 0.244 0.264 0.275 0.285 0.3 0.321 0.348 0.376 0.396 0.357 0.368 0.377 0.391 0.402 0.431 0.481 0.503 0.521 0.482 0.444 0.409 0.372 0.337 0.307 0.286 0.27 0.257 0.247 0.251 0.257 0.255 0.254 0.25 0.258 0.259 0.265 0.269 0.278 0.284 0.292 0.297 0.305 0.317 0.33 0.344 0.357 0.321 0.322 0.328 0.332 0.333 0.346 0.365 0.389 0.411 0.459 0.443 0.399 0.352 0.327 0.313 0.304 0.3 0.294 0.295 0.294 0.293 0.292 0.291 0.295 0.3 0.301 0.302 0.304 0.304 0.304 0.305 0.307 0.309 0.312 0.313 0.316 0.321}
    blue {curve 0.26 0.281 0.298 0.306 0.342 0.365 0.39 0.381 0.392 0.416 0.413 0.43 0.448 0.446 0.433 0.425 0.419 0.394 0.362 0.328 0.305 0.298 0.286 0.247 0.26 0.219 0.199 0.168 0.178 0.14 0.11 0.084 0.104 0.158 0.18 0.225 0.26 0.235 0.26 0.28 0.298 0.327 0.372 0.395 0.417 0.43 0.435 0.455 0.488 0.479 0.521 0.522 0.515 0.49 0.436 0.383 0.331 0.295 0.282 0.258 0.219 0.208 0.179 0.168 0.141 0.129 0.106 0.094 0.095 0.112 0.127 0.165 0.199 0.235 0.226 0.258 0.28 0.298 0.316 0.361 0.399 0.427 0.446 0.461 0.482 0.52 0.521 0.553 0.563 0.573 0.524 0.454 0.389 0.33 0.295 0.266 0.247 0.214 0.195 0.168 0.178 0.142 0.14 0.128 0.129 0.126 0.131 0.144 0.167 0.199 0.226 0.238 0.266 0.289 0.31 0.329 0.351 0.395 0.428 0.453 0.475 0.494 0.533 0.542 0.568 0.584 0.576 0.53 0.451 0.385 0.331 0.299 0.266 0.245 0.22 0.206 0.184 0.174 0.167 0.166 0.166 0.173 0.172 0.165 0.172 0.187 0.208 0.238 0.258 0.28 0.3 0.321 0.343 0.362 0.391 0.427 0.458 0.482 0.503 0.546 0.554 0.573 0.582 0.546 0.499 0.431 0.375 0.33 0.304 0.275 0.254 0.234 0.225 0.212 0.209 0.206 0.203 0.21 0.215 0.212 0.204 0.208 0.214 0.231 0.258 0.277 0.294 0.31 0.328 0.348 0.372 0.397 0.427 0.462 0.487 0.51 0.544 0.558 0.559 0.556 0.503 0.444 0.402 0.355 0.329 0.309 0.289 0.275 0.26 0.254 0.245 0.245 0.241 0.238 0.249 0.249 0.245 0.241 0.242 0.246 0.258 0.277 0.295 0.305 0.315 0.327 0.339 0.359 0.39 0.421 0.461 0.491 0.515 0.54 0.546 0.522 0.478 0.429 0.393 0.368 0.345 0.325 0.313 0.303 0.295 0.286 0.284 0.279 0.277 0.274 0.277 0.277 0.28 0.276 0.273 0.274 0.279 0.285 0.295 0.311 0.314 0.316 0.32 0.323 0.331 0.346 0.367 0.397 0.468 0.513 0.494 0.425 0.388 0.372 0.348 0.336 0.331 0.326 0.32 0.316 0.314 0.312 0.309 0.321 0.32 0.319 0.305 0.317 0.316 0.316 0.315 0.316 0.317 0.319 0.321 0.311}
    alpha {}}
  name ColorLookup7
  label "Pointers Samples Yxy\nSource: https://www.rit.edu/cos/colorscience/rc_useful_data.php"
  xpos -1580
  ypos -790
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace12
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1580
  ypos -688
 }
 Fill {
  output alpha
  name Fill5
  xpos -1580
  ypos -639
 }
 BlackOutside {
  name BlackOutside7
  xpos -1580
  ypos -562
 }
 Position {
  translate {6 {parent.Position1.translate.y-input.height}}
  name Position3
  xpos -1580
  ypos -538
 }
 Dot {
  name Dot15
  xpos -1546
  ypos -414
 }
push $N6c52ac00
 Reformat {
  type "to box"
  box_width 2048
  box_height 2048
  box_fixed true
  name ReformatBox4
  xpos -700
  ypos -1258
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression7
  xpos -700
  ypos -1209
 }
 Dot {
  name Dot10
  xpos -666
  ypos -1158
 }
set N6c4d3000 [stack 0]
 Dot {
  name Dot26
  xpos -886
  ypos -1158
 }
set N6c4d2c00 [stack 0]
 Dot {
  name Dot23
  xpos -1106
  ypos -1158
 }
set N6c4d2800 [stack 0]
 Dot {
  name Dot12
  xpos -1326
  ypos -1158
 }
 Mirror2 {
  flip true
  flop true
  name Mirror2_1
  xpos -1360
  ypos -1042
 }
 Reformat {
  type "to box"
  box_width 512
  box_height {{box_width}}
  box_fixed true
  name Reformat1
  xpos -1360
  ypos -994
 }
 Gamma {
  channels rgb
  value 2
  name Gamma1
  xpos -1360
  ypos -898
 }
 Multiply {
  channels rgb
  value 8000
  name Multiply1
  label "\[value value]"
  xpos -1360
  ypos -811
 }
 ColorLookup {
  lut {master {}
    red {curve R 0.4830000103 x50 0.5045000315 0.5260000229 0.5475000143 0.5690000057 0.5904999971 0.6119999886 0.63349998 0.6549999714 0.6805312037 0.7087500095 0.7315937281 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.7409999967 0.75459373 0.7845000029 0.8144062757 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8280000091 0.8009687662 0.74150002 0.6820312142 0.6549999714 0.6684374809 0.6980000138 0.7275624871 0.7409999967 0.7315937281 0.7087500095 0.6805312037 0.6549999714 0.629468739 0.6012499928 0.5784062743 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5555624962 0.5260000229 0.4964375198 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4964375198 0.5260000229 0.5555624962 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5690000057 0.5653046966 0.5555624962 0.5417890549 0.5260000229 0.5102109313 0.4964375198 0.4866953194 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4695625007 0.4400000274 0.4104375243 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.3970000148 0.4104375243 0.4400000274 0.4695625007 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103 0.4830000103}
    green {curve R 0.6589999795 x50 0.6542205811 0.6484853029 0.6414804459 0.6340000033 0.6249843836 0.6147499681 0.6041406393 0.5939999819 0.5844687223 0.575124979 0.5659687519 0.5569999814 0.5484530926 0.5402500033 0.5319218636 0.5230000019 0.5131718516 0.5027499795 0.4922031164 0.4819999933 0.4722187519 0.4626249969 0.4532187581 0.4440000057 0.4351093769 0.4265000224 0.4178906381 0.4090000093 0.3997343779 0.3902499974 0.380640626 0.3709999919 0.3614374995 0.3518749774 0.3421249986 0.3319999874 0.321398437 0.3104375005 0.2992577851 0.2879999876 0.2764999866 0.2647500038 0.2531249821 0.2419999987 0.2312265635 0.2206875086 0.2108047009 0.202000007 0.1947187632 0.1886250079 0.1829687506 0.1770000011 0.1693515629 0.1608124971 0.1538671851 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1509999931 0.1527187377 0.1564999968 0.1602812558 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1620000005 0.1612187475 0.1595000029 0.1577812582 0.1570000052 0.1573124975 0.1579999924 0.1586875021 0.1589999944 0.1575781256 0.1543750018 0.1509843767 0.1490000039 0.1485625058 0.1484999955 0.1484375 0.1480000019 0.1467812508 0.1449999958 0.1432187557 0.1420000046 0.1415625066 0.1414999962 0.1414375007 0.1410000026 0.1397656202 0.1378750056 0.1357968748 0.1340000033 0.1323750019 0.1307500005 0.1295000017 0.1289999932 0.130031243 0.1324999928 0.1354687512 0.1379999965 0.1402187496 0.1424999982 0.1442812532 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1449999958 0.1464921832 0.1503124982 0.1554765552 0.1609999985 0.1673984379 0.1749375015 0.1822578013 0.1879999936 0.1906718612 0.1913749874 0.1926406175 0.1969999969 0.2064140588 0.2199375033 0.2357421964 0.2520000041 0.2688750029 0.2871249914 0.3058125079 0.324000001 0.3417187631 0.359375 0.3765937686 0.3930000067 0.4082968831 0.4227499962 0.4368281364 0.451000005 0.4659531415 0.4812500179 0.4956718981 0.5080000162 0.5169296861 0.5234375 0.5297265649 0.5379999876 0.5491171479 0.5618124604 0.5751015544 0.5879999995 0.6009531021 0.6142500043 0.6266719103 0.6370000243 0.6457066536 0.6532088518 0.6575522423 0.6589999795}
    blue {curve R 0.3160000145 x50 0.324739933 0.3330312669 0.3418398499 0.351000011 0.3607422113 0.3709374964 0.3811640739 0.3910000026 0.4003046751 0.4093124866 0.4181640446 0.4269999862 0.4359609187 0.4449374974 0.453695327 0.4620000124 0.4697890878 0.4771875143 0.4842422009 0.4909999967 0.4971874952 0.5028749704 0.5086249709 0.5149999857 0.5227031112 0.53125 0.5394218564 0.5460000038 0.5502656102 0.5530000329 0.5552343726 0.5580000281 0.561632812 0.5655625463 0.5694609284 0.5730000138 0.5765469074 0.5801249743 0.5828906298 0.5839999914 0.5838750005 0.5830000043 0.5806249976 0.5759999752 0.5682968497 0.5576249957 0.5446406007 0.5299999714 0.5128515363 0.4931874871 0.4729296863 0.4539999962 0.4368359447 0.420437485 0.4045703113 0.3889999986 0.3731718659 0.3573749959 0.3426406384 0.3300000131 0.3193906248 0.310375005 0.3034218848 0.298999995 0.2972500026 0.2969999909 0.2967499793 0.2949999869 0.2899531126 0.2821249962 0.2734843791 0.2660000026 0.2602812648 0.2552500069 0.2503437698 0.2450000048 0.2380000055 0.2300000042 0.2232500017 0.2199999988 0.2195625007 0.2194999903 0.2194374949 0.2189999968 0.2183593661 0.2176249921 0.2163281292 0.2140000015 0.2101874948 0.205249995 0.1999374926 0.1949999928 0.1904453039 0.185937494 0.1817109436 0.1780000031 0.1754062474 0.1736250073 0.1715312451 0.1679999977 0.1620937437 0.1546249986 0.147093758 0.1410000026 0.1372031271 0.1347499937 0.1324218661 0.1289999932 0.1237656176 0.1174999923 0.1112343743 0.1059999987 0.1021796837 0.09918750077 0.09660156071 0.09399999678 0.09089062363 0.0876249969 0.0850468725 0.08399999887 0.08524999768 0.0882499963 0.09187500179 0.09499999881 0.09706249833 0.09875000268 0.1008125022 0.1040000021 0.1084140688 0.1136875004 0.1198671907 0.1270000041 0.1355390698 0.145312503 0.1554296911 0.1650000066 0.1739453226 0.1826875061 0.1910859346 0.199000001 0.2061250061 0.2126249969 0.2190624923 0.2259999961 0.2338827997 0.2423124909 0.2505859137 0.2579999864 0.2642968595 0.26987499 0.2750156224 0.2800000012 0.2847812474 0.2892500162 0.2935937643 0.2980000079 0.3025000095 0.3070000112 0.3115000129 0.3160000145}
    alpha {}}
  name ColorLookup5
  label "Pointer's Gamut Boundary Yxy\ninterpolated: incr 50 - 0 to 8000"
  xpos -1360
  ypos -775
 }
 Multiply {
  channels rgb
  value {0.31 1 1 1}
  name Multiply2
  label "dim boundary"
  xpos -1360
  ypos -725
 }
 Colorspace {
  colorspace_in CIE-Yxy
  primary_in "Adobe (1998)"
  colorspace_out CIE-XYZ
  name Colorspace5
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1360
  ypos -688
 }
 Fill {
  output alpha
  name Fill4
  xpos -1360
  ypos -639
 }
 BlackOutside {
  name BlackOutside1
  xpos -1360
  ypos -562
 }
 Position {
  translate {6 {ReformatBox4.box_width-input.width}}
  name Position1
  xpos -1360
  ypos -538
 }
 Dot {
  name Dot24
  xpos -1326
  ypos -486
 }
push $N6c4d2800
 Reformat {
  type "to box"
  box_width {{parent.Reformat1.box_width}}
  box_height 100
  box_fixed true
  name ReformatBox2
  xpos -1140
  ypos -994
 }
 Expression {
  temp_name0 n
  temp_expr0 input.width/8
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 x/width*(1-y/height)
  channel3 alpha
  expr3 1
  name Expression1
  xpos -1140
  ypos -898
 }
set N6c47e400 [stack 0]
 Dot {
  name Dot8
  xpos -996
  ypos -894
 }
 ColorLookup {
  lut {master {curve L 0 s0 t0.9499999881 C k x0.308139503 1 s0}
    red {}
    green {}
    blue {}
    alpha {}}
  name ColorLookup1
  xpos -1030
  ypos -849
 }
 Dot {
  name Dot14
  xpos -996
  ypos -750
 }
push $N6c47e400
 Multiply {
  channels rgb
  value 269
  name Multiply5
  label "\[value value]"
  xpos -1140
  ypos -856
 }
 ColorLookup {
  lut {master {}
    red {curve C 1.8783474 1.85965741 1.8410753 1.82260251 1.80424976 1.78602886 1.76794314 1.75000143 1.73221421 1.71458244 1.69711792 1.67982578 1.66271067 1.6457777 1.62903571 1.6124835 1.59613538 1.57998943 1.56404996 1.54832447 1.5328095 1.51751649 1.50244594 1.48759735 1.47297573 1.45858264 1.44442391 1.43049574 1.41680288 1.40334678 1.39012623 1.37714779 1.36440396 1.35190022 1.33963728 1.32761216 1.31582856 1.30428183 1.29297352 1.28190565 1.27107596 1.2604804 1.25012183 1.23999798 1.23010659 1.22044563 1.21101499 1.20181489 1.19284034 1.18408906 1.17556167 1.16725397 1.15916491 1.15129638 1.14363372 1.13618886 1.12895167 1.12192106 1.11509454 1.10846853 1.10204577 1.09580922 1.08977199 1.08392429 1.07826447 1.07278681 1.06749392 1.06237841 1.05743873 1.05267084 1.04807138 1.04364109 1.03937256 1.03526449 1.03131545 1.02751946 1.02387333 1.02037668 1.01702523 1.01381445 1.01074362 1.00780725 1.00500631 1.00233305 0.99978602 0.99736285 0.9950608 0.99287677 0.99080539 0.98884678 0.98699367 0.9852494 0.98361033 0.98206747 0.98062134 0.97926998 0.97800934 0.97683728 0.97575116 0.97474778 0.97382426 0.97297859 0.97220623 0.97150886 0.97087657 0.97031689 0.96981871 0.96938527 0.96900952 0.96869147 0.96842706 0.96821606 0.96805781 0.96794283 0.96787858 0.96785843 0.96787864 0.96793604 0.96803701 0.96817231 0.96833968 0.96854311 0.96877253 0.96903455 0.96932232 0.96963543 0.96997368 0.97033387 0.97071254 0.9711163 0.97153723 0.97197378 0.97242606 0.97289121 0.97337079 0.97386622 0.97437072 0.97488332 0.97540969 0.97594237 0.97647977 0.97702706 0.97757769 0.97813445 0.97869468 0.97925854 0.97982538 0.98039114 0.98096472 0.98153675 0.98210776 0.98267955 0.98325121 0.98382008 0.98438704 0.9849571 0.98552132 0.98608243 0.98664182 0.98719966 0.98775077 0.98829895 0.98884273 0.98938417 0.98991877 0.9904511 0.99097681 0.99149919 0.99201453 0.99252397 0.99303031 0.99353105 0.99402624 0.99451613 0.99499857 0.99547589 0.99594522 0.99641174 0.99687338 0.99732745 0.99777603 0.9982177 0.99865389 0.999084 0.99950838 0.99992663 1.00033772 1.00074494 1.00114489 1.00153947 1.00192833 1.00231075 1.00268865 1.00305855 1.00342607 1.00378489 1.00413895 1.00448751 1.00483036 1.00517035 1.00550389 1.00583148 1.00615203 1.00646758 1.00678015 1.00708604 1.00738645 1.00768471 1.00797844 1.0082655 1.00854778 1.00882483 1.00909901 1.00936711 1.00963116 1.00989032 1.0101465 1.01039672 1.01064491 1.01088691 1.0111258 1.01135957 1.01158977 1.01181614 1.01203847 1.01225793 1.01247287 1.01268291 1.01289058 1.01309609 1.01329684 1.01349473 1.0136888 1.0138787 1.01406395 1.01424909 1.01442885 1.01460576 1.01478052 1.01495218 1.01512218 1.01528883 1.01545072 1.01561022 1.01576698 1.01592219 1.01607502 1.01622343 1.01636875 1.0165143 1.01665616 1.01679492 1.0169313 1.01706588 1.01719737 1.01732695 1.01745498 1.01757956 1.01770294 1.01782393 1.01794255 1.0180583 1.01817465 1.01828551 1.01839495 1.01850486 1.01861191 1.01871693 1.01882088 1.01891339}
    green {curve C 1}
    blue {curve C 0.00879261 0.00962762 0.010532 0.01151017 0.01256675 0.01370643 0.01493413 0.01625487 0.01767381 0.01919618 0.02082733 0.02257277 0.02443803 0.02642871 0.02855051 0.03080913 0.0332104 0.0357601 0.03846392 0.04132775 0.04435719 0.04755813 0.05093599 0.05449668 0.0582453 0.0621875 0.06632853 0.07067341 0.07522713 0.07999477 0.08498063 0.09018957 0.09562518 0.10129225 0.10719412 0.11333443 0.11971687 0.12634411 0.133219 0.14034435 0.14772213 0.15535444 0.16324303 0.17138906 0.179794 0.18845794 0.197382 0.20656651 0.21601067 0.22571453 0.23567709 0.24589771 0.25637382 0.26710594 0.2780903 0.28932518 0.30080822 0.3125369 0.32450783 0.33671761 0.34916404 0.36183971 0.37474373 0.38787127 0.40121818 0.41477671 0.42854655 0.44251823 0.45668846 0.47105014 0.48559928 0.50033116 0.5152359 0.5303098 0.5455451 0.56093836 0.5764783 0.59215891 0.60797763 0.62392306 0.63999057 0.65616876 0.6724565 0.68884456 0.70532417 0.72188419 0.73852479 0.7552371 0.77200818 0.78883314 0.80570388 0.82261622 0.83956301 0.8565321 0.87351894 0.89051074 0.90751225 0.92450547 0.94148719 0.95845115 0.97538745 0.99229181 1.00915313 1.02597356 1.04273522 1.05944169 1.07608175 1.09265125 1.10914159 1.12555146 1.14187002 1.15809321 1.1742171 1.190238 1.20614767 1.22194457 1.23762202 1.2531724 1.26859927 1.28389311 1.29905295 1.31407428 1.32895291 1.34368753 1.35827363 1.3727088 1.38699389 1.40111876 1.41508293 1.42889357 1.44254065 1.45602405 1.46934104 1.48249614 1.49548101 1.50830269 1.5209527 1.53343177 1.54574537 1.5578897 1.56985986 1.5816654 1.59329891 1.60476208 1.61605716 1.62718153 1.63813758 1.64892519 1.65955138 1.67000985 1.68030369 1.69043732 1.70040607 1.71021223 1.71985734 1.72934508 1.73867714 1.74785423 1.75688136 1.76575518 1.77447391 1.78304338 1.79146802 1.79975164 1.80788386 1.81587982 1.82373333 1.83144975 1.83902776 1.84647095 1.85378456 1.86096811 1.86802399 1.87495112 1.88175035 1.88842535 1.89497983 1.90141833 1.90774179 1.91394711 1.92004013 1.92602086 1.93188739 1.93765306 1.94330883 1.94886208 1.95430994 1.95965815 1.96490622 1.97005856 1.97511387 1.98007631 1.98494554 1.98972344 1.99441445 1.99901712 2.00353193 2.00796437 2.01231384 2.01658392 2.02076721 2.02487659 2.02890825 2.03286695 2.03675175 2.04056406 2.04430199 2.04797506 2.05157685 2.05511236 2.0585804 2.06198287 2.06532407 2.06860161 2.07181907 2.07497644 2.07807779 2.0811162 2.08409977 2.08702946 2.08990335 2.09272337 2.09549189 2.0982089 2.10087585 2.10349345 2.10606146 2.1085825 2.11105394 2.11348104 2.11586332 2.11820364 2.12050176 2.12275648 2.12496805 2.127141 2.12927723 2.13136625 2.13341999 2.13543844 2.13741732 2.13936305 2.1412704 2.1431427 2.14498401 2.14678812 2.14856291 2.1503005 2.15200949 2.15368938 2.15533352 2.15695238 2.15853977 2.16009951 2.16162968 2.16313291 2.16460824 2.16605687 2.16747928 2.16887903 2.17024994 2.1715951 2.17291784 2.17421341 2.17548871 2.17674041 2.17797112 2.17918396 2.18036819 2.18143296}
    alpha {}}
  name ColorLookup3
  label "Planckian Locus 0-269"
  xpos -1140
  ypos -808
 }
 Multiply {
  inputs 1+1
  channels rgb
  value 0
  maskChannelMask rgba.red
  invert_mask true
  name Multiply3
  label dim
  xpos -1140
  ypos -760
 }
 BlackOutside {
  name BlackOutside6
  xpos -1140
  ypos -706
 }
 Position {
  translate {6 {parent.Position2.translate.y-input.height}}
  name Position8
  xpos -1140
  ypos -682
 }
 Dot {
  name Dot28
  xpos -1106
  ypos -654
 }
push $N6c4d2c00
 Dot {
  name Dot4
  xpos -886
  ypos -1086
 }
set N6c43b800 [stack 0]
 Rectangle {
  replace true
  area {0 0 6 {height}}
  name Rectangle1
  xpos -810
  ypos -1089
 }
 BlackOutside {
  name BlackOutside5
  xpos -810
  ypos -1041
 }
push $N6c43b800
 Radial {
  inputs 1+1
  replace true
  area {-5422 -3542 7470 5590}
  softness 0
  ramp linear
  color {0.0719 0.02604 0.0001 1}
  p1 {0 0}
  color0 {0.039378 0.001097 0.188331 1}
  p0 {0 2048}
  name Radial1
  xpos -920
  ypos -1041
 }
 Dot {
  name Dot9
  xpos -886
  ypos -894
 }
push $N6c4d3000
 Gamma {
  channels rgba
  value 0.5
  name Gamma2
  xpos -700
  ypos -1120
 }
 Expression {
  temp_name0 start
  temp_expr0 360
  temp_name1 end
  temp_expr1 830
  channel0 {rgba.red rgba.green rgba.blue none}
  expr0 r*(end-start)+start
  channel1 none
  channel2 none
  expr3 1
  name Expression2
  label "360nm to 830nm"
  xpos -700
  ypos -1096
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 6.97e-06 7.81e-06 8.77e-06 9.84e-06 1.104e-05 1.239e-05 1.389e-05 1.556e-05 1.744e-05 1.958e-05 2.202e-05 2.484e-05 2.804e-05 3.153e-05 3.522e-05 3.9e-05 4.283e-05 4.691e-05 5.159e-05 5.718e-05 6.4e-05 7.234e-05 8.221e-05 9.351e-05 0.00010614 0.00012 0.00013498 0.00015149 0.00017021 0.00019182 0.000217 0.00024691 0.00028124 0.00031852 0.00035727 0.000396 0.00043371 0.00047302 0.00051788 0.00057222 0.00064 0.00072456 0.0008255 0.00094116 0.00106988 0.00121 0.00136209 0.00153075 0.00172037 0.00193532 0.00218 0.0024548 0.002764 0.0031178 0.0035264 0.004 0.00454624 0.00515932 0.00582928 0.00654616 0.0073 0.00808651 0.00890872 0.00976768 0.01066443 0.0116 0.01257317 0.01358272 0.01462968 0.01571509 0.01684 0.01800736 0.01921448 0.02045392 0.02171824 0.023 0.02429461 0.02561024 0.02695857 0.02835125 0.0298 0.03131083 0.03288368 0.03452112 0.03622571 0.038 0.03984667 0.041768 0.043766 0.04584267 0.048 0.05024368 0.05257304 0.05498056 0.05745872 0.06 0.06260197 0.06527752 0.06804208 0.07091109 0.0739 0.077016 0.0802664 0.0836668 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name ColorLookup4
  label "CIE 1931 2 Degree Standard Observer\n360nm to 830nm"
  xpos -700
  ypos -1030
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeLineOfPurples
  xpos -700
  ypos -897
  disable {{!parent.draw_line_of_purples}}
 }
 Fill {
  color {0 0 0 1}
  name Disable_SpectralLocus
  xpos -700
  ypos -826
  disable {{parent.draw_spectral_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePlanckianLocus
  xpos -700
  ypos -658
  disable {{!parent.draw_planckian_locus}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut
  xpos -700
  ypos -489
  disable {{!parent.draw_pointers_gamut}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergePointerGamut_Samples
  xpos -700
  ypos -417
  disable {{!draw_pointers_samples}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeMacbeth
  xpos -700
  ypos -273
  disable {{!parent.draw_macbeth_chart}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutGrid
  xpos -700
  ypos -81
  disable {{!parent.gamut_grid}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutA
  xpos -700
  ypos 255
  disable {{!parent.gamut_a}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutB
  xpos -700
  ypos 279
  disable {{!parent.gamut_b}}
 }
 Merge2 {
  inputs 2
  bbox B
  name MergeGamutC
  xpos -700
  ypos 303
  disable {{!parent.gamut_c}}
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 450
 }
set N6c7bec00 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 450
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace6
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -590
  ypos 488
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression5
  label "CIE Yxy to CIELuv"
  xpos -590
  ypos 536
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -556
  ypos 618
 }
push $N6c7bec00
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  invert true
  name ColorMatrix1
  label "XYZ to working"
  xpos -700
  ypos 488
  disable {{!map_overlays_to_input_gamut}}
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_grid\" iterate pixelWise b2e7b5f8a89bdb0629aa8cc2eae387ef3436f24cb0af642eeba41235874506c4 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 6 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== \"draw_axes\" Bool 1 AA== \"grid_color\" Float 4 AAAAAAAAAAAAAAAAAAAAAA== 6 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 \"draw_axes\" 1 1 \"grid_color\" 4 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_grid : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n  bool draw_axes;\n  float4 grid_color;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n  void draw_grid() \{\n    // grid width in pixels. expresses a 0 to 1 range in CIE xy\n    float grid_width = 1.0f * outsize + offset;\n    // draw grid lines\n    float i = offset;\n    while (i <= grid_width && i > 0.0f) \{\n      write_aa(offset, i, grid_color);\n      write_aa(i, offset, grid_color);\n      i += 1.0;\n    \}\n    // cross-hatching interval in pixels\n    float hatch_interval = (grid_width - offset) * 0.1f;\n    // cross-hatch length in pixels\n    float hatch_width = outsize * 0.01f;\n    i = offset;\n    while (i <= grid_width) \{\n      i += hatch_interval;\n      float j = 0.0;\n      while (j <= hatch_width/2) \{\n        write_aa(offset+j, i, grid_color);\n        write_aa(offset-j, i, grid_color);\n        write_aa(i, offset+j, grid_color);\n        write_aa(i, offset-j, grid_color);\n        j += 1.0;\n      \}\n    \}\n  \}\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n\n    // draw CIExy coordinate system axes\n    if (draw_axes && pos.x == 0 && pos.y == 0) \{\n      draw_grid();\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_grid_padding {{parent.PlotChromaticities.PlotChromaticity_padding}}
  PlotChromaticity_grid_left_margin {{parent.PlotChromaticities.PlotChromaticity_left_margin}}
  PlotChromaticity_grid_tolerance 0.8
  PlotChromaticity_grid_antialias true
  PlotChromaticity_grid_draw_axes {{parent.coordinate_system}}
  PlotChromaticity_grid_grid_color {0.15 0 0.005 1}
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotInput2
  xpos -700
  ypos 608
 }
 FrameHold {
  firstFrame 1
  name FrameHold1
  xpos -700
  ypos 680
  cached true
 }
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 762
 }
 Input {
  inputs 0
  name Input
  xpos 620
  ypos -1426
 }
 AddChannels {
  name AddChannels1
  xpos 620
  ypos -1360
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat
  xpos 620
  ypos -1282
  disable {{!parent.resample_input}}
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name CropBBox
  xpos 620
  ypos -1257
 }
 Dot {
  name Dot7
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 162
 }
set N6c757400 [stack 0]
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "256 256 0 0 256 256 1 square_256"
  name Constant2
  xpos 400
  ypos 38
  postage_stamp false
 }
 Reformat {
  type "to box"
  box_width {{parent.resolution}}
  box_height {{box_width}}
  box_fixed true
  box_pixel_aspect {{input.pixel_aspect}}
  resize distort
  filter impulse
  name OutputFormat1
  xpos 400
  ypos 64
  disable {{!parent.resample_input}}
 }
 Switch {
  inputs 2
  which {{"\[exists parent.input0]"}}
  name Switch1
  xpos 400
  ypos 158
 }
 Fill {
  output rgb
  color 0.18
  name SampleColor
  xpos 290
  ypos 158
 }
 Crop {
  box {0 0 {width} {height}}
  crop false
  name Crop2
  xpos 290
  ypos 184
 }
 Fill {
  output alpha
  name Fill3
  xpos 290
  ypos 224
 }
 Dot {
  name Dot6
  xpos 324
  ypos 282
 }
set N6c755800 [stack 0]
 ColorMatrix {
  matrix {
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
      {{parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix} {parent.GamutToXYZ.ColorMatrix.matrix}}
    }
  name ColorMatrix4
  label "working to XYZ"
  xpos 180
  ypos 272
 }
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace1
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 180
  ypos 320
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression6
  label "CIE Yxy to CIELuv"
  xpos 180
  ypos 368
  disable {{!parent.diagram}}
 }
push $N6c755800
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity_sample\" iterate pixelWise 20e14b615a937bac78c1a771cbdfd10cc7c5fb6c487f65d0bb2d6633e404b958 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 3 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== 3 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity_sample : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  void process(int2 pos) \{\n    // only process the first pixel\n    if (pos.x > 0 && pos.y > 0) return;\n\n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    int2 p = int2(round(out_coord.x), round(out_coord.y));\n    if (dst.bounds.inside(p.x, p.y)) \{\n      for (int k=0; k<3; k++) \{\n        dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n      \}\n      dst(p.x, p.y, 3) = 1.0f;\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_sample_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_sample_left_margin {{parent.left_margin}}
  PlotChromaticity_sample_tolerance 1
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities1
  xpos 290
  ypos 368
 }
 Dot {
  name Dot22
  xpos 324
  ypos 450
 }
set N6c754400 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048}}
  name Dilate1
  label "\[value size]"
  xpos 290
  ypos 488
 }
set N6caf7c00 [stack 0]
 Dilate {
  channels rgba
  size {{Output.width/2048*2}}
  name Dilate2
  label "\[value size]"
  xpos 180
  ypos 488
 }
push $N6c754400
 Dot {
  name Dot21
  xpos -6
  ypos 450
 }
 FilterErode {
  channels rgba
  size {{-Output.width/2048/5}}
  filter triangle
  name FilterErode1
  label "\[value size]"
  xpos -40
  ypos 489
 }
set N6caf7000 [stack 0]
 Dilate {
  channels rgba
  size {0 {parent.Dilate3.size.w}}
  name Dilate4
  label "\[value size]"
  xpos -40
  ypos 584
 }
push $N6caf7000
 Dilate {
  channels rgba
  size {{Output.width*plus_size/100} 0}
  name Dilate3
  label "\[value size]"
  xpos 70
  ypos 488
  addUserKnob {20 User}
  addUserKnob {7 plus_size R 0 4}
  plus_size 0.8
 }
 Merge2 {
  inputs 2
  operation screen
  bbox B
  name Merge9
  xpos 70
  ypos 591
 }
 Merge2 {
  inputs 2
  operation stencil
  bbox B
  name Merge10
  xpos 180
  ypos 591
 }
 Group {
  name HueRotate
  xpos 180
  ypos 639
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -24
  }
  Unpremult {
   name Unpremult1
   xpos -40
   ypos 15
  }
  Colorspace {
   colorspace_out HSV
   name Colorspace1
   xpos -40
   ypos 72
  }
  Add {
   channels {rgba.red -rgba.green -rgba.blue none}
   value 0.5
   name Add1
   xpos -40
   ypos 111
  }
  Fill {
   output {-rgba.red -rgba.green rgba.blue none}
   name Fill1
   xpos -40
   ypos 147
  }
  Colorspace {
   colorspace_in HSV
   name Colorspace2
   xpos -40
   ypos 183
  }
  Premult {
   name Premult1
   xpos -40
   ypos 231
  }
  Output {
   name Output1
   xpos -40
   ypos 302
  }
 end_group
push $N6caf7c00
 Merge2 {
  inputs 2
  bbox B
  name Merge8
  xpos 290
  ypos 638
 }
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 324
  ypos 690
 }
push $N6c757400
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 162
 }
 Group {
  name GamutToXYZ
  label "\[if \{\[value invert]\} \{return \"XYZ to \[value gamut]\"\} else \{return \"\[value gamut] to XYZ\"\}]\n\n"
  xpos 730
  ypos 247
  addUserKnob {20 GamutToXYZ_tab l GamutToXYZ}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACES
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Colorspace {
  colorspace_in CIE-XYZ
  primary_in "Adobe (1998)"
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 730
  ypos 296
 }
 Expression {
  expr0 r
  expr1 "4*g / ( -2*g + 12*b + 3)"
  expr2 "9*b / ( -2*g + 12*b + 3)"
  name Expression4
  label "CIE Yxy to CIELuv"
  xpos 730
  ypos 344
  disable {{!parent.diagram}}
 }
 Dot {
  name Dot13
  label " Pos"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 764
  ypos 546
 }
push $N6c757400
 Dot {
  name Dot16
  label " Col"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 450
 }
 BlinkScript {
  inputs 2
  KernelDescription "2 \"PlotChromaticity\" iterate pixelWise 3e86399c7642fe5c35c23528a644f88a8bf13f967de084ae6842f8be55098c6b 3 \"col\" Read Random \"Yxy\" Read Random \"dst\" Write Random 4 \"padding\" Float 1 AAAAAA== \"left_margin\" Float 1 AAAAAA== \"tolerance\" Float 1 AAAAAA== \"antialias\" Bool 1 AA== 4 \"padding\" 1 1 \"left_margin\" 1 1 \"tolerance\" 1 1 \"antialias\" 1 1 2 \"outsize\" Float 1 1 AAAAAA== \"offset\" Float 1 1 AAAAAA=="
  kernelSource "kernel PlotChromaticity : public ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessRandom, eEdgeClamped> col;\n  Image<eRead, eAccessRandom, eEdgeClamped> Yxy;\n  Image<eWrite, eAccessRandom> dst;\n\nparam:\n  float padding;\n  float left_margin;\n  float tolerance;\n  bool antialias;\n\nlocal:\n  float outsize;\n  float offset;\n\n  void init() \{\n    // calculate output width and height and offset based on padding\n    outsize = float(dst.bounds.height()/padding);\n    // xy offset for margin on lower left corner\n    offset = dst.bounds.height()*left_margin;\n  \}\n\n  float gaussian(float d, float a, float expv) \{\n    return max(0.0f, exp(-a*d*d)-expv);\n  \}\n\n  float gaussian_filter(float x, float y, float r) \{\n    // return gaussian weighted distance from origin (0, 0)\n    // given coordinate (x, y) and radius r\n    float a = 1.5f; // rate falloff\n    float expv = exp(-a*r*r);\n    return gaussian(x, a, expv) * gaussian(y, a, expv);\n  \}\n\n  void write_aa(float x, float y, float4 rgb) \{\n    // skip black pixels\n    if (rgb.x == 0.0f && rgb.y == 0.0f && rgb.z == 0.0f) return;\n    \n    // size of pixel neighborhood = n*2+1 by n*2+1\n    int n = 2;\n\n    // center of neighborhood\n    int u0 = round(x);\n    int v0 = round(y);\n\n    // skip if center pixel weight is greater than tolerance\n    if ( dst.bounds.inside(u0, v0)) \{\n      if (dst(u0, v0, 3) >= tolerance) return;\n    \}\n\n    // loop over neighborhood\n    for (int j = -n; j <= n; j++) \{\n      int v = v0 + j;\n      for (int i = -n; i <= n; i++) \{\n        int u = u0 + i;\n        if ( dst.bounds.inside(u, v)) \{\n          // get filter weight for coord (u,v)\n          float w = gaussian_filter(u-x, v-y, float(n));\n          float4 c0 = dst(u, v); // existing color\n\n          // merge current color sample over existing color sample\n          for (int k=0; k<3; k++) \{\n            dst(u, v, k) = rgb\[k]*w+c0\[k]*(1-w); \n          \}\n\n          // merge current weight over existing weight\n          float w0 = dst(u, v, 3);\n          dst(u, v, 3) = w+w0*(1-w);\n        \}\n      \}\n    \}\n  \}\n\n\n  void process(int2 pos) \{\n    float4 rgba = col(pos.x, pos.y);\n    \n    // Get CIE xy position from Yxy input for current pixel\n    float2 xy = float2(Yxy(pos.x, pos.y, 1), Yxy(pos.x, pos.y, 2));\n    \n    // Find output pixel coordinate for this CIE xy pixel value\n    float2 out_coord = float2(xy.x * outsize + offset, xy.y * outsize + offset);\n\n    // For each RGB component, write value from color input to output coordinate\n    if (antialias) \{\n      write_aa(out_coord.x, out_coord.y, rgba);\n    \} else \{\n      // For each RGB component, write value from color input to output coordinate\n      int2 p = int2(round(out_coord.x), round(out_coord.y));\n      if (dst.bounds.inside(p.x, p.y)) \{\n        for (int k=0; k<3; k++) \{\n          dst(p.x, p.y, k) = col(pos.x, pos.y, k);\n        \}\n        dst(p.x, p.y, 3) = 1.0f;\n      \}\n    \}\n  \}\n\};"
  useGPUIfAvailable {{parent.use_gpu}}
  rebuild ""
  PlotChromaticity_padding {{"parent.diagram ? parent.right_margin*0.8 : parent.right_margin"}}
  PlotChromaticity_left_margin {{parent.left_margin}}
  PlotChromaticity_tolerance 2
  PlotChromaticity_antialias true
  format "2048 2048 0 0 2048 2048 1 square_2K"
  rebuild_finalise ""
  name PlotChromaticities
  xpos 620
  ypos 536
  disable {{!parent.plot_input}}
 }
 Fill {
  color 0
  name BLACK
  tile_color 0x111111ff
  xpos 620
  ypos 591
  disable {{parent.plot_input}}
 }
 Merge2 {
  inputs 2
  bbox B
  name Merge7
  xpos 620
  ypos 686
  disable {{!parent.enable_sample_color}}
 }
 Merge2 {
  inputs 2
  name Merge1
  xpos 620
  ypos 758
 }
 Output {
  name Output
  xpos 620
  ypos 1046
 }
end_group
Merge2 {
 inputs 3+1
 operation plus
 name Plus
 xpos 3032
 ypos 2265
}
Crop {
 box {0 0 1712 1634}
 reformat true
 crop false
 name Crop8
 xpos 3032
 ypos 2289
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/examples/BlueBar_ZCAMishDRTv04_sRGB_noLimit_CIE76.jpg
 file_type jpeg
 checkHashOnRead false
 version 1
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write17
 xpos 3032
 ypos 2324
}
Ramp {
 inputs 0
 p0 {0 0}
 p1 {{width-1} 0}
 color 20
 name Ramp4
 xpos 1126
 ypos 1892
}
Group {
 name ACES_OutputTransform_v1_2_2
 tile_color 0xa57aaaff
 xpos 1126
 ypos 1920
 disable true
 addUserKnob {20 ACES_OutputTransform_tab l "ACES OutputTransform"}
 addUserKnob {41 gamut l "input gamut" T GamutToXYZ_lite.gamut}
 addUserKnob {26 ""}
 addUserKnob {35 presets t "display output presets." M {display/sRGB "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB\"\}" "display/sRGB D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB D60 sim.\"\}" display/Rec.709 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709\"\}" "display/Rec.709 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709 D60 sim.\"\}" display/Rec.2020 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 1 limiting_pri 1 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.2020\"\}" display/P3D60 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 4 limiting_pri 4 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D60\"\}" display/P3D65 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65\"\}" "display/P3D65 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 D60 sim.\"\}" display/P3DCI "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI\"\}" "display/P3DCI D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI D60 sim.\"\}" "display/P3DCI D65 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 1 dark_to_dim 0 legal_range 0 label \"P3DCI D65 sim.\"\}" display/DCDM "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 7 limiting_pri 7 eotf 5 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"DCDM\"\}" "display/P3D65 ST2084 108nits 7.2nits" "knobs this \{lum \{0.0001 7.2 108\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 108nits 7.2nits\"\}" "display/P3D65 ST2084 1000nits 15nits" "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 1000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 4000nits 15nits" "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 4000nits 15nits\"\}" display/Rec2020_HLG_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 7 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_HLG_1000nits_15nits\"\}" display/Rec2020_ST2084_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_1000nits_15nits\"\}" display/Rec2020_ST2084_2000nits_15nits "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_2000nits_15nits\"\}" display/Rec2020_ST2084_4000nits_15nits "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_4000nits_15nits\"\}" display/OCES "knobs this \{lum \{0.0001 4.8 10000\} override_ssts_params 0 use_c9 0 display_pri 6 limiting_pri 6 eotf 9 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"OCES\"\}" "" ""}}
 addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
 addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
 lum {0.02 4.8 48}
 addUserKnob {20 ssts_params_grp l "SSTS Parameters" n 1}
 ssts_params_grp 0
 addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
 addUserKnob {35 presets_ssts_param l presets t "If you want to override the default SSTS parameters and play around, here are some useful starting points." M {contrast/default "knobs this \{override_ssts_params 0 pctLow 0.35 pctHigh 0.89 slope \{0 1.5 0.\} exposure 0.0 use_c9 0\}" contrast/sdr "knobs this \{override_ssts_params 1 pctLow 0.35 pctHigh 0.89 slope \{0.1 1.6 0.01\} exposure 0.0 use_c9 0\}" contrast/high "knobs this \{override_ssts_params 1 pctLow 0.2 pctHigh 0.89 slope \{0.28 1.75 0.01\} exposure 0.0 use_c9 0\}" contrast/med "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.89 slope \{0.38 1.3 0.01\} exposure 0.0 use_c9 0\}" contrast/med-low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.42 0.01\} exposure 0.0 use_c9 0\}" contrast/low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.2 0.01\} exposure 0.0 use_c9 0\}" ""}}
 addUserKnob {7 exposure R -5 5}
 addUserKnob {7 pctLow l knee}
 pctLow 0.35
 addUserKnob {7 pctHigh l shoulder}
 pctHigh 0.89
 addUserKnob {78 slope n 3}
 slope {0.38 1.501 0.01}
 addUserKnob {20 endGroup n -1}
 addUserKnob {6 use_c9 l "use SegmentedSpline_c9" t "In ACES 1.1 the Output Transform was re-written for HDR tonescales. \n\nIn ACES 1.1, HDR transforms use the new SSTS (Single Stage Tone Scale), while SDR transforms continue to use the old SegmentedSpline_c5 -> OCES -> SegmentedSpline_c9 -> ODT transform.\n\nIf this is enabled, the SegmentedSpline_c9 transform is used to maintain compatibility with the ACES SDR output transforms and enable a 1:1 match with the AMPAS CTL.\n\nIf you are curious, turn use_c9 off and play around with the SSTS Parameters." +STARTLINE}
 use_c9 true
 addUserKnob {26 ""}
 addUserKnob {4 display_pri l "display pri" t "Display encoding primaries." M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 addUserKnob {4 limiting_pri l "limiting pri" t "Limiting primaries for the output transform." -STARTLINE M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 addUserKnob {4 eotf l EOTF t "Electrical to Optical Transfer Function of the monitor." M {sRGB BT.1886 "Gamma 2.2" "Gamma 2.4" "Gamma 2.6" DCDM "ST-2084 (PQ)" HLG Linear OCES ""}}
 eotf Linear
 addUserKnob {6 stretch_black l "stretch black" t "For hdr outputs: stretch black luminance to a PQ code value of 0" +STARTLINE}
 addUserKnob {6 d60_sim l "d60 sim" t "d60 whitepoint simulation." +STARTLINE}
 addUserKnob {6 force_d65_cat l "force d60 to d65 cat" -STARTLINE}
 addUserKnob {6 dark_to_dim l "dark to dim surround" t "Apply gamma adjustment to compensate for \"Dark to Dim\" surround. For SDR outputs only." +STARTLINE}
 addUserKnob {6 legal_range l "legal range" t "Output legal range." +STARTLINE}
}
 BackdropNode {
  inputs 0
  name Electrical_Optical_Transfer_Function
  tile_color 0x151515ff
  label "ACESlib.OutputTransforms.ctl : 185\n// EOTF"
  note_font_size 12
  xpos -2025
  ypos 2294
  bdwidth 3391
  bdheight 740
  z_order -10
 }
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x272727ff
  label "HDR EOTFs"
  note_font_size 42
  xpos 425
  ypos 2379
  bdwidth 910
  bdheight 617
  z_order -5
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x272727ff
  label "SDR EOTFs"
  note_font_size 42
  xpos -1158
  ypos 2384
  bdwidth 1436
  bdheight 608
  z_order -5
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ
  tile_color 0x555b5cff
  label "ACESlib.OutputTransforms.ctl : 90\n// Rendering primaries to XYZ\n"
  note_font_size 12
  xpos -1400
  ypos 906
  bdwidth 380
  bdheight 156
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ1
  tile_color 0x555a5cff
  label "// Apply desaturation to compensate for luminance difference\nlinearCV = mult_f3_f33( linearCV, ODT_SAT_MAT);\n( SDR only)"
  note_font_size 12
  xpos -1412
  ypos 669
  bdwidth 439
  bdheight 186
 }
 BackdropNode {
  inputs 0
  name D60_whitepoint_simulation
  tile_color 0x232323ff
  label "ACESlib.OutputTransforms.ctl : 150\n// Scale to avoid clipping when device calibration is different from D60. \n// To simulate D60, unequal code values are sent to the display.\n"
  note_font_size 12
  xpos -1399
  ypos 176
  bdwidth 818
  bdheight 463
 }
 BackdropNode {
  inputs 0
  name Luminance_to_Linear_Code_Values
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 87\n/*  Scale absolute luminance to linear code value  */\n"
  note_font_size 12
  xpos -1367
  ypos -50
  bdwidth 315
  bdheight 148
 }
 BackdropNode {
  inputs 0
  name Output_Color_Encoding_Specification
  tile_color 0x1d1d1dff
  label "<font size=12>OCES\n<font size=0.1>\n- ACES Output Output Color Encoding Specification \n- An idealized reference display with 0.0001 / 4.8 / 10000 luma\n w/ ACES AP0 Primaries."
  note_font_size 27.4
  xpos -1833
  ypos 2379
  bdwidth 367
  bdheight 377
 }
 BackdropNode {
  inputs 0
  name Output_Legal_Range
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 216\n"
  note_font_size 12
  xpos -1369
  ypos 3128
  bdwidth 318
  bdheight 176
 }
 BackdropNode {
  inputs 0
  name Single_Stage_Tone_Scale
  tile_color 0x272727ff
  label "<b>Single Stage Tone Scale : ACESlib.OutputTransforms.ctl : 82</b><pre>// Apply the tonescale independently in rendering-space RGB\nfloat rgbPost\[3] = ssts_f3( rgbPre, PARAMS);\n\nIf output is SDR, output OCES from SSTS and use SegmentedSpline_c9."
  note_font_size 12
  xpos -1502
  ypos -653
  bdwidth 609
  bdheight 533
 }
 BackdropNode {
  inputs 0
  name clamp_negatives
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 174\n// Clip values < 0 (i.e. projecting outside the display primaries)\nNote: Also clamping values > 1 here."
  note_font_size 12
  xpos -1393
  ypos 2087
  bdwidth 386
  bdheight 120
 }
 BackdropNode {
  inputs 0
  name dim_surround_gamma_adjustment
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 92\n// Apply gamma adjustment to compensate for dim surround\n"
  note_font_size 12
  xpos -1407
  ypos 1063
  bdwidth 395
  bdheight 258
 }
 BackdropNode {
  inputs 0
  name limit_primaries
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n// Gamut limit to limiting primaries\n"
  note_font_size 12
  xpos -1408
  ypos 1655
  bdwidth 396
  bdheight 194
 }
 BackdropNode {
  inputs 0
  name limit_primaries1
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 144\n// CIE XYZ to display encoding primaries\n"
  note_font_size 12
  xpos -1402
  ypos 1892
  bdwidth 384
  bdheight 151
 }
 BackdropNode {
  inputs 0
  name limit_primaries2
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n    // Apply CAT from ACES white point to assumed observer adapted white point\n    // TODO: Needs to expand from just supporting D60 sim to allow for any\n    // observer adapted white point.\n"
  note_font_size 12
  xpos -1407
  ypos 1337
  bdwidth 467
  bdheight 301
 }
 BackdropNode {
  inputs 0
  name rrt_sweeteners_
  tile_color 0x555a5cff
  label "<b>RRT Sweeteners : ACESlib.OutputTransforms.ctl : 79</b><pre>// RRT sweeteners\nfloat rgbPre\[3] = rrt_sweeteners( in);\n"
  note_font_size 18
  xpos -1469
  ypos -1234
  bdwidth 519
  bdheight 548
 }
 Input {
  inputs 0
  name Input
  xpos -1250
  ypos -1450
 }
 AddChannels {
  channels rgba
  name AddChannels
  xpos -1250
  ypos -1415
 }
 Group {
  name GamutToXYZ_lite
  xpos -1250
  ypos -1373
  addUserKnob {20 GamutToXYZ_lite_tab l GamutToXYZ_lite}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACES
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {20 chromaticities_grp l "" +STARTLINE n 1}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {20 endGroup n -1}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorMatrix {
  matrix {
      {1.049811006 0 -9.748453158e-05}
      {-0.4959030151 1.373313069 0.09824004024}
      {4.020908051e-08 0 0.9912520051}
    }
  name ColorMatrix4
  label "XYZ to ACES"
  note_font Helvetica
  xpos -1250
  ypos -1338
 }
 Dot {
  name Dot7
  label " ACES 2065-1 IN"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -1268
 }
 Group {
  name glow_module1
  note_font Helvetica
  xpos -1250
  ypos -1089
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_GLOW_GAIN}
  RRT_GLOW_GAIN 0.05
  addUserKnob {7 RRT_GLOW_MID}
  RRT_GLOW_MID 0.08
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -562
  }
  Dot {
   name Dot2
   xpos -6
   ypos -510
  }
set N6ca38800 [stack 0]
  Dot {
   name Dot4
   xpos -116
   ypos -510
  }
set N6ca38400 [stack 0]
  Expression {
   temp_name0 chroma
   temp_expr0 sqrt(b*(b-g)+g*(g-r)+r*(r-b))
   temp_name1 ycRadiusWeight
   temp_expr1 1.75
   channel0 {-rgba.red rgba.green -rgba.blue none}
   expr0 "( b + g + r + ycRadiusWeight * chroma) / 3.0"
   channel1 {rgba.red -rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_yc1
   xpos -150
   ypos -466
  }
push 0
push $N6ca38400
  Dot {
   name Dot3
   xpos -226
   ypos -510
  }
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   expr1 0
   expr2 0
   name rgb_2_saturation1
   xpos -260
   ypos -466
  }
set N6c98f400 [stack 0]
  Expression {
   channel0 {rgba.red rgba.green rgba.blue none}
   expr0 "(r - 0.4) / 0.2"
   name Expression1
   xpos -370
   ypos -466
  }
  Expression {
   temp_name0 t
   temp_expr0 "max( 1.0 - fabs( r / 2.0), 0.0)"
   temp_name1 sign
   temp_expr1 r>0?1:r<0?-1:0
   temp_name2 valy
   temp_expr2 "1.0 + sign * (1.0 - t * t)"
   channel0 {-rgba.red -rgba.green rgba.blue none}
   expr0 "valy / 2"
   channel1 {rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red rgba.green rgba.blue none}
   expr2 0
   name sigmoid_shaper1
   xpos -370
   ypos -442
  }
push $N6c98f400
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   note_font Helvetica
   xpos -260
   ypos -393
  }
set N6c98e800 [stack 0]
  Expression {
   temp_name0 ycOut
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ((ycOut <= ((1 + glowGainIn) * 2./3. * glowMid)) ? -glowGainIn / (1 + glowGainIn) : ( ycOut >= (2. * glowMid)) ? 0 : glowGainIn * (glowMid / ycOut - 1./2.) / (glowGainIn / 2. - 1.))"
   channel1 none
   channel2 none
   name glow_inv
   xpos -150
   ypos -346
  }
push $N6c98e800
  Expression {
   temp_name0 ycIn
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ( ycIn <= 2./3. * glowMid ? glowGainIn : ycIn >= 2. * glowMid ? 0 : glowGainIn * (glowMid / ycIn - 1./2.) )"
   channel1 none
   channel2 none
   name glow_fwd
   xpos -370
   ypos -346
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -260
   ypos -297
  }
  Dot {
   name Dot5
   xpos -226
   ypos -246
  }
push $N6ca38800
  Merge2 {
   inputs 2
   operation multiply
   bbox B
   output rgb
   name Merge3
   note_font Helvetica
   xpos -40
   ypos -249
  }
  Output {
   name Output
   xpos -40
   ypos -178
  }
 end_group
 Group {
  name red_modifier1
  note_font Helvetica
  xpos -1250
  ypos -1041
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_RED_SCALE}
  RRT_RED_SCALE 0.82
  addUserKnob {7 RRT_RED_PIVOT}
  RRT_RED_PIVOT 0.03
  addUserKnob {7 RRT_RED_HUE}
  addUserKnob {7 RRT_RED_WIDTH R 0 360}
  RRT_RED_WIDTH 135
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  Dot {
   name Dot1
   xpos -6
   ypos 42
  }
set N6c98cc00 [stack 0]
  Dot {
   name Dot2
   xpos -226
   ypos 42
  }
set N6c98c800 [stack 0]
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   channel0 rgb
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   channel1 none
   expr1 0
   channel2 none
   expr2 0
   name rgb_2_saturation
   xpos -260
   ypos 86
  }
push $N6c98c800
  Dot {
   name Dot3
   xpos -336
   ypos 42
  }
  Expression {
   temp_name0 hue
   temp_expr0 "(r==g&&g==b)?0:(180/pi) * atan2( sqrt(3)*(g-b), 2*r-g-b)"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "hue < 0 ? hue + 360 : hue"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_hue
   xpos -370
   ypos 86
  }
  Expression {
   temp_name0 hue
   temp_expr0 r
   temp_name1 centerH
   temp_expr1 RRT_RED_HUE
   temp_name2 hueCentered
   temp_expr2 hue-centerH
   channel0 {-rgba.red rgba.green -rgba.blue -rgba.alpha}
   expr0 "hueCentered < -180.0 ? hueCentered + 360.0 : (hueCentered > 180.0) ? hueCentered - 360.0 : hueCentered"
   name center_hue
   xpos -370
   ypos 134
  }
  Expression {
   temp_name0 centeredHue
   temp_expr0 g
   temp_name1 knot_coord
   temp_expr1 "(centeredHue - knots.0) * 4.0/w"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "(min((centeredHue > knots.0?1:0) , (centeredHue < knots.4?1:0)) ? j == 3 ? t*t*t * -1./6 + t*t * 3./6 +  t * -3./6 + 1 * 1./6 : j == 2 ? t*t*t * 3./6 + t*t * -6./6 + t * 0./6 + 1. *4./6 : j == 1 ? t*t*t * -3./6 + t*t * 3./6 + t * 3./6 + 1. * 1./6 : j == 0 ? t*t*t * 1./6 + t*t * 0./6 + t * 0./6 + 1. * 0./6 : 0 : 0) * 3/2"
   channel1 none
   channel2 none
   name cubic_basis_shaper
   xpos -370
   ypos 182
   addUserKnob {20 param}
   addUserKnob {7 w R 0 360}
   w {{parent.RRT_RED_WIDTH}}
   addUserKnob {78 knots n 5}
   knots {{-w/2} {-w/4} 0 {w/4} {w/2}}
  }
  Dot {
   name Dot4
   xpos -336
   ypos 234
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy4
   note_font Helvetica
   xpos -260
   ypos 226
  }
  Dot {
   name Dot6
   label " r : hueWeight\n g : centeredHue\n b : saturation"
   note_font "Helvetica \[pyrs]"
   note_font_size 12
   note_font_color 0xff
   xpos -226
   ypos 282
  }
  Dot {
   name Dot7
   xpos -226
   ypos 330
  }
set N6c916000 [stack 0]
push $N6c98cc00
  Dot {
   name Dot8
   xpos -6
   ypos 258
  }
set N6c915c00 [stack 0]
  MergeExpression {
   inputs 2
   temp_name0 minChan
   temp_expr0 "Ag < 0 ? Bg : Bb"
   temp_name1 a_
   temp_expr1 "Ar * (1. - RRT_RED_SCALE) - 1."
   temp_name2 b
   temp_expr2 "Br - Ar* (RRT_RED_PIVOT + minChan) * (1. - RRT_RED_SCALE)"
   temp_name3 c
   temp_expr3 "Ar * RRT_RED_PIVOT * minChan * (1. - RRT_RED_SCALE)"
   expr0 "( -b - sqrt( b * b - 4. * a_ * c)) / ( 2. * a_)"
   name red_modifier_rev
   note_font Helvetica
   xpos -150
   ypos 351
  }
push $N6c916000
push $N6c915c00
  MergeExpression {
   inputs 2
   expr0 "r + Ar * Ab * (RRT_RED_PIVOT - r) * (1. - RRT_RED_SCALE)"
   name red_modifier_fwd
   note_font Helvetica
   xpos -40
   ypos 327
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -40
   ypos 423
  }
  Output {
   name Output
   xpos -40
   ypos 494
  }
 end_group
 Clamp {
  channels rgb
  maximum_enable false
  name clamp_f3_min
  label "Clamp Negative Values"
  xpos -1250
  ypos -976
 }
 ColorMatrix {
  matrix {
      {1.451439381 -0.2365107685 -0.2149285674}
      {-0.07655383646 1.176229835 -0.09967593104}
      {0.008316127583 -0.0060324613 0.997716248}
    }
  name ColorMatrix15
  label "ACES to ACEScg"
  xpos -1250
  ypos -928
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3_
  label "clamp to HALF_MAX"
  xpos -1250
  ypos -880
 }
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix
  label "// --- Global desaturation --- //\nrgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);"
  xpos -1250
  ypos -790
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.96
 }
 Dot {
  name Dot29
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xff
  xpos -1216
  ypos -558
 }
set N6c8af800 [stack 0]
 Group {
  name ssts
  xpos -1250
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} {parent.lum} {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.override_ssts_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 mid_lum l "mid lum" R 0 20}
  mid_lum {{parent.lum.1}}
  addUserKnob {7 expShift R -4 4}
  expShift {{"(parent.override_ssts_params ? exposure : 0) + (mid_lum<= 4.8 ? 0 : \[sample parent.expShift r 0 0] )"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} 4.8 {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR + (MAX_STOP_RRT-MAX_STOP_SDR) / (log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR)) * (log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6c8af000 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6c8af000
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6c8ae800 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6c8ae400 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6c8ae000 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6c8adc00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6c8adc00
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6c8ad000 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr1 "logg * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr2 "logb* minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6c8ae000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6c8ad000
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6c867400 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N6c867000 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N6c866c00 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N6c866400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression5
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N6c866400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N6c866c00
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N6c865000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression3
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N6c865000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N6c867000
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N6cc07800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N6cc07800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6c8ae400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6c867400
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6cc05000 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N6cc04c00 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N6cc04800 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N6cbafc00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression11
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N6cbafc00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N6cc04800
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N6cbae800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression9
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N6cbae800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N6cc04c00
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N6cbad400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression7
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N6cbad400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6c8ae800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6cc05000
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr1 "logg * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr2 "logb* maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -160
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Dot {
   name Dot30
   xpos 1534
   ypos 810
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Dot {
  name Dot23
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -462
 }
set N6cb40800 [stack 0]
 Dot {
  name Dot22
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos -462
 }
 ColorMatrix {
  matrix {
      {0.6954522133 0.1406786889 0.163869068}
      {0.04479461163 0.8596711159 0.09553432465}
      {-0.005525866989 0.004025223665 1.001500726}
    }
  name ColorMatrix7
  label "ACEScg to ACES"
  note_font Helvetica
  xpos -1690
  ypos -398
 }
 Dot {
  name Dot21
  label " OCES"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos 2658
 }
push $N6cb40800
 Dot {
  name Dot28
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -342
 }
set N6ceeb400 [stack 0]
 Group {
  name segmented_spline_c9_fwd
  xpos -1140
  ypos -346
  addUserKnob {20 SegmentedSplineParams_c9_tab l SegmentedSplineParams_c9}
  addUserKnob {78 coefsLow n 10}
  coefsLow {-1.698970004 -1.698970004 -1.4779 -1.2291 -0.8648 -0.448 0.00518 0.4511080334 0.9113744414 0.9113744414}
  addUserKnob {78 coefsHigh n 10}
  coefsHigh {0.5154386965 0.8470437783 1.1358 1.3802 1.5197 1.5985 1.6467 1.674609136 1.687873339 1.687873339}
  addUserKnob {12 minPoint}
  minPoint {0.0028799 0.02}
  addUserKnob {12 midPoint}
  midPoint {4.79999924 4.8}
  addUserKnob {12 maxPoint}
  maxPoint {1005.719116 48}
  addUserKnob {7 slopeLow}
  addUserKnob {7 slopeHigh}
  slopeHigh 0.04
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 8
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 8
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6ceeac00 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6ceeac00
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6ceea400 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6ceea000 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6cee9c00 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6cee9800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6cee9800
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6cee8c00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr1 "logg * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr2 "logb* slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6cee9c00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6cee8c00
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6ce97000 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N6ce96c00 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N6ce96800 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N6ce96000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression15
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N6ce96000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N6ce96800
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N6ce94c00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression14
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N6ce94c00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N6ce96c00
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N6ce47400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N6ce47400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6ceea000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6ce97000
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6ce44c00 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N6ce44800 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N6ce44400 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N6cddf800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression3
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N6cddf800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N6ce44400
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N6cdde400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression5
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N6cdde400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N6ce44800
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N6cddd000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression16
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N6cddd000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6ceea400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6ce44c00
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr1 "logg * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr2 "logb* slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
push $N6ceeb400
 Switch {
  inputs 2
  which {{parent.use_c9}}
  name Switch_c9
  xpos -1250
  ypos -298
 }
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_
  xpos -1250
  ypos 38
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Dot {
  name Dot12
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 282
 }
set N6cd74400 [stack 0]
 Dot {
  name Dot15
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 282
 }
set N6cd0bc00 [stack 0]
 Dot {
  name Dot13
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 282
 }
 Dot {
  name Dot16
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 354
 }
set N6cd0b400 [stack 0]
 Expression {
  temp_name0 tr
  temp_expr0 "(-r - c_x_0) / (c_x_1 - c_x_0)"
  temp_name1 tg
  temp_expr1 "(-g - c_x_0) / (c_x_1 - c_x_0)"
  temp_name2 tb
  temp_expr2 "(-b - c_x_0) / (c_x_1 - c_x_0)"
  expr0 "tr < 0.0 ? -(tr * c_b + c_c) : tr > 1.0 ? r : -(( tr * c_a + c_b) * tr + c_c)"
  expr1 "tg < 0.0 ? -(tg * c_b + c_c) : tg > 1.0 ? g : -(( tg * c_a + c_b) * tg + c_c)"
  expr2 "tb < 0.0 ? -(tb * c_b + c_c) : tb > 1.0 ? b : -(( tb * c_a + c_b) * tb + c_c)"
  name roll_white_fwd_1
  xpos -920
  ypos 398
  addUserKnob {20 Params}
  addUserKnob {7 new_wht}
  new_wht 0.918
  addUserKnob {7 c_width}
  c_width 0.5
  addUserKnob {7 c_x_0 +DISABLED}
  c_x_0 -1
  addUserKnob {7 c_x_1 +DISABLED}
  c_x_1 {{"c_x_0 + c_width"}}
  addUserKnob {7 c_y0 +DISABLED}
  c_y0 {{-new_wht}}
  addUserKnob {7 c_y1 +DISABLED}
  c_y1 {{c_x_1}}
  addUserKnob {7 c_m1 +DISABLED}
  c_m1 {{"(c_x_1 - c_x_0)"}}
  addUserKnob {7 c_a +DISABLED}
  c_a {{"c_y0 - c_y1 + c_m1"}}
  addUserKnob {7 c_b +DISABLED}
  c_b {{"2 * (c_y1 - c_y0) - c_m1"}}
  addUserKnob {7 c_c +DISABLED}
  c_c {{c_y0}}
 }
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96
  temp_name1 NEW_WHT
  temp_expr1 0.918
  expr0 "min( r, NEW_WHT) * SCALE"
  expr1 "min( g, NEW_WHT) * SCALE"
  expr2 "min( b, NEW_WHT) * SCALE"
  name Expression2
  label "// Scale and clamp white to avoid casted highlights due to D60 simulation"
  xpos -920
  ypos 440
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 498
 }
push $N6cd0b400
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96362
  expr0 "r * SCALE"
  expr1 "g * SCALE"
  expr2 "b * SCALE"
  name mult_f_f3_
  label D65
  xpos -1030
  ypos 344
 }
push $N6cd0bc00
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_
  xpos -1140
  ypos 350
 }
 Dot {
  name Dot14
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 426
 }
push $N6cd74400
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch1
  xpos -1250
  ypos 422
 }
 Switch {
  inputs 2
  which {{"parent.display_pri == 3"}}
  name switch_wp_is_dci_
  xpos -1250
  ypos 494
 }
 Dot {
  name Dot26
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 762
 }
set N6cd09c00 [stack 0]
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix3
  label "// Apply desaturation to compensate \nfor luminance difference"
  xpos -1140
  ypos 746
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.93
 }
push $N6cd09c00
 Switch {
  inputs 2
  which {{"parent.eotf < 5 && display_pri < 2"}}
  name Switch_eotf
  label "Use if output is SDR"
  xpos -1250
  ypos 800
 }
 ColorMatrix {
  matrix {
      {0.6624541879 0.1340042055 0.1561876982}
      {0.2722287476 0.6740817428 0.05368951708}
      {-0.005574660841 0.004060741514 1.010339141}
    }
  name ColorMatrix1
  label "ACES AP1 to XYZ"
  xpos -1250
  ypos 968
 }
 Dot {
  name Dot8
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1146
 }
set N6cd09000 [stack 0]
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1136
 }
 Clamp {
  channels {rgba.red -rgba.green -rgba.blue none}
  maximum_enable false
  name ClampMin4
  xpos -1140
  ypos 1190
 }
 Expression {
  expr0 "pow(r, DIM_SURROUND_GAMMA)"
  expr1 g
  expr2 b
  channel3 none
  name dark_to_dim3
  xpos -1140
  ypos 1214
  addUserKnob {20 Params}
  addUserKnob {7 DIM_SURROUND_GAMMA}
  DIM_SURROUND_GAMMA 0.9811
 }
 Colorspace {
  colorspace_in CIE-Yxy
  colorspace_out CIE-XYZ
  name Colorspace4
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1256
 }
push $N6cd09000
 Switch {
  inputs 2
  which {{"(parent.eotf <= 4) ? parent.dark_to_dim : 0"}}
  name DarkToDim_Switch
  label "enable if sdr\nand dark_to_dim enabled"
  xpos -1250
  ypos 1250
 }
 Dot {
  name Dot19
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1434
 }
set N6cc97800 [stack 0]
 Dot {
  name Dot9
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 1434
 }
set N6cc97400 [stack 0]
 ColorMatrix {
  matrix {
      {0.9872254133 -0.006114810705 0.01592640579}
      {-0.007603884675 1.001874804 0.005322027951}
      {0.003066040576 -0.005084238946 1.081519246}
    }
  name ColorMatrix2
  label "CAT: Bradford\n D60 to D65"
  xpos -1140
  ypos 1466
 }
set N6cc97000 [stack 0]
push $N6cc97400
 Dot {
  name Dot10
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -996
  ypos 1434
 }
push $N6cc97000
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch
  xpos -1140
  ypos 1550
 }
push $N6cc97800
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_1
  xpos -1250
  ypos 1550
 }
 Switch {
  inputs 2
  which {{parent.force_d65_cat}}
  name switch_force_d65_cat
  xpos -1250
  ypos 1598
 }
 Group {
  name limit_to_primaries
  label "Only enabled when display_pri != limiting_pri"
  xpos -1250
  ypos 1760
  disable {{"!(parent.display_pri != parent.limiting_pri)"}}
  addUserKnob {20 limit_to_primaries}
  addUserKnob {4 limiting_pri l "limiting pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  limiting_pri {{parent.limiting_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to limiting primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6cc96400 [stack 0]
push $N6cc96400
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix5
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6cc96400
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6cc96400
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6cc96400
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6cc96400
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6cc96400
  ColorMatrix {
   matrix {
       {0.6954522133 0.1406786889 0.163869068}
       {0.04479461163 0.8596711159 0.09553432465}
       {-0.005525866989 0.004025223665 1.001500726}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6cc96400
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Clamp {
   channels rgb
   name clamp_f3
   label "Clip any values outside the limiting primaries"
   xpos -40
   ypos 56
  }
  Dot {
   name Dot2
   label " Convert limited RGB to XYZ"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 162
  }
set N6cc2bc00 [stack 0]
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.9525524378 0 9.367863095e-05}
       {0.3439664543 0.7281661034 -0.07213255018}
       {-3.863927134e-08 0 1.008825183}
     }
   name ColorMatrix4
   label "ACES to XYZ"
   xpos 730
   ypos 224
  }
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.6624541879 0.1340042055 0.1561876982}
       {0.2722287476 0.6740817428 0.05368951708}
       {-0.005574660841 0.004060741514 1.010339141}
     }
   name ColorMatrix20
   label "ACEScg to XYZ"
   xpos 620
   ypos 224
  }
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.5049495697 0.2646814585 0.1830150485}
       {0.237623319 0.6891706586 0.07320601493}
       {0 0.0449459292 0.9638792276}
     }
   name ColorMatrix13
   label "P3D60 to XYZ"
   xpos 510
   ypos 224
  }
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.4451698363 0.2771343887 0.1722826511}
       {0.209491685 0.7215952873 0.06891305745}
       {0 0.04706057906 0.9073553085}
     }
   name ColorMatrix18
   label "P3DCI to XYZ"
   xpos 400
   ypos 224
  }
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.4865709841 0.2656676769 0.1982172877}
       {0.2289745659 0.6917385459 0.07928691059}
       {0 0.04511339962 1.043944359}
     }
   name ColorMatrix16
   label "P3D65 to XYZ"
   xpos 290
   ypos 224
  }
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.6369580626 0.1446169019 0.1688809693}
       {0.2627002299 0.6779980659 0.05930171534}
       {0 0.0280726999 1.060985088}
     }
   name ColorMatrix3
   label "Rec2020 to XYZ"
   xpos 180
   ypos 224
  }
push $N6cc2bc00
  ColorMatrix {
   matrix {
       {0.4123907983 0.3575843275 0.180480808}
       {0.2126390189 0.7151686549 0.07219231874}
       {0.01933082007 0.1191947311 0.950532198}
     }
   name ColorMatrix1
   label "Rec709 to XYZ"
   xpos 70
   ypos 224
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch1
   xpos -40
   ypos 326
  }
  Output {
   name Output
   xpos -40
   ypos 446
  }
 end_group
 Group {
  name XYZ_2_DISPLAY_PRI
  label "CIE XYZ to display encoding primaries"
  xpos -1250
  ypos 1976
  addUserKnob {20 XYZ_2_DISPLAY_PRI_tab l XYZ_2_DISPLAY_PRI}
  addUserKnob {4 display_pri l "display pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  display_pri {{parent.display_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to display primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6cc29400 [stack 0]
push $N6cc29400
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix3
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6cc29400
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6cc29400
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6cc29400
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6cc29400
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6cc29400
  ColorMatrix {
   matrix {
       {1.71665132 -0.3556708097 -0.2533662617}
       {-0.6666844487 1.616481304 0.01576855592}
       {0.01763986237 -0.04277062416 0.9421030879}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6cc29400
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.display_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Clamp {
  channels rgb
  name clamp_f3_all
  xpos -1250
  ypos 2164
 }
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 2514
 }
set N6cfae800 [stack 0]
push $N6cfae800
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 2514
 }
set N6cfae400 [stack 0]
 Dot {
  name Dot4
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 2514
 }
set N6cfae000 [stack 0]
 Dot {
  name Dot6
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -446
  ypos 2514
 }
set N6cfadc00 [stack 0]
 Dot {
  name Dot18
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -226
  ypos 2514
 }
set N6cfad800 [stack 0]
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -6
  ypos 2514
 }
set N6cfad400 [stack 0]
 Dot {
  name Dot25
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 214
  ypos 2514
 }
set N6cfad000 [stack 0]
 Dot {
  name Dot24
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2514
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2610
 }
set N6cfac800 [stack 0]
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr
  label "stretch_black = True"
  xpos 510
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
push $N6cfac800
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr2
  label "stretch_black = False"
  xpos 620
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Switch {
  inputs 2
  which {{parent.stretch_black}}
  name StretchBlacks_Switch
  xpos 620
  ypos 2750
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3__
  xpos 620
  ypos 2822
 }
 Expression {
  temp_name0 Lm_r
  temp_expr0 "pow((r / pq_C), pq_m1)"
  temp_name1 Lm_g
  temp_expr1 "pow((g / pq_C), pq_m1)"
  temp_name2 Lm_b
  temp_expr2 "pow((b / pq_C), pq_m1)"
  expr0 "pow(( pq_c1 + pq_c2 * Lm_r ) / ( 1.0 + pq_c3 * Lm_r ), pq_m2)"
  expr1 "pow(( pq_c1 + pq_c2 * Lm_g ) / ( 1.0 + pq_c3 * Lm_g ), pq_m2)"
  expr2 "pow(( pq_c1 + pq_c2 * Lm_b ) / ( 1.0 + pq_c3 * Lm_b ), pq_m2)"
  name Y_2_ST2084_
  label "ACESlib.OutputTransforms.ctl : 243 \nACESlib.Utilities_Color.ctl : 425"
  xpos 620
  ypos 2882
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
set N6cf67400 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2514
 }
 Expression {
  temp_name0 Np_r
  temp_expr0 "pow( r, 1.0 / pq_m2 )"
  temp_name1 Np_g
  temp_expr1 "pow( g, 1.0 / pq_m2 )"
  temp_name2 Np_b
  temp_expr2 "pow( b, 1.0 / pq_m2 )"
  expr0 "r < 0 ? 0 : pow((Np_r - pq_c1) / ( pq_c2 - pq_c3 * Np_r ), 1.0/pq_m1) * pq_C"
  expr1 "g < 0 ? 0 : pow((Np_g - pq_c1) / ( pq_c2 - pq_c3 * Np_g ), 1.0/pq_m1) * pq_C"
  expr2 "b < 0 ? 0 : pow((Np_b - pq_c1) / ( pq_c2 - pq_c3 * Np_b ), 1.0/pq_m1) * pq_C"
  name ST2084_2_Y_f3_
  label "ACESlib.Utilities_Color.ctl : 408\n// Converts from the non-linear perceptually quantized space to linear cd/m^2"
  xpos 950
  ypos 2618
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Expression {
  temp_name0 Y_d
  temp_expr0 "0.2627*r + 0.6780*g + 0.0593*b"
  expr0 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((r-c_beta)/c_alpha)"
  expr1 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((g-c_beta)/c_alpha)"
  expr2 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((b-c_beta)/c_alpha)"
  name ST2084_2_HLG_1000nits_f3_3
  label "ACESlib.Utilities_Color.ctl : 469\n// HLG Inverse EOTF (i.e. HLG inverse OOTF followed by the HLG OETF)\n// HLG Inverse OOTF (display linear to scene linear)"
  xpos 950
  ypos 2732
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 L_w +DISABLED}
  L_w 1000
  addUserKnob {7 L_b +DISABLED}
  addUserKnob {7 c_alpha +DISABLED}
  c_alpha {{L_w-L_b}}
  addUserKnob {7 c_beta +DISABLED}
  c_beta {{L_b}}
  addUserKnob {7 c_gamma +DISABLED}
  c_gamma 1.2
 }
 Expression {
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "r <= 1.0/12 ? sqrt(3.0*r) : c_a * log(12.0 * r - c_b) + c_c"
  expr1 "g <= 1.0/12 ? sqrt(3.0*g) : c_a * log(12.0 * g- c_b) + c_c"
  expr2 "b <= 1.0/12 ? sqrt(3.0*b) : c_a * log(12.0 * b - c_b) + c_c"
  name ST2084_2_HLG_1000nits_f3_
  label "ACESlib.Utilities_Color.ctl : 493\n// HLG OETF (scene linear to non-linear signal value)"
  xpos 950
  ypos 2834
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 c_a +DISABLED}
  c_a 0.17883277
  addUserKnob {7 c_b t 1.-4.*a +DISABLED}
  c_b 0.28466892
  addUserKnob {7 c_c t 0.5-a*log(4.*a) +DISABLED}
  c_c 0.55991073
 }
 Dot {
  name Dot17
  label " HLG"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2970
 }
push $N6cf67400
 Dot {
  name Dot27
  label " PQ"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2970
 }
push $N6cfad000
 Expression {
  expr0 "pow( (48./52.37) * r, 1./2.6)"
  expr1 "pow( (48./52.37) * g, 1./2.6)"
  expr2 "pow( (48./52.37) * b, 1./2.6)"
  expr3 1
  name dcdm_encode
  xpos 180
  ypos 2702
 }
push $N6cfad400
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_26_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.6"
  xpos -40
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.6
 }
push $N6cfad800
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_24_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.4"
  xpos -260
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
 }
push $N6cfadc00
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_22_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.2"
  xpos -480
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.2
 }
push $N6cfae000
 Expression {
  temp_name0 c_a
  temp_expr0 "pow( pow( Lw, 1./gamma) - pow( Lb, 1./gamma), gamma)"
  temp_name1 c_b
  temp_expr1 "pow( Lb, 1./gamma) / ( pow( Lw, 1./gamma) - pow( Lb, 1./gamma))"
  expr0 "pow( max( r / c_a, 0.), 1.0/gamma) - c_b"
  expr1 "pow( max( g / c_a, 0.), 1.0/gamma) - c_b"
  expr2 "pow( max( b / c_a, 0.), 1.0/gamma) - c_b"
  name bt1886_r_f3
  label "ACESlib.Utilities_Color.ctl : 301\n// The reference EOTF specified in Rec. ITU-R BT.1886\n// L = a(max\[(V+b),0])^g"
  xpos -700
  ypos 2684
  addUserKnob {20 Luminance}
  addUserKnob {7 Lw R 48 10000}
  Lw 1
  addUserKnob {7 Lb R 0.0001 0.02}
  addUserKnob {7 gamma R 1 4}
  gamma 2.4
 }
push $N6cfae400
 Expression {
  temp_name0 yb
  temp_expr0 "pow( offs * gamma / ( ( gamma - 1.0) * ( 1.0 + offs)), gamma)"
  temp_name1 rs
  temp_expr1 "pow( ( gamma - 1.0) / offs, gamma - 1.0) * pow( ( 1.0 + offs) / gamma, gamma)"
  expr0 "r >= yb ? ( 1.0 + offs) * pow( r, 1.0 / gamma) - offs : r * rs"
  expr1 "g >= yb ? ( 1.0 + offs) * pow( g, 1.0 / gamma) - offs : g * rs"
  expr2 "b >= yb ? ( 1.0 + offs) * pow( b, 1.0 / gamma) - offs : b * rs"
  name moncurve_r_f3_
  label "ACESlib.Utilities_Color.ctl : 260\nmoncurve_r with gamma of 2.4 and offset of 0.055 matches the EOTF found in IEC 61966-2-1:1999 (sRGB)"
  xpos -920
  ypos 2690
  addUserKnob {20 Luminance}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
  addUserKnob {7 offs}
  offs 0.055
 }
 Switch {
  inputs 10
  which {{parent.eotf}}
  name EOTF_Switch
  xpos -1250
  ypos 2966
 }
 Expression {
  temp_name0 REFBLACK
  temp_expr0 "64 / 1023"
  temp_name1 REFWHITE
  temp_expr1 "940 / 1023"
  expr0 "r * ( REFWHITE - REFBLACK) + REFBLACK"
  expr1 "g * ( REFWHITE - REFBLACK) + REFBLACK"
  expr2 "b * ( REFWHITE - REFBLACK) + REFBLACK"
  name fullRange_to_smpteRange_f3_
  label "ACESlib.OutputTransforms.ctl : 216"
  xpos -1250
  ypos 3224
  disable {{!parent.legal_range}}
 }
 Output {
  name Output
  xpos -1250
  ypos 3446
 }
 StickyNote {
  inputs 0
  name StickyNote1
  tile_color 0x535a61ff
  label "\n<b>ACESlib.RRT_Common.ctl : 135</b>\n<pre>\nfloat\[3] rrt_sweeteners( float in\[3])\n\{\n    float aces\[3] = in;\n    \n    // --- Glow module --- //\n    float saturation = rgb_2_saturation( aces);\n    float ycIn = rgb_2_yc( aces);\n    float s = sigmoid_shaper( (saturation - 0.4) / 0.2);\n    float addedGlow = 1. + glow_fwd( ycIn, RRT_GLOW_GAIN * s, RRT_GLOW_MID);\n\n    aces = mult_f_f3( addedGlow, aces);\n\n    // --- Red modifier --- //\n    float hue = rgb_2_hue( aces);\n    float centeredHue = center_hue( hue, RRT_RED_HUE);\n    float hueWeight = cubic_basis_shaper( centeredHue, RRT_RED_WIDTH);\n\n    aces\[0] = aces\[0] + hueWeight * saturation * (RRT_RED_PIVOT - aces\[0]) * (1. - RRT_RED_SCALE);\n\n    // --- ACES to RGB rendering space --- //\n    aces = clamp_f3( aces, 0., HALF_POS_INF);\n    float rgbPre\[3] = mult_f3_f44( aces, AP0_2_AP1_MAT);\n    rgbPre = clamp_f3( rgbPre, 0., HALF_MAX);\n    \n    // --- Global desaturation --- //\n    rgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);\n    return rgbPre;\n\}\n\n\n\n"
  note_font_size 10
  xpos -825
  ypos -1204
 }
 StickyNote {
  inputs 0
  name StickyNote2
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.SSTS.ctl : 163</b><pre>float ssts\n( \n    varying float x,\n    varying TsParams C\n)\n\{\n    const int N_KNOTS_LOW = 4;\n    const int N_KNOTS_HIGH = 4;\n\n    // Check for negatives or zero before taking the log. If negative or zero,\n    // set to HALF_MIN.\n    float logx = log10( max(x, HALF_MIN )); \n\n    float logy;\n\n    if ( logx <= log10(C.Min.x) ) \{ \n\n        logy = logx * C.Min.slope + ( log10(C.Min.y) - C.Min.slope * log10(C.Min.x) );\n\n    \} else if (( logx > log10(C.Min.x) ) && ( logx < log10(C.Mid.x) )) \{\n\n        float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.Min.x))/(log10(C.Mid.x)-log10(C.Min.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else if (( logx >= log10(C.Mid.x) ) && ( logx < log10(C.Max.x) )) \{\n\n        float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.Mid.x))/(log10(C.Max.x)-log10(C.Mid.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else \{ //if ( logIn >= log10(C.Max.x) ) \{ \n\n        logy = logx * C.Max.slope + ( log10(C.Max.y) - C.Max.slope * log10(C.Max.x) );\n\n    \}\n\n    return pow10(logy);\n\n\}"
  note_font_size 10
  xpos -830
  ypos -664
 }
 StickyNote {
  inputs 0
  name StickyNote3
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.Tonescales.ctl : 271</b><pre>float segmented_spline_c9_fwd\n  ( \n    varying float x,\n    varying SegmentedSplineParams_c9 C = ODT_48nits\n  )\n\{    \n  const int N_KNOTS_LOW = 8;\n  const int N_KNOTS_HIGH = 8;\n\n  // Check for negatives or zero before taking the log. If negative or zero,\n  // set to HALF_MIN.\n  float logx = log10( max(x, HALF_MIN )); \n\n  float logy;\n\n  if ( logx <= log10(C.minPoint.x) ) \{ \n\n    logy = logx * C.slopeLow + ( log10(C.minPoint.y) - C.slopeLow * log10(C.minPoint.x) );\n\n  \} else if (( logx > log10(C.minPoint.x) ) && ( logx < log10(C.midPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.minPoint.x))/(log10(C.midPoint.x)-log10(C.minPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n    \n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else if (( logx >= log10(C.midPoint.x) ) && ( logx < log10(C.maxPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.midPoint.x))/(log10(C.maxPoint.x)-log10(C.midPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else \{ //if ( logIn >= log10(C.maxPoint.x) ) \{ \n\n    logy = logx * C.slopeHigh + ( log10(C.maxPoint.y) - C.slopeHigh * log10(C.maxPoint.x) );\n\n  \}\n\n  return pow10(logy);\n  \n\}"
  note_font_size 10
  xpos -200
  ypos -660
 }
push $N6c8af800
 Reformat {
  type "to box"
  box_width 4
  box_height 4
  box_fixed true
  name Reformat1
  note_font Helvetica
  xpos -1140
  ypos -561
 }
 Fill {
  output rgb
  color {{parent.ssts.mid_lum}}
  name Fill1
  note_font Helvetica
  xpos -1140
  ypos -537
 }
 Group {
  name inv_ssts
  xpos -1140
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} 4.8 {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.ACES_SSTS.AcesSSTSKernel_override_curve_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 expShift R -4 4}
  expShift {{"override_ssts_params ? exposure : 0"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} {lum.1} {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR+(MAX_STOP_RRT-MAX_STOP_SDR)/(log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR))*(log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 4}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2) / 2"} {"(coefsLow.2 + coefsLow.3) / 2"} {"(coefsLow.3 + coefsLow.4) / 2"}}
  addUserKnob {78 KNOT_Y_HIGH n 4}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1) / 2"} {"(coefsHigh.1 + coefsHigh.2) / 2"} {"(coefsHigh.2 + coefsHigh.3) / 2"} {"(coefsHigh.3 + coefsHigh.4) / 2"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6d2dd800 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6d2dd800
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6d2dd000 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6d2dcc00 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6d2dc800 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6d2dc400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -202
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6d2dc400
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6d29b400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6d2dc800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr <= log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg <= log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb <= log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -202
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6d29b400
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6d299c00 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -174
  }
set N6d299800 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -174
  }
set N6d299400 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -174
  }
  Dot {
   name Dot19
   xpos 434
   ypos -78
  }
set N6d298c00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow5
   xpos 290
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low5
   xpos 290
   ypos -34
  }
push $N6d298c00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy5
   xpos 400
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals4
   xpos 400
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push 0
push $N6d299800
  Dot {
   name Dot10
   xpos -6
   ypos -78
  }
set N6d24b400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow
   xpos -150
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low
   xpos -150
   ypos -34
  }
push $N6d24b400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy
   xpos -40
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals
   xpos -40
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push $N6d299400
  Dot {
   name Dot18
   xpos 214
   ypos -78
  }
set N6d24a000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow4
   xpos 70
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low4
   xpos 70
   ypos -34
  }
push $N6d24a000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy4
   xpos 180
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals5
   xpos 180
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   name Merge2
   xpos 180
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6d2dcc00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -202
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6d299c00
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6d1db400 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -174
  }
set N6d1db000 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -174
  }
set N6d1dac00 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -174
  }
  Dot {
   name Dot16
   xpos 1204
   ypos -78
  }
set N6d1da400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow3
   xpos 1060
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low3
   xpos 1060
   ypos -34
  }
push $N6d1da400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy3
   xpos 1170
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals3
   xpos 1170
   ypos 14
  }
push 0
push $N6d1db000
  Dot {
   name Dot11
   xpos 764
   ypos -78
  }
set N6d1d9000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow1
   xpos 620
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low1
   xpos 620
   ypos -34
  }
push $N6d1d9000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy1
   xpos 730
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals1
   xpos 730
   ypos 14
  }
push $N6d1dac00
  Dot {
   name Dot12
   xpos 984
   ypos -78
  }
set N6d177800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow2
   xpos 840
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low2
   xpos 840
   ypos -34
  }
push $N6d177800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy2
   xpos 950
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals2
   xpos 950
   ypos 14
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 950
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6d2dd000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -202
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6d1db400
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -208
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Expression {
  channel0 rgb
  expr0 log(r)/log(2)-log(0.18)/log(2)
  name expShift
  note_font Helvetica
  xpos -1140
  ypos -489
 }
end_group
Constant {
 inputs 0
 channels rgb
 color 1000
 name Constant11
 xpos -420
 ypos 913
}
Colorspace {
 colorspace_out CIE-XYZ
 name Colorspace46
 xpos -420
 ypos 985
}
Group {
 name ZCAM20
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -420
 ypos 1011
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 C,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N6d105c00 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N6d104800 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N6d104800
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N6d09b200 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N6d09b200
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N6d096800 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N6d096400 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N6d096800
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N6d095800 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N6d095400 [stack 0]
push $N6d096800
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N6d095000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N6d094c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N6d094800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N6d094400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N6d096400
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N6d096800
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N6d096800
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N6d096800
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N6d105c00
push $N6d096400
push $N6d095800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N6d40e400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N6d40e400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N6d096400
push $N6d095400
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N6d40d000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N6d40d000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N6d096400
push $N6d095000
push $N6d095800
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N6d3bb400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N6d3bb000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N6d3bb000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N6d094800
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N6d3bb400
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N6d094800
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N6d094400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N6d3bb400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N6d095400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N6d094c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N6d095800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N6d095000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N6d096400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N6d105c00
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N6d6e1c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N6d6e1000 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N6d6e1000
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N6d677400 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N6d676800 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N6d676800
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N6d676800
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N6d675800 [stack 0]
push $N6d675800
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N6d677400
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N6d626800 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N6d626800
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N6d626800
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N6d64f200 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2710
 }
set N6d625800 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N6d64f200
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2032
  ypos 2710
 }
set N6d625000 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N6d64f200
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N6d624400 [stack 0]
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N6d5db400 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N6d64eb00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1814
  ypos 2705
 }
push $N6d625800
push $N6d625000
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  selected true
  xpos -1543
  ypos 2822
 }
set N6d5da400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2985
 }
set N6d5d9800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N6d5d9800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N6d64eb00
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N6d55b400 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N6d55b400
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N6d64dd00 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N6d64dd00
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N6d6e1c00
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N6d6e1c00
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N6d6e1c00
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N6d64eb00
push $N6d6e1c00
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N6d677400
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N6d624400
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N6d5db400
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N6d64f200
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
push $N6d625000
push $N6d5da400
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {0.00390625 -0.1640625 0.005859375 -0.162109375}
  name Viewer1
  xpos -2115
  ypos 2819
 }
end_group
Shuffle2 {
 fromInput1 {{0} B}
 in1 zcam_J
 fromInput2 {{0} B}
 mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
 name Shuffle59
 xpos -420
 ypos 1063
}
Constant {
 inputs 0
 channels rgb
 color {100 {frame/1023*100} 0 0}
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Constant10
 xpos -1020
 ypos 995
}
Expression {
 expr0 y/(height-1)*226
 expr2 cx*180
 name Expression28
 xpos -1020
 ypos 1106
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.red 0 0 zcam_J.blue 0 2 rgba.red 0 0 zcam_J.alpha 0 3"
 name Shuffle55
 xpos -1020
 ypos 1130
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_M
 fromInput2 {{0} B}
 mappings "4 rgba.green 0 1 zcam_M.green 0 1 rgba.green 0 1 zcam_M.red 0 0 rgba.green 0 1 zcam_M.blue 0 2 rgba.green 0 1 zcam_M.alpha 0 3"
 name Shuffle56
 xpos -1020
 ypos 1176
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_h
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.red 0 0 rgba.blue 0 2 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.alpha 0 3"
 name Shuffle57
 xpos -1020
 ypos 1200
}
Group {
 name ZCAM19
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -1020
 ypos 1252
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 M,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N6d477000 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N6d475c00 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N6d475c00
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N6d433200 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N6d433200
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N6d803c00 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N6d803800 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N6d803c00
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N6d802c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N6d802800 [stack 0]
push $N6d803c00
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N6d802400 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N6d802000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N6d801c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N6d801800 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N6d803800
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N6d803c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N6d803c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N6d803c00
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N6d477000
push $N6d803800
push $N6d802c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N6d787800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N6d787800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N6d803800
push $N6d802800
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N6d786400 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N6d786400
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N6d803800
push $N6d802400
push $N6d802c00
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N6d784c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N6d784800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N6d784800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N6d801c00
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N6d784c00
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N6d801c00
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N6d801800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N6d784c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N6d802800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N6d802000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N6d802c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N6d802400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N6d803800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N6d477000
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N6da4b000 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N6da4a400 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N6da4a400
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N6da48c00 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N6d9ebc00 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N6d9ebc00
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N6d9ebc00
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N6d9eac00 [stack 0]
push $N6d9eac00
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N6da48c00
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N6d98fc00 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N6d98fc00
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N6d98fc00
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N6d9cf200 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2710
 }
set N6d98ec00 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N6d9cf200
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2032
  ypos 2710
 }
set N6d98e400 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N6d9cf200
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N6d98d800 [stack 0]
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N6d98cc00 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N6d9ceb00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1814
  ypos 2705
 }
push $N6d98ec00
push $N6d98e400
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  selected true
  xpos -1543
  ypos 2822
 }
set N6d937800 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2985
 }
set N6d936c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N6d936c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N6d9ceb00
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N6d934c00 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N6d934c00
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N6d9cdd00 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N6d9cdd00
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N6da4b000
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N6da4b000
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N6da4b000
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N6d9ceb00
push $N6da4b000
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N6da48c00
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N6d98d800
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N6d98cc00
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N6d9cf200
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
push $N6d98e400
push $N6d937800
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {0.00390625 -0.1640625 0.005859375 -0.162109375}
  name Viewer1
  xpos -2115
  ypos 2819
 }
end_group
Multiply {
 value 0.001
 name Multiply31
 label "Div by 100 to go from nits"
 xpos -1020
 ypos 1334
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle58
 xpos -1020
 ypos 1376
}
Colorspace {
 colorspace_in CIE-XYZ
 primary_out DCI-P3
 name Colorspace43
 label "XYZ to P3 Prims"
 xpos -1020
 ypos 1400
}
set N6d85e000 [stack 0]
PositionToPoints2 {
 display textured
 render_mode textured
 P_channel rgb
 name PositionToPoints9
 xpos -1158
 ypos 1591
}
Cube {
 inputs 0
 display wireframe
 rows 1
 columns 1
 cube {0 0 0 1 1 1}
 name Cube3
 xpos -1245
 ypos 1593
}
Scene {
 inputs 2
 name Scene3
 xpos -1186
 ypos 1626
}
push $N6d85e000
Dot {
 name Dot25
 xpos -986
 ypos 1449
}
set N6d85d000 [stack 0]
Dot {
 name Dot26
 xpos -859
 ypos 1475
}
set N6d85cc00 [stack 0]
Expression {
 channel0 rgba
 expr0 min((r<0?0:1),(g<0?0:1),(b<0?0:1))
 name Expression29
 xpos -936
 ypos 1500
}
push $N6d85cc00
Expression {
 channel0 rgba
 expr0 min((r>1?0:1),(g>1?0:1),(b>1?0:1))
 name Expression30
 xpos -831
 ypos 1498
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply32
 xpos -894
 ypos 1530
}
push $N6d85d000
Copy {
 inputs 2
 from0 rgba.alpha
 to0 rgba.alpha
 name Copy9
 xpos -1020
 ypos 1586
}
Premult {
 name Premult5
 xpos -1020
 ypos 1618
}
Dot {
 name Dot27
 xpos -986
 ypos 1725
}
Read {
 inputs 0
 file_type exr
 file "\[value Write19.file]"
 origset true
 version 7195
 name Read95
 xpos -872
 ypos 1673
}
Merge2 {
 inputs 2
 name Merge4
 xpos -872
 ypos 1798
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_P3_1000nits_gamutBound_tempImg.exr
 file_type exr
 first_part rgba
 version 7199
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write19
 xpos -872
 ypos 1836
 addUserKnob {20 User}
 addUserKnob {22 recursiveWrite T "writeNode = nuke.thisNode()\nmergeNode = writeNode.input(0)\nreadNode = writeNode.input(0).input(0)\n\nwriteNode.setInput(0,writeNode.input(0).input(1))\nnuke.execute(writeNode, 0, 0)\nreadNode.knob('reload').execute()\nwriteNode.setInput(0,mergeNode)\n\n\nfor i in range(0,1024):\n    nuke.execute(writeNode, i, i)\n    readNode.knob('reload').execute()" +STARTLINE}
}
push $N60c87200
Colorspace {
 colorspace_in sRGB
 name Colorspace47
 xpos 823
 ypos 2055
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle60
 xpos 823
 ypos 2079
}
PositionToPoints2 {
 display textured
 render_mode textured
 P_channel rgb
 detail 1
 name PositionToPoints6
 xpos 697
 ypos 2095
}
ColorWheel {
 inputs 0
 gamma 0.45
 name ColorWheel2
 xpos 894
 ypos 1844
}
Saturation {
 saturation 0
 name Saturation2
 xpos 860
 ypos 1921
}
EXPTool {
 mode Stops
 red 7
 green 7
 blue 7
 name Exposure8
 xpos 941
 ypos 1950
}
Read {
 inputs 0
 file_type exr
 file "/Volumes/GoogleDrive/My Drive/Output Transform Image Submissions/aces-exr-1920/christophe-brejon/cornell_box_001_lin_ap0.exr"
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read96
 xpos 1265
 ypos 1733
}
Group {
 inputs 0
 name ACES_OutputTransform_v1_2_4
 tile_color 0xa57aaaff
 label Rec2020_ST2084_1000nits_15nits
 xpos 1352
 ypos 1955
 addUserKnob {20 ACES_OutputTransform_tab l "ACES OutputTransform"}
 addUserKnob {41 gamut l "input gamut" T GamutToXYZ_lite.gamut}
 addUserKnob {26 ""}
 addUserKnob {35 presets t "display output presets." M {display/sRGB "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB\"\}" "display/sRGB D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB D60 sim.\"\}" display/Rec.709 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709\"\}" "display/Rec.709 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709 D60 sim.\"\}" display/Rec.2020 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 1 limiting_pri 1 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.2020\"\}" display/P3D60 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 4 limiting_pri 4 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D60\"\}" display/P3D65 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65\"\}" "display/P3D65 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 D60 sim.\"\}" display/P3DCI "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI\"\}" "display/P3DCI D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI D60 sim.\"\}" "display/P3DCI D65 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 1 dark_to_dim 0 legal_range 0 label \"P3DCI D65 sim.\"\}" display/DCDM "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 7 limiting_pri 7 eotf 5 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"DCDM\"\}" "display/P3D65 ST2084 108nits 7.2nits" "knobs this \{lum \{0.0001 7.2 108\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 108nits 7.2nits\"\}" "display/P3D65 ST2084 1000nits 15nits" "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 1000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 4000nits 15nits" "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 4000nits 15nits\"\}" display/Rec2020_HLG_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 7 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_HLG_1000nits_15nits\"\}" display/Rec2020_ST2084_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_1000nits_15nits\"\}" display/Rec2020_ST2084_2000nits_15nits "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_2000nits_15nits\"\}" display/Rec2020_ST2084_4000nits_15nits "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_4000nits_15nits\"\}" display/OCES "knobs this \{lum \{0.0001 4.8 10000\} override_ssts_params 0 use_c9 0 display_pri 6 limiting_pri 6 eotf 9 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"OCES\"\}" "" ""}}
 addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
 addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
 lum {0.0001 15 1000}
 addUserKnob {20 ssts_params_grp l "SSTS Parameters" n 1}
 ssts_params_grp 0
 addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
 addUserKnob {35 presets_ssts_param l presets t "If you want to override the default SSTS parameters and play around, here are some useful starting points." M {contrast/default "knobs this \{override_ssts_params 0 pctLow 0.35 pctHigh 0.89 slope \{0 1.5 0.\} exposure 0.0 use_c9 0\}" contrast/sdr "knobs this \{override_ssts_params 1 pctLow 0.35 pctHigh 0.89 slope \{0.1 1.6 0.01\} exposure 0.0 use_c9 0\}" contrast/high "knobs this \{override_ssts_params 1 pctLow 0.2 pctHigh 0.89 slope \{0.28 1.75 0.01\} exposure 0.0 use_c9 0\}" contrast/med "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.89 slope \{0.38 1.3 0.01\} exposure 0.0 use_c9 0\}" contrast/med-low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.42 0.01\} exposure 0.0 use_c9 0\}" contrast/low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.2 0.01\} exposure 0.0 use_c9 0\}" ""}}
 addUserKnob {7 exposure R -5 5}
 addUserKnob {7 pctLow l knee}
 pctLow 0.35
 addUserKnob {7 pctHigh l shoulder}
 pctHigh 0.89
 addUserKnob {78 slope n 3}
 slope {0.38 1.501 0.01}
 addUserKnob {20 endGroup n -1}
 addUserKnob {6 use_c9 l "use SegmentedSpline_c9" t "In ACES 1.1 the Output Transform was re-written for HDR tonescales. \n\nIn ACES 1.1, HDR transforms use the new SSTS (Single Stage Tone Scale), while SDR transforms continue to use the old SegmentedSpline_c5 -> OCES -> SegmentedSpline_c9 -> ODT transform.\n\nIf this is enabled, the SegmentedSpline_c9 transform is used to maintain compatibility with the ACES SDR output transforms and enable a 1:1 match with the AMPAS CTL.\n\nIf you are curious, turn use_c9 off and play around with the SSTS Parameters." +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {4 display_pri l "display pri" t "Display encoding primaries." M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 display_pri Rec2020
 addUserKnob {4 limiting_pri l "limiting pri" t "Limiting primaries for the output transform." -STARTLINE M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 limiting_pri Rec2020
 addUserKnob {4 eotf l EOTF t "Electrical to Optical Transfer Function of the monitor." M {sRGB BT.1886 "Gamma 2.2" "Gamma 2.4" "Gamma 2.6" DCDM "ST-2084 (PQ)" HLG Linear OCES ""}}
 eotf "ST-2084 (PQ)"
 addUserKnob {6 stretch_black l "stretch black" t "For hdr outputs: stretch black luminance to a PQ code value of 0" +STARTLINE}
 stretch_black true
 addUserKnob {6 d60_sim l "d60 sim" t "d60 whitepoint simulation." +STARTLINE}
 addUserKnob {6 force_d65_cat l "force d60 to d65 cat" -STARTLINE}
 addUserKnob {6 dark_to_dim l "dark to dim surround" t "Apply gamma adjustment to compensate for \"Dark to Dim\" surround. For SDR outputs only." +STARTLINE}
 addUserKnob {6 legal_range l "legal range" t "Output legal range." +STARTLINE}
}
 BackdropNode {
  inputs 0
  name Electrical_Optical_Transfer_Function
  tile_color 0x151515ff
  label "ACESlib.OutputTransforms.ctl : 185\n// EOTF"
  note_font_size 12
  xpos -2025
  ypos 2294
  bdwidth 3391
  bdheight 740
  z_order -10
 }
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x272727ff
  label "HDR EOTFs"
  note_font_size 42
  xpos 425
  ypos 2379
  bdwidth 910
  bdheight 617
  z_order -5
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x272727ff
  label "SDR EOTFs"
  note_font_size 42
  xpos -1158
  ypos 2384
  bdwidth 1436
  bdheight 608
  z_order -5
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ
  tile_color 0x555b5cff
  label "ACESlib.OutputTransforms.ctl : 90\n// Rendering primaries to XYZ\n"
  note_font_size 12
  xpos -1400
  ypos 906
  bdwidth 380
  bdheight 156
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ1
  tile_color 0x555a5cff
  label "// Apply desaturation to compensate for luminance difference\nlinearCV = mult_f3_f33( linearCV, ODT_SAT_MAT);\n( SDR only)"
  note_font_size 12
  xpos -1412
  ypos 669
  bdwidth 439
  bdheight 186
 }
 BackdropNode {
  inputs 0
  name D60_whitepoint_simulation
  tile_color 0x232323ff
  label "ACESlib.OutputTransforms.ctl : 150\n// Scale to avoid clipping when device calibration is different from D60. \n// To simulate D60, unequal code values are sent to the display.\n"
  note_font_size 12
  xpos -1399
  ypos 176
  bdwidth 818
  bdheight 463
 }
 BackdropNode {
  inputs 0
  name Luminance_to_Linear_Code_Values
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 87\n/*  Scale absolute luminance to linear code value  */\n"
  note_font_size 12
  xpos -1367
  ypos -50
  bdwidth 315
  bdheight 148
 }
 BackdropNode {
  inputs 0
  name Output_Color_Encoding_Specification
  tile_color 0x1d1d1dff
  label "<font size=12>OCES\n<font size=0.1>\n- ACES Output Output Color Encoding Specification \n- An idealized reference display with 0.0001 / 4.8 / 10000 luma\n w/ ACES AP0 Primaries."
  note_font_size 27.4
  xpos -1833
  ypos 2379
  bdwidth 367
  bdheight 377
 }
 BackdropNode {
  inputs 0
  name Output_Legal_Range
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 216\n"
  note_font_size 12
  xpos -1369
  ypos 3128
  bdwidth 318
  bdheight 176
 }
 BackdropNode {
  inputs 0
  name Single_Stage_Tone_Scale
  tile_color 0x272727ff
  label "<b>Single Stage Tone Scale : ACESlib.OutputTransforms.ctl : 82</b><pre>// Apply the tonescale independently in rendering-space RGB\nfloat rgbPost\[3] = ssts_f3( rgbPre, PARAMS);\n\nIf output is SDR, output OCES from SSTS and use SegmentedSpline_c9."
  note_font_size 12
  xpos -1502
  ypos -653
  bdwidth 609
  bdheight 533
 }
 BackdropNode {
  inputs 0
  name clamp_negatives
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 174\n// Clip values < 0 (i.e. projecting outside the display primaries)\nNote: Also clamping values > 1 here."
  note_font_size 12
  xpos -1393
  ypos 2087
  bdwidth 386
  bdheight 120
 }
 BackdropNode {
  inputs 0
  name dim_surround_gamma_adjustment
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 92\n// Apply gamma adjustment to compensate for dim surround\n"
  note_font_size 12
  xpos -1407
  ypos 1063
  bdwidth 395
  bdheight 258
 }
 BackdropNode {
  inputs 0
  name limit_primaries
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n// Gamut limit to limiting primaries\n"
  note_font_size 12
  xpos -1408
  ypos 1655
  bdwidth 396
  bdheight 194
 }
 BackdropNode {
  inputs 0
  name limit_primaries1
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 144\n// CIE XYZ to display encoding primaries\n"
  note_font_size 12
  xpos -1402
  ypos 1892
  bdwidth 384
  bdheight 151
 }
 BackdropNode {
  inputs 0
  name limit_primaries2
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n    // Apply CAT from ACES white point to assumed observer adapted white point\n    // TODO: Needs to expand from just supporting D60 sim to allow for any\n    // observer adapted white point.\n"
  note_font_size 12
  xpos -1407
  ypos 1337
  bdwidth 467
  bdheight 301
 }
 BackdropNode {
  inputs 0
  name rrt_sweeteners_
  tile_color 0x555a5cff
  label "<b>RRT Sweeteners : ACESlib.OutputTransforms.ctl : 79</b><pre>// RRT sweeteners\nfloat rgbPre\[3] = rrt_sweeteners( in);\n"
  note_font_size 18
  xpos -1469
  ypos -1234
  bdwidth 519
  bdheight 548
 }
 Input {
  inputs 0
  name Input
  xpos -1250
  ypos -1450
 }
 AddChannels {
  channels rgba
  name AddChannels
  xpos -1250
  ypos -1415
 }
 Group {
  name GamutToXYZ_lite
  xpos -1250
  ypos -1373
  addUserKnob {20 GamutToXYZ_lite_tab l GamutToXYZ_lite}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACES
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {20 chromaticities_grp l "" +STARTLINE n 1}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {20 endGroup n -1}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorMatrix {
  matrix {
      {1.049811006 0 -9.748453158e-05}
      {-0.4959030151 1.373313069 0.09824004024}
      {4.020908051e-08 0 0.9912520051}
    }
  name ColorMatrix4
  label "XYZ to ACES"
  note_font Helvetica
  xpos -1250
  ypos -1338
 }
 Dot {
  name Dot7
  label " ACES 2065-1 IN"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -1268
 }
 Group {
  name glow_module1
  note_font Helvetica
  xpos -1250
  ypos -1089
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_GLOW_GAIN}
  RRT_GLOW_GAIN 0.05
  addUserKnob {7 RRT_GLOW_MID}
  RRT_GLOW_MID 0.08
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -562
  }
  Dot {
   name Dot2
   xpos -6
   ypos -510
  }
set N6df16000 [stack 0]
  Dot {
   name Dot4
   xpos -116
   ypos -510
  }
set N6df15c00 [stack 0]
  Expression {
   temp_name0 chroma
   temp_expr0 sqrt(b*(b-g)+g*(g-r)+r*(r-b))
   temp_name1 ycRadiusWeight
   temp_expr1 1.75
   channel0 {-rgba.red rgba.green -rgba.blue none}
   expr0 "( b + g + r + ycRadiusWeight * chroma) / 3.0"
   channel1 {rgba.red -rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_yc1
   xpos -150
   ypos -466
  }
push 0
push $N6df15c00
  Dot {
   name Dot3
   xpos -226
   ypos -510
  }
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   expr1 0
   expr2 0
   name rgb_2_saturation1
   xpos -260
   ypos -466
  }
set N6df15000 [stack 0]
  Expression {
   channel0 {rgba.red rgba.green rgba.blue none}
   expr0 "(r - 0.4) / 0.2"
   name Expression1
   xpos -370
   ypos -466
  }
  Expression {
   temp_name0 t
   temp_expr0 "max( 1.0 - fabs( r / 2.0), 0.0)"
   temp_name1 sign
   temp_expr1 r>0?1:r<0?-1:0
   temp_name2 valy
   temp_expr2 "1.0 + sign * (1.0 - t * t)"
   channel0 {-rgba.red -rgba.green rgba.blue none}
   expr0 "valy / 2"
   channel1 {rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red rgba.green rgba.blue none}
   expr2 0
   name sigmoid_shaper1
   xpos -370
   ypos -442
  }
push $N6df15000
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   note_font Helvetica
   xpos -260
   ypos -393
  }
set N6df14400 [stack 0]
  Expression {
   temp_name0 ycOut
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ((ycOut <= ((1 + glowGainIn) * 2./3. * glowMid)) ? -glowGainIn / (1 + glowGainIn) : ( ycOut >= (2. * glowMid)) ? 0 : glowGainIn * (glowMid / ycOut - 1./2.) / (glowGainIn / 2. - 1.))"
   channel1 none
   channel2 none
   name glow_inv
   xpos -150
   ypos -346
  }
push $N6df14400
  Expression {
   temp_name0 ycIn
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ( ycIn <= 2./3. * glowMid ? glowGainIn : ycIn >= 2. * glowMid ? 0 : glowGainIn * (glowMid / ycIn - 1./2.) )"
   channel1 none
   channel2 none
   name glow_fwd
   xpos -370
   ypos -346
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -260
   ypos -297
  }
  Dot {
   name Dot5
   xpos -226
   ypos -246
  }
push $N6df16000
  Merge2 {
   inputs 2
   operation multiply
   bbox B
   output rgb
   name Merge3
   note_font Helvetica
   xpos -40
   ypos -249
  }
  Output {
   name Output
   xpos -40
   ypos -178
  }
 end_group
 Group {
  name red_modifier1
  note_font Helvetica
  xpos -1250
  ypos -1041
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_RED_SCALE}
  RRT_RED_SCALE 0.82
  addUserKnob {7 RRT_RED_PIVOT}
  RRT_RED_PIVOT 0.03
  addUserKnob {7 RRT_RED_HUE}
  addUserKnob {7 RRT_RED_WIDTH R 0 360}
  RRT_RED_WIDTH 135
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  Dot {
   name Dot1
   xpos -6
   ypos 42
  }
set N6deb6400 [stack 0]
  Dot {
   name Dot2
   xpos -226
   ypos 42
  }
set N6deb6000 [stack 0]
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   channel0 rgb
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   channel1 none
   expr1 0
   channel2 none
   expr2 0
   name rgb_2_saturation
   xpos -260
   ypos 86
  }
push $N6deb6000
  Dot {
   name Dot3
   xpos -336
   ypos 42
  }
  Expression {
   temp_name0 hue
   temp_expr0 "(r==g&&g==b)?0:(180/pi) * atan2( sqrt(3)*(g-b), 2*r-g-b)"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "hue < 0 ? hue + 360 : hue"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_hue
   xpos -370
   ypos 86
  }
  Expression {
   temp_name0 hue
   temp_expr0 r
   temp_name1 centerH
   temp_expr1 RRT_RED_HUE
   temp_name2 hueCentered
   temp_expr2 hue-centerH
   channel0 {-rgba.red rgba.green -rgba.blue -rgba.alpha}
   expr0 "hueCentered < -180.0 ? hueCentered + 360.0 : (hueCentered > 180.0) ? hueCentered - 360.0 : hueCentered"
   name center_hue
   xpos -370
   ypos 134
  }
  Expression {
   temp_name0 centeredHue
   temp_expr0 g
   temp_name1 knot_coord
   temp_expr1 "(centeredHue - knots.0) * 4.0/w"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "(min((centeredHue > knots.0?1:0) , (centeredHue < knots.4?1:0)) ? j == 3 ? t*t*t * -1./6 + t*t * 3./6 +  t * -3./6 + 1 * 1./6 : j == 2 ? t*t*t * 3./6 + t*t * -6./6 + t * 0./6 + 1. *4./6 : j == 1 ? t*t*t * -3./6 + t*t * 3./6 + t * 3./6 + 1. * 1./6 : j == 0 ? t*t*t * 1./6 + t*t * 0./6 + t * 0./6 + 1. * 0./6 : 0 : 0) * 3/2"
   channel1 none
   channel2 none
   name cubic_basis_shaper
   xpos -370
   ypos 182
   addUserKnob {20 param}
   addUserKnob {7 w R 0 360}
   w {{parent.RRT_RED_WIDTH}}
   addUserKnob {78 knots n 5}
   knots {{-w/2} {-w/4} 0 {w/4} {w/2}}
  }
  Dot {
   name Dot4
   xpos -336
   ypos 234
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy4
   note_font Helvetica
   xpos -260
   ypos 226
  }
  Dot {
   name Dot6
   label " r : hueWeight\n g : centeredHue\n b : saturation"
   note_font "Helvetica \[pyrs]"
   note_font_size 12
   note_font_color 0xff
   xpos -226
   ypos 282
  }
  Dot {
   name Dot7
   xpos -226
   ypos 330
  }
set N6de4f800 [stack 0]
push $N6deb6400
  Dot {
   name Dot8
   xpos -6
   ypos 258
  }
set N6de4f400 [stack 0]
  MergeExpression {
   inputs 2
   temp_name0 minChan
   temp_expr0 "Ag < 0 ? Bg : Bb"
   temp_name1 a_
   temp_expr1 "Ar * (1. - RRT_RED_SCALE) - 1."
   temp_name2 b
   temp_expr2 "Br - Ar* (RRT_RED_PIVOT + minChan) * (1. - RRT_RED_SCALE)"
   temp_name3 c
   temp_expr3 "Ar * RRT_RED_PIVOT * minChan * (1. - RRT_RED_SCALE)"
   expr0 "( -b - sqrt( b * b - 4. * a_ * c)) / ( 2. * a_)"
   name red_modifier_rev
   note_font Helvetica
   xpos -150
   ypos 351
  }
push $N6de4f800
push $N6de4f400
  MergeExpression {
   inputs 2
   expr0 "r + Ar * Ab * (RRT_RED_PIVOT - r) * (1. - RRT_RED_SCALE)"
   name red_modifier_fwd
   note_font Helvetica
   xpos -40
   ypos 327
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -40
   ypos 423
  }
  Output {
   name Output
   xpos -40
   ypos 494
  }
 end_group
 Clamp {
  channels rgb
  maximum_enable false
  name clamp_f3_min
  label "Clamp Negative Values"
  xpos -1250
  ypos -976
 }
 ColorMatrix {
  matrix {
      {1.451439381 -0.2365107685 -0.2149285674}
      {-0.07655383646 1.176229835 -0.09967593104}
      {0.008316127583 -0.0060324613 0.997716248}
    }
  name ColorMatrix15
  label "ACES to ACEScg"
  xpos -1250
  ypos -928
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3_
  label "clamp to HALF_MAX"
  xpos -1250
  ypos -880
 }
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix
  label "// --- Global desaturation --- //\nrgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);"
  xpos -1250
  ypos -790
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.96
 }
 Dot {
  name Dot29
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xff
  xpos -1216
  ypos -558
 }
set N6de4d400 [stack 0]
 Group {
  name ssts
  xpos -1250
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} {parent.lum} {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.override_ssts_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 mid_lum l "mid lum" R 0 20}
  mid_lum {{parent.lum.1}}
  addUserKnob {7 expShift R -4 4}
  expShift {{"(parent.override_ssts_params ? exposure : 0) + (mid_lum<= 4.8 ? 0 : \[sample parent.expShift r 0 0] )"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} 4.8 {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR + (MAX_STOP_RRT-MAX_STOP_SDR) / (log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR)) * (log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6de4cc00 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6de4cc00
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6de4c400 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6ddefc00 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6ddef800 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6ddef400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6ddef400
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6ddee800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr1 "logg * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr2 "logb* minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6ddef800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6ddee800
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6dded000 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N6ddecc00 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N6ddec800 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N6ddb3c00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression5
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N6ddb3c00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N6ddec800
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N6ddb2800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression3
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N6ddb2800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N6ddecc00
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N6ddb1400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N6ddb1400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6ddefc00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6dded000
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6dd42800 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N6dd42400 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N6dd42000 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N6dd41800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression11
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N6dd41800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N6dd42000
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N6dd40400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression9
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N6dd40400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N6dd42400
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N6dceac00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression7
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N6dceac00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6de4c400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6dd42800
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr1 "logg * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr2 "logb* maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -160
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Dot {
   name Dot30
   xpos 1534
   ypos 810
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Dot {
  name Dot23
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -462
 }
set N6dc82000 [stack 0]
 Dot {
  name Dot22
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos -462
 }
 ColorMatrix {
  matrix {
      {0.6954522133 0.1406786889 0.163869068}
      {0.04479461163 0.8596711159 0.09553432465}
      {-0.005525866989 0.004025223665 1.001500726}
    }
  name ColorMatrix7
  label "ACEScg to ACES"
  note_font Helvetica
  xpos -1690
  ypos -398
 }
 Dot {
  name Dot21
  label " OCES"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos 2658
 }
push $N6dc82000
 Dot {
  name Dot28
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -342
 }
set N6dc81000 [stack 0]
 Group {
  name segmented_spline_c9_fwd
  xpos -1140
  ypos -346
  addUserKnob {20 SegmentedSplineParams_c9_tab l SegmentedSplineParams_c9}
  addUserKnob {78 coefsLow n 10}
  coefsLow {-1.698970004 -1.698970004 -1.4779 -1.2291 -0.8648 -0.448 0.00518 0.4511080334 0.9113744414 0.9113744414}
  addUserKnob {78 coefsHigh n 10}
  coefsHigh {0.5154386965 0.8470437783 1.1358 1.3802 1.5197 1.5985 1.6467 1.674609136 1.687873339 1.687873339}
  addUserKnob {12 minPoint}
  minPoint {0.0028799 0.02}
  addUserKnob {12 midPoint}
  midPoint {4.79999924 4.8}
  addUserKnob {12 maxPoint}
  maxPoint {1005.719116 48}
  addUserKnob {7 slopeLow}
  addUserKnob {7 slopeHigh}
  slopeHigh 0.04
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 8
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 8
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6dc80800 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6dc80800
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6dc27c00 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6dc27800 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6dc27400 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6dc27000 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6dc27000
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6dc26400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr1 "logg * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr2 "logb* slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6dc27400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6dc26400
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6dc24c00 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N6dc24800 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N6dc24400 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N6dfe3800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression15
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N6dfe3800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N6dc24400
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N6dfe2400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression14
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N6dfe2400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N6dc24800
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N6dfe1000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N6dfe1000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6dc27800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6dc24c00
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6df76400 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N6df76000 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N6df75c00 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N6df75400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression3
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N6df75400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N6df75c00
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N6e31bc00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression5
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N6e31bc00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N6df76000
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N6e31a800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression16
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N6e31a800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6dc27c00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6df76400
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr1 "logg * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr2 "logb* slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
push $N6dc81000
 Switch {
  inputs 2
  which {{parent.use_c9}}
  name Switch_c9
  xpos -1250
  ypos -298
 }
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_
  xpos -1250
  ypos 38
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Dot {
  name Dot12
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 282
 }
set N6e2adc00 [stack 0]
 Dot {
  name Dot15
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 282
 }
set N6e2ad800 [stack 0]
 Dot {
  name Dot13
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 282
 }
 Dot {
  name Dot16
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 354
 }
set N6e2ad000 [stack 0]
 Expression {
  temp_name0 tr
  temp_expr0 "(-r - c_x_0) / (c_x_1 - c_x_0)"
  temp_name1 tg
  temp_expr1 "(-g - c_x_0) / (c_x_1 - c_x_0)"
  temp_name2 tb
  temp_expr2 "(-b - c_x_0) / (c_x_1 - c_x_0)"
  expr0 "tr < 0.0 ? -(tr * c_b + c_c) : tr > 1.0 ? r : -(( tr * c_a + c_b) * tr + c_c)"
  expr1 "tg < 0.0 ? -(tg * c_b + c_c) : tg > 1.0 ? g : -(( tg * c_a + c_b) * tg + c_c)"
  expr2 "tb < 0.0 ? -(tb * c_b + c_c) : tb > 1.0 ? b : -(( tb * c_a + c_b) * tb + c_c)"
  name roll_white_fwd_1
  xpos -920
  ypos 398
  addUserKnob {20 Params}
  addUserKnob {7 new_wht}
  new_wht 0.918
  addUserKnob {7 c_width}
  c_width 0.5
  addUserKnob {7 c_x_0 +DISABLED}
  c_x_0 -1
  addUserKnob {7 c_x_1 +DISABLED}
  c_x_1 {{"c_x_0 + c_width"}}
  addUserKnob {7 c_y0 +DISABLED}
  c_y0 {{-new_wht}}
  addUserKnob {7 c_y1 +DISABLED}
  c_y1 {{c_x_1}}
  addUserKnob {7 c_m1 +DISABLED}
  c_m1 {{"(c_x_1 - c_x_0)"}}
  addUserKnob {7 c_a +DISABLED}
  c_a {{"c_y0 - c_y1 + c_m1"}}
  addUserKnob {7 c_b +DISABLED}
  c_b {{"2 * (c_y1 - c_y0) - c_m1"}}
  addUserKnob {7 c_c +DISABLED}
  c_c {{c_y0}}
 }
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96
  temp_name1 NEW_WHT
  temp_expr1 0.918
  expr0 "min( r, NEW_WHT) * SCALE"
  expr1 "min( g, NEW_WHT) * SCALE"
  expr2 "min( b, NEW_WHT) * SCALE"
  name Expression2
  label "// Scale and clamp white to avoid casted highlights due to D60 simulation"
  xpos -920
  ypos 440
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 498
 }
push $N6e2ad000
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96362
  expr0 "r * SCALE"
  expr1 "g * SCALE"
  expr2 "b * SCALE"
  name mult_f_f3_
  label D65
  xpos -1030
  ypos 344
 }
push $N6e2ad800
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_
  xpos -1140
  ypos 350
 }
 Dot {
  name Dot14
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 426
 }
push $N6e2adc00
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch1
  xpos -1250
  ypos 422
 }
 Switch {
  inputs 2
  which {{"parent.display_pri == 3"}}
  name switch_wp_is_dci_
  xpos -1250
  ypos 494
 }
 Dot {
  name Dot26
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 762
 }
set N6e253400 [stack 0]
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix3
  label "// Apply desaturation to compensate \nfor luminance difference"
  xpos -1140
  ypos 746
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.93
 }
push $N6e253400
 Switch {
  inputs 2
  which {{"parent.eotf < 5 && display_pri < 2"}}
  name Switch_eotf
  label "Use if output is SDR"
  xpos -1250
  ypos 800
 }
 ColorMatrix {
  matrix {
      {0.6624541879 0.1340042055 0.1561876982}
      {0.2722287476 0.6740817428 0.05368951708}
      {-0.005574660841 0.004060741514 1.010339141}
    }
  name ColorMatrix1
  label "ACES AP1 to XYZ"
  xpos -1250
  ypos 968
 }
 Dot {
  name Dot8
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1146
 }
set N6e252800 [stack 0]
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1136
 }
 Clamp {
  channels {rgba.red -rgba.green -rgba.blue none}
  maximum_enable false
  name ClampMin4
  xpos -1140
  ypos 1190
 }
 Expression {
  expr0 "pow(r, DIM_SURROUND_GAMMA)"
  expr1 g
  expr2 b
  channel3 none
  name dark_to_dim3
  xpos -1140
  ypos 1214
  addUserKnob {20 Params}
  addUserKnob {7 DIM_SURROUND_GAMMA}
  DIM_SURROUND_GAMMA 0.9811
 }
 Colorspace {
  colorspace_in CIE-Yxy
  colorspace_out CIE-XYZ
  name Colorspace4
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1256
 }
push $N6e252800
 Switch {
  inputs 2
  which {{"(parent.eotf <= 4) ? parent.dark_to_dim : 0"}}
  name DarkToDim_Switch
  label "enable if sdr\nand dark_to_dim enabled"
  xpos -1250
  ypos 1250
 }
 Dot {
  name Dot19
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1434
 }
set N6e251400 [stack 0]
 Dot {
  name Dot9
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 1434
 }
set N6e251000 [stack 0]
 ColorMatrix {
  matrix {
      {0.9872254133 -0.006114810705 0.01592640579}
      {-0.007603884675 1.001874804 0.005322027951}
      {0.003066040576 -0.005084238946 1.081519246}
    }
  name ColorMatrix2
  label "CAT: Bradford\n D60 to D65"
  xpos -1140
  ypos 1466
 }
set N6e250c00 [stack 0]
push $N6e251000
 Dot {
  name Dot10
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -996
  ypos 1434
 }
push $N6e250c00
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch
  xpos -1140
  ypos 1550
 }
push $N6e251400
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_1
  xpos -1250
  ypos 1550
 }
 Switch {
  inputs 2
  which {{parent.force_d65_cat}}
  name switch_force_d65_cat
  xpos -1250
  ypos 1598
 }
 Group {
  name limit_to_primaries
  label "Only enabled when display_pri != limiting_pri"
  xpos -1250
  ypos 1760
  disable {{"!(parent.display_pri != parent.limiting_pri)"}}
  addUserKnob {20 limit_to_primaries}
  addUserKnob {4 limiting_pri l "limiting pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  limiting_pri {{parent.limiting_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to limiting primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6e1cbc00 [stack 0]
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix5
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {0.6954522133 0.1406786889 0.163869068}
       {0.04479461163 0.8596711159 0.09553432465}
       {-0.005525866989 0.004025223665 1.001500726}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6e1cbc00
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Clamp {
   channels rgb
   name clamp_f3
   label "Clip any values outside the limiting primaries"
   xpos -40
   ypos 56
  }
  Dot {
   name Dot2
   label " Convert limited RGB to XYZ"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 162
  }
set N6e1c9800 [stack 0]
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.9525524378 0 9.367863095e-05}
       {0.3439664543 0.7281661034 -0.07213255018}
       {-3.863927134e-08 0 1.008825183}
     }
   name ColorMatrix4
   label "ACES to XYZ"
   xpos 730
   ypos 224
  }
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.6624541879 0.1340042055 0.1561876982}
       {0.2722287476 0.6740817428 0.05368951708}
       {-0.005574660841 0.004060741514 1.010339141}
     }
   name ColorMatrix20
   label "ACEScg to XYZ"
   xpos 620
   ypos 224
  }
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.5049495697 0.2646814585 0.1830150485}
       {0.237623319 0.6891706586 0.07320601493}
       {0 0.0449459292 0.9638792276}
     }
   name ColorMatrix13
   label "P3D60 to XYZ"
   xpos 510
   ypos 224
  }
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.4451698363 0.2771343887 0.1722826511}
       {0.209491685 0.7215952873 0.06891305745}
       {0 0.04706057906 0.9073553085}
     }
   name ColorMatrix18
   label "P3DCI to XYZ"
   xpos 400
   ypos 224
  }
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.4865709841 0.2656676769 0.1982172877}
       {0.2289745659 0.6917385459 0.07928691059}
       {0 0.04511339962 1.043944359}
     }
   name ColorMatrix16
   label "P3D65 to XYZ"
   xpos 290
   ypos 224
  }
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.6369580626 0.1446169019 0.1688809693}
       {0.2627002299 0.6779980659 0.05930171534}
       {0 0.0280726999 1.060985088}
     }
   name ColorMatrix3
   label "Rec2020 to XYZ"
   xpos 180
   ypos 224
  }
push $N6e1c9800
  ColorMatrix {
   matrix {
       {0.4123907983 0.3575843275 0.180480808}
       {0.2126390189 0.7151686549 0.07219231874}
       {0.01933082007 0.1191947311 0.950532198}
     }
   name ColorMatrix1
   label "Rec709 to XYZ"
   xpos 70
   ypos 224
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch1
   xpos -40
   ypos 326
  }
  Output {
   name Output
   xpos -40
   ypos 446
  }
 end_group
 Group {
  name XYZ_2_DISPLAY_PRI
  label "CIE XYZ to display encoding primaries"
  xpos -1250
  ypos 1976
  addUserKnob {20 XYZ_2_DISPLAY_PRI_tab l XYZ_2_DISPLAY_PRI}
  addUserKnob {4 display_pri l "display pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  display_pri {{parent.display_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to display primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6e15ac00 [stack 0]
push $N6e15ac00
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix3
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6e15ac00
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6e15ac00
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6e15ac00
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6e15ac00
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6e15ac00
  ColorMatrix {
   matrix {
       {1.71665132 -0.3556708097 -0.2533662617}
       {-0.6666844487 1.616481304 0.01576855592}
       {0.01763986237 -0.04277062416 0.9421030879}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6e15ac00
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.display_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Clamp {
  channels rgb
  name clamp_f3_all
  xpos -1250
  ypos 2164
 }
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 2514
 }
set N6e158400 [stack 0]
push $N6e158400
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 2514
 }
set N6e0dfc00 [stack 0]
 Dot {
  name Dot4
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 2514
 }
set N6e0df800 [stack 0]
 Dot {
  name Dot6
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -446
  ypos 2514
 }
set N6e0df400 [stack 0]
 Dot {
  name Dot18
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -226
  ypos 2514
 }
set N6e0df000 [stack 0]
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -6
  ypos 2514
 }
set N6e0dec00 [stack 0]
 Dot {
  name Dot25
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 214
  ypos 2514
 }
set N6e0de800 [stack 0]
 Dot {
  name Dot24
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2514
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2610
 }
set N6e0de000 [stack 0]
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr
  label "stretch_black = True"
  xpos 510
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
push $N6e0de000
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr2
  label "stretch_black = False"
  xpos 620
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Switch {
  inputs 2
  which {{parent.stretch_black}}
  name StretchBlacks_Switch
  xpos 620
  ypos 2750
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3__
  xpos 620
  ypos 2822
 }
 Expression {
  temp_name0 Lm_r
  temp_expr0 "pow((r / pq_C), pq_m1)"
  temp_name1 Lm_g
  temp_expr1 "pow((g / pq_C), pq_m1)"
  temp_name2 Lm_b
  temp_expr2 "pow((b / pq_C), pq_m1)"
  expr0 "pow(( pq_c1 + pq_c2 * Lm_r ) / ( 1.0 + pq_c3 * Lm_r ), pq_m2)"
  expr1 "pow(( pq_c1 + pq_c2 * Lm_g ) / ( 1.0 + pq_c3 * Lm_g ), pq_m2)"
  expr2 "pow(( pq_c1 + pq_c2 * Lm_b ) / ( 1.0 + pq_c3 * Lm_b ), pq_m2)"
  name Y_2_ST2084_
  label "ACESlib.OutputTransforms.ctl : 243 \nACESlib.Utilities_Color.ctl : 425"
  xpos 620
  ypos 2882
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
set N6e0dd000 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2514
 }
 Expression {
  temp_name0 Np_r
  temp_expr0 "pow( r, 1.0 / pq_m2 )"
  temp_name1 Np_g
  temp_expr1 "pow( g, 1.0 / pq_m2 )"
  temp_name2 Np_b
  temp_expr2 "pow( b, 1.0 / pq_m2 )"
  expr0 "r < 0 ? 0 : pow((Np_r - pq_c1) / ( pq_c2 - pq_c3 * Np_r ), 1.0/pq_m1) * pq_C"
  expr1 "g < 0 ? 0 : pow((Np_g - pq_c1) / ( pq_c2 - pq_c3 * Np_g ), 1.0/pq_m1) * pq_C"
  expr2 "b < 0 ? 0 : pow((Np_b - pq_c1) / ( pq_c2 - pq_c3 * Np_b ), 1.0/pq_m1) * pq_C"
  name ST2084_2_Y_f3_
  label "ACESlib.Utilities_Color.ctl : 408\n// Converts from the non-linear perceptually quantized space to linear cd/m^2"
  xpos 950
  ypos 2618
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Expression {
  temp_name0 Y_d
  temp_expr0 "0.2627*r + 0.6780*g + 0.0593*b"
  expr0 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((r-c_beta)/c_alpha)"
  expr1 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((g-c_beta)/c_alpha)"
  expr2 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((b-c_beta)/c_alpha)"
  name ST2084_2_HLG_1000nits_f3_3
  label "ACESlib.Utilities_Color.ctl : 469\n// HLG Inverse EOTF (i.e. HLG inverse OOTF followed by the HLG OETF)\n// HLG Inverse OOTF (display linear to scene linear)"
  xpos 950
  ypos 2732
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 L_w +DISABLED}
  L_w 1000
  addUserKnob {7 L_b +DISABLED}
  addUserKnob {7 c_alpha +DISABLED}
  c_alpha {{L_w-L_b}}
  addUserKnob {7 c_beta +DISABLED}
  c_beta {{L_b}}
  addUserKnob {7 c_gamma +DISABLED}
  c_gamma 1.2
 }
 Expression {
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "r <= 1.0/12 ? sqrt(3.0*r) : c_a * log(12.0 * r - c_b) + c_c"
  expr1 "g <= 1.0/12 ? sqrt(3.0*g) : c_a * log(12.0 * g- c_b) + c_c"
  expr2 "b <= 1.0/12 ? sqrt(3.0*b) : c_a * log(12.0 * b - c_b) + c_c"
  name ST2084_2_HLG_1000nits_f3_
  label "ACESlib.Utilities_Color.ctl : 493\n// HLG OETF (scene linear to non-linear signal value)"
  xpos 950
  ypos 2834
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 c_a +DISABLED}
  c_a 0.17883277
  addUserKnob {7 c_b t 1.-4.*a +DISABLED}
  c_b 0.28466892
  addUserKnob {7 c_c t 0.5-a*log(4.*a) +DISABLED}
  c_c 0.55991073
 }
 Dot {
  name Dot17
  label " HLG"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2970
 }
push $N6e0dd000
 Dot {
  name Dot27
  label " PQ"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2970
 }
push $N6e0de800
 Expression {
  expr0 "pow( (48./52.37) * r, 1./2.6)"
  expr1 "pow( (48./52.37) * g, 1./2.6)"
  expr2 "pow( (48./52.37) * b, 1./2.6)"
  expr3 1
  name dcdm_encode
  xpos 180
  ypos 2702
 }
push $N6e0dec00
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_26_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.6"
  xpos -40
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.6
 }
push $N6e0df000
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_24_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.4"
  xpos -260
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
 }
push $N6e0df400
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_22_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.2"
  xpos -480
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.2
 }
push $N6e0df800
 Expression {
  temp_name0 c_a
  temp_expr0 "pow( pow( Lw, 1./gamma) - pow( Lb, 1./gamma), gamma)"
  temp_name1 c_b
  temp_expr1 "pow( Lb, 1./gamma) / ( pow( Lw, 1./gamma) - pow( Lb, 1./gamma))"
  expr0 "pow( max( r / c_a, 0.), 1.0/gamma) - c_b"
  expr1 "pow( max( g / c_a, 0.), 1.0/gamma) - c_b"
  expr2 "pow( max( b / c_a, 0.), 1.0/gamma) - c_b"
  name bt1886_r_f3
  label "ACESlib.Utilities_Color.ctl : 301\n// The reference EOTF specified in Rec. ITU-R BT.1886\n// L = a(max\[(V+b),0])^g"
  xpos -700
  ypos 2684
  addUserKnob {20 Luminance}
  addUserKnob {7 Lw R 48 10000}
  Lw 1
  addUserKnob {7 Lb R 0.0001 0.02}
  addUserKnob {7 gamma R 1 4}
  gamma 2.4
 }
push $N6e0dfc00
 Expression {
  temp_name0 yb
  temp_expr0 "pow( offs * gamma / ( ( gamma - 1.0) * ( 1.0 + offs)), gamma)"
  temp_name1 rs
  temp_expr1 "pow( ( gamma - 1.0) / offs, gamma - 1.0) * pow( ( 1.0 + offs) / gamma, gamma)"
  expr0 "r >= yb ? ( 1.0 + offs) * pow( r, 1.0 / gamma) - offs : r * rs"
  expr1 "g >= yb ? ( 1.0 + offs) * pow( g, 1.0 / gamma) - offs : g * rs"
  expr2 "b >= yb ? ( 1.0 + offs) * pow( b, 1.0 / gamma) - offs : b * rs"
  name moncurve_r_f3_
  label "ACESlib.Utilities_Color.ctl : 260\nmoncurve_r with gamma of 2.4 and offset of 0.055 matches the EOTF found in IEC 61966-2-1:1999 (sRGB)"
  xpos -920
  ypos 2690
  addUserKnob {20 Luminance}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
  addUserKnob {7 offs}
  offs 0.055
 }
 Switch {
  inputs 10
  which {{parent.eotf}}
  name EOTF_Switch
  xpos -1250
  ypos 2966
 }
 Expression {
  temp_name0 REFBLACK
  temp_expr0 "64 / 1023"
  temp_name1 REFWHITE
  temp_expr1 "940 / 1023"
  expr0 "r * ( REFWHITE - REFBLACK) + REFBLACK"
  expr1 "g * ( REFWHITE - REFBLACK) + REFBLACK"
  expr2 "b * ( REFWHITE - REFBLACK) + REFBLACK"
  name fullRange_to_smpteRange_f3_
  label "ACESlib.OutputTransforms.ctl : 216"
  xpos -1250
  ypos 3224
  disable {{!parent.legal_range}}
 }
 Output {
  name Output
  xpos -1250
  ypos 3446
 }
 StickyNote {
  inputs 0
  name StickyNote1
  tile_color 0x535a61ff
  label "\n<b>ACESlib.RRT_Common.ctl : 135</b>\n<pre>\nfloat\[3] rrt_sweeteners( float in\[3])\n\{\n    float aces\[3] = in;\n    \n    // --- Glow module --- //\n    float saturation = rgb_2_saturation( aces);\n    float ycIn = rgb_2_yc( aces);\n    float s = sigmoid_shaper( (saturation - 0.4) / 0.2);\n    float addedGlow = 1. + glow_fwd( ycIn, RRT_GLOW_GAIN * s, RRT_GLOW_MID);\n\n    aces = mult_f_f3( addedGlow, aces);\n\n    // --- Red modifier --- //\n    float hue = rgb_2_hue( aces);\n    float centeredHue = center_hue( hue, RRT_RED_HUE);\n    float hueWeight = cubic_basis_shaper( centeredHue, RRT_RED_WIDTH);\n\n    aces\[0] = aces\[0] + hueWeight * saturation * (RRT_RED_PIVOT - aces\[0]) * (1. - RRT_RED_SCALE);\n\n    // --- ACES to RGB rendering space --- //\n    aces = clamp_f3( aces, 0., HALF_POS_INF);\n    float rgbPre\[3] = mult_f3_f44( aces, AP0_2_AP1_MAT);\n    rgbPre = clamp_f3( rgbPre, 0., HALF_MAX);\n    \n    // --- Global desaturation --- //\n    rgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);\n    return rgbPre;\n\}\n\n\n\n"
  note_font_size 10
  xpos -825
  ypos -1204
 }
 StickyNote {
  inputs 0
  name StickyNote2
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.SSTS.ctl : 163</b><pre>float ssts\n( \n    varying float x,\n    varying TsParams C\n)\n\{\n    const int N_KNOTS_LOW = 4;\n    const int N_KNOTS_HIGH = 4;\n\n    // Check for negatives or zero before taking the log. If negative or zero,\n    // set to HALF_MIN.\n    float logx = log10( max(x, HALF_MIN )); \n\n    float logy;\n\n    if ( logx <= log10(C.Min.x) ) \{ \n\n        logy = logx * C.Min.slope + ( log10(C.Min.y) - C.Min.slope * log10(C.Min.x) );\n\n    \} else if (( logx > log10(C.Min.x) ) && ( logx < log10(C.Mid.x) )) \{\n\n        float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.Min.x))/(log10(C.Mid.x)-log10(C.Min.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else if (( logx >= log10(C.Mid.x) ) && ( logx < log10(C.Max.x) )) \{\n\n        float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.Mid.x))/(log10(C.Max.x)-log10(C.Mid.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else \{ //if ( logIn >= log10(C.Max.x) ) \{ \n\n        logy = logx * C.Max.slope + ( log10(C.Max.y) - C.Max.slope * log10(C.Max.x) );\n\n    \}\n\n    return pow10(logy);\n\n\}"
  note_font_size 10
  xpos -830
  ypos -664
 }
 StickyNote {
  inputs 0
  name StickyNote3
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.Tonescales.ctl : 271</b><pre>float segmented_spline_c9_fwd\n  ( \n    varying float x,\n    varying SegmentedSplineParams_c9 C = ODT_48nits\n  )\n\{    \n  const int N_KNOTS_LOW = 8;\n  const int N_KNOTS_HIGH = 8;\n\n  // Check for negatives or zero before taking the log. If negative or zero,\n  // set to HALF_MIN.\n  float logx = log10( max(x, HALF_MIN )); \n\n  float logy;\n\n  if ( logx <= log10(C.minPoint.x) ) \{ \n\n    logy = logx * C.slopeLow + ( log10(C.minPoint.y) - C.slopeLow * log10(C.minPoint.x) );\n\n  \} else if (( logx > log10(C.minPoint.x) ) && ( logx < log10(C.midPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.minPoint.x))/(log10(C.midPoint.x)-log10(C.minPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n    \n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else if (( logx >= log10(C.midPoint.x) ) && ( logx < log10(C.maxPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.midPoint.x))/(log10(C.maxPoint.x)-log10(C.midPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else \{ //if ( logIn >= log10(C.maxPoint.x) ) \{ \n\n    logy = logx * C.slopeHigh + ( log10(C.maxPoint.y) - C.slopeHigh * log10(C.maxPoint.x) );\n\n  \}\n\n  return pow10(logy);\n  \n\}"
  note_font_size 10
  xpos -200
  ypos -660
 }
push $N6de4d400
 Reformat {
  type "to box"
  box_width 4
  box_height 4
  box_fixed true
  name Reformat1
  note_font Helvetica
  xpos -1140
  ypos -561
 }
 Fill {
  output rgb
  color {{parent.ssts.mid_lum}}
  name Fill1
  note_font Helvetica
  xpos -1140
  ypos -537
 }
 Group {
  name inv_ssts
  xpos -1140
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} 4.8 {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.ACES_SSTS.AcesSSTSKernel_override_curve_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 expShift R -4 4}
  expShift {{"override_ssts_params ? exposure : 0"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} {lum.1} {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR+(MAX_STOP_RRT-MAX_STOP_SDR)/(log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR))*(log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 4}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2) / 2"} {"(coefsLow.2 + coefsLow.3) / 2"} {"(coefsLow.3 + coefsLow.4) / 2"}}
  addUserKnob {78 KNOT_Y_HIGH n 4}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1) / 2"} {"(coefsHigh.1 + coefsHigh.2) / 2"} {"(coefsHigh.2 + coefsHigh.3) / 2"} {"(coefsHigh.3 + coefsHigh.4) / 2"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6e033000 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6e033000
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6e032800 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6e032400 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6e032000 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6e031c00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -202
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6e031c00
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6e031000 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6e032000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr <= log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg <= log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb <= log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -202
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6e031000
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6e3db400 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -174
  }
set N6e3db000 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -174
  }
set N6e3dac00 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -174
  }
  Dot {
   name Dot19
   xpos 434
   ypos -78
  }
set N6e3da400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow5
   xpos 290
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low5
   xpos 290
   ypos -34
  }
push $N6e3da400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy5
   xpos 400
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals4
   xpos 400
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push 0
push $N6e3db000
  Dot {
   name Dot10
   xpos -6
   ypos -78
  }
set N6e3d9000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow
   xpos -150
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low
   xpos -150
   ypos -34
  }
push $N6e3d9000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy
   xpos -40
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals
   xpos -40
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push $N6e3dac00
  Dot {
   name Dot18
   xpos 214
   ypos -78
  }
set N6e377800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow4
   xpos 70
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low4
   xpos 70
   ypos -34
  }
push $N6e377800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy4
   xpos 180
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals5
   xpos 180
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   name Merge2
   xpos 180
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6e032400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -202
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6e3db400
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6e375000 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -174
  }
set N6e374c00 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -174
  }
set N6e374800 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -174
  }
  Dot {
   name Dot16
   xpos 1204
   ypos -78
  }
set N6e71bc00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow3
   xpos 1060
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low3
   xpos 1060
   ypos -34
  }
push $N6e71bc00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy3
   xpos 1170
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals3
   xpos 1170
   ypos 14
  }
push 0
push $N6e374c00
  Dot {
   name Dot11
   xpos 764
   ypos -78
  }
set N6e71a800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow1
   xpos 620
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low1
   xpos 620
   ypos -34
  }
push $N6e71a800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy1
   xpos 730
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals1
   xpos 730
   ypos 14
  }
push $N6e374800
  Dot {
   name Dot12
   xpos 984
   ypos -78
  }
set N6e719400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow2
   xpos 840
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low2
   xpos 840
   ypos -34
  }
push $N6e719400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy2
   xpos 950
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals2
   xpos 950
   ypos 14
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 950
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6e032800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -202
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6e375000
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -208
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Expression {
  channel0 rgb
  expr0 log(r)/log(2)-log(0.18)/log(2)
  name expShift
  note_font Helvetica
  xpos -1140
  ypos -489
 }
end_group
Constant {
 inputs 0
 channels rgb
 color 1
 name Constant12
 xpos 1366
 ypos 1791
}
set N6e6a4800 [stack 0]
Group {
 name ACES_InvOutputTransform_v1_2_1
 tile_color 0xa57aaaff
 label Rec2020_ST2084_1000nits_15nits
 xpos 1347
 ypos 1904
 addUserKnob {20 ACES_OutputTransform_tab l "ACES OutputTransform"}
 addUserKnob {41 gamut l "out gamut" T GamutToXYZ_lite.gamut}
 addUserKnob {26 ""}
 addUserKnob {35 presets t "display output presets." M {display/sRGB "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB\"\}" "display/sRGB D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB D60 sim.\"\}" display/Rec.709 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709\"\}" "display/Rec.709 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709 D60 sim.\"\}" display/Rec.2020 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 1 limiting_pri 1 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.2020\"\}" display/P3D60 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 4 limiting_pri 4 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D60\"\}" display/P3D65 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65\"\}" "display/P3D65 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 D60 sim.\"\}" display/P3DCI "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI\"\}" "display/P3DCI D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI D60 sim.\"\}" "display/P3DCI D65 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 1 dark_to_dim 0 legal_range 0 label \"P3DCI D65 sim.\"\}" display/DCDM "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 7 limiting_pri 7 eotf 5 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"DCDM\"\}" "display/P3D65 ST2084 108nits 7.2nits" "knobs this \{lum \{0.0001 7.2 108\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 108nits 7.2nits\"\}" "display/P3D65 ST2084 1000nits 15nits" "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 1000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 4000nits 15nits" "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 4000nits 15nits\"\}" display/Rec2020_HLG_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 7 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_HLG_1000nits_15nits\"\}" display/Rec2020_ST2084_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_1000nits_15nits\"\}" display/Rec2020_ST2084_2000nits_15nits "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_2000nits_15nits\"\}" display/Rec2020_ST2084_4000nits_15nits "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_4000nits_15nits\"\}" display/OCES "knobs this \{lum \{0.0001 4.8 10000\} override_ssts_params 0 use_c9 0 display_pri 6 limiting_pri 6 eotf 9 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"OCES\"\}" "" ""}}
 addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
 addUserKnob {78 lum l luminance t "SSTS Output Display Luminance:\nx = y_min / y = y_mid / z = y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\nStandard Cinema\n0.02 / 4.8 / 48\n" n 3}
 lum {0.0001 15 1000}
 addUserKnob {20 ssts_params_grp l "SSTS Parameters" n 1}
 ssts_params_grp 0
 addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
 addUserKnob {35 presets_ssts_param l presets t "If you want to override the default SSTS parameters and play around, here are some useful starting points." M {contrast/default "knobs this \{override_ssts_params 0 pctLow 0.35 pctHigh 0.89 slope \{0.38 1.501 0.01\} exposure 0.0 use_c9 0\}" "contrast/sdr (eye match)" "knobs this \{override_ssts_params 1 pctLow 0.35 pctHigh 0.99 slope \{0.38 1.501 0.1\} exposure 0.0 use_c9 0\}" contrast/high "knobs this \{override_ssts_params 1 pctLow 0.2 pctHigh 0.90 slope \{0.28 1.75 0.01\} exposure 0.0 use_c9 0\}" contrast/med "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.96 slope \{0.38 1.3 0.01\} exposure 0.0 use_c9 0\}" contrast/med-low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.42 0.01\} exposure 0.0 use_c9 0\}" contrast/low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.2 0.01\} exposure 0.0 use_c9 0\}"}}
 addUserKnob {7 exposure R -5 5}
 addUserKnob {7 pctLow l knee}
 pctLow 0.4
 addUserKnob {7 pctHigh l shoulder}
 pctHigh 0.8
 addUserKnob {78 slope n 3}
 slope {0.38 1.42 0.01}
 addUserKnob {20 endGroup n -1}
 addUserKnob {6 use_c9 l "use SegmentedSpline_c9" t "In ACES 1.1 the Output Transform was re-written for HDR tonescales. \n\nIn ACES 1.1, HDR transforms use the new SSTS (Single Stage Tone Scale), while SDR transforms continue to use the old SegmentedSpline_c5 -> OCES -> SegmentedSpline_c9 -> ODT transform.\n\nIf this is enabled, the SegmentedSpline_c9 transform is used to maintain compatibility with the ACES SDR output transforms and enable a 1:1 match with the AMPAS CTL.\n\nIf you are curious, turn use_c9 off and play around with the SSTS Parameters." +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {4 display_pri l "display pri" t "Display encoding primaries." M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 display_pri Rec2020
 addUserKnob {4 limiting_pri l "limiting pri" t "Limiting primaries for the output transform." -STARTLINE M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 limiting_pri Rec2020
 addUserKnob {4 eotf l EOTF t "Electrical to Optical Transfer Function of the monitor." M {sRGB BT.1886 "Gamma 2.2" "Gamma 2.4" "Gamma 2.6" DCDM "ST-2084 (PQ)" HLG Linear OCES ""}}
 eotf "ST-2084 (PQ)"
 addUserKnob {6 stretch_black l "stretch black" t "For hdr outputs: stretch black luminance to a PQ code value of 0" +STARTLINE}
 stretch_black true
 addUserKnob {6 d60_sim l "d60 sim" t "d60 whitepoint simulation." +STARTLINE}
 addUserKnob {6 force_d65_cat l "force d60 to d65 cat" -STARTLINE}
 addUserKnob {6 dark_to_dim l "dark to dim surround" t "Apply gamma adjustment to compensate for \"Dark to Dim\" surround. For SDR outputs only." +STARTLINE}
 addUserKnob {6 legal_range l "legal range" t "Output legal range." +STARTLINE}
}
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x3f3f3f01
  label EOTFs
  note_font_size 42
  xpos 3359
  ypos -1033
  bdwidth 1203
  bdheight 530
  z_order -5
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x3f3f3f01
  label "HDR EOTFs"
  note_font_size 42
  xpos 4605
  ypos -1053
  bdwidth 910
  bdheight 617
  z_order -5
 }
 BackdropNode {
  inputs 0
  name HLG_2_ST2084_1000nits_f3
  tile_color 0x7f7f7f01
  note_font_size 14
  xpos 4975
  ypos -941
  bdwidth 467
  bdheight 420
 }
 BackdropNode {
  inputs 0
  name Output_Legal_Range1
  tile_color 0x232323ff
  label "ACESlib.OutputTransforms.ctl : 216\n"
  note_font_size 12
  xpos 3361
  ypos -1240
  bdwidth 318
  bdheight 176
 }
 Input {
  inputs 0
  name Input
  xpos 3480
  ypos -1570
 }
 AddChannels {
  channels rgba
  name AddChannels
  xpos 3480
  ypos -1498
 }
 Dot {
  name Dot27
  label " Display-Referred IN"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos -1326
 }
set N6e633800 [stack 0]
 Dot {
  name Dot28
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3294
  ypos -1326
 }
 Dot {
  name Dot29
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3294
  ypos 1218
 }
push $N6e633800
 Expression {
  temp_name0 REFBLACK
  temp_expr0 "64 / 1023"
  temp_name1 REFWHITE
  temp_expr1 "940 / 1023"
  expr0 "r * ( REFWHITE - REFBLACK) + REFBLACK"
  expr1 "g * ( REFWHITE - REFBLACK) + REFBLACK"
  expr2 "b * ( REFWHITE - REFBLACK) + REFBLACK"
  name fullRange_to_smpteRange_f3_1
  label "ACESlib.OutputTransforms.ctl : 216"
  xpos 3480
  ypos -1168
  disable {{!parent.legal_range}}
 }
 Dot {
  name Dot30
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos -990
 }
set N6e632800 [stack 0]
push $N6e632800
 Dot {
  name Dot31
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3624
  ypos -990
 }
set N6e632400 [stack 0]
 Dot {
  name Dot32
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3734
  ypos -990
 }
set N6e632000 [stack 0]
 Dot {
  name Dot33
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3844
  ypos -990
 }
set N6e631c00 [stack 0]
 Dot {
  name Dot34
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3954
  ypos -990
 }
set N6e631800 [stack 0]
 Dot {
  name Dot35
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 4064
  ypos -990
 }
set N6e631400 [stack 0]
 Dot {
  name Dot36
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 4174
  ypos -990
 }
set N6e631000 [stack 0]
 Dot {
  name Dot40
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 4781
  ypos -990
 }
set N6e630c00 [stack 0]
 Dot {
  name Dot47
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 5202
  ypos -990
 }
 Expression {
  temp_name0 e
  temp_expr0 2.718281828
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "r >= 0.0 && r <= 0.5 ? pow(r, 2)/3 : (pow(e, (r - c_c)/c_a)+c_b)/12"
  expr1 "g >= 0.0 && g <= 0.5 ? pow(g, 2)/3 : (pow(e, (g - c_c)/c_a)+c_b)/12"
  expr2 "b >= 0.0 && b <= 0.5 ? pow(b, 2)/3 : (pow(e, (b - c_c)/c_a)+c_b)/12"
  expr3 1
  name ST2084_2_HLG_1000nits_f3_2
  label "ACESlib.Utilities_Color.ctl : 533\n// HLG EOTF (non-linear signal value to display linear)"
  xpos 5168
  ypos -910
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 c_a +DISABLED}
  c_a 0.17883277
  addUserKnob {7 c_b t 1.-4.*a +DISABLED}
  c_b 0.28466892
  addUserKnob {7 c_c t 0.5-a*log(4.*a) +DISABLED}
  c_c 0.55991073
 }
 Expression {
  temp_name0 Y_s
  temp_expr0 "0.2627*r + 0.6780*g + 0.0593*b"
  expr0 "c_alpha * pow( Y_s, c_gamma-1.) * r + c_beta"
  expr1 "c_alpha * pow( Y_s, c_gamma-1.) * g + c_beta"
  expr2 "c_alpha * pow( Y_s, c_gamma-1.) * b + c_beta"
  name ST2084_2_HLG_1000nits_f3_1
  label "ACESlib.Utilities_Color.ctl : 550\n// Scene-linear to display-linear"
  xpos 5168
  ypos -860
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 L_w +DISABLED}
  L_w 1000
  addUserKnob {7 L_b +DISABLED}
  addUserKnob {7 c_alpha +DISABLED}
  c_alpha {{L_w-L_b}}
  addUserKnob {7 c_beta +DISABLED}
  c_beta {{L_b}}
  addUserKnob {7 c_gamma +DISABLED}
  c_gamma 1.2
 }
 Expression {
  temp_name0 Lm_r
  temp_expr0 "pow((r / pq_C), pq_m1)"
  temp_name1 Lm_g
  temp_expr1 "pow((g / pq_C), pq_m1)"
  temp_name2 Lm_b
  temp_expr2 "pow((b / pq_C), pq_m1)"
  expr0 "pow(( pq_c1 + pq_c2 * Lm_r ) / ( 1.0 + pq_c3 * Lm_r ), pq_m2)"
  expr1 "pow(( pq_c1 + pq_c2 * Lm_g ) / ( 1.0 + pq_c3 * Lm_g ), pq_m2)"
  expr2 "pow(( pq_c1 + pq_c2 * Lm_b ) / ( 1.0 + pq_c3 * Lm_b ), pq_m2)"
  name Y_2_ST2084_1
  label "ACESlib.OutputTransforms.ctl : 243 \nACESlib.Utilities_Color.ctl : 425"
  xpos 5168
  ypos -790
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Expression {
  temp_name0 Np_r
  temp_expr0 "pow( r, 1.0 / pq_m2 )"
  temp_name1 Np_g
  temp_expr1 "pow( g, 1.0 / pq_m2 )"
  temp_name2 Np_b
  temp_expr2 "pow( b, 1.0 / pq_m2 )"
  expr0 "r < 0 ? 0 : pow((Np_r - pq_c1) / ( pq_c2 - pq_c3 * Np_r ), 1.0/pq_m1) * pq_C"
  expr1 "g < 0 ? 0 : pow((Np_g - pq_c1) / ( pq_c2 - pq_c3 * Np_g ), 1.0/pq_m1) * pq_C"
  expr2 "b < 0 ? 0 : pow((Np_b - pq_c1) / ( pq_c2 - pq_c3 * Np_b ), 1.0/pq_m1) * pq_C"
  name ST2084_2_Y_f3_2
  label "ACESlib.Utilities_Color.ctl : 408\n// Converts from the non-linear perceptually quantized space to linear cd/m^2"
  xpos 5168
  ypos -740
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 5202
  ypos -678
 }
set N6e5ef000 [stack 0]
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_4
  label "stretch_black = True"
  xpos 5058
  ypos -640
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
push $N6e5ef000
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_2
  label "stretch_black = False"
  xpos 5168
  ypos -640
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Switch {
  inputs 2
  which {{parent.stretch_black}}
  name StretchBlacks_Switch3
  xpos 5168
  ypos -562
 }
push $N6e630c00
 Expression {
  temp_name0 Np_r
  temp_expr0 "pow( r, 1.0 / pq_m2 )"
  temp_name1 Np_g
  temp_expr1 "pow( g, 1.0 / pq_m2 )"
  temp_name2 Np_b
  temp_expr2 "pow( b, 1.0 / pq_m2 )"
  expr0 "r < 0 ? 0 : pow((Np_r - pq_c1) / ( pq_c2 - pq_c3 * Np_r ), 1.0/pq_m1) * pq_C"
  expr1 "g < 0 ? 0 : pow((Np_g - pq_c1) / ( pq_c2 - pq_c3 * Np_g ), 1.0/pq_m1) * pq_C"
  expr2 "b < 0 ? 0 : pow((Np_b - pq_c1) / ( pq_c2 - pq_c3 * Np_b ), 1.0/pq_m1) * pq_C"
  name ST2084_2_Y_f3_1
  label "ACESlib.Utilities_Color.ctl : 408\n// Converts from the non-linear perceptually quantized space to linear cd/m^2"
  xpos 4747
  ypos -934
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Dot {
  name Dot46
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 4781
  ypos -846
 }
set N6e5ee000 [stack 0]
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_5
  label "stretch_black = True"
  xpos 4637
  ypos -808
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
push $N6e5ee000
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_1
  label "stretch_black = False"
  xpos 4747
  ypos -808
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Switch {
  inputs 2
  which {{parent.stretch_black}}
  name StretchBlacks_Switch1
  xpos 4747
  ypos -730
 }
 Dot {
  name Dot48
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 4781
  ypos -630
 }
push $N6e631000
 Expression {
  expr0 "(52.37/48.0) * pow( r, 2.6)"
  expr1 "(52.37/48.0) * pow( g, 2.6)"
  expr2 "(52.37/48.0) * pow( b, 2.6)"
  expr3 1
  name dcdm_decode1
  xpos 4140
  ypos -874
 }
push $N6e631400
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_26_1
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.6"
  xpos 4030
  ypos -886
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 0.3846153846
 }
push $N6e631800
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_24_1
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.4"
  xpos 3920
  ypos -886
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 0.4166666667
 }
push $N6e631c00
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_22_1
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.2"
  xpos 3810
  ypos -886
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 0.4545454545
 }
push $N6e632000
 Expression {
  temp_name0 c_a
  temp_expr0 "pow( pow( Lw, 1./gamma) - pow( Lb, 1./gamma), gamma)"
  temp_name1 c_b
  temp_expr1 "pow( Lb, 1./gamma) / ( pow( Lw, 1./gamma) - pow( Lb, 1./gamma))"
  expr0 "c_a * pow( max( r + c_b, 0.), gamma)"
  expr1 "c_a * pow( max( g + c_b, 0.), gamma)"
  expr2 "c_a * pow( max( b + c_b, 0.), gamma)"
  name bt1886_f_f3_1
  label "ACESlib.Utilities_Color.ctl : 301\n// The reference EOTF specified in Rec. ITU-R BT.1886\n// L = a(max\[(V+b),0])^g"
  xpos 3700
  ypos -892
  addUserKnob {20 Luminance}
  addUserKnob {7 Lw R 48 10000}
  Lw 1
  addUserKnob {7 Lb R 0.0001 0.02}
  addUserKnob {7 gamma R 1 4}
  gamma 2.4
 }
push $N6e632400
 Expression {
  temp_name0 fs
  temp_expr0 "(( gamma - 1.0) / offs) * pow( offs * gamma / ( ( gamma - 1.0) * ( 1.0 + offs)), gamma)"
  temp_name1 xb
  temp_expr1 "offs / ( gamma - 1.0)"
  expr0 "r >= xb ? pow( ( r + offs) / ( 1.0 + offs), gamma) : r * fs"
  expr1 "g >= xb ? pow( ( g + offs) / ( 1.0 + offs), gamma) : g * fs"
  expr2 "b >= xb ? pow( ( b + offs) / ( 1.0 + offs), gamma) : b * fs"
  name moncurve_f_f3_1
  label "ACESlib.Utilities_Color.ctl : 260\nmoncurve_f with gamma of 2.4 and offset of 0.055 matches the EOTF found in IEC 61966-2-1:1999 (sRGB)\n// Forward monitor curve"
  xpos 3590
  ypos -892
  addUserKnob {20 Luminance}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
  addUserKnob {7 offs}
  offs 0.055
 }
 Switch {
  inputs 9
  which {{parent.eotf}}
  name EOTF_Switch1
  xpos 3480
  ypos -562
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos -462
 }
set N6e573400 [stack 0]
 Dot {
  name Dot51
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3844
  ypos -462
 }
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96
  temp_name1 NEW_WHT
  temp_expr1 0.918
  expr0 "r / SCALE"
  expr1 "g / SCALE"
  expr2 "b / SCALE"
  name Expression4
  label "// Scale and clamp white to avoid casted highlights due to D60 simulation"
  xpos 3810
  ypos -376
 }
 Expression {
  temp_name0 tr
  temp_expr0 "( 2. * (c_c + r)) / ( -(sqrt( c_b * c_b - 4. * c_a * (c_c + r))) - c_b)"
  temp_name1 tg
  temp_expr1 "( 2. * (c_c + g)) / ( -(sqrt( c_b * c_b - 4. * c_a * (c_c + g))) - c_b)"
  temp_name2 tb
  temp_expr2 "( 2. * (c_c + b)) / ( -(sqrt( c_b * c_b - 4. * c_a * (c_c + b))) - c_b)"
  expr0 "-r < c_y0 ? -c_x0 : -r > c_y1 ? r : -(( tr * ( c_x1 - c_x0)) + c_x0)"
  expr1 "-g < c_y0 ? -c_x0 : -g > c_y1 ? g : -(( tg * ( c_x1 - c_x0)) + c_x0)"
  expr2 "-b < c_y0 ? -c_x0 : -b > c_y1 ? b : -(( tb * ( c_x1 - c_x0)) + c_x0)"
  name roll_white_rev_2
  xpos 3810
  ypos -322
  addUserKnob {20 Params}
  addUserKnob {7 new_wht}
  new_wht 0.918
  addUserKnob {7 c_width}
  c_width 0.5
  addUserKnob {7 c_x0 +DISABLED}
  c_x0 -1
  addUserKnob {7 c_x1 +DISABLED}
  c_x1 {{"c_x0 + c_width"}}
  addUserKnob {7 c_y0 +DISABLED}
  c_y0 {{-new_wht}}
  addUserKnob {7 c_y1 +DISABLED}
  c_y1 {{c_x1}}
  addUserKnob {7 c_m1 +DISABLED}
  c_m1 {{"(c_x1 - c_x0)"}}
  addUserKnob {7 c_a +DISABLED}
  c_a {{"c_y0 - c_y1 + c_m1"}}
  addUserKnob {7 c_b +DISABLED}
  c_b {{"2 * (c_y1 - c_y0) - c_m1"}}
  addUserKnob {7 c_c +DISABLED}
  c_c {{c_y0}}
 }
 Dot {
  name Dot52
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3844
  ypos -246
 }
push $N6e573400
 Switch {
  inputs 2
  which {{"parent.display_pri == 3"}}
  name switch_wp_is_dci_2
  xpos 3480
  ypos -250
 }
 Group {
  name DISPLAY_PRI_to_XYZ
  label "display encoding primaries to CIE XYZ"
  xpos 3480
  ypos -184
  addUserKnob {20 XYZ_2_DISPLAY_PRI_tab l XYZ_2_DISPLAY_PRI}
  addUserKnob {4 display_pri l "display pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  display_pri {{parent.display_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to display primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6e571c00 [stack 0]
push $N6e571c00
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   invert true
   name ColorMatrix3
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6e571c00
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   invert true
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6e571c00
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   invert true
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6e571c00
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   invert true
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6e571c00
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   invert true
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6e571c00
  ColorMatrix {
   matrix {
       {1.71665132 -0.3556708097 -0.2533662617}
       {-0.6666844487 1.616481304 0.01576855592}
       {0.01763986237 -0.04277062416 0.9421030879}
     }
   invert true
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6e571c00
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   invert true
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.display_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Dot {
  name Dot19
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos -126
 }
set N6e4fb400 [stack 0]
 Dot {
  name Dot9
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3624
  ypos -126
 }
set N6e4fb000 [stack 0]
 ColorMatrix {
  matrix {
      {0.9872254133 -0.006114810705 0.01592640579}
      {-0.007603884675 1.001874804 0.005322027951}
      {0.003066040576 -0.005084238946 1.081519246}
    }
  invert true
  name ColorMatrix2
  label "CAT: Bradford\n D60 to D65"
  xpos 3590
  ypos -91
 }
set N6e4fac00 [stack 0]
push $N6e4fb000
 Dot {
  name Dot10
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3734
  ypos -126
 }
push $N6e4fac00
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch
  xpos 3590
  ypos -10
 }
push $N6e4fb400
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_1
  xpos 3480
  ypos -10
 }
 Switch {
  inputs 2
  which {{parent.force_d65_cat}}
  name switch_force_d65_cat
  xpos 3480
  ypos 41
 }
 Dot {
  name Dot39
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos 107
 }
set N6e4fa400 [stack 0]
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 3607
  ypos 97
 }
 Clamp {
  channels {rgba.red -rgba.green -rgba.blue none}
  maximum_enable false
  name ClampMin4
  xpos 3607
  ypos 154
 }
 Expression {
  expr0 "pow(r, 1/DIM_SURROUND_GAMMA)"
  expr1 g
  expr2 b
  channel3 none
  name dim_to_dark
  xpos 3607
  ypos 180
  addUserKnob {20 Params}
  addUserKnob {7 DIM_SURROUND_GAMMA}
  DIM_SURROUND_GAMMA 0.9811
 }
 Colorspace {
  colorspace_in CIE-Yxy
  colorspace_out CIE-XYZ
  name Colorspace4
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos 3607
  ypos 217
 }
push $N6e4fa400
 Switch {
  inputs 2
  which {{"(parent.eotf <= 4) ? parent.dark_to_dim : 0"}}
  name DimToDark_Switch1
  label "enable if sdr\nand dark_to_dim enabled"
  xpos 3480
  ypos 211
 }
 ColorMatrix {
  matrix {
      {1.641023397 -0.3248033226 -0.2364246994}
      {-0.6636629701 1.615331769 0.01675636508}
      {0.01172191743 -0.008284457959 0.9883947968}
    }
  name ColorMatrix10
  label "XYZ to ACEScg"
  xpos 3480
  ypos 333
 }
 Dot {
  name Dot38
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos 415
 }
set N6e4f8c00 [stack 0]
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  invert true
  name ColorMatrix4
  label "// Remove desaturation to compensate \nfor luminance difference"
  xpos 3590
  ypos 399
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.93
 }
push $N6e4f8c00
 Switch {
  inputs 2
  which {{"parent.eotf < 5 && display_pri < 2"}}
  name Switch_eotf
  xpos 3480
  ypos 476
 }
 Dot {
  name Dot17
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos 570
 }
set N6e4f8400 [stack 0]
 Dot {
  name Dot49
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3624
  ypos 570
 }
set N6e47fc00 [stack 0]
 Dot {
  name Dot50
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3734
  ypos 570
 }
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96362
  expr0 "r / SCALE"
  expr1 "g / SCALE"
  expr2 "b / SCALE"
  name mult_f_f3_
  label D65
  xpos 3700
  ypos 608
 }
push $N6e47fc00
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_
  xpos 3590
  ypos 638
 }
 Dot {
  name Dot53
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3624
  ypos 714
 }
push $N6e4f8400
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch2
  xpos 3480
  ypos 710
 }
 Dot {
  name Dot44
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos 810
 }
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_
  xpos 3480
  ypos 854
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Dot {
  name Dot55
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 3514
  ypos 938
 }
set N6e47e400 [stack 0]
 Group {
  name segmented_spline_c9_rev
  xpos 3590
  ypos 974
  addUserKnob {20 segmented_spline_c9_rev_tab l segmented_spline_c9_rev}
  addUserKnob {78 coefsLow n 10}
  coefsLow {-1.698970004 -1.698970004 -1.4779 -1.2291 -0.8648 -0.448 0.00518 0.4511080334 0.9113744414 0.9113744414}
  addUserKnob {78 coefsHigh n 10}
  coefsHigh {0.5154386965 0.8470437783 1.1358 1.3802 1.5197 1.5985 1.6467 1.674609136 1.687873339 1.687873339}
  addUserKnob {12 minPoint}
  minPoint {0.0028799 0.02}
  addUserKnob {12 midPoint}
  midPoint {4.79999924 4.8}
  addUserKnob {12 maxPoint}
  maxPoint {1005.719116 48}
  addUserKnob {7 slopeLow}
  addUserKnob {7 slopeHigh}
  slopeHigh 0.04
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 8
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 8
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 8}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2)/2"} {"(coefsLow.2 + coefsLow.3)/2"} {"(coefsLow.3 + coefsLow.4)/2"} {"(coefsLow.4 + coefsLow.5)/2"} {"(coefsLow.5 + coefsLow.6)/2"} {"(coefsLow.6 + coefsLow.7)/2"} {"(coefsLow.7 + coefsLow.8)/2"}}
  addUserKnob {78 KNOT_Y_HIGH n 8}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1)/2"} {"(coefsHigh.1 + coefsHigh.2)/2"} {"(coefsHigh.2 + coefsHigh.3)/2"} {"(coefsHigh.3 + coefsHigh.4)/2"} {"(coefsHigh.4 + coefsHigh.5)/2"} {"(coefsHigh.5 + coefsHigh.6)/2"} {"(coefsHigh.6 + coefsHigh.7)/2"} {"(coefsHigh.7 + coefsHigh.8)/2"}}
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6e47dc00 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6e47dc00
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6e47d400 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6e47d000 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6e47cc00 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6e47c800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6e47c800
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6e42f800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6e47cc00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr < log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg < log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb < log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6e42f800
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6e42e000 [stack 0]
  Dot {
   name Dot32
   label " "
   xpos -6
   ypos -198
  }
set N6e42dc00 [stack 0]
  Dot {
   name Dot30
   label " "
   xpos -6
   ypos -102
  }
set N6e42d800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "(log10( max(r, 1e-10 )))"
   temp_name1 r0
   temp_expr1 "( logy > KNOT_Y_LOW.0 && logy <= KNOT_Y_LOW.1)"
   temp_name2 r1
   temp_expr2 "( logy > KNOT_Y_LOW.1 && logy <= KNOT_Y_LOW.2)"
   temp_name3 r2
   temp_expr3 "( logy > KNOT_Y_LOW.2 && logy <= KNOT_Y_LOW.3)"
   expr0 "r0 ? coefsLow.0 : r1 ? coefsLow.1 : r2 ? coefsLow.2 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.3 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.4 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.5 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.6 : 0"
   expr1 "r0 ? coefsLow.1 : r1 ? coefsLow.2 : r2 ? coefsLow.3 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.4 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.5 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.6 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.7 : 0"
   expr2 "r0 ? coefsLow.2 : r1 ? coefsLow.3 : r2 ? coefsLow.4 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.5 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.6 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.7 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.8 : 0"
   expr3 "r0 ? 0 : r1 ? 1 : r2 ? 2 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? 3 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? 4 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? 5 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? 6 : 0"
   name inv_cfLow12
   xpos -150
   ypos -106
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos -64
  }
push $N6e42d800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy6
   xpos -40
   ypos -58
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "( 2. * b) / ( -d - g)"
   temp_name3 logx
   temp_expr3 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr0 "isinf(logx) ? 0 : logx"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals6
   xpos -40
   ypos -10
  }
push 0
push $N6e42dc00
  Dot {
   name Dot33
   label " "
   xpos 214
   ypos -198
  }
set N6e42c400 [stack 0]
  Dot {
   name Dot34
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot35
   label " "
   xpos 434
   ypos -102
  }
set N6e7db800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "(log10( max(b, 1e-10 )))"
   temp_name1 r0
   temp_expr1 "( logy > KNOT_Y_LOW.0 && logy <= KNOT_Y_LOW.1)"
   temp_name2 r1
   temp_expr2 "( logy > KNOT_Y_LOW.1 && logy <= KNOT_Y_LOW.2)"
   temp_name3 r2
   temp_expr3 "( logy > KNOT_Y_LOW.2 && logy <= KNOT_Y_LOW.3)"
   expr0 "r0 ? coefsLow.0 : r1 ? coefsLow.1 : r2 ? coefsLow.2 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.3 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.4 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.5 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.6 : 0"
   expr1 "r0 ? coefsLow.1 : r1 ? coefsLow.2 : r2 ? coefsLow.3 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.4 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.5 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.6 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.7 : 0"
   expr2 "r0 ? coefsLow.2 : r1 ? coefsLow.3 : r2 ? coefsLow.4 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.5 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.6 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.7 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.8 : 0"
   expr3 "r0 ? 0 : r1 ? 1 : r2 ? 2 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? 3 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? 4 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? 5 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? 6 : 0"
   name inv_cfLow5
   xpos 290
   ypos -106
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos -64
  }
push $N6e7db800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy8
   xpos 400
   ypos -58
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "( 2. * b) / ( -d - g)"
   temp_name3 logx
   temp_expr3 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "isinf(logx) ? 0 : logx"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals8
   xpos 400
   ypos -10
  }
push $N6e42c400
  Dot {
   name Dot31
   label " "
   xpos 214
   ypos -102
  }
set N6e7da400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "(log10( max(g, 1e-10 )))"
   temp_name1 r0
   temp_expr1 "( logy > KNOT_Y_LOW.0 && logy <= KNOT_Y_LOW.1)"
   temp_name2 r1
   temp_expr2 "( logy > KNOT_Y_LOW.1 && logy <= KNOT_Y_LOW.2)"
   temp_name3 r2
   temp_expr3 "( logy > KNOT_Y_LOW.2 && logy <= KNOT_Y_LOW.3)"
   expr0 "r0 ? coefsLow.0 : r1 ? coefsLow.1 : r2 ? coefsLow.2 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.3 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.4 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.5 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.6 : 0"
   expr1 "r0 ? coefsLow.1 : r1 ? coefsLow.2 : r2 ? coefsLow.3 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.4 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.5 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.6 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.7 : 0"
   expr2 "r0 ? coefsLow.2 : r1 ? coefsLow.3 : r2 ? coefsLow.4 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? coefsLow.5 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? coefsLow.6 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? coefsLow.7 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? coefsLow.8 : 0"
   expr3 "r0 ? 0 : r1 ? 1 : r2 ? 2 : ( logy > KNOT_Y_LOW.3 && logy <= KNOT_Y_LOW.4) ? 3 : ( logy > KNOT_Y_LOW.4 && logy <= KNOT_Y_LOW.5) ? 4 : ( logy > KNOT_Y_LOW.5 && logy <= KNOT_Y_LOW.6) ? 5 : ( logy > KNOT_Y_LOW.6 && logy <= KNOT_Y_LOW.7) ? 6 : 0"
   name inv_cfLow4
   xpos 70
   ypos -106
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos -64
  }
push $N6e7da400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy7
   xpos 180
   ypos -58
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "( 2. * b) / ( -d - g)"
   temp_name3 logx
   temp_expr3 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "isinf(logx) ? 0 : logx"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals7
   xpos 180
   ypos -10
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge4
   xpos 180
   ypos 62
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6e47d000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6e42e000
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6e76f800 [stack 0]
  Dot {
   name Dot36
   label " "
   xpos 764
   ypos -198
  }
set N6e76f400 [stack 0]
  Dot {
   name Dot37
   label " "
   xpos 764
   ypos -102
  }
set N6e76f000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "(log10( max(r, 1e-10 )))"
   temp_name1 r0
   temp_expr1 "( logy > KNOT_Y_HIGH.0 && logy <= KNOT_Y_HIGH.1)"
   temp_name2 r1
   temp_expr2 "( logy > KNOT_Y_HIGH.1 && logy <= KNOT_Y_HIGH.2)"
   temp_name3 r2
   temp_expr3 "( logy > KNOT_Y_HIGH.2 && logy <= KNOT_Y_HIGH.3)"
   expr0 "r0 ? coefsHigh.0 : r1 ? coefsHigh.1 : r2 ? coefsHigh.2 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.3 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.6 : 0"
   expr1 "r0 ? coefsHigh.1 : r1 ? coefsHigh.2 : r2 ? coefsHigh.3 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.6 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.7 : 0"
   expr2 "r0 ? coefsHigh.2 : r1 ? coefsHigh.3 : r2 ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.6 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.7 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.8 : 0"
   expr3 "r0 ? 0 : r1 ? 1 : r2 ? 2 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? 3 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? 4 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? 5 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? 6 : 0"
   name inv_cfLow8
   xpos 620
   ypos -106
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos -64
  }
push $N6e76f000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy9
   xpos 730
   ypos -58
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "( 2. * b) / ( -d - g)"
   temp_name3 logx
   temp_expr3 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr0 "isinf(logx) ? 0 : logx"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals9
   xpos 730
   ypos -10
  }
push 0
push $N6e76f400
  Dot {
   name Dot38
   label " "
   xpos 984
   ypos -198
  }
set N6e76dc00 [stack 0]
  Dot {
   name Dot39
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot40
   label " "
   xpos 1204
   ypos -102
  }
set N6e76d400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "(log10( max(b, 1e-10 )))"
   temp_name1 r0
   temp_expr1 "( logy > KNOT_Y_HIGH.0 && logy <= KNOT_Y_HIGH.1)"
   temp_name2 r1
   temp_expr2 "( logy > KNOT_Y_HIGH.1 && logy <= KNOT_Y_HIGH.2)"
   temp_name3 r2
   temp_expr3 "( logy > KNOT_Y_HIGH.2 && logy <= KNOT_Y_HIGH.3)"
   expr0 "r0 ? coefsHigh.0 : r1 ? coefsHigh.1 : r2 ? coefsHigh.2 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.3 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.6 : 0"
   expr1 "r0 ? coefsHigh.1 : r1 ? coefsHigh.2 : r2 ? coefsHigh.3 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.6 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.7 : 0"
   expr2 "r0 ? coefsHigh.2 : r1 ? coefsHigh.3 : r2 ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.6 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.7 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.8 : 0"
   expr3 "r0 ? 0 : r1 ? 1 : r2 ? 2 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? 3 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? 4 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? 5 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? 6 : 0"
   name inv_cfLow10
   xpos 1060
   ypos -106
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos -64
  }
push $N6e76d400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy10
   xpos 1170
   ypos -58
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "( 2. * b) / ( -d - g)"
   temp_name3 logx
   temp_expr3 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "isinf(logx) ? 0 : logx"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals10
   xpos 1170
   ypos -10
  }
push $N6e76dc00
  Dot {
   name Dot41
   label " "
   xpos 984
   ypos -102
  }
set N6eb0fc00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "(log10( max(g, 1e-10 )))"
   temp_name1 r0
   temp_expr1 "( logy > KNOT_Y_HIGH.0 && logy <= KNOT_Y_HIGH.1)"
   temp_name2 r1
   temp_expr2 "( logy > KNOT_Y_HIGH.1 && logy <= KNOT_Y_HIGH.2)"
   temp_name3 r2
   temp_expr3 "( logy > KNOT_Y_HIGH.2 && logy <= KNOT_Y_HIGH.3)"
   expr0 "r0 ? coefsHigh.0 : r1 ? coefsHigh.1 : r2 ? coefsHigh.2 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.3 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.6 : 0"
   expr1 "r0 ? coefsHigh.1 : r1 ? coefsHigh.2 : r2 ? coefsHigh.3 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.6 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.7 : 0"
   expr2 "r0 ? coefsHigh.2 : r1 ? coefsHigh.3 : r2 ? coefsHigh.4 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? coefsHigh.5 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? coefsHigh.6 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? coefsHigh.7 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? coefsHigh.8 : 0"
   expr3 "r0 ? 0 : r1 ? 1 : r2 ? 2 : ( logy > KNOT_Y_HIGH.3 && logy <= KNOT_Y_HIGH.4) ? 3 : ( logy > KNOT_Y_HIGH.4 && logy <= KNOT_Y_HIGH.5) ? 4 : ( logy > KNOT_Y_HIGH.5 && logy <= KNOT_Y_HIGH.6) ? 5 : ( logy > KNOT_Y_HIGH.6 && logy <= KNOT_Y_HIGH.7) ? 6 : 0"
   name inv_cfLow11
   xpos 840
   ypos -106
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos -64
  }
push $N6eb0fc00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy11
   xpos 950
   ypos -58
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "( 2. * b) / ( -d - g)"
   temp_name3 logx
   temp_expr3 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "isinf(logx) ? 0 : logx"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals11
   xpos 950
   ypos -10
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge5
   xpos 950
   ypos 62
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6e47d400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6e76f800
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
push $N6e47e400
 Switch {
  inputs 2
  which {{parent.use_c9}}
  name Switch_c1
  xpos 3480
  ypos 1022
 }
 ColorMatrix {
  matrix {
      {0.6954522133 0.1406786889 0.163869068}
      {0.04479460046 0.8596710563 0.09553432465}
      {-0.005525867455 0.004025223199 1.001500726}
    }
  name ColorMatrix11
  label "ACEScg to ACES"
  xpos 3480
  ypos 1112
 }
 Switch {
  inputs 2
  which {{parent.eotf==9}}
  name Switch_OCES
  xpos 3480
  ypos 1214
 }
 ColorMatrix {
  matrix {
      {1.451439381 -0.2365107685 -0.2149285674}
      {-0.07655383646 1.176229835 -0.09967593104}
      {0.008316127583 -0.0060324613 0.997716248}
    }
  name ColorMatrix9
  label "ACES to ACEScg"
  xpos 3480
  ypos 1280
 }
 Dot {
  name Dot3
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xff
  xpos 3514
  ypos 1338
 }
set N6eaa6c00 [stack 0]
 Group {
  name inv_ssts
  xpos 3480
  ypos 1382
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} {parent.lum} {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.ACES_SSTS.AcesSSTSKernel_override_curve_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 mid_lum l "mid lum" R 0 20}
  mid_lum {{parent.lum.1}}
  addUserKnob {7 expShift R -4 4}
  expShift {{"(parent.override_ssts_params ? exposure : 0) + (mid_lum<= 4.8 ? 0 : \[sample parent.expShift r 0 0] )"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} 4.8 {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR+(MAX_STOP_RRT-MAX_STOP_SDR)/(log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR))*(log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 4}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2) / 2"} {"(coefsLow.2 + coefsLow.3) / 2"} {"(coefsLow.3 + coefsLow.4) / 2"}}
  addUserKnob {78 KNOT_Y_HIGH n 4}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1) / 2"} {"(coefsHigh.1 + coefsHigh.2) / 2"} {"(coefsHigh.2 + coefsHigh.3) / 2"} {"(coefsHigh.3 + coefsHigh.4) / 2"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6eaa6400 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6eaa6400
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6eaa5c00 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6eaa5800 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6eaa5400 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6eaa5000 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -202
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6eaa5000
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6eaa4400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6eaa5400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr <= log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg <= log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb <= log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -202
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6eaa4400
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6ea46800 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -174
  }
set N6ea46400 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -174
  }
set N6ea46000 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -174
  }
  Dot {
   name Dot19
   xpos 434
   ypos -78
  }
set N6ea45800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow5
   xpos 290
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low5
   xpos 290
   ypos -34
  }
push $N6ea45800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy5
   xpos 400
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals4
   xpos 400
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push 0
push $N6ea46400
  Dot {
   name Dot10
   xpos -6
   ypos -78
  }
set N6ea44400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow
   xpos -150
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low
   xpos -150
   ypos -34
  }
push $N6ea44400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy
   xpos -40
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals
   xpos -40
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push $N6ea46000
  Dot {
   name Dot18
   xpos 214
   ypos -78
  }
set N6e9f6c00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow4
   xpos 70
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low4
   xpos 70
   ypos -34
  }
push $N6e9f6c00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy4
   xpos 180
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals5
   xpos 180
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   name Merge2
   xpos 180
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6eaa5800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -202
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6ea46800
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6e9f4400 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -174
  }
set N6e987c00 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -174
  }
set N6e987800 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -174
  }
  Dot {
   name Dot16
   xpos 1204
   ypos -78
  }
set N6e987000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow3
   xpos 1060
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low3
   xpos 1060
   ypos -34
  }
push $N6e987000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy3
   xpos 1170
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals3
   xpos 1170
   ypos 14
  }
push 0
push $N6e987c00
  Dot {
   name Dot11
   xpos 764
   ypos -78
  }
set N6e985c00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow1
   xpos 620
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low1
   xpos 620
   ypos -34
  }
push $N6e985c00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy1
   xpos 730
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals1
   xpos 730
   ypos 14
  }
push $N6e987800
  Dot {
   name Dot12
   xpos 984
   ypos -78
  }
set N6e984800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow2
   xpos 840
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low2
   xpos 840
   ypos -34
  }
push $N6e984800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy2
   xpos 950
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals2
   xpos 950
   ypos 14
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 950
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6eaa5c00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -202
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6e9f4400
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -208
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  invert true
  name ColorMatrix5
  label "// --- Global desaturation --- //\nrgbPost = mult_f3_f33( rgbPost, invert_f33(RRT_SAT_MAT));"
  xpos 3480
  ypos 1442
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.96
 }
 ColorMatrix {
  matrix {
      {0.6954522133 0.1406786889 0.163869068}
      {0.04479460046 0.8596710563 0.09553432465}
      {-0.005525867455 0.004025223199 1.001500726}
    }
  name ColorMatrix14
  label "ACEScg to ACES"
  xpos 3480
  ypos 1544
 }
 Group {
  name red_modifier
  note_font Helvetica
  xpos 3480
  ypos 1664
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_RED_SCALE}
  RRT_RED_SCALE 0.82
  addUserKnob {7 RRT_RED_PIVOT}
  RRT_RED_PIVOT 0.03
  addUserKnob {7 RRT_RED_HUE}
  addUserKnob {7 RRT_RED_WIDTH R 0 360}
  RRT_RED_WIDTH 135
  addUserKnob {6 invert +STARTLINE}
  invert true
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  Dot {
   name Dot1
   xpos -6
   ypos 42
  }
set N6e8c3000 [stack 0]
  Dot {
   name Dot2
   xpos -226
   ypos 42
  }
set N6e8c2c00 [stack 0]
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   channel0 rgb
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   channel1 none
   expr1 0
   channel2 none
   expr2 0
   name rgb_2_saturation
   xpos -260
   ypos 86
  }
push $N6e8c2c00
  Dot {
   name Dot3
   xpos -336
   ypos 42
  }
  Expression {
   temp_name0 hue
   temp_expr0 "(r==g&&g==b)?0:(180/pi) * atan2( sqrt(3)*(g-b), 2*r-g-b)"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "hue < 0 ? hue + 360 : hue"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_hue
   xpos -370
   ypos 86
  }
  Expression {
   temp_name0 hue
   temp_expr0 r
   temp_name1 centerH
   temp_expr1 RRT_RED_HUE
   temp_name2 hueCentered
   temp_expr2 hue-centerH
   channel0 {-rgba.red rgba.green -rgba.blue -rgba.alpha}
   expr0 "hueCentered < -180.0 ? hueCentered + 360.0 : (hueCentered > 180.0) ? hueCentered - 360.0 : hueCentered"
   name center_hue
   xpos -370
   ypos 134
  }
  Expression {
   temp_name0 centeredHue
   temp_expr0 g
   temp_name1 knot_coord
   temp_expr1 "(centeredHue - knots.0) * 4.0/w"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "(min((centeredHue > knots.0?1:0) , (centeredHue < knots.4?1:0)) ? j == 3 ? t*t*t * -1./6 + t*t * 3./6 +  t * -3./6 + 1 * 1./6 : j == 2 ? t*t*t * 3./6 + t*t * -6./6 + t * 0./6 + 1. *4./6 : j == 1 ? t*t*t * -3./6 + t*t * 3./6 + t * 3./6 + 1. * 1./6 : j == 0 ? t*t*t * 1./6 + t*t * 0./6 + t * 0./6 + 1. * 0./6 : 0 : 0) * 3/2"
   channel1 none
   channel2 none
   name cubic_basis_shaper
   xpos -370
   ypos 182
   addUserKnob {20 param}
   addUserKnob {7 w R 0 360}
   w {{parent.RRT_RED_WIDTH}}
   addUserKnob {78 knots n 5}
   knots {{-w/2} {-w/4} 0 {w/4} {w/2}}
  }
  Dot {
   name Dot4
   xpos -336
   ypos 234
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy4
   note_font Helvetica
   xpos -260
   ypos 226
  }
  Dot {
   name Dot6
   label " r : hueWeight\n g : centeredHue\n b : saturation"
   note_font "Helvetica \[pyrs]"
   note_font_size 12
   note_font_color 0xff
   xpos -226
   ypos 282
  }
  Dot {
   name Dot7
   xpos -226
   ypos 330
  }
set N6e8c0800 [stack 0]
push $N6e8c3000
  Dot {
   name Dot8
   xpos -6
   ypos 258
  }
set N6e8c0400 [stack 0]
  MergeExpression {
   inputs 2
   temp_name0 minChan
   temp_expr0 "Ag < 0 ? Bg : Bb"
   temp_name1 a_
   temp_expr1 "Ar * (1. - RRT_RED_SCALE) - 1."
   temp_name2 b
   temp_expr2 "Br - Ar* (RRT_RED_PIVOT + minChan) * (1. - RRT_RED_SCALE)"
   temp_name3 c
   temp_expr3 "Ar * RRT_RED_PIVOT * minChan * (1. - RRT_RED_SCALE)"
   expr0 "( -b - sqrt( b * b - 4. * a_ * c)) / ( 2. * a_)"
   name red_modifier_rev
   note_font Helvetica
   xpos -150
   ypos 351
  }
push $N6e8c0800
push $N6e8c0400
  MergeExpression {
   inputs 2
   expr0 "r + Ar * Ab * (RRT_RED_PIVOT - r) * (1. - RRT_RED_SCALE)"
   name red_modifier_fwd
   note_font Helvetica
   xpos -40
   ypos 327
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -40
   ypos 423
  }
  Output {
   name Output
   xpos -40
   ypos 494
  }
 end_group
 Group {
  name glow_module
  note_font Helvetica
  xpos 3480
  ypos 1760
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_GLOW_GAIN}
  RRT_GLOW_GAIN 0.05
  addUserKnob {7 RRT_GLOW_MID}
  RRT_GLOW_MID 0.08
  addUserKnob {6 invert +STARTLINE}
  invert true
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -562
  }
  Dot {
   name Dot2
   xpos -6
   ypos -510
  }
set N6e866c00 [stack 0]
  Dot {
   name Dot4
   xpos -116
   ypos -510
  }
set N6e866800 [stack 0]
  Expression {
   temp_name0 chroma
   temp_expr0 sqrt(b*(b-g)+g*(g-r)+r*(r-b))
   temp_name1 ycRadiusWeight
   temp_expr1 1.75
   channel0 {-rgba.red rgba.green -rgba.blue none}
   expr0 "( b + g + r + ycRadiusWeight * chroma) / 3.0"
   channel1 {rgba.red -rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_yc1
   xpos -150
   ypos -466
  }
push 0
push $N6e866800
  Dot {
   name Dot3
   xpos -226
   ypos -510
  }
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   expr1 0
   expr2 0
   name rgb_2_saturation1
   xpos -260
   ypos -466
  }
set N6e865c00 [stack 0]
  Expression {
   channel0 {rgba.red rgba.green rgba.blue none}
   expr0 "(r - 0.4) / 0.2"
   name Expression1
   xpos -370
   ypos -466
  }
  Expression {
   temp_name0 t
   temp_expr0 "max( 1.0 - fabs( r / 2.0), 0.0)"
   temp_name1 sign
   temp_expr1 r>0?1:r<0?-1:0
   temp_name2 valy
   temp_expr2 "1.0 + sign * (1.0 - t * t)"
   channel0 {-rgba.red -rgba.green rgba.blue none}
   expr0 "valy / 2"
   channel1 {rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red rgba.green rgba.blue none}
   expr2 0
   name sigmoid_shaper1
   xpos -370
   ypos -442
  }
push $N6e865c00
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   note_font Helvetica
   xpos -260
   ypos -393
  }
set N6e865000 [stack 0]
  Expression {
   temp_name0 ycOut
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ((ycOut <= ((1 + glowGainIn) * 2./3. * glowMid)) ? -glowGainIn / (1 + glowGainIn) : ( ycOut >= (2. * glowMid)) ? 0 : glowGainIn * (glowMid / ycOut - 1./2.) / (glowGainIn / 2. - 1.))"
   channel1 none
   channel2 none
   name glow_inv
   xpos -150
   ypos -346
  }
push $N6e865000
  Expression {
   temp_name0 ycIn
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ( ycIn <= 2./3. * glowMid ? glowGainIn : ycIn >= 2. * glowMid ? 0 : glowGainIn * (glowMid / ycIn - 1./2.) )"
   channel1 none
   channel2 none
   name glow_fwd
   xpos -370
   ypos -346
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -260
   ypos -297
  }
  Dot {
   name Dot5
   xpos -226
   ypos -246
  }
push $N6e866c00
  Merge2 {
   inputs 2
   operation multiply
   bbox B
   output rgb
   name Merge3
   note_font Helvetica
   xpos -40
   ypos -249
  }
  Output {
   name Output
   xpos -40
   ypos -178
  }
 end_group
 ColorMatrix {
  matrix {
      {0.9525523186 0 9.367861639e-05}
      {0.3439664245 0.7281660438 -0.07213255018}
      {-3.863926779e-08 0 1.008825183}
    }
  name ColorMatrix1
  label "ACES to XYZ"
  note_font Helvetica
  xpos 3480
  ypos 1895
 }
 Group {
  name GamutToXYZ_lite
  xpos 3480
  ypos 1940
  addUserKnob {20 GamutToXYZ_lite_tab l GamutToXYZ_lite}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACEScg
  addUserKnob {6 invert +STARTLINE}
  invert true
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {20 chromaticities_grp l "" +STARTLINE n 1}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {20 endGroup n -1}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Output {
  name Output
  xpos 3480
  ypos 1994
 }
push $N6eaa6c00
 Reformat {
  type "to box"
  box_width 4
  box_height 4
  box_fixed true
  name Reformat1
  note_font Helvetica
  xpos 3590
  ypos 1335
 }
 Fill {
  output rgb
  color {{parent.inv_ssts.mid_lum}}
  name Fill1
  note_font Helvetica
  xpos 3590
  ypos 1359
 }
 Group {
  name inv_ssts1
  xpos 3590
  ypos 1382
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} 4.8 {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.ACES_SSTS.AcesSSTSKernel_override_curve_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 expShift R -4 4}
  expShift {{"override_ssts_params ? exposure : 0"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} {lum.1} {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR+(MAX_STOP_RRT-MAX_STOP_SDR)/(log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR))*(log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 4}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2) / 2"} {"(coefsLow.2 + coefsLow.3) / 2"} {"(coefsLow.3 + coefsLow.4) / 2"}}
  addUserKnob {78 KNOT_Y_HIGH n 4}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1) / 2"} {"(coefsHigh.1 + coefsHigh.2) / 2"} {"(coefsHigh.2 + coefsHigh.3) / 2"} {"(coefsHigh.3 + coefsHigh.4) / 2"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6ebf1000 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6ebf1000
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6ebf0800 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6ebf0400 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6eb9fc00 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6eb9f800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -202
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6eb9f800
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6eb9ec00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6eb9fc00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr <= log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg <= log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb <= log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -202
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6eb9ec00
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6eb9d400 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -174
  }
set N6eb9d000 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -174
  }
set N6eb9cc00 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -174
  }
  Dot {
   name Dot19
   xpos 434
   ypos -78
  }
set N6eb9c400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow5
   xpos 290
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low5
   xpos 290
   ypos -34
  }
push $N6eb9c400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy5
   xpos 400
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals4
   xpos 400
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push 0
push $N6eb9d000
  Dot {
   name Dot10
   xpos -6
   ypos -78
  }
set N6eb62c00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow
   xpos -150
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low
   xpos -150
   ypos -34
  }
push $N6eb62c00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy
   xpos -40
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals
   xpos -40
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push $N6eb9cc00
  Dot {
   name Dot18
   xpos 214
   ypos -78
  }
set N6eb61800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow4
   xpos 70
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low4
   xpos 70
   ypos -34
  }
push $N6eb61800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy4
   xpos 180
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals5
   xpos 180
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   name Merge2
   xpos 180
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6ebf0400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -202
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6eb9d400
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6eee2c00 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -174
  }
set N6eee2800 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -174
  }
set N6eee2400 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -174
  }
  Dot {
   name Dot16
   xpos 1204
   ypos -78
  }
set N6eee1c00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow3
   xpos 1060
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low3
   xpos 1060
   ypos -34
  }
push $N6eee1c00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy3
   xpos 1170
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals3
   xpos 1170
   ypos 14
  }
push 0
push $N6eee2800
  Dot {
   name Dot11
   xpos 764
   ypos -78
  }
set N6eee0800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow1
   xpos 620
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low1
   xpos 620
   ypos -34
  }
push $N6eee0800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy1
   xpos 730
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals1
   xpos 730
   ypos 14
  }
push $N6eee2400
  Dot {
   name Dot12
   xpos 984
   ypos -78
  }
set N6ee87000 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow2
   xpos 840
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low2
   xpos 840
   ypos -34
  }
push $N6ee87000
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy2
   xpos 950
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals2
   xpos 950
   ypos 14
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 950
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6ebf0800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -202
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6eee2c00
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -208
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Expression {
  channel0 rgb
  expr0 log(r)/log(2)-log(0.18)/log(2)
  name expShift
  note_font Helvetica
  xpos 3590
  ypos 1407
 }
end_group
push $N6e6a4800
OCIOColorSpace {
 in_colorspace "Output - Rec.2020 ST2084 (1000 nits)"
 out_colorspace scene_linear
 name OCIOColorSpace31
 xpos 1392
 ypos 1875
}
Ramp {
 inputs 0
 p0 {0 0}
 p1 {{width-1} 0}
 color 184
 name Ramp5
 xpos 1234
 ypos 1863
}
Group {
 name ACES_OutputTransform_v1_2_3
 tile_color 0xa57aaaff
 label Rec2020_ST2084_1000nits_15nits
 xpos 1234
 ypos 1918
 addUserKnob {20 ACES_OutputTransform_tab l "ACES OutputTransform"}
 addUserKnob {41 gamut l "input gamut" T GamutToXYZ_lite.gamut}
 addUserKnob {26 ""}
 addUserKnob {35 presets t "display output presets." M {display/sRGB "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB\"\}" "display/sRGB D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 0 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"sRGB D60 sim.\"\}" display/Rec.709 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709\"\}" "display/Rec.709 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 0 limiting_pri 0 eotf 1 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.709 D60 sim.\"\}" display/Rec.2020 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 1 limiting_pri 1 eotf 1 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 1 legal_range 0 label \"Rec.2020\"\}" display/P3D60 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 4 limiting_pri 4 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D60\"\}" display/P3D65 "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65\"\}" "display/P3D65 D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 2 limiting_pri 2 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 D60 sim.\"\}" display/P3DCI "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI\"\}" "display/P3DCI D60 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 1 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3DCI D60 sim.\"\}" "display/P3DCI D65 sim." "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 3 limiting_pri 3 eotf 4 stretch_black 0 d60_sim 0 force_d65_cat 1 dark_to_dim 0 legal_range 0 label \"P3DCI D65 sim.\"\}" display/DCDM "knobs this \{lum \{0.02 4.8 48\} override_ssts_params 0 use_c9 1 display_pri 7 limiting_pri 7 eotf 5 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"DCDM\"\}" "display/P3D65 ST2084 108nits 7.2nits" "knobs this \{lum \{0.0001 7.2 108\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 108nits 7.2nits\"\}" "display/P3D65 ST2084 1000nits 15nits" "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 1000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 2000nits 15nits" "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 2000nits 15nits\"\}" "display/P3D65 ST2084 4000nits 15nits" "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 2 limiting_pri 2 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"P3D65 ST2084 4000nits 15nits\"\}" display/Rec2020_HLG_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 7 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_HLG_1000nits_15nits\"\}" display/Rec2020_ST2084_1000nits_15nits "knobs this \{lum \{0.0001 15 1000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_1000nits_15nits\"\}" display/Rec2020_ST2084_2000nits_15nits "knobs this \{lum \{0.0001 15 2000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_2000nits_15nits\"\}" display/Rec2020_ST2084_4000nits_15nits "knobs this \{lum \{0.0001 15 4000\} override_ssts_params 0 use_c9 0 display_pri 1 limiting_pri 1 eotf 6 stretch_black 1 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"Rec2020_ST2084_4000nits_15nits\"\}" display/OCES "knobs this \{lum \{0.0001 4.8 10000\} override_ssts_params 0 use_c9 0 display_pri 6 limiting_pri 6 eotf 9 stretch_black 0 d60_sim 0 force_d65_cat 0 dark_to_dim 0 legal_range 0 label \"OCES\"\}" "" ""}}
 addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
 addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
 lum {0.0001 15 1000}
 addUserKnob {20 ssts_params_grp l "SSTS Parameters" n 1}
 ssts_params_grp 0
 addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
 addUserKnob {35 presets_ssts_param l presets t "If you want to override the default SSTS parameters and play around, here are some useful starting points." M {contrast/default "knobs this \{override_ssts_params 0 pctLow 0.35 pctHigh 0.89 slope \{0 1.5 0.\} exposure 0.0 use_c9 0\}" contrast/sdr "knobs this \{override_ssts_params 1 pctLow 0.35 pctHigh 0.89 slope \{0.1 1.6 0.01\} exposure 0.0 use_c9 0\}" contrast/high "knobs this \{override_ssts_params 1 pctLow 0.2 pctHigh 0.89 slope \{0.28 1.75 0.01\} exposure 0.0 use_c9 0\}" contrast/med "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.89 slope \{0.38 1.3 0.01\} exposure 0.0 use_c9 0\}" contrast/med-low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.42 0.01\} exposure 0.0 use_c9 0\}" contrast/low "knobs this \{override_ssts_params 1 pctLow 0.40 pctHigh 0.80 slope \{0.38 1.2 0.01\} exposure 0.0 use_c9 0\}" ""}}
 addUserKnob {7 exposure R -5 5}
 addUserKnob {7 pctLow l knee}
 pctLow 0.35
 addUserKnob {7 pctHigh l shoulder}
 pctHigh 0.89
 addUserKnob {78 slope n 3}
 slope {0.38 1.501 0.01}
 addUserKnob {20 endGroup n -1}
 addUserKnob {6 use_c9 l "use SegmentedSpline_c9" t "In ACES 1.1 the Output Transform was re-written for HDR tonescales. \n\nIn ACES 1.1, HDR transforms use the new SSTS (Single Stage Tone Scale), while SDR transforms continue to use the old SegmentedSpline_c5 -> OCES -> SegmentedSpline_c9 -> ODT transform.\n\nIf this is enabled, the SegmentedSpline_c9 transform is used to maintain compatibility with the ACES SDR output transforms and enable a 1:1 match with the AMPAS CTL.\n\nIf you are curious, turn use_c9 off and play around with the SSTS Parameters." +STARTLINE}
 addUserKnob {26 ""}
 addUserKnob {4 display_pri l "display pri" t "Display encoding primaries." M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 display_pri Rec2020
 addUserKnob {4 limiting_pri l "limiting pri" t "Limiting primaries for the output transform." -STARTLINE M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
 limiting_pri Rec2020
 addUserKnob {4 eotf l EOTF t "Electrical to Optical Transfer Function of the monitor." M {sRGB BT.1886 "Gamma 2.2" "Gamma 2.4" "Gamma 2.6" DCDM "ST-2084 (PQ)" HLG Linear OCES ""}}
 eotf "ST-2084 (PQ)"
 addUserKnob {6 stretch_black l "stretch black" t "For hdr outputs: stretch black luminance to a PQ code value of 0" +STARTLINE}
 stretch_black true
 addUserKnob {6 d60_sim l "d60 sim" t "d60 whitepoint simulation." +STARTLINE}
 addUserKnob {6 force_d65_cat l "force d60 to d65 cat" -STARTLINE}
 addUserKnob {6 dark_to_dim l "dark to dim surround" t "Apply gamma adjustment to compensate for \"Dark to Dim\" surround. For SDR outputs only." +STARTLINE}
 addUserKnob {6 legal_range l "legal range" t "Output legal range." +STARTLINE}
}
 BackdropNode {
  inputs 0
  name Electrical_Optical_Transfer_Function
  tile_color 0x151515ff
  label "ACESlib.OutputTransforms.ctl : 185\n// EOTF"
  note_font_size 12
  xpos -2025
  ypos 2294
  bdwidth 3391
  bdheight 740
  z_order -10
 }
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x272727ff
  label "HDR EOTFs"
  note_font_size 42
  xpos 425
  ypos 2379
  bdwidth 910
  bdheight 617
  z_order -5
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x272727ff
  label "SDR EOTFs"
  note_font_size 42
  xpos -1158
  ypos 2384
  bdwidth 1436
  bdheight 608
  z_order -5
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ
  tile_color 0x555b5cff
  label "ACESlib.OutputTransforms.ctl : 90\n// Rendering primaries to XYZ\n"
  note_font_size 12
  xpos -1400
  ypos 906
  bdwidth 380
  bdheight 156
 }
 BackdropNode {
  inputs 0
  name AP1_to_XYZ1
  tile_color 0x555a5cff
  label "// Apply desaturation to compensate for luminance difference\nlinearCV = mult_f3_f33( linearCV, ODT_SAT_MAT);\n( SDR only)"
  note_font_size 12
  xpos -1412
  ypos 669
  bdwidth 439
  bdheight 186
 }
 BackdropNode {
  inputs 0
  name D60_whitepoint_simulation
  tile_color 0x232323ff
  label "ACESlib.OutputTransforms.ctl : 150\n// Scale to avoid clipping when device calibration is different from D60. \n// To simulate D60, unequal code values are sent to the display.\n"
  note_font_size 12
  xpos -1399
  ypos 176
  bdwidth 818
  bdheight 463
 }
 BackdropNode {
  inputs 0
  name Luminance_to_Linear_Code_Values
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 87\n/*  Scale absolute luminance to linear code value  */\n"
  note_font_size 12
  xpos -1367
  ypos -50
  bdwidth 315
  bdheight 148
 }
 BackdropNode {
  inputs 0
  name Output_Color_Encoding_Specification
  tile_color 0x1d1d1dff
  label "<font size=12>OCES\n<font size=0.1>\n- ACES Output Output Color Encoding Specification \n- An idealized reference display with 0.0001 / 4.8 / 10000 luma\n w/ ACES AP0 Primaries."
  note_font_size 27.4
  xpos -1833
  ypos 2379
  bdwidth 367
  bdheight 377
 }
 BackdropNode {
  inputs 0
  name Output_Legal_Range
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 216\n"
  note_font_size 12
  xpos -1369
  ypos 3128
  bdwidth 318
  bdheight 176
 }
 BackdropNode {
  inputs 0
  name Single_Stage_Tone_Scale
  tile_color 0x272727ff
  label "<b>Single Stage Tone Scale : ACESlib.OutputTransforms.ctl : 82</b><pre>// Apply the tonescale independently in rendering-space RGB\nfloat rgbPost\[3] = ssts_f3( rgbPre, PARAMS);\n\nIf output is SDR, output OCES from SSTS and use SegmentedSpline_c9."
  note_font_size 12
  xpos -1502
  ypos -653
  bdwidth 609
  bdheight 533
 }
 BackdropNode {
  inputs 0
  name clamp_negatives
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 174\n// Clip values < 0 (i.e. projecting outside the display primaries)\nNote: Also clamping values > 1 here."
  note_font_size 12
  xpos -1393
  ypos 2087
  bdwidth 386
  bdheight 120
 }
 BackdropNode {
  inputs 0
  name dim_surround_gamma_adjustment
  tile_color 0x272727ff
  label "ACESlib.OutputTransforms.ctl : 92\n// Apply gamma adjustment to compensate for dim surround\n"
  note_font_size 12
  xpos -1407
  ypos 1063
  bdwidth 395
  bdheight 258
 }
 BackdropNode {
  inputs 0
  name limit_primaries
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n// Gamut limit to limiting primaries\n"
  note_font_size 12
  xpos -1408
  ypos 1655
  bdwidth 396
  bdheight 194
 }
 BackdropNode {
  inputs 0
  name limit_primaries1
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 144\n// CIE XYZ to display encoding primaries\n"
  note_font_size 12
  xpos -1402
  ypos 1892
  bdwidth 384
  bdheight 151
 }
 BackdropNode {
  inputs 0
  name limit_primaries2
  tile_color 0x555a5cff
  label "ACESlib.OutputTransforms.ctl : 130\n    // Apply CAT from ACES white point to assumed observer adapted white point\n    // TODO: Needs to expand from just supporting D60 sim to allow for any\n    // observer adapted white point.\n"
  note_font_size 12
  xpos -1407
  ypos 1337
  bdwidth 467
  bdheight 301
 }
 BackdropNode {
  inputs 0
  name rrt_sweeteners_
  tile_color 0x555a5cff
  label "<b>RRT Sweeteners : ACESlib.OutputTransforms.ctl : 79</b><pre>// RRT sweeteners\nfloat rgbPre\[3] = rrt_sweeteners( in);\n"
  note_font_size 18
  xpos -1469
  ypos -1234
  bdwidth 519
  bdheight 548
 }
 Input {
  inputs 0
  name Input
  xpos -1250
  ypos -1450
 }
 AddChannels {
  channels rgba
  name AddChannels
  xpos -1250
  ypos -1415
 }
 Group {
  name GamutToXYZ_lite
  xpos -1250
  ypos -1373
  addUserKnob {20 GamutToXYZ_lite_tab l GamutToXYZ_lite}
  addUserKnob {4 gamut t "Choose gamut" M {XYZ ACES ACEScg "Filmlight E-Gamut" "DaVinci WG" Rec709 Rec2020 P3D60 P3D65 P3DCI "Arri AlexaWideGamut" REDDRAGONcolor REDDRAGONcolor2 REDcolor REDcolor2 REDcolor3 REDcolor4 REDWideGamutRGB "GoPro Protune Native" CanonCinemaGamut SonySGamut SonySGamut3Cine PanasonicVGamut "DJI D-Gamut" "Fujifilm F-Gamut" BMDFilmV1 BMD4kFilmV1 BMD4kFilmV3 BMD46kFilmV1 BMD46kFilmV3 BMDWideGamutV4 "AdobeRGB\t" AdobeWideGamutRGB ROMM RIMM ERIMM ProPhotoRGB RusselRGB SharpRGB AppleRGB BestRGB}}
  gamut ACES
  addUserKnob {6 invert +STARTLINE}
  addUserKnob {26 ""}
  addUserKnob {26 chromaticity_coordinates_label l " " T "<b>Chromaticity Coordinates</b>"}
  addUserKnob {20 chromaticities_grp l "" +STARTLINE n 1}
  addUserKnob {41 rxy T ColorMatrix.rxy}
  addUserKnob {41 gxy T ColorMatrix.gxy}
  addUserKnob {41 bxy T ColorMatrix.bxy}
  addUserKnob {41 wxy T ColorMatrix.wxy}
  addUserKnob {41 matrix T ColorMatrix.matrix}
  addUserKnob {20 endGroup n -1}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  ColorMatrix {
   matrix {
       {{curve(which) 1 0.9525524378 0.6624541879 0.7053968906 0.4123907983 0.6369580626 0.5049495697 0.4865709841 0.4451698363 0.6380076408 0.5070186853 0.4462202489 0.4300414324 0.4581649601 0.4878340662 0.4517004192 0.7352752686 0.5022571683 0.7160496712 0.7064827085 0.5990839601 0.6796444654 0.6481720209 0.6369580626 0.6390493512 0.6141571999 0.3724023998 0.60689044 0.4017650783 0.6065810919 0.5766690373 0.7165006995 0.797760427 0.797760427 0.797760427 0.7976718545 0.7015837431 0.8156226277 0.4496616423 0.6318944097} {curve(which) 0 0 0.1340042055 0.1640413404 0.3575843275 0.1446169019 0.2646814585 0.2656676769 0.2771343887 0.2147038579 0.3587769568 0.3157556653 0.3700728714 0.3832037449 0.3432727158 0.3178463876 0.06860940903 0.2929667532 0.1296834797 0.1288010478 0.2489254922 0.1522114277 0.1940581352 0.1446169019 0.1578372866 0.2825684249 0.4324877858 0.2193847299 0.4560420811 0.2203479856 0.1855582297 0.1010205746 0.1351858526 0.1351858526 0.1351858526 0.1351878047 0.1554162204 0.04716260359 0.3162561059 0.2053879201} {curve(which) 0 9.367863095e-05 0.1561876982 0.08101774752 0.180480808 0.1688809693 0.1830150485 0.1982172877 0.1722826511 0.09774444997 0.0868505761 0.190669477 0.152531758 0.1112773567 0.1215386018 0.1830992699 0.1465712637 0.1552320272 0.1047228053 0.1151721701 0.1024464965 0.1186000481 0.108225815 0.1688809693 0.1516760886 0.05183707923 0.1436725408 0.124180764 0.09264881909 0.123526901 0.1882286519 0.1467743814 0.03134934977 0.03134934977 0.03134934977 0.03133957833 0.09979832917 0.1372147948 0.1845382005 0.1270133406}}
       {{curve(which) 0 0.3439664543 0.2722287476 0.2801307142 0.2126390189 0.2627002299 0.237623319 0.2289745659 0.209491685 0.2919537723 0.2207257152 0.1942579001 0.2022213936 0.1694435924 0.2289056629 0.2119505703 0.2866941094 0.1387997568 0.2612613738 0.2709796727 0.2150758505 0.2606855333 0.2830046713 0.2627002299 0.1743051857 0.2365771234 0.1383759677 0.1973138005 0.1721783578 0.2680045366 0.2973450124 0.258728236 0.2880711257 0.2880711257 0.2880711257 0.2880405784 0.3152042925 0.3790788651 0.2446159422 0.2276017666} {curve(which) 1 0.7281661034 0.6740817428 0.8202066422 0.7151686549 0.6779980659 0.6891706586 0.6917385459 0.7215952873 0.8238410354 0.839184761 0.7385566831 0.7585275769 0.8648257852 0.7808576822 0.7230190039 0.8429791331 0.910841465 0.8696421385 0.786606431 0.8850684762 0.7748944759 0.8131960034 0.6779980659 0.951146543 0.8896810412 0.911518693 0.943950057 0.8553914428 0.8326833844 0.6273635626 0.7246823311 0.7118432522 0.7118432522 0.7118432522 0.7118694782 0.6648360491 0.5769088268 0.6720442176 0.7383946776} {curve(which) 0 -0.07213255018 0.05368951708 -0.1003373638 0.07219231874 0.05930171534 0.07320601493 0.07928691059 0.06891305745 -0.1157948226 -0.05991046131 0.06718540192 0.03925102949 -0.03426937759 -0.009763340466 0.06503042579 -0.1296732277 -0.04964122549 -0.1309035122 -0.05758608505 -0.1001443192 -0.03558001295 -0.09620071948 0.05930171534 -0.1254517138 -0.1262581497 -0.04989464581 -0.1412638426 -0.02756982669 -0.1006879359 0.07529145479 0.01658944227 8.565396274e-05 8.565396274e-05 8.565396274e-05 8.991353388e-05 0.01995966583 0.04401229322 0.08333983272 0.0340035744}}
       {{curve(which) 0 -3.863927134e-08 -0.005574660841 -0.1037815213 0.01933082007 0 0 0 0 0.0027982709 -0.0544523783 -0.04792318866 -0.0176958181 -0.1061859056 -0.02100777067 -0.01945115253 -0.07968087494 0.07801423222 -0.009676366113 -0.009677864611 -0.03206583485 -0.009310216643 -0.01825834997 0 -0.11669112 -0.02325225808 -0.1602820009 -0.1427432895 -0.10720893 -0.02941203304 0.02703136392 -2.906408625e-08 -3.236030111e-08 -3.236030111e-08 -3.236030111e-08 0 0 -0.01229703799 0.02518104948 0} {curve(which) 0 0 0.004060741514 -0.07290724665 0.1191947311 0.0280726999 0.0449459292 0.04511339962 0.04706057906 -0.06703422964 -0.0003228379355 -0.0002844714036 0.08768811822 0.02554347552 0.01782695204 0.01650637016 -0.3473432064 -0.3148325086 -0.2364816219 0.004600019194 -0.02765839547 -0.004612449091 -0.08316776901 0.0280726999 -0.5518454909 -0.4897170365 -0.171635136 -0.4278847873 0.07809129357 -0.08659287542 0.07068887353 0.05121183768 1.2621717e-08 1.2621717e-08 1.2621717e-08 -1.262213711e-08 0.04317118227 0.01672476344 0.1411857158 0.01001892332} {curve(which) 1 1.008825183 1.010339141 1.265746474 0.950532198 1.060985088 0.9638792276 1.043944359 0.9073553085 1.153293729 1.063571215 1.057001948 0.9388025999 1.089437366 1.01197505 1.011739731 1.51608181 1.325875998 1.335215807 1.094135642 1.148782015 1.102980375 1.190483928 1.060985088 1.745692492 1.590125084 1.409072995 1.65968585 1.118175387 1.205062628 0.9913375378 0.7738927603 0.8251045942 0.8251045942 0.8251045942 0.8248898983 0.8782252669 0.9955722094 0.9226909876 0.8150856495}}
     }
   invert {{parent.invert}}
   name ColorMatrix
   label "RGB to XYZ"
   xpos -40
   ypos 32
   addUserKnob {20 Gamut}
   addUserKnob {3 which}
   which {{parent.gamut}}
   addUserKnob {12 rxy}
   rxy {{curve(which) 1 0.7347 0.713 0.8 0.8 0.64 0.708 0.68 0.68 0.68 0.684 0.7530442228 0.7530444911 0.6997470013 0.8786825105 0.7011810359 0.7011805919 0.780308 0.69848046 0.74 0.73 0.766 0.73 0.71 0.708 0.9173 0.7422 1.0625 0.9175 0.8608 0.7177 0.64 0.7347 0.7347 0.7347 0.7347 0.734699 0.69 0.6898 0.625 0.7351916376} {curve(which) 0 0.2653 0.293 0.3177 0.313 0.33 0.292 0.32 0.32 0.32 0.313 0.3278305767 0.3278310295 0.3290469303 0.3249640074 0.3290141556 0.3290136991 0.304253 0.19302645 0.27 0.28 0.275 0.28 0.31 0.292 0.2502 0.2859 0.3948 0.2983 0.3689 0.3171 0.33 0.2653 0.2653 0.2653 0.2653 0.265301 0.31 0.3206 0.34 0.2648083624}}
   addUserKnob {12 gxy}
   gxy {{curve(which) 0 0 0.165 0.18 0.1682 0.3 0.17 0.265 0.265 0.265 0.221 0.2995702285 0.2995704905 0.304264039 0.3008887144 0.3006003047 0.3006003955 0.121595 0.32955538 0.17 0.14 0.225 0.165 0.21 0.17 0.2833 0.414 0.3689 0.2983 0.3282 0.228 0.21 0.1152 0.1596 0.1596 0.1596 0.159597 0.18 0.0736 0.28 0.2153361345} {curve(which) 1 1 0.83 0.9 0.9877 0.6 0.797 0.69 0.69 0.69 0.848 0.700699322 0.7006994156 0.6236411451 0.6790547558 0.6837888343 0.6837888243 1.493994 1.02459662 1.14 0.855 0.8 0.84 0.88 0.797 1.7072 1.3035 0.7775 1.2835 0.6156 0.8616 0.71 0.8264 0.8404 0.8404 0.8404 0.840403 0.77 0.9003 0.595 0.7741596639}}
   addUserKnob {12 bxy}
   bxy {{curve(which) 0 0.0001 0.128 0.065 0.079 0.15 0.131 0.15 0.15 0.15 0.0861 0.07964206674 0.1450115843 0.1349139613 0.09539869461 0.1081544556 0.1453319462 0.095612 0.10844263 0.08 0.1 0.089 0.1 0.09 0.131 0.0856 0.0342 0.0956 0.0756 0.0783 0.1006 0.15 0.1566 0.0366 0.0366 0.0366 0.036598 0.1 0.1166 0.155 0.1301229508} {curve(which) 0 -0.077 0.044 -0.0805 -0.1155 0.06 0.046 0.06 0.06 0.06 -0.102 -0.05493795109 0.05109712509 0.03471744128 -0.02937932683 -0.008688175787 0.05161680362 -0.084589 -0.03467857 -0.1 -0.05 -0.087 -0.03 -0.08 0.046 -0.0708 -0.0833 -0.0332 -0.086 -0.0233 -0.082 0.06 0.0177 0.0001 0.0001 0.0001 0.000105 0.02 0.0374 0.07 0.03483606557}}
   addUserKnob {12 wxy}
   wxy {{curve(which) 0.33333333 0.32168 0.32168 0.3127 0.3127 0.3127 0.3127 0.32168 0.3127 0.314 0.3127 0.3216831877 0.3216832104 0.3216832894 0.3216832894 0.3216832104 0.3216832894 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3127 0.3135 0.3135 0.3135 0.3127 0.3127 0.3127 0.3127 0.3457 0.3457 0.3457 0.3457 0.345704 0.33243 0.33333333 0.3127 0.3457} {curve(which) 0.33333333 0.33767 0.33767 0.329 0.329 0.329 0.329 0.33767 0.329 0.351 0.329 0.337673316 0.3376736101 0.3376734472 0.3376734472 0.3376736101 0.3376734472 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.329 0.3305 0.3305 0.3305 0.329 0.329 0.329 0.329 0.3585 0.3585 0.3585 0.3585 0.35854 0.34744 0.33333333 0.329 0.3585}}
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 ColorMatrix {
  matrix {
      {1.049811006 0 -9.748453158e-05}
      {-0.4959030151 1.373313069 0.09824004024}
      {4.020908051e-08 0 0.9912520051}
    }
  name ColorMatrix4
  label "XYZ to ACES"
  note_font Helvetica
  xpos -1250
  ypos -1338
 }
 Dot {
  name Dot7
  label " ACES 2065-1 IN"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -1268
 }
 Group {
  name glow_module1
  note_font Helvetica
  xpos -1250
  ypos -1089
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_GLOW_GAIN}
  RRT_GLOW_GAIN 0.05
  addUserKnob {7 RRT_GLOW_MID}
  RRT_GLOW_MID 0.08
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -562
  }
  Dot {
   name Dot2
   xpos -6
   ypos -510
  }
set N6ed67800 [stack 0]
  Dot {
   name Dot4
   xpos -116
   ypos -510
  }
set N6ed67400 [stack 0]
  Expression {
   temp_name0 chroma
   temp_expr0 sqrt(b*(b-g)+g*(g-r)+r*(r-b))
   temp_name1 ycRadiusWeight
   temp_expr1 1.75
   channel0 {-rgba.red rgba.green -rgba.blue none}
   expr0 "( b + g + r + ycRadiusWeight * chroma) / 3.0"
   channel1 {rgba.red -rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_yc1
   xpos -150
   ypos -466
  }
push 0
push $N6ed67400
  Dot {
   name Dot3
   xpos -226
   ypos -510
  }
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   expr1 0
   expr2 0
   name rgb_2_saturation1
   xpos -260
   ypos -466
  }
set N6ed66800 [stack 0]
  Expression {
   channel0 {rgba.red rgba.green rgba.blue none}
   expr0 "(r - 0.4) / 0.2"
   name Expression1
   xpos -370
   ypos -466
  }
  Expression {
   temp_name0 t
   temp_expr0 "max( 1.0 - fabs( r / 2.0), 0.0)"
   temp_name1 sign
   temp_expr1 r>0?1:r<0?-1:0
   temp_name2 valy
   temp_expr2 "1.0 + sign * (1.0 - t * t)"
   channel0 {-rgba.red -rgba.green rgba.blue none}
   expr0 "valy / 2"
   channel1 {rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red rgba.green rgba.blue none}
   expr2 0
   name sigmoid_shaper1
   xpos -370
   ypos -442
  }
push $N6ed66800
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   note_font Helvetica
   xpos -260
   ypos -393
  }
set N6ed65c00 [stack 0]
  Expression {
   temp_name0 ycOut
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ((ycOut <= ((1 + glowGainIn) * 2./3. * glowMid)) ? -glowGainIn / (1 + glowGainIn) : ( ycOut >= (2. * glowMid)) ? 0 : glowGainIn * (glowMid / ycOut - 1./2.) / (glowGainIn / 2. - 1.))"
   channel1 none
   channel2 none
   name glow_inv
   xpos -150
   ypos -346
  }
push $N6ed65c00
  Expression {
   temp_name0 ycIn
   temp_expr0 g
   temp_name1 glowGainIn
   temp_expr1 "RRT_GLOW_GAIN * b"
   temp_name2 glowMid
   temp_expr2 RRT_GLOW_MID
   channel0 rgb
   expr0 "1 + ( ycIn <= 2./3. * glowMid ? glowGainIn : ycIn >= 2. * glowMid ? 0 : glowGainIn * (glowMid / ycIn - 1./2.) )"
   channel1 none
   channel2 none
   name glow_fwd
   xpos -370
   ypos -346
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -260
   ypos -297
  }
  Dot {
   name Dot5
   xpos -226
   ypos -246
  }
push $N6ed67800
  Merge2 {
   inputs 2
   operation multiply
   bbox B
   output rgb
   name Merge3
   note_font Helvetica
   xpos -40
   ypos -249
  }
  Output {
   name Output
   xpos -40
   ypos -178
  }
 end_group
 Group {
  name red_modifier1
  note_font Helvetica
  xpos -1250
  ypos -1041
  addUserKnob {20 Params_tab l Params}
  addUserKnob {7 RRT_RED_SCALE}
  RRT_RED_SCALE 0.82
  addUserKnob {7 RRT_RED_PIVOT}
  RRT_RED_PIVOT 0.03
  addUserKnob {7 RRT_RED_HUE}
  addUserKnob {7 RRT_RED_WIDTH R 0 360}
  RRT_RED_WIDTH 135
  addUserKnob {6 invert +STARTLINE}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  Dot {
   name Dot1
   xpos -6
   ypos 42
  }
set N6ed03c00 [stack 0]
  Dot {
   name Dot2
   xpos -226
   ypos 42
  }
set N6ed03800 [stack 0]
  Expression {
   temp_name0 TINY
   temp_expr0 1e-10
   temp_name1 min_f3
   temp_expr1 min(r,min(g,b))
   temp_name2 max_f3
   temp_expr2 max(r,max(g,b))
   channel0 rgb
   expr0 "(max( max_f3, TINY) - max( min_f3, TINY)) / max( max_f3, 1e-2)"
   channel1 none
   expr1 0
   channel2 none
   expr2 0
   name rgb_2_saturation
   xpos -260
   ypos 86
  }
push $N6ed03800
  Dot {
   name Dot3
   xpos -336
   ypos 42
  }
  Expression {
   temp_name0 hue
   temp_expr0 "(r==g&&g==b)?0:(180/pi) * atan2( sqrt(3)*(g-b), 2*r-g-b)"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "hue < 0 ? hue + 360 : hue"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   expr2 0
   name rgb_2_hue
   xpos -370
   ypos 86
  }
  Expression {
   temp_name0 hue
   temp_expr0 r
   temp_name1 centerH
   temp_expr1 RRT_RED_HUE
   temp_name2 hueCentered
   temp_expr2 hue-centerH
   channel0 {-rgba.red rgba.green -rgba.blue -rgba.alpha}
   expr0 "hueCentered < -180.0 ? hueCentered + 360.0 : (hueCentered > 180.0) ? hueCentered - 360.0 : hueCentered"
   name center_hue
   xpos -370
   ypos 134
  }
  Expression {
   temp_name0 centeredHue
   temp_expr0 g
   temp_name1 knot_coord
   temp_expr1 "(centeredHue - knots.0) * 4.0/w"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   channel0 {rgba.red -rgba.green -rgba.blue -rgba.alpha}
   expr0 "(min((centeredHue > knots.0?1:0) , (centeredHue < knots.4?1:0)) ? j == 3 ? t*t*t * -1./6 + t*t * 3./6 +  t * -3./6 + 1 * 1./6 : j == 2 ? t*t*t * 3./6 + t*t * -6./6 + t * 0./6 + 1. *4./6 : j == 1 ? t*t*t * -3./6 + t*t * 3./6 + t * 3./6 + 1. * 1./6 : j == 0 ? t*t*t * 1./6 + t*t * 0./6 + t * 0./6 + 1. * 0./6 : 0 : 0) * 3/2"
   channel1 none
   channel2 none
   name cubic_basis_shaper
   xpos -370
   ypos 182
   addUserKnob {20 param}
   addUserKnob {7 w R 0 360}
   w {{parent.RRT_RED_WIDTH}}
   addUserKnob {78 knots n 5}
   knots {{-w/2} {-w/4} 0 {w/4} {w/2}}
  }
  Dot {
   name Dot4
   xpos -336
   ypos 234
  }
  Copy {
   inputs 2
   from0 rgba.blue
   to0 rgba.blue
   name Copy4
   note_font Helvetica
   xpos -260
   ypos 226
  }
  Dot {
   name Dot6
   label " r : hueWeight\n g : centeredHue\n b : saturation"
   note_font "Helvetica \[pyrs]"
   note_font_size 12
   note_font_color 0xff
   xpos -226
   ypos 282
  }
  Dot {
   name Dot7
   xpos -226
   ypos 330
  }
set N6ed01400 [stack 0]
push $N6ed03c00
  Dot {
   name Dot8
   xpos -6
   ypos 258
  }
set N6ed01000 [stack 0]
  MergeExpression {
   inputs 2
   temp_name0 minChan
   temp_expr0 "Ag < 0 ? Bg : Bb"
   temp_name1 a_
   temp_expr1 "Ar * (1. - RRT_RED_SCALE) - 1."
   temp_name2 b
   temp_expr2 "Br - Ar* (RRT_RED_PIVOT + minChan) * (1. - RRT_RED_SCALE)"
   temp_name3 c
   temp_expr3 "Ar * RRT_RED_PIVOT * minChan * (1. - RRT_RED_SCALE)"
   expr0 "( -b - sqrt( b * b - 4. * a_ * c)) / ( 2. * a_)"
   name red_modifier_rev
   note_font Helvetica
   xpos -150
   ypos 351
  }
push $N6ed01400
push $N6ed01000
  MergeExpression {
   inputs 2
   expr0 "r + Ar * Ab * (RRT_RED_PIVOT - r) * (1. - RRT_RED_SCALE)"
   name red_modifier_fwd
   note_font Helvetica
   xpos -40
   ypos 327
  }
  Switch {
   inputs 2
   which {{parent.invert}}
   name Switch_direction
   note_font Helvetica
   xpos -40
   ypos 423
  }
  Output {
   name Output
   xpos -40
   ypos 494
  }
 end_group
 Clamp {
  channels rgb
  maximum_enable false
  name clamp_f3_min
  label "Clamp Negative Values"
  xpos -1250
  ypos -976
 }
 ColorMatrix {
  matrix {
      {1.451439381 -0.2365107685 -0.2149285674}
      {-0.07655383646 1.176229835 -0.09967593104}
      {0.008316127583 -0.0060324613 0.997716248}
    }
  name ColorMatrix15
  label "ACES to ACEScg"
  xpos -1250
  ypos -928
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3_
  label "clamp to HALF_MAX"
  xpos -1250
  ypos -880
 }
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix
  label "// --- Global desaturation --- //\nrgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);"
  xpos -1250
  ypos -790
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.96
 }
 Dot {
  name Dot29
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xff
  xpos -1216
  ypos -558
 }
set N6ec9ec00 [stack 0]
 Group {
  name ssts
  xpos -1250
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {26 display_label l " " T "<b>Display Settings</b>"}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} {parent.lum} {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.override_ssts_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 mid_lum l "mid lum" R 0 20}
  mid_lum {{parent.lum.1}}
  addUserKnob {7 expShift R -4 4}
  expShift {{"(parent.override_ssts_params ? exposure : 0) + (mid_lum<= 4.8 ? 0 : \[sample parent.expShift r 0 0] )"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} 4.8 {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR + (MAX_STOP_RRT-MAX_STOP_SDR) / (log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR)) * (log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6ec9e400 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6ec9e400
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6ec9dc00 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6ec9d800 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6ec9d400 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6ec9d000 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6ec9d000
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6ec9c400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr1 "logg * minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr2 "logb* minPoint.z + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6ec9d400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6ec9c400
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6ec52800 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N6ec52400 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N6ec52000 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N6ec51800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression5
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N6ec51800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N6ec52000
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N6ec50400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression3
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N6ec50400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N6ec52400
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N6effac00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : 0"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.4 : 0"
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N6effac00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6ec9d800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6ec52800
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6eff8400 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N6ef93c00 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N6ef93800 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N6ef93000 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression11
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N6ef93000
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N6ef93800
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N6ef91c00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression9
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N6ef91c00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N6ef93c00
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N6ef90800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : 0"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.4 : 0"
   expr3 j
   name Expression7
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N6ef90800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6ec9dc00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6eff8400
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr1 "logg * maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr2 "logb* maxPoint.z + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -160
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Dot {
   name Dot30
   xpos 1534
   ypos 810
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Dot {
  name Dot23
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -462
 }
set N6f2b7800 [stack 0]
 Dot {
  name Dot22
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos -462
 }
 ColorMatrix {
  matrix {
      {0.6954522133 0.1406786889 0.163869068}
      {0.04479461163 0.8596711159 0.09553432465}
      {-0.005525866989 0.004025223665 1.001500726}
    }
  name ColorMatrix7
  label "ACEScg to ACES"
  note_font Helvetica
  xpos -1690
  ypos -398
 }
 Dot {
  name Dot21
  label " OCES"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1656
  ypos 2658
 }
push $N6f2b7800
 Dot {
  name Dot28
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos -342
 }
set N6f2b6800 [stack 0]
 Group {
  name segmented_spline_c9_fwd
  xpos -1140
  ypos -346
  addUserKnob {20 SegmentedSplineParams_c9_tab l SegmentedSplineParams_c9}
  addUserKnob {78 coefsLow n 10}
  coefsLow {-1.698970004 -1.698970004 -1.4779 -1.2291 -0.8648 -0.448 0.00518 0.4511080334 0.9113744414 0.9113744414}
  addUserKnob {78 coefsHigh n 10}
  coefsHigh {0.5154386965 0.8470437783 1.1358 1.3802 1.5197 1.5985 1.6467 1.674609136 1.687873339 1.687873339}
  addUserKnob {12 minPoint}
  minPoint {0.0028799 0.02}
  addUserKnob {12 midPoint}
  midPoint {4.79999924 4.8}
  addUserKnob {12 maxPoint}
  maxPoint {1005.719116 48}
  addUserKnob {7 slopeLow}
  addUserKnob {7 slopeHigh}
  slopeHigh 0.04
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 8
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 8
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6f2b6000 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6f2b6000
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6f2b5800 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6f2b5400 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6f2b5000 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6f2b4c00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr <= log10(minPoint.x)"
   expr1 "logg <= log10(minPoint.x)"
   expr2 "logb <= log10(minPoint.x)"
   name segment_bottom
   xpos -590
   ypos -178
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6f2b4c00
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6f27fc00 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr1 "logg * slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr2 "logb* slopeLow + ( log10(minPoint.y) - slopeLow * log10(minPoint.x) )"
   expr3 1
   name Expression
   xpos -370
   ypos -178
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6f2b5000
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr > log10(minPoint.x) ) * ( logr < log10(midPoint.x) )"
   expr1 "( logg > log10(minPoint.x) ) * ( logg < log10(midPoint.x) )"
   expr2 "( logb > log10(minPoint.x) ) * ( logb < log10(midPoint.x) )"
   name segment_low
   xpos -700
   ypos -178
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6f27fc00
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6f27e400 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -198
  }
set N6f27e000 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -198
  }
set N6f27dc00 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -198
  }
  Dot {
   name Dot12
   label " "
   xpos 434
   ypos -78
  }
set N6f27d400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression15
   xpos 290
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix3
   label "mult_f3_f33( cf, M)"
   xpos 290
   ypos 8
  }
push $N6f27d400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression6
   xpos 400
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f2
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 400
   ypos 8
  }
push 0
push $N6f27dc00
  Dot {
   name Dot11
   label " "
   xpos 214
   ypos -78
  }
set N6f22fc00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression14
   xpos 70
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix1
   label "mult_f3_f33( cf, M)"
   xpos 70
   ypos 8
  }
push $N6f22fc00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression4
   xpos 180
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f7
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 180
   ypos 8
  }
push $N6f27e000
  Dot {
   name Dot10
   label " "
   xpos -6
   ypos -78
  }
set N6f22e800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsLow.0 : j == 1 ? coefsLow.1 : j == 2 ? coefsLow.2 :j == 3 ? coefsLow.3 : j == 4 ? coefsLow.4 : j == 5 ? coefsLow.5 : j == 6 ? coefsLow.6 : j == 7 ? coefsLow.7 : j == 8 ? coefsLow.8 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr1 "j == 0 ? coefsLow.1 : j == 1 ? coefsLow.2 : j == 2 ? coefsLow.3 :j == 3 ? coefsLow.4 : j == 4 ? coefsLow.5 : j == 5 ? coefsLow.6 : j == 6 ? coefsLow.7 : j == 7 ? coefsLow.8 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr2 "j == 0 ? coefsLow.2 : j == 1 ? coefsLow.3 : j == 2 ? coefsLow.4 :j == 3 ? coefsLow.5 : j == 4 ? coefsLow.6 : j == 5 ? coefsLow.7 : j == 6 ? coefsLow.8 : j == 7 ? coefsLow.9 : j == 8 ? coefsLow.9 : j == 9 ? coefsLow.9 : coefsLow.9"
   expr3 j
   name Expression1
   xpos -150
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix2
   label "mult_f3_f33( cf, M)"
   xpos -150
   ypos 8
  }
push $N6f22e800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_LOW-1) * (logx-log10(minPoint.x))/(log10(midPoint.x)-log10(minPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression2
   xpos -40
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f1
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos -40
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 180
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6f2b5400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "( logr >= log10(midPoint.x) ) * ( logr < log10(maxPoint.x) )"
   expr1 "( logg >= log10(midPoint.x) ) * ( logg < log10(maxPoint.x) )"
   expr2 "( logb >= log10(midPoint.x) ) * ( logb < log10(maxPoint.x) )"
   name segment_high
   xpos -810
   ypos -178
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6f27e400
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6f1bfc00 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -198
  }
set N6f1bf800 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -198
  }
set N6f1bf400 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -198
  }
  Dot {
   name Dot19
   label " "
   xpos 1204
   ypos -78
  }
set N6f1bec00 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression3
   xpos 1060
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix6
   label "mult_f3_f33( cf, M)"
   xpos 1060
   ypos 8
  }
push $N6f1bec00
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(b, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression12
   xpos 1170
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 0
   expr2 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   name dot_f3_f6
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 1170
   ypos 8
  }
push 0
push $N6f1bf400
  Dot {
   name Dot18
   label " "
   xpos 984
   ypos -78
  }
set N6f1bd800 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression5
   xpos 840
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix5
   label "mult_f3_f33( cf, M)"
   xpos 840
   ypos 8
  }
push $N6f1bd800
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(g, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression10
   xpos 950
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 0
   expr1 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr2 0
   name dot_f3_f5
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 950
   ypos 8
  }
push $N6f1bf800
  Dot {
   name Dot16
   label " "
   xpos 764
   ypos -78
  }
set N6f1bc400 [stack 0]
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 "j == 0 ? coefsHigh.0 : j == 1 ? coefsHigh.1 : j == 2 ? coefsHigh.2 :j == 3 ? coefsHigh.3 : j == 4 ? coefsHigh.4 : j == 5 ? coefsHigh.5 : j == 6 ? coefsHigh.6 : j == 7 ? coefsHigh.7 : j == 8 ? coefsHigh.8 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr1 "j == 0 ? coefsHigh.1 : j == 1 ? coefsHigh.2 : j == 2 ? coefsHigh.3 :j == 3 ? coefsHigh.4 : j == 4 ? coefsHigh.5 : j == 5 ? coefsHigh.6 : j == 6 ? coefsHigh.7 : j == 7 ? coefsHigh.8 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr2 "j == 0 ? coefsHigh.2 : j == 1 ? coefsHigh.3 : j == 2 ? coefsHigh.4 :j == 3 ? coefsHigh.5 : j == 4 ? coefsHigh.6 : j == 5 ? coefsHigh.7 : j == 6 ? coefsHigh.8 : j == 7 ? coefsHigh.9 : j == 8 ? coefsHigh.9 : j == 9 ? coefsHigh.9 : coefsHigh.9"
   expr3 j
   name Expression16
   xpos 620
   ypos -34
  }
  ColorMatrix {
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name ColorMatrix4
   label "mult_f3_f33( cf, M)"
   xpos 620
   ypos 8
  }
push $N6f1bc400
  Expression {
   temp_name0 logx
   temp_expr0 "(log10( max(r, 5.96046448e-08 )))"
   temp_name1 knot_coord
   temp_expr1 "(N_KNOTS_HIGH-1) * (logx-log10(midPoint.x))/(log10(maxPoint.x)-log10(midPoint.x))"
   temp_name2 j
   temp_expr2 int(knot_coord)
   temp_name3 t
   temp_expr3 "knot_coord - j"
   expr0 t*t
   expr1 t
   expr2 1
   expr3 1
   name Expression8
   xpos 730
   ypos -34
  }
  MergeExpression {
   inputs 2
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 (Ar*Br)+(Ag*Bg)+(Ab*Bb)
   expr1 0
   expr2 0
   name dot_f3_f4
   label "logy = dot_f3_f3( monomials, mult_f3_f33( cf, M))"
   xpos 730
   ypos 8
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge2
   xpos 950
   ypos 158
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6f2b5800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   expr0 "logr >= log10(maxPoint.x) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.x) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.x) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -178
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6f1bfc00
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 5.96046448e-08 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 5.96046448e-08 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 5.96046448e-08 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 "logr * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr1 "logg * slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr2 "logb* slopeHigh + ( log10(maxPoint.y) - slopeHigh * log10(maxPoint.x) )"
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
push $N6f2b6800
 Switch {
  inputs 2
  which {{parent.use_c9}}
  name Switch_c9
  xpos -1250
  ypos -298
 }
 Expression {
  expr0 "(r - Ymin) / (Ymax - Ymin)"
  expr1 "(g - Ymin) / (Ymax - Ymin)"
  expr2 "(b - Ymin) / (Ymax - Ymin)"
  expr3 1
  name Y_2_linCV_f3_
  xpos -1250
  ypos 38
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Dot {
  name Dot12
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 282
 }
set N6f0f3400 [stack 0]
 Dot {
  name Dot15
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 282
 }
set N6f0f3000 [stack 0]
 Dot {
  name Dot13
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 282
 }
 Dot {
  name Dot16
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 354
 }
set N6f0f2800 [stack 0]
 Expression {
  temp_name0 tr
  temp_expr0 "(-r - c_x_0) / (c_x_1 - c_x_0)"
  temp_name1 tg
  temp_expr1 "(-g - c_x_0) / (c_x_1 - c_x_0)"
  temp_name2 tb
  temp_expr2 "(-b - c_x_0) / (c_x_1 - c_x_0)"
  expr0 "tr < 0.0 ? -(tr * c_b + c_c) : tr > 1.0 ? r : -(( tr * c_a + c_b) * tr + c_c)"
  expr1 "tg < 0.0 ? -(tg * c_b + c_c) : tg > 1.0 ? g : -(( tg * c_a + c_b) * tg + c_c)"
  expr2 "tb < 0.0 ? -(tb * c_b + c_c) : tb > 1.0 ? b : -(( tb * c_a + c_b) * tb + c_c)"
  name roll_white_fwd_1
  xpos -920
  ypos 398
  addUserKnob {20 Params}
  addUserKnob {7 new_wht}
  new_wht 0.918
  addUserKnob {7 c_width}
  c_width 0.5
  addUserKnob {7 c_x_0 +DISABLED}
  c_x_0 -1
  addUserKnob {7 c_x_1 +DISABLED}
  c_x_1 {{"c_x_0 + c_width"}}
  addUserKnob {7 c_y0 +DISABLED}
  c_y0 {{-new_wht}}
  addUserKnob {7 c_y1 +DISABLED}
  c_y1 {{c_x_1}}
  addUserKnob {7 c_m1 +DISABLED}
  c_m1 {{"(c_x_1 - c_x_0)"}}
  addUserKnob {7 c_a +DISABLED}
  c_a {{"c_y0 - c_y1 + c_m1"}}
  addUserKnob {7 c_b +DISABLED}
  c_b {{"2 * (c_y1 - c_y0) - c_m1"}}
  addUserKnob {7 c_c +DISABLED}
  c_c {{c_y0}}
 }
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96
  temp_name1 NEW_WHT
  temp_expr1 0.918
  expr0 "min( r, NEW_WHT) * SCALE"
  expr1 "min( g, NEW_WHT) * SCALE"
  expr2 "min( b, NEW_WHT) * SCALE"
  name Expression2
  label "// Scale and clamp white to avoid casted highlights due to D60 simulation"
  xpos -920
  ypos 440
 }
 Dot {
  name Dot11
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 498
 }
push $N6f0f2800
 Expression {
  temp_name0 SCALE
  temp_expr0 0.96362
  expr0 "r * SCALE"
  expr1 "g * SCALE"
  expr2 "b * SCALE"
  name mult_f_f3_
  label D65
  xpos -1030
  ypos 344
 }
push $N6f0f3000
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_
  xpos -1140
  ypos 350
 }
 Dot {
  name Dot14
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 426
 }
push $N6f0f3400
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch1
  xpos -1250
  ypos 422
 }
 Switch {
  inputs 2
  which {{"parent.display_pri == 3"}}
  name switch_wp_is_dci_
  xpos -1250
  ypos 494
 }
 Dot {
  name Dot26
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 762
 }
set N6f0f1000 [stack 0]
 ColorMatrix {
  matrix {
      {{"(1.0 - sat) * rgb2Y.x + sat"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y + sat"} {"(1.0 - sat) * rgb2Y.z"}}
      {{"(1.0 - sat) * rgb2Y.x"} {"(1.0 - sat) * rgb2Y.y"} {"(1.0 - sat) * rgb2Y.z + sat"}}
    }
  name ColorMatrix3
  label "// Apply desaturation to compensate \nfor luminance difference"
  xpos -1140
  ypos 746
  addUserKnob {20 params}
  addUserKnob {13 rgb2Y}
  rgb2Y {0.27222875 0.67408174 0.05368952}
  addUserKnob {7 sat}
  sat 0.93
 }
push $N6f0f1000
 Switch {
  inputs 2
  which {{"parent.eotf < 5 && display_pri < 2"}}
  name Switch_eotf
  label "Use if output is SDR"
  xpos -1250
  ypos 800
 }
 ColorMatrix {
  matrix {
      {0.6624541879 0.1340042055 0.1561876982}
      {0.2722287476 0.6740817428 0.05368951708}
      {-0.005574660841 0.004060741514 1.010339141}
    }
  name ColorMatrix1
  label "ACES AP1 to XYZ"
  xpos -1250
  ypos 968
 }
 Dot {
  name Dot8
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1146
 }
set N6f0f0400 [stack 0]
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out CIE-Yxy
  name Colorspace2
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1136
 }
 Clamp {
  channels {rgba.red -rgba.green -rgba.blue none}
  maximum_enable false
  name ClampMin4
  xpos -1140
  ypos 1190
 }
 Expression {
  expr0 "pow(r, DIM_SURROUND_GAMMA)"
  expr1 g
  expr2 b
  channel3 none
  name dark_to_dim3
  xpos -1140
  ypos 1214
  addUserKnob {20 Params}
  addUserKnob {7 DIM_SURROUND_GAMMA}
  DIM_SURROUND_GAMMA 0.9811
 }
 Colorspace {
  colorspace_in CIE-Yxy
  colorspace_out CIE-XYZ
  name Colorspace4
  label "\[value colorspace_in] -> \[value colorspace_out]"
  xpos -1140
  ypos 1256
 }
push $N6f0f0400
 Switch {
  inputs 2
  which {{"(parent.eotf <= 4) ? parent.dark_to_dim : 0"}}
  name DarkToDim_Switch
  label "enable if sdr\nand dark_to_dim enabled"
  xpos -1250
  ypos 1250
 }
 Dot {
  name Dot19
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 1434
 }
set N6f086c00 [stack 0]
 Dot {
  name Dot9
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1106
  ypos 1434
 }
set N6f086800 [stack 0]
 ColorMatrix {
  matrix {
      {0.9872254133 -0.006114810705 0.01592640579}
      {-0.007603884675 1.001874804 0.005322027951}
      {0.003066040576 -0.005084238946 1.081519246}
    }
  name ColorMatrix2
  label "CAT: Bradford\n D60 to D65"
  xpos -1140
  ypos 1466
 }
set N6f086400 [stack 0]
push $N6f086800
 Dot {
  name Dot10
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -996
  ypos 1434
 }
push $N6f086400
 Switch {
  inputs 2
  which {{parent.d60_sim}}
  name d60_sim_switch
  xpos -1140
  ypos 1550
 }
push $N6f086c00
 Switch {
  inputs 2
  which {{"parent.display_pri < 3"}}
  name switch_wp_is_d65_1
  xpos -1250
  ypos 1550
 }
 Switch {
  inputs 2
  which {{parent.force_d65_cat}}
  name switch_force_d65_cat
  xpos -1250
  ypos 1598
 }
 Group {
  name limit_to_primaries
  label "Only enabled when display_pri != limiting_pri"
  xpos -1250
  ypos 1760
  disable {{"!(parent.display_pri != parent.limiting_pri)"}}
  addUserKnob {20 limit_to_primaries}
  addUserKnob {4 limiting_pri l "limiting pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  limiting_pri {{parent.limiting_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to limiting primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6f085800 [stack 0]
push $N6f085800
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix5
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6f085800
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6f085800
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6f085800
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6f085800
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6f085800
  ColorMatrix {
   matrix {
       {0.6954522133 0.1406786889 0.163869068}
       {0.04479461163 0.8596711159 0.09553432465}
       {-0.005525866989 0.004025223665 1.001500726}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6f085800
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Clamp {
   channels rgb
   name clamp_f3
   label "Clip any values outside the limiting primaries"
   xpos -40
   ypos 56
  }
  Dot {
   name Dot2
   label " Convert limited RGB to XYZ"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos 162
  }
set N6f407000 [stack 0]
push $N6f407000
  ColorMatrix {
   matrix {
       {0.9525524378 0 9.367863095e-05}
       {0.3439664543 0.7281661034 -0.07213255018}
       {-3.863927134e-08 0 1.008825183}
     }
   name ColorMatrix4
   label "ACES to XYZ"
   xpos 730
   ypos 224
  }
push $N6f407000
  ColorMatrix {
   matrix {
       {0.6624541879 0.1340042055 0.1561876982}
       {0.2722287476 0.6740817428 0.05368951708}
       {-0.005574660841 0.004060741514 1.010339141}
     }
   name ColorMatrix20
   label "ACEScg to XYZ"
   xpos 620
   ypos 224
  }
push $N6f407000
  ColorMatrix {
   matrix {
       {0.5049495697 0.2646814585 0.1830150485}
       {0.237623319 0.6891706586 0.07320601493}
       {0 0.0449459292 0.9638792276}
     }
   name ColorMatrix13
   label "P3D60 to XYZ"
   xpos 510
   ypos 224
  }
push $N6f407000
  ColorMatrix {
   matrix {
       {0.4451698363 0.2771343887 0.1722826511}
       {0.209491685 0.7215952873 0.06891305745}
       {0 0.04706057906 0.9073553085}
     }
   name ColorMatrix18
   label "P3DCI to XYZ"
   xpos 400
   ypos 224
  }
push $N6f407000
  ColorMatrix {
   matrix {
       {0.4865709841 0.2656676769 0.1982172877}
       {0.2289745659 0.6917385459 0.07928691059}
       {0 0.04511339962 1.043944359}
     }
   name ColorMatrix16
   label "P3D65 to XYZ"
   xpos 290
   ypos 224
  }
push $N6f407000
  ColorMatrix {
   matrix {
       {0.6369580626 0.1446169019 0.1688809693}
       {0.2627002299 0.6779980659 0.05930171534}
       {0 0.0280726999 1.060985088}
     }
   name ColorMatrix3
   label "Rec2020 to XYZ"
   xpos 180
   ypos 224
  }
push $N6f407000
  ColorMatrix {
   matrix {
       {0.4123907983 0.3575843275 0.180480808}
       {0.2126390189 0.7151686549 0.07219231874}
       {0.01933082007 0.1191947311 0.950532198}
     }
   name ColorMatrix1
   label "Rec709 to XYZ"
   xpos 70
   ypos 224
  }
  Switch {
   inputs 8
   which {{parent.limiting_pri}}
   name limiting_primary_switch1
   xpos -40
   ypos 326
  }
  Output {
   name Output
   xpos -40
   ypos 446
  }
 end_group
 Group {
  name XYZ_2_DISPLAY_PRI
  label "CIE XYZ to display encoding primaries"
  xpos -1250
  ypos 1976
  addUserKnob {20 XYZ_2_DISPLAY_PRI_tab l XYZ_2_DISPLAY_PRI}
  addUserKnob {4 display_pri l "display pri" M {Rec709 Rec2020 P3D65 P3DCI P3D60 ACEScg ACES XYZ}}
  display_pri {{parent.display_pri}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -298
  }
  Dot {
   name Dot1
   label " XYZ to display primaries"
   note_font "Helvetica Bold"
   note_font_size 24
   note_font_color 0xa5a5a501
   xpos -6
   ypos -198
  }
set N6f404800 [stack 0]
push $N6f404800
  ColorMatrix {
   matrix {
       {1.049811006 0 -9.748453158e-05}
       {-0.4959030151 1.373313069 0.09824004024}
       {4.020908051e-08 0 0.9912520051}
     }
   name ColorMatrix3
   label "XYZ to ACES"
   xpos 730
   ypos -136
  }
push $N6f404800
  ColorMatrix {
   matrix {
       {1.641023397 -0.3248033226 -0.2364246994}
       {-0.6636629701 1.615331769 0.01675636508}
       {0.01172191743 -0.008284457959 0.9883947968}
     }
   name ColorMatrix21
   label "XYZ to ACEScg"
   xpos 620
   ypos -136
  }
push $N6f404800
  ColorMatrix {
   matrix {
       {2.402741432 -0.8974840641 -0.3880533576}
       {-0.8325796723 1.769231915 0.02371272631}
       {0.03882339597 -0.08249972761 1.036368608}
     }
   name ColorMatrix15
   label "XYZ to P3D60"
   xpos 510
   ypos -136
  }
push $N6f404800
  ColorMatrix {
   matrix {
       {2.725393534 -1.018002748 -0.4401631057}
       {-0.795167923 1.689731717 0.02264718339}
       {0.04124190658 -0.0876390487 1.100929499}
     }
   name ColorMatrix19
   label "XYZ to P3DCI"
   xpos 400
   ypos -136
  }
push $N6f404800
  ColorMatrix {
   matrix {
       {2.493496418 -0.9313833117 -0.4027107358}
       {-0.8294888139 1.762663841 0.02362467349}
       {0.03584583849 -0.07617240399 0.9568845034}
     }
   name ColorMatrix17
   label "XYZ to P3D65"
   xpos 290
   ypos -136
  }
push $N6f404800
  ColorMatrix {
   matrix {
       {1.71665132 -0.3556708097 -0.2533662617}
       {-0.6666844487 1.616481304 0.01576855592}
       {0.01763986237 -0.04277062416 0.9421030879}
     }
   name ColorMatrix12
   label "XYZ to Rec2020"
   xpos 180
   ypos -136
  }
push $N6f404800
  ColorMatrix {
   matrix {
       {3.240970135 -1.537383318 -0.4986107945}
       {-0.9692437053 1.875967622 0.04155509174}
       {0.0556300357 -0.2039768547 1.056971431}
     }
   name ColorMatrix2
   label "XYZ to Rec709"
   xpos 70
   ypos -136
  }
  Switch {
   inputs 8
   which {{parent.display_pri}}
   name limiting_primary_switch
   xpos -40
   ypos -34
  }
  Output {
   name Output
   xpos -40
   ypos 86
  }
 end_group
 Clamp {
  channels rgb
  name clamp_f3_all
  xpos -1250
  ypos 2164
 }
 Dot {
  name Dot1
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -1216
  ypos 2514
 }
set N6f395c00 [stack 0]
push $N6f395c00
 Dot {
  name Dot3
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -886
  ypos 2514
 }
set N6f395800 [stack 0]
 Dot {
  name Dot4
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -666
  ypos 2514
 }
set N6f395400 [stack 0]
 Dot {
  name Dot6
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -446
  ypos 2514
 }
set N6f395000 [stack 0]
 Dot {
  name Dot18
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -226
  ypos 2514
 }
set N6f394c00 [stack 0]
 Dot {
  name Dot20
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos -6
  ypos 2514
 }
set N6f394800 [stack 0]
 Dot {
  name Dot25
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 214
  ypos 2514
 }
set N6f394400 [stack 0]
 Dot {
  name Dot24
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2514
 }
 Dot {
  name Dot2
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2610
 }
set N6f347800 [stack 0]
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr
  label "stretch_black = True"
  xpos 510
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
push $N6f347800
 Expression {
  expr0 "r * (Ymax - Ymin) + Ymin"
  expr1 "g * (Ymax - Ymin) + Ymin"
  expr2 "b * (Ymax - Ymin) + Ymin"
  name linCV_2_Y_f3_hdr2
  label "stretch_black = False"
  xpos 620
  ypos 2672
  addUserKnob {20 Luminance}
  addUserKnob {7 Ymin R 0.0001 0.02}
  Ymin {{parent.lum.0}}
  addUserKnob {7 Ymax R 48 10000}
  Ymax {{parent.lum.2}}
 }
 Switch {
  inputs 2
  which {{parent.stretch_black}}
  name StretchBlacks_Switch
  xpos 620
  ypos 2750
 }
 Clamp {
  channels rgb
  maximum 65535
  name clamp_f3__
  xpos 620
  ypos 2822
 }
 Expression {
  temp_name0 Lm_r
  temp_expr0 "pow((r / pq_C), pq_m1)"
  temp_name1 Lm_g
  temp_expr1 "pow((g / pq_C), pq_m1)"
  temp_name2 Lm_b
  temp_expr2 "pow((b / pq_C), pq_m1)"
  expr0 "pow(( pq_c1 + pq_c2 * Lm_r ) / ( 1.0 + pq_c3 * Lm_r ), pq_m2)"
  expr1 "pow(( pq_c1 + pq_c2 * Lm_g ) / ( 1.0 + pq_c3 * Lm_g ), pq_m2)"
  expr2 "pow(( pq_c1 + pq_c2 * Lm_b ) / ( 1.0 + pq_c3 * Lm_b ), pq_m2)"
  name Y_2_ST2084_
  label "ACESlib.OutputTransforms.ctl : 243 \nACESlib.Utilities_Color.ctl : 425"
  xpos 620
  ypos 2882
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
set N6f346800 [stack 0]
 Dot {
  name Dot5
  label " "
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2514
 }
 Expression {
  temp_name0 Np_r
  temp_expr0 "pow( r, 1.0 / pq_m2 )"
  temp_name1 Np_g
  temp_expr1 "pow( g, 1.0 / pq_m2 )"
  temp_name2 Np_b
  temp_expr2 "pow( b, 1.0 / pq_m2 )"
  expr0 "r < 0 ? 0 : pow((Np_r - pq_c1) / ( pq_c2 - pq_c3 * Np_r ), 1.0/pq_m1) * pq_C"
  expr1 "g < 0 ? 0 : pow((Np_g - pq_c1) / ( pq_c2 - pq_c3 * Np_g ), 1.0/pq_m1) * pq_C"
  expr2 "b < 0 ? 0 : pow((Np_b - pq_c1) / ( pq_c2 - pq_c3 * Np_b ), 1.0/pq_m1) * pq_C"
  name ST2084_2_Y_f3_
  label "ACESlib.Utilities_Color.ctl : 408\n// Converts from the non-linear perceptually quantized space to linear cd/m^2"
  xpos 950
  ypos 2618
  addUserKnob {20 SMPTE_ST2084-2014_Constants_tab l "Constants from SMPTE ST 2084-2014"}
  addUserKnob {7 pq_m1 t " ( 2610.0 / 4096.0 ) / 4.0;" +DISABLED R 0 100}
  pq_m1 0.1593017578
  addUserKnob {7 pq_m2 t " ( 2523.0 / 4096.0 ) * 128.0;" +DISABLED R 0 100}
  pq_m2 78.84375
  addUserKnob {7 pq_c1 t " 3424.0 / 4096.0 or pq_c3 - pq_c2 + 1.0;" +DISABLED R 0 100}
  pq_c1 0.8359375
  addUserKnob {7 pq_c2 t " ( 2413.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c2 18.8515625
  addUserKnob {7 pq_c3 t " ( 2392.0 / 4096.0 ) * 32.0;" +DISABLED R 0 100}
  pq_c3 18.6875
  addUserKnob {7 pq_C +DISABLED R 0 100}
  pq_C 10000
 }
 Expression {
  temp_name0 Y_d
  temp_expr0 "0.2627*r + 0.6780*g + 0.0593*b"
  expr0 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((r-c_beta)/c_alpha)"
  expr1 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((g-c_beta)/c_alpha)"
  expr2 "Y_d == 0 ? 0 : pow( (Y_d-c_beta)/c_alpha, (1-c_gamma)/c_gamma) * ((b-c_beta)/c_alpha)"
  name ST2084_2_HLG_1000nits_f3_3
  label "ACESlib.Utilities_Color.ctl : 469\n// HLG Inverse EOTF (i.e. HLG inverse OOTF followed by the HLG OETF)\n// HLG Inverse OOTF (display linear to scene linear)"
  xpos 950
  ypos 2732
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 L_w +DISABLED}
  L_w 1000
  addUserKnob {7 L_b +DISABLED}
  addUserKnob {7 c_alpha +DISABLED}
  c_alpha {{L_w-L_b}}
  addUserKnob {7 c_beta +DISABLED}
  c_beta {{L_b}}
  addUserKnob {7 c_gamma +DISABLED}
  c_gamma 1.2
 }
 Expression {
  channel0 {rgba.red -rgba.green -rgba.blue none}
  expr0 "r <= 1.0/12 ? sqrt(3.0*r) : c_a * log(12.0 * r - c_b) + c_c"
  expr1 "g <= 1.0/12 ? sqrt(3.0*g) : c_a * log(12.0 * g- c_b) + c_c"
  expr2 "b <= 1.0/12 ? sqrt(3.0*b) : c_a * log(12.0 * b - c_b) + c_c"
  name ST2084_2_HLG_1000nits_f3_
  label "ACESlib.Utilities_Color.ctl : 493\n// HLG OETF (scene linear to non-linear signal value)"
  xpos 950
  ypos 2834
  addUserKnob {20 Constants_tab l Constants}
  addUserKnob {7 c_a +DISABLED}
  c_a 0.17883277
  addUserKnob {7 c_b t 1.-4.*a +DISABLED}
  c_b 0.28466892
  addUserKnob {7 c_c t 0.5-a*log(4.*a) +DISABLED}
  c_c 0.55991073
 }
 Dot {
  name Dot17
  label " HLG"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 984
  ypos 2970
 }
push $N6f346800
 Dot {
  name Dot27
  label " PQ"
  note_font "Helvetica Bold"
  note_font_size 24
  note_font_color 0xa5a5a501
  xpos 654
  ypos 2970
 }
push $N6f394400
 Expression {
  expr0 "pow( (48./52.37) * r, 1./2.6)"
  expr1 "pow( (48./52.37) * g, 1./2.6)"
  expr2 "pow( (48./52.37) * b, 1./2.6)"
  expr3 1
  name dcdm_encode
  xpos 180
  ypos 2702
 }
push $N6f394800
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_26_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.6"
  xpos -40
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.6
 }
push $N6f394c00
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_24_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.4"
  xpos -260
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
 }
push $N6f395000
 Expression {
  expr0 pow(r,1/gamma)
  expr1 pow(g,1/gamma)
  expr2 pow(b,1/gamma)
  name pow_f3_gamma_22_
  label "ACESlib.Utilities_Color.ctl : 260\n// Gamma 2.2"
  xpos -480
  ypos 2690
  addUserKnob {20 Gamma_tab l Gamma}
  addUserKnob {7 gamma R 0 4}
  gamma 2.2
 }
push $N6f395400
 Expression {
  temp_name0 c_a
  temp_expr0 "pow( pow( Lw, 1./gamma) - pow( Lb, 1./gamma), gamma)"
  temp_name1 c_b
  temp_expr1 "pow( Lb, 1./gamma) / ( pow( Lw, 1./gamma) - pow( Lb, 1./gamma))"
  expr0 "pow( max( r / c_a, 0.), 1.0/gamma) - c_b"
  expr1 "pow( max( g / c_a, 0.), 1.0/gamma) - c_b"
  expr2 "pow( max( b / c_a, 0.), 1.0/gamma) - c_b"
  name bt1886_r_f3
  label "ACESlib.Utilities_Color.ctl : 301\n// The reference EOTF specified in Rec. ITU-R BT.1886\n// L = a(max\[(V+b),0])^g"
  xpos -700
  ypos 2684
  addUserKnob {20 Luminance}
  addUserKnob {7 Lw R 48 10000}
  Lw 1
  addUserKnob {7 Lb R 0.0001 0.02}
  addUserKnob {7 gamma R 1 4}
  gamma 2.4
 }
push $N6f395800
 Expression {
  temp_name0 yb
  temp_expr0 "pow( offs * gamma / ( ( gamma - 1.0) * ( 1.0 + offs)), gamma)"
  temp_name1 rs
  temp_expr1 "pow( ( gamma - 1.0) / offs, gamma - 1.0) * pow( ( 1.0 + offs) / gamma, gamma)"
  expr0 "r >= yb ? ( 1.0 + offs) * pow( r, 1.0 / gamma) - offs : r * rs"
  expr1 "g >= yb ? ( 1.0 + offs) * pow( g, 1.0 / gamma) - offs : g * rs"
  expr2 "b >= yb ? ( 1.0 + offs) * pow( b, 1.0 / gamma) - offs : b * rs"
  name moncurve_r_f3_
  label "ACESlib.Utilities_Color.ctl : 260\nmoncurve_r with gamma of 2.4 and offset of 0.055 matches the EOTF found in IEC 61966-2-1:1999 (sRGB)"
  xpos -920
  ypos 2690
  addUserKnob {20 Luminance}
  addUserKnob {7 gamma R 0 4}
  gamma 2.4
  addUserKnob {7 offs}
  offs 0.055
 }
 Switch {
  inputs 10
  which {{parent.eotf}}
  name EOTF_Switch
  xpos -1250
  ypos 2966
 }
 Expression {
  temp_name0 REFBLACK
  temp_expr0 "64 / 1023"
  temp_name1 REFWHITE
  temp_expr1 "940 / 1023"
  expr0 "r * ( REFWHITE - REFBLACK) + REFBLACK"
  expr1 "g * ( REFWHITE - REFBLACK) + REFBLACK"
  expr2 "b * ( REFWHITE - REFBLACK) + REFBLACK"
  name fullRange_to_smpteRange_f3_
  label "ACESlib.OutputTransforms.ctl : 216"
  xpos -1250
  ypos 3224
  disable {{!parent.legal_range}}
 }
 Output {
  name Output
  xpos -1250
  ypos 3446
 }
 StickyNote {
  inputs 0
  name StickyNote1
  tile_color 0x535a61ff
  label "\n<b>ACESlib.RRT_Common.ctl : 135</b>\n<pre>\nfloat\[3] rrt_sweeteners( float in\[3])\n\{\n    float aces\[3] = in;\n    \n    // --- Glow module --- //\n    float saturation = rgb_2_saturation( aces);\n    float ycIn = rgb_2_yc( aces);\n    float s = sigmoid_shaper( (saturation - 0.4) / 0.2);\n    float addedGlow = 1. + glow_fwd( ycIn, RRT_GLOW_GAIN * s, RRT_GLOW_MID);\n\n    aces = mult_f_f3( addedGlow, aces);\n\n    // --- Red modifier --- //\n    float hue = rgb_2_hue( aces);\n    float centeredHue = center_hue( hue, RRT_RED_HUE);\n    float hueWeight = cubic_basis_shaper( centeredHue, RRT_RED_WIDTH);\n\n    aces\[0] = aces\[0] + hueWeight * saturation * (RRT_RED_PIVOT - aces\[0]) * (1. - RRT_RED_SCALE);\n\n    // --- ACES to RGB rendering space --- //\n    aces = clamp_f3( aces, 0., HALF_POS_INF);\n    float rgbPre\[3] = mult_f3_f44( aces, AP0_2_AP1_MAT);\n    rgbPre = clamp_f3( rgbPre, 0., HALF_MAX);\n    \n    // --- Global desaturation --- //\n    rgbPre = mult_f3_f33( rgbPre, RRT_SAT_MAT);\n    return rgbPre;\n\}\n\n\n\n"
  note_font_size 10
  xpos -825
  ypos -1204
 }
 StickyNote {
  inputs 0
  name StickyNote2
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.SSTS.ctl : 163</b><pre>float ssts\n( \n    varying float x,\n    varying TsParams C\n)\n\{\n    const int N_KNOTS_LOW = 4;\n    const int N_KNOTS_HIGH = 4;\n\n    // Check for negatives or zero before taking the log. If negative or zero,\n    // set to HALF_MIN.\n    float logx = log10( max(x, HALF_MIN )); \n\n    float logy;\n\n    if ( logx <= log10(C.Min.x) ) \{ \n\n        logy = logx * C.Min.slope + ( log10(C.Min.y) - C.Min.slope * log10(C.Min.x) );\n\n    \} else if (( logx > log10(C.Min.x) ) && ( logx < log10(C.Mid.x) )) \{\n\n        float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.Min.x))/(log10(C.Mid.x)-log10(C.Min.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else if (( logx >= log10(C.Mid.x) ) && ( logx < log10(C.Max.x) )) \{\n\n        float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.Mid.x))/(log10(C.Max.x)-log10(C.Mid.x));\n        int j = knot_coord;\n        float t = knot_coord - j;\n\n        float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n        float monomials\[ 3] = \{ t * t, t, 1. \};\n        logy = dot_f3_f3( monomials, mult_f3_f33( cf, M1));\n\n    \} else \{ //if ( logIn >= log10(C.Max.x) ) \{ \n\n        logy = logx * C.Max.slope + ( log10(C.Max.y) - C.Max.slope * log10(C.Max.x) );\n\n    \}\n\n    return pow10(logy);\n\n\}"
  note_font_size 10
  xpos -830
  ypos -664
 }
 StickyNote {
  inputs 0
  name StickyNote3
  tile_color 0x535a61ff
  label "\n\n<b>ACESlib.Tonescales.ctl : 271</b><pre>float segmented_spline_c9_fwd\n  ( \n    varying float x,\n    varying SegmentedSplineParams_c9 C = ODT_48nits\n  )\n\{    \n  const int N_KNOTS_LOW = 8;\n  const int N_KNOTS_HIGH = 8;\n\n  // Check for negatives or zero before taking the log. If negative or zero,\n  // set to HALF_MIN.\n  float logx = log10( max(x, HALF_MIN )); \n\n  float logy;\n\n  if ( logx <= log10(C.minPoint.x) ) \{ \n\n    logy = logx * C.slopeLow + ( log10(C.minPoint.y) - C.slopeLow * log10(C.minPoint.x) );\n\n  \} else if (( logx > log10(C.minPoint.x) ) && ( logx < log10(C.midPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_LOW-1) * (logx-log10(C.minPoint.x))/(log10(C.midPoint.x)-log10(C.minPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsLow\[ j], C.coefsLow\[ j + 1], C.coefsLow\[ j + 2]\};\n    \n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else if (( logx >= log10(C.midPoint.x) ) && ( logx < log10(C.maxPoint.x) )) \{\n\n    float knot_coord = (N_KNOTS_HIGH-1) * (logx-log10(C.midPoint.x))/(log10(C.maxPoint.x)-log10(C.midPoint.x));\n    int j = knot_coord;\n    float t = knot_coord - j;\n\n    float cf\[ 3] = \{ C.coefsHigh\[ j], C.coefsHigh\[ j + 1], C.coefsHigh\[ j + 2]\}; \n\n    float monomials\[ 3] = \{ t * t, t, 1. \};\n    logy = dot_f3_f3( monomials, mult_f3_f33( cf, M));\n\n  \} else \{ //if ( logIn >= log10(C.maxPoint.x) ) \{ \n\n    logy = logx * C.slopeHigh + ( log10(C.maxPoint.y) - C.slopeHigh * log10(C.maxPoint.x) );\n\n  \}\n\n  return pow10(logy);\n  \n\}"
  note_font_size 10
  xpos -200
  ypos -660
 }
push $N6ec9ec00
 Reformat {
  type "to box"
  box_width 4
  box_height 4
  box_fixed true
  name Reformat1
  note_font Helvetica
  xpos -1140
  ypos -561
 }
 Fill {
  output rgb
  color {{parent.ssts.mid_lum}}
  name Fill1
  note_font Helvetica
  xpos -1140
  ypos -537
 }
 Group {
  name inv_ssts
  xpos -1140
  ypos -514
  addUserKnob {20 ssts_tab l ssts}
  addUserKnob {78 lum l luminance t "<b>SSTS Display Luminance</b>: \ny_min y_mid y_max\n\nAccording to Zach Lewis's ACES_OT\nhttps://gist.github.com/zachlewis/786c0be941868644c993fde1c3515c2c\n\n<b>Standard Cinema</b>: \n0.02 4.8 48\n<b>Dolby Cinema</b>: \n0.0001 7.2 108\n<b>Dolby Pulsar</b>: \n0.005 15 4000\n<b>Dolby PRR-4220</b>: \n0.005 10 600\n<b>Sony BVM-X300</b>: \n0.0001 10 1000\n<b>ACES OCES</b>: \n0.0001 4.8 10000\n\n" n 3}
  lum {{"use_c9 ? 0.0001 : parent.lum"} 4.8 {"use_c9 ? 10000 : parent.lum"}}
  addUserKnob {6 override_ssts_params l "override ssts params" t "Enable overrides of SSTS params.\n\nOtherwise the values will be calculated automatically by the algorithm." +STARTLINE}
  override_ssts_params {{parent.ACES_SSTS.AcesSSTSKernel_override_curve_params}}
  addUserKnob {7 exposure R -5 5}
  exposure {{parent.exposure}}
  addUserKnob {7 knee}
  knee {{parent.pctLow}}
  addUserKnob {7 shoulder}
  shoulder {{parent.pctHigh}}
  addUserKnob {78 slope n 3}
  slope {{parent.slope} {parent.slope} {parent.slope}}
  addUserKnob {20 TsParams_tab l TsParams}
  addUserKnob {7 expShift R -4 4}
  expShift {{"override_ssts_params ? exposure : 0"}}
  addUserKnob {13 minPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  minPoint {{"pow(2, log(0.18*pow(2, MIN_STOP_RRT+((MIN_STOP_SDR-MIN_STOP_RRT)/(log10(MIN_LUM_SDR)-log10(MIN_LUM_RRT)))*(log10(minPoint.y)-log10(MIN_LUM_RRT))))/log(2)-expShift)"} {lum.0} {override_ssts_params?slope.0:0}}
  addUserKnob {13 midPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  midPoint {{"pow(2, ((log(0.18)/log(2)-expShift)))"} {lum.1} {override_ssts_params?slope.1:1.55}}
  addUserKnob {13 maxPoint t "x;        // ACES\ny;        // luminance\nz;        // slope"}
  maxPoint {{"pow(2, log(0.18*pow(2, (MAX_STOP_SDR+(MAX_STOP_RRT-MAX_STOP_SDR)/(log10(MAX_LUM_RRT)-log10(MAX_LUM_SDR))*(log10(maxPoint.y)-log10(MAX_LUM_SDR)))))/log(2)-expShift)"} {lum.2} {override_ssts_params?slope.2:0}}
  addUserKnob {7 knotIncLow}
  knotIncLow {{"(log10(midPoint.x) - log10(minPoint.x)) / 3.0"}}
  addUserKnob {7 knotIncHigh}
  knotIncHigh {{"(log10(maxPoint.x) - log10(midPoint.x)) / 3.0"}}
  addUserKnob {7 pctLow}
  pctLow {{0.18+(0.35-0.18)/(MIN_STOP_SDR-MIN_STOP_RRT)*(log(minPoint.x/0.18)/log(2)-MIN_STOP_RRT)}}
  addUserKnob {7 pctHigh}
  pctHigh {{0.89+(0.90-0.89)/(MAX_STOP_SDR-MAX_STOP_RRT)*(log(maxPoint.x/0.89)/log(2)-MAX_STOP_RRT)}}
  addUserKnob {78 coefsLow n 5}
  coefsLow {{"(minPoint.z * (log10(minPoint.x)-0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {"(minPoint.z * (log10(minPoint.x)+0.5*knotIncLow)) + ( log10(minPoint.y) - minPoint.z * log10(minPoint.x))"} {log10(minPoint.y)+pctLow*(log10(midPoint.y)-log10(minPoint.y))} {"(midPoint.z * (log10(midPoint.x)-0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncLow)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"}}
  addUserKnob {78 coefsHigh n 5}
  coefsHigh {{"(midPoint.z * (log10(midPoint.x)-0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {"(midPoint.z * (log10(midPoint.x)+0.5*knotIncHigh)) + ( log10(midPoint.y) - midPoint.z * log10(midPoint.x))"} {log10(midPoint.y)+pctHigh*(log10(maxPoint.y)-log10(midPoint.y))} {"(maxPoint.z * (log10(maxPoint.x)-0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"} {"(maxPoint.z * (log10(maxPoint.x)+0.5*knotIncHigh)) + ( log10(maxPoint.y) - maxPoint.z * log10(maxPoint.x))"}}
  addUserKnob {7 KNOT_INC_LOW}
  KNOT_INC_LOW {{"(log10(midPoint.x) - log10(minPoint.x)) / (N_KNOTS_LOW - 1)"}}
  addUserKnob {7 KNOT_INC_HIGH}
  KNOT_INC_HIGH {{"(log10(maxPoint.x) - log10(midPoint.x)) / (N_KNOTS_HIGH - 1)"}}
  addUserKnob {78 KNOT_Y_LOW n 4}
  KNOT_Y_LOW {{"(coefsLow.0 + coefsLow.1) / 2"} {"(coefsLow.1 + coefsLow.2) / 2"} {"(coefsLow.2 + coefsLow.3) / 2"} {"(coefsLow.3 + coefsLow.4) / 2"}}
  addUserKnob {78 KNOT_Y_HIGH n 4}
  KNOT_Y_HIGH {{"(coefsHigh.0 + coefsHigh.1) / 2"} {"(coefsHigh.1 + coefsHigh.2) / 2"} {"(coefsHigh.2 + coefsHigh.3) / 2"} {"(coefsHigh.3 + coefsHigh.4) / 2"}}
  addUserKnob {20 Constants_tab l const}
  addUserKnob {3 N_KNOTS_LOW}
  N_KNOTS_LOW 4
  addUserKnob {3 N_KNOTS_HIGH}
  N_KNOTS_HIGH 4
  addUserKnob {7 MIN_STOP_SDR R -20 20}
  MIN_STOP_SDR -6.5
  addUserKnob {7 MAX_STOP_SDR R -20 20}
  MAX_STOP_SDR 6.5
  addUserKnob {7 MIN_STOP_RRT R -20 20}
  MIN_STOP_RRT -15
  addUserKnob {7 MAX_STOP_RRT R -20 20}
  MAX_STOP_RRT 18
  addUserKnob {7 MIN_LUM_SDR R 0 0.1}
  MIN_LUM_SDR 0.02
  addUserKnob {7 MAX_LUM_SDR R 0 100}
  MAX_LUM_SDR 48
  addUserKnob {7 MIN_LUM_RRT R 0 0.1}
  MIN_LUM_RRT 0.0001
  addUserKnob {7 MAX_LUM_RRT R 0 10000}
  MAX_LUM_RRT 10000
 }
  Input {
   inputs 0
   name Input
   xpos -1030
   ypos -634
  }
  Dot {
   name Dot25
   label " "
   xpos -996
   ypos -318
  }
set N6f6d0c00 [stack 0]
  Dot {
   name Dot26
   label " "
   xpos -996
   ypos 1506
  }
push $N6f6d0c00
  Dot {
   name Dot4
   label " "
   xpos -886
   ypos -318
  }
set N6f6d0400 [stack 0]
  Dot {
   name Dot5
   label " "
   xpos -776
   ypos -318
  }
set N6f683c00 [stack 0]
  Dot {
   name Dot2
   label " "
   xpos -666
   ypos -318
  }
set N6f683800 [stack 0]
  Dot {
   name Dot3
   label " "
   xpos -556
   ypos -318
  }
set N6f683400 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr <= log10(minPoint.y)"
   expr1 "logg <= log10(minPoint.y)"
   expr2 "logb <= log10(minPoint.y)"
   name segment_bottom
   xpos -590
   ypos -202
  }
  Dot {
   name Dot1
   label " "
   xpos -556
   ypos 162
  }
push $N6f683400
  Dot {
   name Dot7
   label " "
   xpos -336
   ypos -318
  }
set N6f682800 [stack 0]
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(minPoint.x)
   expr1 log10(minPoint.x)
   expr2 log10(minPoint.x)
   expr3 1
   name Expression
   xpos -370
   ypos -202
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply3
   xpos -370
   ypos 158
  }
  Dot {
   name Dot27
   label " "
   xpos -336
   ypos 786
  }
push $N6f683800
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr > log10(minPoint.y) ) && ( logr <= log10(midPoint.y) )"
   expr1 "( logg > log10(minPoint.y) ) && ( logg <= log10(midPoint.y) )"
   expr2 "( logb > log10(minPoint.y) ) && ( logb <= log10(midPoint.y) )"
   name segment_low
   xpos -700
   ypos -202
  }
  Dot {
   name Dot22
   label " "
   xpos -666
   ypos 354
  }
push $N6f682800
  Dot {
   name Dot9
   label " "
   xpos -6
   ypos -318
  }
set N6f681000 [stack 0]
  Dot {
   name Dot6
   label " "
   xpos -6
   ypos -174
  }
set N6f680c00 [stack 0]
  Dot {
   name Dot8
   label " "
   xpos 214
   ypos -174
  }
set N6f680800 [stack 0]
  Dot {
   name Dot13
   label " "
   xpos 434
   ypos -174
  }
  Dot {
   name Dot19
   xpos 434
   ypos -78
  }
set N6f62fc00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow5
   xpos 290
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low5
   xpos 290
   ypos -34
  }
push $N6f62fc00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy5
   xpos 400
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals4
   xpos 400
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push 0
push $N6f680c00
  Dot {
   name Dot10
   xpos -6
   ypos -78
  }
set N6f62e800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow
   xpos -150
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low
   xpos -150
   ypos -34
  }
push $N6f62e800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy
   xpos -40
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals
   xpos -40
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
push $N6f680800
  Dot {
   name Dot18
   xpos 214
   ypos -78
  }
set N6f62d400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_LOW.0) && (logy <= KNOT_Y_LOW.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_LOW.1) && (logy <= KNOT_Y_LOW.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_LOW.2) && (logy <= KNOT_Y_LOW.3)"
   expr0 "low ? coefsLow.0 : mid ? coefsLow.1 : coefsLow.2"
   expr1 "low ? coefsLow.1 : mid ? coefsLow.2 : coefsLow.3"
   expr2 "low ? coefsLow.2 : mid ? coefsLow.3 : coefsLow.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow4
   xpos 70
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low4
   xpos 70
   ypos -34
  }
push $N6f62d400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy4
   xpos 180
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b)/(-sqrt(g*g - 4*r*b)-g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(minPoint.x) + (t +j) * KNOT_INC_LOW"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals5
   xpos 180
   ypos 14
   addUserKnob {20 User}
   addUserKnob {7 knotIncLow}
   knotIncLow {{parent.knotIncLow}}
   addUserKnob {13 min l Min}
   min {{parent.min.x} {parent.min.y} {parent.minSlope}}
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   name Merge2
   xpos 180
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply1
   xpos 180
   ypos 350
  }
  Dot {
   name Dot28
   label " "
   xpos 214
   ypos 786
  }
push 0
push $N6f683c00
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "( logr >= log10(midPoint.y) ) && ( logr < log10(maxPoint.y) )"
   expr1 "( logg >= log10(midPoint.y) ) && ( logg < log10(maxPoint.y) )"
   expr2 "( logb >= log10(midPoint.y) ) && ( logb < log10(maxPoint.y) )"
   name segment_high
   xpos -810
   ypos -202
  }
  Dot {
   name Dot23
   label " "
   xpos -776
   ypos 474
  }
push $N6f681000
  Dot {
   name Dot14
   label " "
   xpos 764
   ypos -318
  }
set N6f5c2800 [stack 0]
  Dot {
   name Dot15
   label " "
   xpos 764
   ypos -174
  }
set N6f5c2400 [stack 0]
  Dot {
   name Dot17
   label " "
   xpos 984
   ypos -174
  }
set N6f5c2000 [stack 0]
  Dot {
   name Dot20
   label " "
   xpos 1204
   ypos -174
  }
  Dot {
   name Dot16
   xpos 1204
   ypos -78
  }
set N6f5c1800 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(b, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow3
   xpos 1060
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low3
   xpos 1060
   ypos -34
  }
push $N6f5c1800
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bb, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy3
   xpos 1170
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals3
   xpos 1170
   ypos 14
  }
push 0
push $N6f5c2400
  Dot {
   name Dot11
   xpos 764
   ypos -78
  }
set N6f5c0400 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow1
   xpos 620
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low1
   xpos 620
   ypos -34
  }
push $N6f5c0400
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Br, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy1
   xpos 730
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 0
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals1
   xpos 730
   ypos 14
  }
push $N6f5c2000
  Dot {
   name Dot12
   xpos 984
   ypos -78
  }
set N6f56ac00 [stack 0]
  Expression {
   temp_name0 logy
   temp_expr0 "log10( max(g, 1e-10 ))"
   temp_name1 low
   temp_expr1 "(logy > KNOT_Y_HIGH.0) && (logy <= KNOT_Y_HIGH.1)"
   temp_name2 mid
   temp_expr2 "(logy > KNOT_Y_HIGH.1) && (logy <= KNOT_Y_HIGH.2)"
   temp_name3 high
   temp_expr3 "(logy > KNOT_Y_HIGH.2) && (logy <= KNOT_Y_HIGH.3)"
   expr0 "low ? coefsHigh.0 : mid ? coefsHigh.1 : coefsHigh.2"
   expr1 "low ? coefsHigh.1 : mid ? coefsHigh.2 : coefsHigh.3"
   expr2 "low ? coefsHigh.2 : mid ? coefsHigh.3 : coefsHigh.4"
   expr3 "low ? 0 : mid ? 1 : high ? 2 : 0"
   name inv_cfLow2
   xpos 840
   ypos -82
  }
  ColorMatrix {
   channels {rgba.red rgba.green rgba.blue -rgba.alpha}
   matrix {
       {0.5 -1 0.5}
       {-1 1 0}
       {0.5 0.5 0}
     }
   name inv_basis_low2
   xpos 840
   ypos -34
  }
push $N6f56ac00
  MergeExpression {
   inputs 2
   temp_name0 logy
   temp_expr0 "log10(max(Bg, 1e-10))"
   expr0 Ar
   expr1 Ag
   expr2 Ab-logy
   expr3 Aa
   name c_minus_logy2
   xpos 950
   ypos -34
  }
  Expression {
   temp_name0 j
   temp_expr0 a
   temp_name1 d
   temp_expr1 "sqrt(g*g - 4*r*b)"
   temp_name2 t
   temp_expr2 "(2.*b) / (-sqrt(g*g - 4*r*b) - g)"
   expr0 0
   channel1 {-rgba.red rgba.green -rgba.blue none}
   expr1 "log10(midPoint.x) + (t +j) * KNOT_INC_HIGH"
   channel2 {-rgba.red -rgba.green rgba.blue none}
   expr2 0
   expr3 1
   maskChannelInput -rgba.alpha
   unpremult -rgba.alpha
   name inv_knot_vals2
   xpos 950
   ypos 14
  }
  Merge2 {
   inputs 3+1
   operation plus
   bbox B
   output rgb
   name Merge1
   xpos 950
   ypos 134
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply2
   xpos 950
   ypos 470
  }
  Dot {
   name Dot29
   label " "
   xpos 984
   ypos 786
  }
push $N6f6d0400
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   expr0 "logr >= log10(maxPoint.y) ? 1 : 0"
   expr1 "logg >= log10(maxPoint.y) ? 1 : 0"
   expr2 "logb >= log10(maxPoint.y) ? 1 : 0"
   name segment_peak
   xpos -920
   ypos -202
  }
  Dot {
   name Dot24
   label " "
   xpos -886
   ypos 618
  }
push $N6f5c2800
  Dot {
   name Dot21
   label " "
   xpos 1534
   ypos -318
  }
  Expression {
   temp_name0 logr
   temp_expr0 "log10( max(r, 1e-10 ))"
   temp_name1 logg
   temp_expr1 "log10( max(g, 1e-10 ))"
   temp_name2 logb
   temp_expr2 "log10( max(b, 1e-10 ))"
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 log10(maxPoint.x)
   expr1 log10(maxPoint.x)
   expr2 log10(maxPoint.x)
   expr3 1
   name proc_low1
   label Expression
   xpos 1500
   ypos -208
  }
  Merge2 {
   inputs 2
   operation multiply
   also_merge all
   name Multiply4
   xpos 1500
   ypos 614
  }
  Merge2 {
   inputs 4+1
   operation plus
   bbox B
   output rgb
   name Merge3
   xpos 510
   ypos 1118
  }
  Expression {
   channel0 {rgba.red -rgba.green -rgba.blue none}
   expr0 pow(10,r)
   expr1 pow(10,g)
   expr2 pow(10,b)
   name Expression13
   xpos 510
   ypos 1238
  }
  Copy {
   inputs 2
   from0 rgba.alpha
   to0 rgba.alpha
   name Copy1
   xpos 510
   ypos 1496
  }
  Output {
   name Output1
   xpos 510
   ypos 1814
  }
 end_group
 Expression {
  channel0 rgb
  expr0 log(r)/log(2)-log(0.18)/log(2)
  name expShift
  note_font Helvetica
  xpos -1140
  ypos -489
 }
end_group
Colorspace {
 colorspace_in st2084
 name Colorspace45
 xpos 1234
 ypos 1953
}
Multiply {
 value 0.01
 name Multiply33
 xpos 1234
 ypos 1974
}
Colorspace {
 colorspace_out sRGB
 name Colorspace48
 xpos 1234
 ypos 2006
}
Constant {
 inputs 0
 channels rgb
 color {100 {frame/1023*100} 0 0}
 format "1024 1024 0 0 1024 1024 1 square_1K"
 name Constant8
 xpos -156
 ypos 991
}
Expression {
 expr0 (y/(height-1))*r
 expr2 cx*180
 name Expression14
 xpos -156
 ypos 1102
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_J
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.red 0 0 zcam_J.blue 0 2 rgba.red 0 0 zcam_J.alpha 0 3"
 name Shuffle36
 xpos -156
 ypos 1126
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_C
 fromInput2 {{0} B}
 mappings "4 rgba.green 0 1 zcam_C.green 0 1 rgba.green 0 1 zcam_C.red 0 0 rgba.green 0 1 zcam_C.blue 0 2 rgba.green 0 1 zcam_C.alpha 0 3"
 name Shuffle37
 xpos -156
 ypos 1172
}
Shuffle2 {
 fromInput1 {{0} B}
 out1 zcam_h
 fromInput2 {{0} B}
 mappings "4 rgba.blue 0 2 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.red 0 0 rgba.blue 0 2 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.alpha 0 3"
 name Shuffle39
 xpos -156
 ypos 1196
}
Group {
 name ZCAM10
 label "\[value direction]\n\[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData0]\} \{return  \"\"\}] - \[if \{\[value direction] ==\"inverse\"\} \{return \[value inverseData1]\} \{return  \"\"\}]\n0.0.2"
 xpos -156
 ypos 1248
 addUserKnob {20 ZCAM}
 addUserKnob {4 direction M {forward inverse}}
 direction inverse
 addUserKnob {26 ""}
 addUserKnob {26 inverseModes l "Inverse Input Data Modes"}
 addUserKnob {4 inverseData0 l "Inverse Data 0" M {J Q}}
 addUserKnob {4 inverseData1 l "Inverse Data 1" M {aM,bM aC,bC aS,bS M,h C,h}}
 inverseData1 C,h
 addUserKnob {26 ""}
 addUserKnob {26 _1 l _SURROUND_PARAMETERS}
 addUserKnob {41 surrounds T Constants.surrounds}
 addUserKnob {41 c T Constants.c}
 addUserKnob {41 Nc T Constants.Nc}
 addUserKnob {41 F T Constants.F}
 addUserKnob {41 FLL T Constants.FLL}
 addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
 addUserKnob {41 La T Constants.La}
 addUserKnob {41 Yb T Constants.Yb}
 addUserKnob {41 surround T Constants.surround}
 addUserKnob {41 D T Constants.D}
 addUserKnob {41 Dtype T Constants.Dtype}
 addUserKnob {26 ""}
 addUserKnob {41 xyzw_d65 T Constants.xyzw_d65}
 addUserKnob {41 xyzw T Constants.xyzw}
 addUserKnob {26 ""}
 addUserKnob {41 Yw T Constants.Yw}
 addUserKnob {41 FL T Constants.FL}
 addUserKnob {41 n T Constants.n}
 addUserKnob {41 Fb T Constants.Fb}
 addUserKnob {41 Fs T Constants.Fs}
 addUserKnob {26 ""}
 addUserKnob {41 xyzwc T Constants.xyzwc}
 addUserKnob {41 iabzw T Constants.iabzw}
 addUserKnob {41 Qw T Constants.Qw}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x71c67100
  label xyz_to_jabz
  note_font_size 42
  xpos -1063
  ypos -50
  bdwidth 255
  bdheight 678
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x388e8e00
  label Forward
  note_font_size 42
  xpos -1278
  ypos 673
  bdwidth 1634
  bdheight 582
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x388e8e00
  label Inverse
  note_font_size 42
  xpos -2310
  ypos 2374
  bdwidth 1715
  bdheight 953
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x388e8e00
  label "jabz to xyz"
  note_font_size 42
  xpos -2260
  ypos 3390
  bdwidth 300
  bdheight 667
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  label "h,H,Q,J,M,C,Sz,Vz,Kz,Wz\n\n        :outin:\n            | 'J,aM,bM', optional\n            | String with requested output (e.g. \"J,aM,bM,M,h\") \[Forward mode]\n            | - attributes: 'J': lightness,'Q': brightness,\n            |               'M': colorfulness,'C': chroma, 's': saturation,\n            |               'h': hue angle, 'H': hue quadrature/composition,\n            |               'Wz': whiteness, 'Kz':blackness, 'Sz': saturation, 'V': vividness\n            | String with inputs in data \[inverse mode]. \n            | Input must have data.shape\[-1]==3 and last dim of data must have \n            | the following structure for inverse mode: \n            |  * data\[...,0] = J or Q,\n            |  * data\[...,1:] = (aM,bM) or (aC,bC) or (aS,bS) or (M,h) or (C, h), ..."
  xpos -1922
  ypos 791
  bdwidth 411
  bdheight 201
 }
 Input {
  inputs 0
  name Input1
  xpos -984
  ypos -137
 }
 Dot {
  name Dot4
  label xyzc
  xpos -950
  ypos -97
 }
 Dot {
  name Dot5
  xpos -950
  ypos -21
 }
set N6f46f400 [stack 0]
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  name M_to_xyzp
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -984
  ypos 30
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  name _M_XYZP_TO_LMS
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -984
  ypos 102
 }
 Dot {
  name Dot1
  label LMS
  xpos -950
  ypos 154
 }
 Expression {
  expr0 "((c1 + c2*(r/10000)**n)/(1 + c3*(r/10000)**n))**p"
  expr1 "((c1 + c2*(g/10000)**n)/(1 + c3*(g/10000)**n))**p"
  expr2 "((c1 + c2*(b/10000)**n)/(1 + c3*(b/10000)**n))**p"
  name Expression1
  label "# response compression: lms to lms'"
  xpos -984
  ypos 199
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 Dot {
  name Dot2
  label lmsp
  xpos -950
  ypos 260
 }
set N6f46e000 [stack 0]
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_ZCAM
  xpos -912
  ypos 329
 }
 Add {
  value -3.703522621e-11
  name Add1
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -912
  ypos 353
 }
 Dot {
  name Dot6
  label Iabz
  xpos -878
  ypos 411
 }
push $N6f46e000
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  name _M_LMSP_TO_IAB_JABZ
  xpos -1053
  ypos 328
 }
 Dot {
  name Dot7
  label Iabz
  xpos -1019
  ypos 410
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters
  xpos -978
  ypos 441
 }
set N6f481600 [stack 0]
 Expression {
  expr0 "((1-0.56)*r/(1-0.56*r)) - 1.6295499532821566e-11"
  name Expression2
  label "    if ztype == 'jabz':\n        Iabz\[...,0] = ((1-0.56)*Iabz\[...,0]/(1-0.56*Iabz\[...,0])) - 1.6295499532821566e-11\n        print(\"Iabz post jabz: \", Iabz)"
  xpos -886
  ypos 492
 }
push $N6f481600
 Switch {
  inputs 2
  name use_zcam_parameters1
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -978
  ypos 564
 }
 Dot {
  name Dot3
  label iabz
  xpos -944
  ypos 753
 }
set N6f46c400 [stack 0]
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(b,g)*r2d
  channel0 rgba
  expr0 h
  name h
  xpos -1074
  ypos 904
 }
set N6f813c00 [stack 0]
 Expression {
  temp_name0 h
  temp_expr0 r
  channel0 rgba
  expr0 "1.015 + cos((h + 89.038)*pi/180)"
  name ez
  xpos -1074
  ypos 928
 }
push $N6f46c400
 Copy {
  inputs 2
  from0 rgba.red
  to0 rgba.red
  name Copy1
  xpos -894
  ypos 989
 }
 Expression {
  channel0 rgba
  expr0 "100*((g**2.0 + b**2.0)**0.37)*(r**0.068)*(Constants.FL**0.2) / ((Constants.iabzw.r**0.78) * (Constants.Fb**0.1))"
  name M_colorfulness
  label "# calculate colorfulness, M:"
  xpos -894
  ypos 1021
 }
set N6f813000 [stack 0]
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C
  label "# calculate chroma, C:"
  xpos -894
  ypos 1118
 }
set N6f812c00 [stack 0]
push $N6f46c400
 Expression {
  channel0 rgba
  expr0 "2700 * (r**(1.6*Constants.Fs/(Constants.Fb**0.12))) * (Constants.Fs**2.2) * (Constants.Fb**0.5) * (Constants.FL**0.2)"
  name Q
  label "# calculate brightness, Q:"
  xpos -1030
  ypos 1019
 }
set N6f812800 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100.0 * (r/Constants.Qw)"
  name J
  label "# calculate lightness, J:"
  xpos -1030
  ypos 1117
 }
set N6f812400 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy3
  xpos -1030
  ypos 1155
 }
set N6f812000 [stack 0]
 Expression {
  channel0 rgba
  expr0 "100 - ((100-r)**2 + g**2)**0.5"
  name Wz
  label "# calculate whiteness, W:"
  xpos -1030
  ypos 1195
 }
set N6f811c00 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam
  fromInput2 {{0} B}
  mappings "4 black -1 -1 zcam.J 0 0 black -1 -1 zcam.Q 0 1 black -1 -1 zcam.M 0 2 black -1 -1 zcam.C 0 3"
  name Shuffle2
  xpos -1202
  ypos 1199
 }
push $N6f813c00
 Dot {
  name Dot9
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1975
  ypos 2339
 }
push $N6f46c400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.red 0 0 rgba.blue 0 2 rgba.red 0 0 rgba.alpha 0 3"
  name Iz
  xpos -1127
  ypos 835
 }
push $N6f46c400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.green 0 1 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.green 0 1 rgba.alpha 0 3"
  name az
  xpos -978
  ypos 837
 }
push $N6f46c400
 Shuffle2 {
  fromInput1 {{0} B}
  fromInput2 {{0} B}
  mappings "4 rgba.blue 0 2 rgba.blue 0 2 rgba.blue 0 2 rgba.red 0 0 rgba.blue 0 2 rgba.green 0 1 rgba.blue 0 2 rgba.alpha 0 3"
  name bz
  xpos -825
  ypos 835
 }
 NoOp {
  inputs 0
  name Constants
  xpos -527
  ypos 180
  addUserKnob {20 User}
  addUserKnob {26 _1 l _SURROUND_PARAMETERS}
  addUserKnob {4 surrounds M {average dim dark}}
  addUserKnob {7 c}
  c {{curve(surrounds) 0.69 0.59 0.525}}
  addUserKnob {7 Nc}
  Nc {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 F}
  F {{curve(surrounds) 1 0.9 0.8}}
  addUserKnob {7 FLL}
  FLL {{curve(surrounds) 1 1 1}}
  addUserKnob {26 _2 l _DEFAULT_CONDITIONS}
  addUserKnob {7 La}
  La 100
  addUserKnob {7 Yb}
  Yb 20
  addUserKnob {4 surround M {avg dim dark}}
  addUserKnob {7 D}
  D 1
  addUserKnob {7 Dtype}
  addUserKnob {26 ""}
  addUserKnob {18 xyzw_d65}
  xyzw_d65 {95.043 100 108.89}
  addUserKnob {6 xyzw_d65_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 xyzw}
  xyzw {{xyzw_d65.r} {xyzw_d65.g} {xyzw_d65.b}}
  addUserKnob {6 xyzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {26 ""}
  addUserKnob {7 Yw}
  Yw 100
  addUserKnob {7 FL}
  FL {{"0.171 * La**(1/3) * (1 - exp(-48/9*La))"}}
  addUserKnob {7 n}
  n {{Yb/Yw}}
  addUserKnob {7 Fb}
  Fb {{n**0.5}}
  addUserKnob {7 Fs}
  Fs {{c}}
  addUserKnob {26 ""}
  addUserKnob {18 xyzwc}
  xyzwc {95.043 100 108.89}
  addUserKnob {6 xyzwc_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {18 iabzw}
  iabzw {0.31331 -0.00014318 -8.9369e-05}
  addUserKnob {6 iabzw_panelDropped l "panel dropped state" -STARTLINE +HIDDEN}
  addUserKnob {7 Qw}
  Qw 185.85
 }
push $N6f46f400
push $N6f813c00
push $N6f813000
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy5
  xpos 67
  ypos 1136
 }
set N6f7a3c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bM
  xpos 163
  ypos 1202
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bM.red 0 0 rgba.green 0 1 zcam_bM.green 0 1 rgba.blue 0 2 zcam_bM.blue 0 2 rgba.alpha 0 3 zcam_bM.alpha 0 3"
  name Shuffle11
  xpos -752
  ypos 1400
 }
push $N6f7a3c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aM
  xpos 67
  ypos 1203
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aM
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aM.red 0 0 rgba.green 0 1 zcam_aM.green 0 1 rgba.blue 0 2 zcam_aM.blue 0 2 rgba.alpha 0 3 zcam_aM.alpha 0 3"
  name Shuffle10
  xpos -848
  ypos 1400
 }
push $N6f813c00
push $N6f812c00
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy25
  xpos -164
  ypos 1149
 }
set N6f7a2800 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bC
  xpos -76
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bC.red 0 0 rgba.green 0 1 zcam_bC.green 0 1 rgba.blue 0 2 zcam_bC.blue 0 2 rgba.alpha 0 3 zcam_bC.alpha 0 3"
  name Shuffle25
  xpos -949
  ypos 1399
 }
push $N6f7a2800
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aC
  xpos -164
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aC
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aC.red 0 0 rgba.green 0 1 zcam_aC.green 0 1 rgba.blue 0 2 zcam_aC.blue 0 2 rgba.alpha 0 3 zcam_aC.alpha 0 3"
  name Shuffle24
  xpos -1048
  ypos 1397
 }
push $N6f813c00
push $N6f812800
push $N6f813000
 Copy {
  inputs 2
  from1 rgba.green
  to1 rgba.green
  name Copy2
  xpos -734
  ypos 1076
 }
 Expression {
  channel0 rgba
  expr0 "100.0* ((r/g)**0.5) * (Constants.FL)**0.6"
  name s
  label "# calculate saturation, s:"
  xpos -734
  ypos 1118
 }
set N6f7a1000 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy24
  xpos -381
  ypos 1143
 }
set N6f7a0c00 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180.0)
  name bS
  xpos -287
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_bS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_bS.red 0 0 rgba.green 0 1 zcam_bS.green 0 1 rgba.blue 0 2 zcam_bS.blue 0 2 rgba.alpha 0 3 zcam_bS.alpha 0 3"
  name Shuffle23
  xpos -1150
  ypos 1398
 }
push $N6f7a0c00
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180.0)
  name aS
  xpos -381
  ypos 1207
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_aS
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_aS.red 0 0 rgba.green 0 1 zcam_aS.green 0 1 rgba.blue 0 2 zcam_aS.blue 0 2 rgba.alpha 0 3 zcam_aS.alpha 0 3"
  name Shuffle22
  xpos -1254
  ypos 1395
 }
push $N6f812000
 Expression {
  channel0 rgba
  expr0 "((r - 58)**2 + 3.4*g**2)**0.5"
  name Vz
  label "# calculate vividness, V:"
  xpos -583
  ypos 1200
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Vz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Vz.red 0 0 rgba.green 0 1 zcam_Vz.green 0 1 rgba.blue 0 2 zcam_Vz.blue 0 2 rgba.alpha 0 3 zcam_Vz.alpha 0 3"
  name Shuffle9
  xpos -1345
  ypos 1396
 }
push $N6f7a1000
 Expression {
  channel0 rgba
  name Sz
  label "# calculate saturation, S:"
  xpos -734
  ypos 1196
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Sz.red 0 0 rgba.green 0 1 zcam_Sz.green 0 1 rgba.blue 0 2 zcam_Sz.blue 0 2 rgba.alpha 0 3 zcam_Sz.alpha 0 3"
  name Shuffle8
  xpos -1436
  ypos 1395
 }
push $N6f812000
 Expression {
  channel0 rgba
  expr0 "100 - 0.8*(r**2 + 8*g**2)**0.5"
  name Kz
  label "# calculate blackness, K:"
  xpos -895
  ypos 1195
 }
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Kz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Kz.red 0 0 rgba.green 0 1 zcam_Kz.green 0 1 rgba.blue 0 2 zcam_Kz.blue 0 2 rgba.alpha 0 3 zcam_Kz.alpha 0 3"
  name Shuffle7
  xpos -1524
  ypos 1393
 }
push $N6f811c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Wz
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Wz.red 0 0 rgba.green 0 1 zcam_Wz.green 0 1 rgba.blue 0 2 zcam_Wz.blue 0 2 rgba.alpha 0 3 zcam_Wz.alpha 0 3"
  name Shuffle6
  xpos -1613
  ypos 1393
 }
push $N6f7a1000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_s
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_s.red 0 0 rgba.green 0 1 zcam_s.green 0 1 rgba.blue 0 2 zcam_s.blue 0 2 rgba.alpha 0 3 zcam_s.alpha 0 3"
  name Shuffle5
  xpos -1708
  ypos 1392
 }
push $N6f812c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_C
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_C.red 0 0 rgba.green 0 1 zcam_C.green 0 1 rgba.blue 0 2 zcam_C.blue 0 2 rgba.alpha 0 3 zcam_C.alpha 0 3"
  name Shuffle4
  xpos -1798
  ypos 1391
 }
push $N6f812400
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_J
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_J.red 0 0 rgba.green 0 1 zcam_J.green 0 1 rgba.blue 0 2 zcam_J.blue 0 2 rgba.alpha 0 3 zcam_J.alpha 0 3"
  name Shuffle1
  xpos -1900
  ypos 1390
 }
push $N6f813000
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_M
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_M.red 0 0 rgba.green 0 1 zcam_M.green 0 1 rgba.blue 0 2 zcam_M.blue 0 2 rgba.alpha 0 3 zcam_M.alpha 0 3"
  name Shuffle12
  xpos -1999
  ypos 1389
 }
push $N6f812800
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_Q.red 0 0 rgba.green 0 1 zcam_Q.green 0 1 rgba.blue 0 2 zcam_Q.blue 0 2 rgba.alpha 0 3 zcam_Q.alpha 0 3"
  name Shuffle3
  xpos -2089
  ypos 1391
 }
push $N6f813c00
 Shuffle2 {
  fromInput1 {{0} B}
  out1 zcam_h
  fromInput2 {{0} B}
  mappings "4 rgba.red 0 0 zcam_h.red 0 0 rgba.green 0 1 zcam_h.green 0 1 rgba.blue 0 2 zcam_h.blue 0 2 rgba.alpha 0 3 zcam_h.alpha 0 3"
  name Shuffle13
  xpos -2182
  ypos 1392
 }
push $N6f46f400
 Dot {
  name Dot16
  xpos -2265
  ypos 1253
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_h
  name Copy21
  xpos -2299
  ypos 1416
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Q
  name Copy22
  xpos -2299
  ypos 1458
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_M
  name Copy20
  xpos -2298
  ypos 1505
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_J
  name Copy11
  xpos -2298
  ypos 1547
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_C
  name Copy12
  xpos -2298
  ypos 1589
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_s
  name Copy13
  xpos -2302
  ypos 1631
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Wz
  name Copy14
  xpos -2302
  ypos 1673
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Kz
  name Copy15
  xpos -2302
  ypos 1715
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Sz
  name Copy16
  xpos -2302
  ypos 1757
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_Vz
  name Copy17
  xpos -2302
  ypos 1799
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aS
  name Copy26
  xpos -2302
  ypos 1841
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bS
  name Copy27
  xpos -2302
  ypos 1883
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aC
  name Copy28
  xpos -2302
  ypos 1925
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bC
  name Copy29
  xpos -2302
  ypos 1963
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_aM
  name Copy18
  xpos -2302
  ypos 2005
 }
 Copy {
  inputs 2
  from0 -rgba.alpha
  to0 -rgba.alpha
  channels zcam_bM
  name Copy19
  xpos -2302
  ypos 2047
 }
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction1
  xpos -2302
  ypos 2112
 }
 Dot {
  name Dot17
  xpos -2268
  ypos 2157
 }
set N6fa53400 [stack 0]
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_h
  fromInput2 {{0} B}
  mappings "4 zcam_h.red 0 0 rgba.red 0 0 zcam_h.green 0 1 rgba.green 0 1 zcam_h.blue 0 2 rgba.blue 0 2 zcam_h.alpha 0 3 rgba.alpha 0 3"
  name Shuffle20
  xpos -1041
  ypos 2260
 }
 Dot {
  name Dot41
  label h
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1007
  ypos 2349
 }
 Dot {
  name Dot33
  label "h in outIn"
  xpos -1007
  ypos 2613
 }
set N6fa52800 [stack 0]
 Dot {
  name Dot34
  xpos -1007
  ypos 2652
 }
push $N6fa52800
 Dot {
  name Dot35
  xpos -1034
  ypos 2640
 }
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bS
  fromInput2 {{0} B}
  in2 zcam_aS
  mappings "4 zcam_bS.blue 0 2 rgba.blue 0 2 zcam_bS.alpha 0 3 rgba.alpha 0 3 zcam_bS.green 0 1 rgba.green 0 1 zcam_aS.red 1 0 rgba.red 0 0"
  name Shuffle16
  label "aS & bS"
  note_font_size 15
  xpos -1489
  ypos 2304
 }
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bC
  fromInput2 {{0} B}
  in2 zcam_aC
  mappings "4 zcam_bC.blue 0 2 rgba.blue 0 2 zcam_bC.alpha 0 3 rgba.alpha 0 3 zcam_bC.green 0 1 rgba.green 0 1 zcam_aC.red 1 0 rgba.red 0 0"
  name Shuffle17
  label "aC & bC"
  note_font_size 15
  xpos -1585
  ypos 2304
 }
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_bM
  fromInput2 {{0} B}
  in2 zcam_aM
  mappings "4 zcam_bM.blue 0 2 rgba.blue 0 2 zcam_bM.alpha 0 3 rgba.alpha 0 3 zcam_bM.green 0 1 rgba.green 0 1 zcam_aM.red 1 0 rgba.red 0 0"
  name Shuffle26
  label "aM & bM"
  note_font_size 15
  xpos -1682
  ypos 2303
 }
 Switch {
  inputs 3
  which {{parent.inverseData1}}
  name inputdata_abX_mode
  xpos -1543
  ypos 2400
 }
 Dot {
  name Dot30
  xpos -1509
  ypos 2449
 }
set N6fa51000 [stack 0]
 Dot {
  name Dot29
  xpos -1210
  ypos 2483
 }
 Expression {
  temp_name0 r2d
  temp_expr0 180.0/pi
  temp_name1 h360
  temp_expr1 "360.0\n"
  temp_name2 h
  temp_expr2 atan2(g,r)*r2d
  channel0 rgba
  expr0 h
  name inv_h
  label "   # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n            print('h:'+str(h))"
  xpos -1244
  ypos 2546
 }
 Dot {
  name Dot36
  label "a in outIn"
  xpos -1210
  ypos 2619
 }
set N6fa50400 [stack 0]
 Dot {
  name Dot37
  xpos -1163
  ypos 2636
 }
push $N6fa50400
 Dot {
  name Dot38
  xpos -1185
  ypos 2648
 }
push $N6fa50400
 Dot {
  name Dot39
  xpos -1210
  ypos 2663
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode1
  label MCs
  xpos -1116
  ypos 2672
 }
 Dot {
  name Dot40
  xpos -1210
  ypos 2719
 }
set N6f9f7000 [stack 0]
push $N6f9f7000
 Expression {
  channel0 rgba
  expr0 "1.015 + cos((r + 89.038)*pi/180)"
  name inv_ez
  xpos -1244
  ypos 2756
 }
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_C
  fromInput2 {{0} B}
  mappings "4 zcam_C.red 0 0 rgba.red 0 0 zcam_C.green 0 1 rgba.green 0 1 zcam_C.blue 0 2 rgba.blue 0 2 zcam_C.alpha 0 3 rgba.alpha 0 3"
  name Shuffle21
  xpos -1357
  ypos 2252
 }
 Dot {
  name Dot42
  label C
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1323
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs2
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1357
  ypos 2501
 }
 Dot {
  name Dot43
  label "h in outIn"
  xpos -1323
  ypos 2578
 }
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_M
  fromInput2 {{0} B}
  mappings "4 zcam_M.red 0 0 rgba.red 0 0 zcam_M.green 0 1 rgba.green 0 1 zcam_M.blue 0 2 rgba.blue 0 2 zcam_M.alpha 0 3 rgba.alpha 0 3"
  name Shuffle19
  xpos -1442
  ypos 2252
 }
 Dot {
  name Dot31
  label M
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1408
  ypos 2341
 }
 Expression {
  channel0 rgba
  expr0 r
  name MCs1
  label "        elif 'h' in outin:\n            h = data\[...,2]\n            MCs = data\[...,1]  "
  xpos -1442
  ypos 2501
 }
 Dot {
  name Dot25
  label "h in outIn"
  xpos -1408
  ypos 2575
 }
push $N6fa51000
 Expression {
  channel0 rgba
  expr0 "(r**2.0 + g**2.0)**0.5"
  name MCs
  label "  if 'a' in outin\[1]: \n            # calculate hue h:\n            h = hue_angle(data\[...,1],data\[...,2], htype = 'deg')\n        \n            #--------------------------------------------\n            # calculate Colorfulness M or Chroma C or Saturation s from a,b:\n            MCs = (data\[...,1]**2.0 + data\[...,2]**2.0)**0.5  \n            print('MCs:'+str(MCs))"
  xpos -1645
  ypos 2460
 }
 Dot {
  name Dot24
  label "a in outIn"
  xpos -1611
  ypos 2581
 }
set N6f9f4400 [stack 0]
 Dot {
  name Dot28
  xpos -1564
  ypos 2598
 }
push $N6f9f4400
 Dot {
  name Dot27
  xpos -1586
  ypos 2610
 }
push $N6f9f4400
 Dot {
  name Dot26
  xpos -1611
  ypos 2625
 }
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inverseData1_Mode
  label MCs
  xpos -1517
  ypos 2634
 }
set N6f79d600 [stack 0]
 Expression {
  channel0 rgba
  expr0 r
  name C_from_aC
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -1926
  ypos 2710
 }
set N6f9b3000 [stack 0]
 Dot {
  name Dot44
  label C,h
  xpos -1673
  ypos 2768
 }
push $N6f79d600
 Expression {
  channel0 rgba
  expr0 100*r/Constants.Qw
  name C_from_aM
  label "        if ('aM' in outin) | ('M' in outin): \n            C = 100*MCs/Qw"
  xpos -2032
  ypos 2710
 }
set N6f9b2800 [stack 0]
 Dot {
  name Dot20
  label M,h
  xpos -1737
  ypos 2767
 }
push $N6f79d600
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Q
  fromInput2 {{0} B}
  mappings "4 zcam_Q.red 0 0 rgba.red 0 0 zcam_Q.green 0 1 rgba.green 0 1 zcam_Q.blue 0 2 rgba.blue 0 2 zcam_Q.alpha 0 3 rgba.alpha 0 3"
  name Shuffle18
  xpos -2182
  ypos 2257
 }
 Dot {
  name Dot21
  label Q
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1996
  ypos 2435
 }
set N6f9b1c00 [stack 0]
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_J
  fromInput2 {{0} B}
  mappings "4 zcam_J.red 0 0 rgba.red 0 0 zcam_J.green 0 1 rgba.green 0 1 zcam_J.blue 0 2 rgba.blue 0 2 zcam_J.alpha 0 3 rgba.alpha 0 3"
  name Shuffle14
  xpos -2302
  ypos 2259
 }
 Dot {
  name Dot8
  label J
  note_font_size 20
  note_font_color 0x677754ff
  xpos -2229
  ypos 2434
 }
 Dot {
  name Dot22
  xpos -2229
  ypos 2456
 }
set N6f9b1000 [stack 0]
 Expression {
  channel0 rgba
  expr0 Constants.Qw*(r/100)
  name Q_from_J
  label "# Get Lightness J and brightness Q from data:"
  xpos -2263
  ypos 2519
 }
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode
  label Q
  xpos -2263
  ypos 2564
 }
set N6f79cf00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy30
  xpos -1818
  ypos 2676
 }
 Expression {
  temp_name0 M
  temp_expr0 "r * (g / Constants.FL**0.6 / 100)**2"
  channel0 rgba
  expr0 100*M/Constants.Qw
  name C_from_aS
  label "        if ('aS' in outin) | ('S' in outin):\n            M = Q * (MCs / FL**0.6 / 100)**2 \n            C = 100*M/Qw"
  xpos -1814
  ypos 2705
 }
push $N6f9b3000
push $N6f9b2800
 Switch {
  inputs 5
  which {{parent.inverseData1}}
  name inputdata_abX_mode1
  xpos -1926
  ypos 2799
 }
 Expression {
  channel0 rgba
  expr0 "Constants.Qw * r / 100"
  name inv_M
  label "        #--------------------------------------------\n        # Calculate colorfulness, M:\n        M = Qw * C / 100\n        "
  selected true
  xpos -1543
  ypos 2822
 }
set N6f947c00 [stack 0]
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy7
  xpos -1543
  ypos 2874
 }
 Expression {
  channel0 rgba
  expr0 "(((r/100) * (Constants.iabzw.r**0.78) * (Constants.Fb**0.1))/((g**0.068)*(Constants.FL**0.2)))**(1/0.37/2)"
  name inv_t
  label "       #--------------------------------------------\n        # calculate t (=sqrt(a**2+b**2)) from M:\n        t = (((M/100) * (iabzw\[...,0]**0.78) * (Fb**0.1))/((ez**0.068)*(FL**0.2)))**(1/0.37/2)"
  xpos -1543
  ypos 2906
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy8
  xpos -1543
  ypos 2985
 }
set N6f947000 [stack 0]
 Expression {
  channel0 rgba
  expr0 r*sin(g*pi/180)
  name inv_bz
  label t*np.sin(h*np.pi/180)
  xpos -1402
  ypos 3067
 }
push $N6f947000
 Expression {
  channel0 rgba
  expr0 r*cos(g*pi/180)
  name inv_az
  label "az = t*np.cos(h*np.pi/180)"
  xpos -1543
  ypos 3064
 }
push $N6f79cf00
 Expression {
  channel0 rgba
  expr0 (r/(2700*(Constants.Fs**2.2)*(Constants.Fb**0.5)*(Constants.FL**0.2)))**((Constants.Fb**0.12)/(1.6*Constants.Fs))
  name inv_Iz
  label "# calculate achromatic signal, Iz:"
  xpos -2263
  ypos 2619
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy9
  xpos -2181
  ypos 3184
 }
 Copy {
  inputs 2
  from0 rgba.blue
  to0 rgba.blue
  name Copy10
  xpos -2181
  ypos 3216
 }
 Dot {
  name Dot15
  label iabz
  note_font_size 20
  xpos -2147
  ypos 3275
 }
 Dot {
  name Dot13
  xpos -2145
  ypos 3414
 }
 Dot {
  name Dot14
  xpos -2145
  ypos 3470
 }
set N6f945000 [stack 0]
 Expression {
  expr0 "(r + 1.6295499532821566e-11)/(1 - 0.56*(1 - (r + 1.6295499532821566e-11)))"
  name Expression3
  label "   # Convert Jz to Iz:\n    if ztype == 'jabz':\n        jabz\[...,0] = (jabz\[...,0] + 1.6295499532821566e-11)/(1 - 0.56*(1 - (jabz\[...,0] + 1.6295499532821566e-11)))\n"
  xpos -2050
  ypos 3532
 }
push $N6f945000
 Switch {
  inputs 2
  name use_zcam_parameters2
  label "# convert Iabz' to Jabz coordinates:\n    if ztype == 'jabz':"
  xpos -2179
  ypos 3608
 }
set N6f79c100 [stack 0]
 Dot {
  name Dot19
  label Iabz
  xpos -2092
  ypos 3678
 }
 Add {
  value 3.703522621e-11
  name Add2
  label "Iabz\[...,0]-=epsilon # correct to ensure zero output"
  xpos -2126
  ypos 3712
 }
 ColorMatrix {
  matrix {
      {0 1 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_ZCAM1
  xpos -2126
  ypos 3750
 }
push $N6f79c100
 Dot {
  name Dot18
  label Iabz
  xpos -2216
  ypos 3683
 }
 ColorMatrix {
  matrix {
      {0.5 0.5 0}
      {3.524 -4.066708 0.542708}
      {0.199076 1.096799 -1.295875}
    }
  invert true
  name _M_LMSP_TO_IAB_JABZ1
  xpos -2250
  ypos 3748
 }
 Switch {
  inputs 2
  which 1
  name use_zcam_parameters3
  xpos -2182
  ypos 3844
 }
 Expression {
  expr0 "10000*((c1 - r**(1/p)) / ((c3*r**(1/p)) - c2))**(1/n)"
  expr1 "10000*((c1 - g**(1/p)) / ((c3*g**(1/p)) - c2))**(1/n)"
  expr2 "10000*((c1 - b**(1/p)) / ((c3*b**(1/p)) - c2))**(1/n)"
  name Expression4
  label "        \n    # Convert lmsp to lms:\n    c1, c2, c3, n, p = \[_PQ_PARAMETERS\[x] for x in sorted(_PQ_PARAMETERS.keys())]\n    lms = 10000*((c1 - lmsp**(1/p)) / ((c3*lmsp**(1/p)) - c2))**(1/n)\n   "
  xpos -2182
  ypos 3874
  addUserKnob {20 _PQ_PARAMETERS}
  addUserKnob {7 c1}
  c1 {{3424/2**12}}
  addUserKnob {7 c2}
  c2 {{2413/2**7}}
  addUserKnob {7 c3}
  c3 {{2392/2**7}}
  addUserKnob {7 n}
  n {{2610/2**14}}
  addUserKnob {7 p}
  p {{1.7*2523/2**5}}
 }
 ColorMatrix {
  matrix {
      {0.41478972 0.579999 0.014648}
      {-0.20151 1.120649 0.0531008}
      {-0.0166008 0.2648 0.6684799}
    }
  invert true
  name _M_XYZP_TO_LMS1
  label "# Define X',Y',Z' to L,M,S conversion matrix:"
  xpos -2182
  ypos 3949
 }
 ColorMatrix {
  matrix {
      {{b} 0 {1-b}}
      {{1-g} {g} 0}
      {0 0 1}
    }
  invert true
  name M_to_xyzp1
  label " # Setup X,Y,Z to X',Y',Z' transform as matrix:\n    b = 1.15 \n    g = 0.66\n\n    M_to_xyzp = np.array(\[\[b, 0, 1 - b],\[1 - g, g, 0],\[0, 0, 1]])"
  xpos -2182
  ypos 3981
  addUserKnob {20 User}
  addUserKnob {7 b}
  b 1.15
  addUserKnob {7 g}
  g 0.66
 }
push $N6fa53400
 Switch {
  inputs 2
  which {{parent.direction}}
  name direction
  xpos -1519
  ypos 4172
 }
 Output {
  name Output1
  xpos -1519
  ypos 4272
 }
push $N6fa53400
 Dot {
  name Dot11
  label aM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1535
  ypos 2170
 }
push $N6fa53400
 Dot {
  name Dot12
  label bM
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1439
  ypos 2173
 }
push $N6f79cf00
push $N6fa53400
 Shuffle2 {
  fromInput1 {{0} B}
  in1 zcam_Sz
  fromInput2 {{0} B}
  mappings "4 zcam_Sz.red 0 0 rgba.red 0 0 zcam_Sz.green 0 1 rgba.green 0 1 zcam_Sz.blue 0 2 rgba.blue 0 2 zcam_Sz.alpha 0 3 rgba.alpha 0 3"
  name Shuffle15
  xpos -1870
  ypos 2254
 }
 Dot {
  name Dot10
  label Sz
  note_font_size 20
  note_font_color 0x677754ff
  xpos -1836
  ypos 2342
 }
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy4
  xpos -1770
  ypos 2555
 }
 Expression {
  expr0 "(g / Constants.Qw) * Constants.MCs**2 / FL**1.2 / 100"
  name inv_C
  label "if ('Sz' in outin) | ('aSz' in outin):  # saturation"
  xpos -1770
  ypos 2587
 }
push $N6fa51000
 Dot {
  name Dot23
  label "H in outIn"
  xpos -1509
  ypos 2582
 }
 Dot {
  inputs 0
  name Dot32
  label "H in outIn"
  xpos -1108
  ypos 2620
 }
push $N6f9b1c00
 Expression {
  channel0 rgba
  expr0 "100.0* (r/Constants.Qw)"
  name J_from_Q
  xpos -2030
  ypos 2479
 }
push $N6f9b1000
 Switch {
  inputs 2
  which {{parent.inverseData0}}
  name InverseData0_Mode1
  label J
  xpos -2030
  ypos 2527
 }
push $N6f79d600
 Copy {
  inputs 2
  from0 rgba.green
  to0 rgba.green
  name Copy23
  xpos -1596
  ypos 2681
 }
 Expression {
  channel0 rgba
  expr0 "(((100-r))**2 - (100 - g)**2)**0.5"
  name inv3_C
  label "if ('Wz' in outin) | ('aWz' in outin): #whiteness\n            C = (((100-MCs))**2 - (100 - J)**2)**0.5"
  xpos -1596
  ypos 2713
 }
 Constant {
  inputs 0
  channels rgb
  color 0.034705
  name Constant1
  xpos -440
  ypos 2450
 }
push $N6f9b2800
push $N6f947c00
 Viewer {
  inputs 2
  frame_range 1-480
  gain 0.015625
  colour_sample_bbox {0.00390625 -0.1640625 0.005859375 -0.162109375}
  name Viewer1
  xpos -2115
  ypos 2819
 }
end_group
Multiply {
 value 0.01
 name Multiply13
 label "Div by 100 to go from nits"
 xpos -156
 ypos 1330
}
Shuffle2 {
 fromInput1 {{0} B}
 fromInput2 {{0} B}
 mappings "4 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3"
 name Shuffle48
 xpos -156
 ypos 1372
}
Colorspace {
 colorspace_in CIE-XYZ
 name Colorspace35
 label "XYZ to sRGB Prims"
 xpos -156
 ypos 1396
}
Dot {
 name Dot12
 xpos -122
 ypos 1445
}
set N6f876000 [stack 0]
Dot {
 name Dot18
 xpos 5
 ypos 1471
}
set N6f875c00 [stack 0]
Expression {
 channel0 rgba
 expr0 min((r<0?0:1),(g<0?0:1),(b<0?0:1))
 name Expression18
 xpos -72
 ypos 1496
}
push $N6f875c00
Expression {
 channel0 rgba
 expr0 min((r>1?0:1),(g>1?0:1),(b>1?0:1))
 name Expression19
 xpos 33
 ypos 1494
}
Merge2 {
 inputs 2
 operation multiply
 name Multiply18
 xpos -30
 ypos 1526
}
push $N6f876000
Copy {
 inputs 2
 from0 rgba.alpha
 to0 rgba.alpha
 name Copy6
 xpos -156
 ypos 1582
}
Premult {
 name Premult3
 xpos -156
 ypos 1614
}
Dot {
 name Dot19
 xpos -122
 ypos 1721
}
push $N65301000
Merge2 {
 inputs 2
 name Merge2
 xpos -8
 ypos 1794
}
Write {
 file /Users/afry/GitHub/nukeZCAM/images/gamutBounds/JMh_sRGBgamutBound_tempImg.exr
 file_type exr
 first_part rgba
 version 3099
 in_colorspace scene_linear
 out_colorspace scene_linear
 name Write11
 xpos -8
 ypos 1831
 addUserKnob {20 User}
 addUserKnob {22 recursiveWrite T "writeNode = nuke.thisNode()\nmergeNode = writeNode.input(0)\nreadNode = writeNode.input(0).input(0)\n\nwriteNode.setInput(0,writeNode.input(0).input(1))\nnuke.execute(writeNode, 0, 0)\nreadNode.knob('reload').execute()\nwriteNode.setInput(0,mergeNode)\n\n\nfor i in range(0,1024):\n    nuke.execute(writeNode, i, i)\n    readNode.knob('reload').execute()" +STARTLINE}
}
push $N60c87200
push $N60c87200
Viewer {
 inputs 2
 frame_range 1-480
 colour_sample_bbox {0.982421875 -0.3955078125 0.9833984375 -0.39453125}
 samplepoints {{-0.4586805701 0.001736111124}
   }
 gl_buffer_depth half-float
 viewerProcess None
 input_process false
 translate {-1.083500028 -0.07800000161}
 name Viewer1
 xpos 1207
 ypos 64
}
